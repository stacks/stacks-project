\input{preamble}

% OK, start here.
%
\begin{document}

\title{Algebraic Curves}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
In this chapter we develop some of the theory of algebraic curves.
A reference covering algebraic curves over the complex numbers is
the book \cite{ACGH}.

\medskip\noindent
What we already know. Besides general algebraic geometry, we
have already proved some specific results on algebraic curves.
Here is a list.
\begin{enumerate}
\item We have discussed affine opens of and ample invertible sheaves on
$1$ dimensional Noetherian schemes in
Varieties, Section \ref{varieties-section-dimension-one}.
\item We have seen a curve is either affine or projective
in Varieties, Section \ref{varieties-section-curves}.
\item We have discussed degrees of locally free modules on
proper curves in Varieties, Section \ref{varieties-section-divisors-curves}.
\item We have discussed the Picard scheme of a nonsingular projective
curve over an algebraically closed field in
Picard Schemes of Curves, Section \ref{pic-section-introduction}.
\end{enumerate}





\section{Curves and function fields}
\label{section-curves-function-fields}

\noindent
In this section we elaborate on the results of
Varieties, Section \ref{varieties-section-varieties-rational-maps}
in the case of curves.

\begin{lemma}
\label{lemma-extend-over-dvr}
Let $k$ be a field. Let $X$ be a curve and $Y$ a proper variety.
Let $U \subset X$ be a nonempty open and let $f : U \to Y$ be a morphism.
If $x \in X$ is a closed point such that $\mathcal{O}_{X, x}$
is a discrete valuation ring, then there exists an open
$U \subset U' \subset X$ containing $x$ and a morphism of
varieties $f' : U' \to Y$ extending $f$.
\end{lemma}

\begin{proof}
This is a specical case of
Morphisms, Lemma \ref{morphisms-lemma-extend-across}.
\end{proof}

\begin{lemma}
\label{lemma-extend-over-normal-curve}
Let $k$ be a field. Let $X$ be a normal curve and $Y$ a proper variety.
The set of rational maps from $X$ to $Y$ is the same as the set
of morphisms $X \to Y$.
\end{lemma}

\begin{proof}
This is clear from Lemma \ref{lemma-extend-over-dvr}
as every local ring is a discrete valuation ring
(for example by Varieties, Lemma \ref{varieties-lemma-regular-point-on-curve}).
\end{proof}

\begin{lemma}
\label{lemma-extend-to-completion}
Let $k$ be a field. Let $X \to Y$ be a morphism of varieties
with $Y$ proper. There exists a factorization $X \to \overline{X} \to Y$
where $X \to \overline{X}$ is an open immersion
and $\overline{X}$ is a projective curve.
\end{lemma}

\begin{proof}
This is clear from Lemma \ref{lemma-extend-over-dvr}
and Varieties, Lemma \ref{varieties-lemma-reduced-dim-1-projective-completion}.
\end{proof}

\noindent
Here is the main theorem of this section. We will say a morphism
$f : X \to Y$ of varieties is {\it constant} if the image $f(X)$
consists of a single point $y$ of $Y$. If this happens then
$y$ is a closed point of $Y$ (since the image of a closed point
of $X$ will be a closed point of $Y$).

\begin{theorem}
\label{theorem-curves-rational-maps}
Let $k$ be a field. The following categories are canonically equivalent
\begin{enumerate}
\item The category of finitely generated field extensions $K/k$ of
transcendence degree $1$.
\item The category of curves and dominant rational maps.
\item The category of normal projective curves and nonconstant morphisms.
\item The category of nonsingular projective curves and nonconstant morphisms.
\item The category of regular projective curves and nonconstant morphisms.
\item The category of normal proper curves and nonconstant morphisms.
\end{enumerate}
\end{theorem}

\begin{proof}
The equivalence between categories (1) and (2) is the restriction of the
equivalence of
Varieties, Theorem \ref{varieties-theorem-varieties-rational-maps}.
Namely, a variety is a curve if and only if its function field has
transcendence degree $1$, see for example
Varieties, Lemma \ref{varieties-lemma-dimension-locally-algebraic}.

\medskip\noindent
The categories in (3), (4), (5), and (6) are the same. First of all, the
terms ``regular'' and ``nonsingular'' are synonyms, see
Properties, Definition \ref{properties-definition-regular}.
Being normal and regular are the same thing for Noetherian
$1$-dimensional schemes
(Properties, Lemmas \ref{properties-lemma-regular-normal} and
\ref{properties-lemma-normal-dimension-1-regular}). See
Varieties, Lemma \ref{varieties-lemma-regular-point-on-curve}
for the case of curves. Thus (3) is the same as (5). Finally, (6)
is the same as (3) by
Varieties, Lemma \ref{varieties-lemma-dim-1-proper-projective}.

\medskip\noindent
If $f : X \to Y$ is a nonconstant morphism of nonsingular projective curves,
then $f$ sends the generic point $\eta$ of $X$ to the generic point $\xi$ of
$Y$. Hence we obtain a morphism
$k(Y) = \mathcal{O}_{Y, \xi} \to \mathcal{O}_{X, \eta} = k(X)$
in the category (1). Conversely, suppose that we have a map
$k(Y) \to k(X)$ in the category (1). Then we obtain a morphism $U \to Y$
for some nonempty open $U \subset X$. By Lemma \ref{lemma-extend-over-dvr}
this extends to all of $X$ and we obtain a morphism in the category (5).
Thus we see that there is a fully faithfull functor (5)$\to$(1).

\medskip\noindent
To finish the proof we have to show that every $K/k$ in (1)
is the function field of a normal projective curve.
We already know that $K = k(X)$ for some curve $X$.
After replacing $X$ by its normalization
(which is a variety birational to $X$)
we may assume $X$ is normal
(Varieties, Lemma \ref{varieties-lemma-normalization-locally-algebraic}).
Then we choose $X \to \overline{X}$ with
$\overline{X} \setminus X = \{x_1, \ldots, x_n\}$ as in
Varieties, Lemma \ref{varieties-lemma-reduced-dim-1-projective-completion}.
Since $X$ is normal and since each
of the local rings $\mathcal{O}_{\overline{X}, x_i}$ is normal
we conclude that $\overline{X}$ is a normal projective curve as desired.
(Remark: We can also first compactify using
Varieties, Lemma \ref{varieties-lemma-dim-1-projective-completion}
and then normalize using
Varieties, Lemma \ref{varieties-lemma-normalization-locally-algebraic}.
Doing it this way we avoid using the somewhat tricky
Morphisms, Lemma \ref{morphisms-lemma-relative-normalization-normal-codim-1}.)
\end{proof}

\begin{definition}
\label{definition-normal-projective-model}
Let $k$ be a field. Let $X$ be a curve.
A {\it nonsingular projective model of $X$}
is a pair $(Y, \varphi)$ where $Y$ is a nonsingular projective
curve and $\varphi : k(X) \to k(Y)$ is an isomorphism
of function fields.
\end{definition}

\noindent
A nonsingular projective model is determined up to unique
isomorphism by Theorem \ref{theorem-curves-rational-maps}.
Thus we often say ``the nonsingular projective model''.
We usually drop $\varphi$ from the notation.
Warning: it needn't be the case that $Y$ is smooth over $k$
but Lemma \ref{lemma-nonsingular-model-smooth}
shows this can only happen in positive characteristic.

\begin{lemma}
\label{lemma-nonsingular-model-smooth}
Let $k$ be a field. Let $X$ be a curve and let $Y$ be the nonsingular
projective model of $X$. If $k$ is perfect, then $Y$ is a smooth
projective curve.
\end{lemma}

\begin{proof}
See Varieties, Lemma \ref{varieties-lemma-regular-point-on-curve}
for example.
\end{proof}

\begin{lemma}
\label{lemma-smooth-models}
Let $k$ be a field. Let $X$ be a geometrically irreducible curve over $k$.
For a field extension $K/k$ denote $Y_K$ a nonsingular projective model
of $(X_K)_{red}$.
\begin{enumerate}
\item If $X$ is proper, then $Y_K$ is the normalization of $X_K$.
\item There exists $K/k$ finite purely inseparable such that $Y_K$ is smooth.
\item Whenever $Y_K$ is smooth\footnote{Or even geometrically reduced.}
we have $H^0(Y_K, \mathcal{O}_{Y_K}) = K$.
\item Given a commutative diagram
$$
\xymatrix{
\Omega & K' \ar[l] \\
K \ar[u] & k \ar[l] \ar[u]
}
$$
of fields such that $Y_K$ and $Y_{K'}$ are smooth, then
$Y_\Omega = (Y_K)_\Omega = (Y_{K'})_\Omega$.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $X'$ be a nonsingular projective model of $X$. Then $X'$ and
$X$ have isomorphic nonempty open subschemes. In particular
$X'$ is geometrically irreducible as $X$ is (some details omitted).
Thus we may assume that $X$ is projective.

\medskip\noindent
Assume $X$ is proper. Then $X_K$ is proper and hence the normalization
$(X_K)^\nu$ is proper as a scheme finite over a proper scheme
(Varieties, Lemma \ref{varieties-lemma-normalization-locally-algebraic}
and Morphisms, Lemmas \ref{morphisms-lemma-finite-proper} and
\ref{morphisms-lemma-composition-proper}).
On the other hand, $X_K$ is irreducible as $X$ is geometrically
irreducible. Hence $X_K^\nu$ is proper, normal, irreducible, and birational
to $(X_K)_{red}$. This proves (1) because a proper curve is projective
(Varieties, Lemma \ref{varieties-lemma-dim-1-proper-projective}).

\medskip\noindent
Proof of (2). As $X$ is proper and we have (1), we can apply
Varieties, Lemma \ref{varieties-lemma-finite-extension-geometrically-normal}
to find $K/k$ finite purely inseparable such that
$Y_K$ is geometrically normal. Then $Y_K$ is geometrically regular
as normal and regular are the same for curves
(Properties, Lemma \ref{properties-lemma-normal-dimension-1-regular}).
Then $Y$ is a smooth variety by
Varieties, Lemma \ref{varieties-lemma-geometrically-regular-smooth}.

\medskip\noindent
If $Y_K$ is geometrically reduced, then $Y_K$ is geometrically
integral (Varieties, Lemma \ref{varieties-lemma-geometrically-integral})
and we see that $H^0(Y_K, \mathcal{O}_{Y_K}) = K$ by
Varieties, Lemma \ref{varieties-lemma-regular-functions-proper-variety}.
This proves (3) because a smooth variety is geometrically reduced
(even geometrically regular, see
Varieties, Lemma \ref{varieties-lemma-geometrically-regular-smooth}).

\medskip\noindent
If $Y_K$ is smooth, then for every extension $\Omega/K$
the base change $(Y_K)_\Omega$ is smooth over $\Omega$
(Morphisms, Lemma \ref{morphisms-lemma-base-change-smooth}).
Hence it is clear that $Y_\omega = (Y_K)_\Omega$. This proves (4).
\end{proof}






\section{Riemann-Roch and duality}
\label{section-Riemann-Roch}

\noindent
Let $k$ be a field. Let $X$ be a proper scheme of dimension $\leq 1$
over $k$. In Varieties, Section \ref{varieties-section-divisors-curves}
we have defined the degree of a locally free $\mathcal{O}_X$-module
$\mathcal{E}$ of constant rank by the formula
\begin{equation}
\label{equation-degree}
\deg(\mathcal{E}) =
\chi(X, \mathcal{E}) - \text{rank}(\mathcal{E})\chi(X, \mathcal{O}_X)
\end{equation}
see Varieties, Definition \ref{varieties-definition-degree-invertible-sheaf}.
In the chapter on Chow Homology we defined the first chern class of
$\mathcal{E}$ as an operation on cycles
(Chow Homology, Section
\ref{chow-section-intersecting-chern-classes}) and we proved that
\begin{equation}
\label{equation-degree-c1}
\deg(\mathcal{E}) = \deg(c_1(\mathcal{E}) \cap [X]_1)
\end{equation}
see Chow Homology, Lemma \ref{chow-lemma-degree-vector-bundle}.
Combining (\ref{equation-degree}) and (\ref{equation-degree-c1})
we obtain our first version of the Riemann-Roch formula
\begin{equation}
\label{equation-rr}
\chi(X, \mathcal{E}) =
\deg(c_1(\mathcal{E}) \cap [X]_1) +
\text{rank}(\mathcal{E})\chi(X, \mathcal{O}_X)
\end{equation}
If $\mathcal{L}$ is an invertible $\mathcal{O}_X$-module, then
we can also consider the numerical intersection
$(\mathcal{L} \cdot X)$ as defined in
Varieties, Definition \ref{varieties-definition-intersection-number}.
However, this does not give anything new as
\begin{equation}
\label{equation-numerical-degree}
(\mathcal{L} \cdot X) = \deg(\mathcal{L})
\end{equation}
by Varieties, Lemma
\ref{varieties-lemma-intersection-numbers-and-degrees-on-curves}. If
$\mathcal{L}$ is ample, then this integer is positive and is
called the degree
\begin{equation}
\label{equation-degree-X}
\deg_\mathcal{L}(X) = (\mathcal{L} \cdot X) = \deg(\mathcal{L})
\end{equation}
of $X$ with respect to $\mathcal{L}$, see
Varieties, Definition \ref{varieties-definition-degree}.

\medskip\noindent
To obtain a true Riemann-Roch theorem we would like to write
$\chi(X, \mathcal{O}_X)$ as the degree of a canonical zero cycle on $X$.
We refer to \cite{F} for a fully general version of this. We will use
duality to get a formula in the case where $X$ is Gorenstein; however,
in some sense this is a cheat (for example because this method cannot
work in higher dimension).

\begin{lemma}
\label{lemma-duality-dim-1}
Let $X$ be a proper scheme of dimension $\leq 1$ over a field $k$.
There exists a dualizing complex $\omega_X^\bullet$ with the
following properties
\begin{enumerate}
\item $H^i(\omega_X^\bullet)$ is nonzero only for $i = -1, 0$,
\item $\omega_X = H^{-1}(\omega_X^\bullet)$
is a coherent Cohen-Macaulay module whose support is the
irreducible components of dimension $1$,
\item for $x \in X$ closed, the module $H^0(\omega_{X, x}^\bullet)$
is nonzero if and only if either
\begin{enumerate}
\item $\dim(\mathcal{O}_{X, x}) = 0$ or
\item $\dim(\mathcal{O}_{X, x}) = 1$
and $\mathcal{O}_{X, x}$ is not Cohen-Macaulay,
\end{enumerate}
\item there are functorial isomorphisms
$\text{Ext}^i_X(K, \omega_X^\bullet) = \Hom_k(H^{-i}(X, K), k)$
compatible with shifts for $K \in D_\QCoh(X)$,
\item there are functorial isomorphisms
$\Hom(\mathcal{F}, \omega_X) = \Hom_k(H^1(X, \mathcal{F}), k)$
for $\mathcal{F}$ quasi-coherent on $X$,
\item if $X \to \Spec(k)$ is smooth of relative dimension $1$,
then $\omega_X \cong \Omega_{X/k}$.
\end{enumerate}
\end{lemma}

\begin{proof}
Denote $f : X \to \Spec(k)$ the structure morphism.
We start with the relative dualizing complex
$$
\omega_X^\bullet = \omega_{X/k}^\bullet = a(\mathcal{O}_{\Spec(k)})
$$
as described in Dualizing Complexes,
Remark \ref{dualizing-remark-relative-dualizing-complex}.
Then property (4) holds by construction.
Observe that $\omega_X^\bullet$ is also the dualizing complex
normalized relative to
$\omega_{\Spec(k)}^\bullet = \mathcal{O}_{\Spec(k)}$, i.e.,
it is the dualizing complex $\omega_X^\bullet$
as in Dualizing Complexes, Example \ref{dualizing-example-proper-over-local}
with $A = k$ and $\omega_A = k[0]$.
Parts (1) and (2) follow from
Dualizing Complexes, Lemma \ref{dualizing-lemma-vanishing-good-dualizing}.
For a closed point $x \in X$ we see that $\omega_{X, x}^\bullet$ is a
normalized dualizing complex over $\mathcal{O}_{X, x}$, see
Dualizing Complexes, Lemma \ref{dualizing-lemma-good-dualizing-normalized}.
Assertion (3) then follows from
Dualizing Complexes, Lemma \ref{dualizing-lemma-apply-CM}.
Assertion (5) follows from
Dualizing Complexes, Lemma \ref{dualizing-lemma-dualizing-module-proper-over-A}
for coherent $\mathcal{F}$ and in general by unwinding
(4) for $K = \mathcal{F}[0]$ and $i = -1$.
Assertion (6) follows from Dualizing Complexes,
Lemma \ref{dualizing-lemma-smooth-proper}.
\end{proof}

\begin{lemma}
\label{lemma-duality-dim-1-CM}
Let $X$ be a proper scheme over a field $k$ which is Cohen-Macaulay
and equidimensional of dimension $1$. There exists a dualizing module
$\omega_X$ with the following properties
\begin{enumerate}
\item $\omega_X$ is a coherent Cohen-Macaulay module whose support is $X$,
\item there are functorial isomorphisms
$\text{Ext}^i_X(K, \omega_X[1]) = \Hom_k(H^{-i}(X, K), k)$
compatible with shifts for $K \in D_\QCoh(X)$,
\item there are functorial isomorphisms
$\text{Ext}^{1 + i}(\mathcal{F}, \omega_X) = \Hom_k(H^{-i}(X, \mathcal{F}), k)$
for $\mathcal{F}$ quasi-coherent on $X$.
\end{enumerate}
\end{lemma}

\begin{proof}
Let us take $\omega_X$ normalized as in
as in Dualizing Complexes, Example
\ref{dualizing-example-equidimensional-over-field}.
Then the statements follow from
Lemma \ref{lemma-duality-dim-1}
and the fact that $\omega_X^\bullet = \omega_X[1]$
as $X$ is Cohen-Macualay (Dualizing Complexes, Lemma
\ref{dualizing-lemma-dualizing-module-CM-scheme}).
\end{proof}

\begin{remark}
\label{remark-rework-duality-locally-free}
Let $X$ be a proper scheme of dimension $\leq 1$ over a field $k$.
Let $\omega_X^\bullet$ be as in Lemma \ref{lemma-duality-dim-1}.
If $\mathcal{E}$ is a finite locally free $\mathcal{O}_X$-module
with dual $\mathcal{E}^\wedge$ then we have canonical isomorphisms
$$
\Hom_k(H^{-i}(X, \mathcal{E}), k) =
H^i(X, \mathcal{E}^\wedge \otimes_{\mathcal{O}_X}^\mathbf{L} \omega_X^\bullet)
$$
This follows from the lemma and
Cohomology, Lemma \ref{cohomology-lemma-dual-perfect-complex}.
If $X$ is Cohen-Macaulay and equidimensional of dimension $1$, then
we have canonical isomorphisms
$$
\Hom_k(H^{-i}(X, \mathcal{E}), k) =
H^{1 - i}(X, \mathcal{E}^\wedge \otimes_{\mathcal{O}_X} \omega_X)
$$
where $\omega_X$ is as in Lemma \ref{lemma-duality-dim-1-CM}. In particular
if $\mathcal{L}$ is an invertible $\mathcal{O}_X$-module, then we have
$$
\dim_k H^0(X, \mathcal{L}) =
\dim_k H^1(X, \mathcal{L}^{\otimes -1} \otimes_{\mathcal{O}_X} \omega_X)
$$
and
$$
\dim_k H^1(X, \mathcal{L}) =
\dim_k H^0(X, \mathcal{L}^{\otimes -1} \otimes_{\mathcal{O}_X} \omega_X)
$$
\end{remark}

\noindent
We can use Lemmas \ref{lemma-duality-dim-1} and \ref{lemma-duality-dim-1-CM}
to get a relation between the euler
characteristic of $\mathcal{O}_X$ and the euler characteristic
of the dualizing complex or the dualizing module.

\begin{lemma}
\label{lemma-euler}
Let $X$ be a proper scheme of dimension $\leq 1$ over a field $k$.
With $\omega_X^\bullet$ as in Lemma \ref{lemma-duality-dim-1} we have
$$
\chi(X, \mathcal{O}_X) = \chi(X, \omega_X^\bullet)
$$
If $X$ is Cohen-Macaulay and equidimensional of dimension $1$, then
$$
\chi(X, \mathcal{O}_X) = - \chi(X, \omega_X)
$$
with $\omega_X$ as in Lemma \ref{lemma-duality-dim-1-CM}.
\end{lemma}

\begin{proof}
We define the right hand side of the first formula as follows:
$$
\chi(X, \omega_X^\bullet) =
\sum\nolimits_{i \in \mathbf{Z}} (-1)^i\dim_k H^i(X, \omega_X^\bullet)
$$
This is well defined because $\omega_X^\bullet$ is in
$D^b_{\textit{Coh}}(\mathcal{O}_X)$, but also because
$$
H^i(X, \omega_X^\bullet) =
\text{Ext}^i(\mathcal{O}_X, \omega_X^\bullet) =
H^{-i}(X, \mathcal{O}_X)
$$
which is always finite dimensional and nonzero only if $i = 0, -1$.
This of course also proves the first formula. The second is a consequence
of the first because $\omega_X^\bullet = \omega_X[1]$ in the CM case.
\end{proof}

\noindent
We will use Lemma \ref{lemma-euler} to get the desired formula for
$\chi(X, \mathcal{O}_X)$ in the case that $\omega_X$ is
invertible, i.e., that $X$ is Gorenstein.
The statement is that $-1/2$ of the first chern class of $\omega_X$
capped with the cycle $[X]_1$ associated to $X$ is a natural zero
cycle on $X$ with half-integer coefficients whose degree is
$\chi(X, \mathcal{O}_X)$.
The occurence of fractions in the statement of Riemann-Roch cannot
be avoided.

\begin{lemma}[Rieman-Roch]
\label{lemma-rr}
Let $X$ be a proper scheme over a field $k$ which is Gorenstein and
equidimensional of dimension $1$. Let $\omega_X$ be as in
Lemma \ref{lemma-duality-dim-1-CM}. Then
\begin{enumerate}
\item $\omega_X$ is an invertible $\mathcal{O}_X$-module,
\item $\deg(\omega_X) = -2\chi(X, \mathcal{O}_X)$,
\item for a locally free $\mathcal{O}_X$-module $\mathcal{E}$
of constant rank we have
$$
\chi(X, \mathcal{E}) = \deg(\mathcal{E}) -
\textstyle{\frac{1}{2}} \text{rank}(\mathcal{E}) \deg(\omega_X)
$$
and $\dim_k(H^i(X, \mathcal{E})) =
\dim_k(H^{1 - i}(X, \mathcal{E}^\wedge \otimes_{\mathcal{O}_X} \omega_X))$
for all $i \in \mathbf{Z}$.
\end{enumerate}
\end{lemma}

\begin{proof}
It follows more or less from the definition of the Gorenstein property
that the dualizing sheaf is invertible, see
Dualizing Complexes, Section \ref{dualizing-section-gorenstein}.
By (\ref{equation-rr}) applied to $\omega_X$ we have
$$
\chi(X, \omega_X) = 
\deg(c_1(\omega_X) \cap [X]_1) + \chi(X, \mathcal{O}_X)
$$
Combined with Lemma \ref{lemma-euler} this gives
$$
2\chi(X, \mathcal{O}_X) = - \deg(c_1(\omega_X) \cap [X]_1) = - \deg(\omega_X)
$$
the second equality by (\ref{equation-degree-c1}). Putting this back into
(\ref{equation-rr}) for $\mathcal{E}$ gives the displayed formula of the lemma.
The symmetry in dimensions is a consequence of duality for $X$, see
Remark \ref{remark-rework-duality-locally-free}.
\end{proof}




\section{Some vanishing results}
\label{section-vanishing}

\begin{lemma}
\label{lemma-automatic}
Let $k$ be a field. Let $X$ be a proper scheme over $k$ having dimension $1$
and $H^0(X, \mathcal{O}_X) = k$. Then $X$ is Cohen-Macaulay
and equidimensional of dimension $1$.
\end{lemma}

\begin{proof}
Since $\Gamma(X, \mathcal{O}_X) = k$ has no nontrivial idempotents,
we see that $X$ is connected. This already shows that $X$ is
equidimensional of dimension $1$ (any irreducible component
of dimension $0$ would be a connected component).
Let $\mathcal{I} \subset \mathcal{O}_X$
be the maximal coherent submodule supported in closed points.
Then $\mathcal{I}$ exists
(Divisors, Lemma \ref{divisors-lemma-remove-embedded-points})
and is globally generated
(Varieties, Lemma \ref{varieties-lemma-chi-tensor-finite}).
Since $1 \in \Gamma(X, \mathcal{O}_X)$ is not a section
of $\mathcal{I}$ we conclude that $\mathcal{I} = 0$.
Thus $X$ does not have embedded points
(Divisors, Lemma \ref{divisors-lemma-remove-embedded-points}).
Thus $X$ has $(S_1)$ by
Divisors, Lemma \ref{divisors-lemma-S1-no-embedded}.
Hence $X$ is Cohen-Macaulay.
\end{proof}

\noindent
In this section we work in the following situation.

\begin{situation}
\label{situation-Cohen-Macaulay-curve}
Here $k$ is a field, $X$ is a proper scheme over $k$ having dimension $1$
and $H^0(X, \mathcal{O}_X) = k$.
\end{situation}

\noindent
By Lemma \ref{lemma-automatic} the scheme $X$ is Cohen-Macaulay and
equidimensional of dimension $1$. We denote $\omega_X$ the dualizing module
of $X$ as in Dualizing Complexes, Example
\ref{dualizing-example-equidimensional-over-field}.
Then Lemmas \ref{lemma-duality-dim-1} and \ref{lemma-duality-dim-1-CM}
show that $\omega_X$ has nonvanishing $H^1$ and in fact
$\dim_k H^1(X, \omega_X) = 1$. It turns out
that anything slightly more ``positive'' than $\omega_X$ has vanishing $H^1$.

\begin{lemma}
\label{lemma-vanishing}
In Situation \ref{situation-Cohen-Macaulay-curve}. Given an exact sequence
$$
\omega_X \to \mathcal{F} \to \mathcal{Q} \to 0
$$
of coherent $\mathcal{O}_X$-modules with $H^1(X, \mathcal{Q}) = 0$
(for example if $\dim(\text{Supp}(\mathcal{Q})) = 0$), then
either $H^1(X, \mathcal{F}) = 0$ or
$\mathcal{F} = \omega_X \oplus \mathcal{Q}$.
\end{lemma}

\begin{proof}
(The parenthetical statement follows from
Cohomology of Schemes, Lemma \ref{coherent-lemma-coherent-support-dimension-0}.)
Since $H^0(X, \mathcal{O}_X) = k$ is dual to $H^1(X, \omega_X)$
(see Section \ref{section-Riemann-Roch})
we see that $\dim H^1(X, \omega_X) = 1$. The sheaf $\omega_X$
represents the functor
$\mathcal{F} \mapsto \Hom_k(H^1(X, \mathcal{F}), k)$
on the category of coherent $\mathcal{O}_X$-modules
(Dualizing Complexes, Lemma
\ref{dualizing-lemma-dualizing-module-proper-over-A}).
Consider an exact sequence as in the statement of the lemma
and assume that $H^1(X, \mathcal{F}) \not = 0$. Since
$H^1(X, \mathcal{Q}) = 0$ we see that
$H^1(X, \omega_X) \to H^1(X, \mathcal{F})$ is an isomorphism.
By the universal property of $\omega_X$ stated above, we conclude there
is a map $\mathcal{F} \to \omega_X$ whose action on $H^1$ is the inverse
of this isomorphism. The composition $\omega_X \to \mathcal{F} \to \omega_X$
is the identity (by the universal property) and the lemma is proved.
\end{proof}

\begin{lemma}
\label{lemma-vanishing-twist}
In Situation \ref{situation-Cohen-Macaulay-curve}. Let
$\mathcal{L}$ be an invertible $\mathcal{O}_X$-module which is
globally generated and not isomorphic to $\mathcal{O}_X$. Then
$H^1(X, \omega_X \otimes \mathcal{L}) = 0$.
\end{lemma}

\begin{proof}
By duality as discussed in Section \ref{section-Riemann-Roch} we have to
show that $H^0(X, \mathcal{L}^{\otimes - 1}) = 0$. If not, then we can
choose a global section $t$ of $\mathcal{L}^{\otimes - 1}$
and a global section $s$ of $\mathcal{L}$ such that $st \not = 0$.
However, then $st$ is a constant multiple of $1$, by our assumption
that $H^0(X, \mathcal{O}_X) = k$. It follows that
$\mathcal{L} \cong \mathcal{O}_X$, which is a contradiction.
\end{proof}

\begin{lemma}
\label{lemma-globally-generated}
In Situation \ref{situation-Cohen-Macaulay-curve}. Given an exact sequence
$$
\omega_X \to \mathcal{F} \to \mathcal{Q} \to 0
$$
of coherent $\mathcal{O}_X$-modules with $\dim(\text{Supp}(\mathcal{Q})) = 0$
and $\dim_k H^0(X, \mathcal{Q}) \geq 2$ and such that there is no nonzero
submodule $\mathcal{Q}' \subset \mathcal{F}$ such that
$\mathcal{Q}' \to \mathcal{Q}$ is injective.
Then the submodule of $\mathcal{F}$ generated by global
sections surjects onto $\mathcal{Q}$.
\end{lemma}

\begin{proof}
Let $\mathcal{F}' \subset \mathcal{F}$ be the submodule generated by
global sections and the image of $\omega_X \to \mathcal{F}$. Since
$\dim_k H^0(X, \mathcal{Q}) \geq 2$ and
$\dim_k H^1(X, \omega_X) = \dim_k H^0(X, \mathcal{O}_X) = 1$,
we see that $\mathcal{F}' \to \mathcal{Q}$ is not zero and
$\omega_X \to \mathcal{F}'$ is not an isomorphism.
Hence $H^1(X, \mathcal{F}') = 0$ by Lemma \ref{lemma-vanishing}
and our assumption on $\mathcal{F}$.
Consider the short exact sequence
$$
0 \to \mathcal{F}' \to \mathcal{F} \to
\mathcal{Q}/\Im(\mathcal{F}' \to \mathcal{Q}) \to 0
$$
If the quotient on the right is nonzero, then we obtain a contradiction
because then $H^0(X, \mathcal{F})$ is bigger than $H^0(X, \mathcal{F}')$.
\end{proof}

\noindent
Here is an example global generation statement.

\begin{lemma}
\label{lemma-globally-generated-curve}
In Situation \ref{situation-Cohen-Macaulay-curve} assume that
$X$ is integral. Let $0 \to \omega_X \to \mathcal{F} \to \mathcal{Q} \to 0$
be a short exact sequence of coherent $\mathcal{O}_X$-modules with
$\mathcal{F}$ torsion free, $\dim(\text{Supp}(\mathcal{Q})) = 0$,
and $\dim_k H^0(X, \mathcal{Q}) \geq 2$. Then $\mathcal{F}$
is globally generated.
\end{lemma}

\begin{proof}
Consider the submodule $\mathcal{F}'$ generated by the global sections. By
Lemma \ref{lemma-globally-generated} we see that $\mathcal{F}' \to \mathcal{Q}$
is surjective, in particular $\mathcal{F}' \not = 0$. Since $X$ is a curve, we
see that $\mathcal{F}' \subset \mathcal{F}$ is an inclusion of rank $1$
sheaves, hence $\mathcal{Q}' = \mathcal{F}/\mathcal{F}'$ is supported in
finitely many points. To get a contradiction, assume that
$\mathcal{Q}'$ is nonzero. Then we see that $H^1(X, \mathcal{F}') \not = 0$.
Then we get a nonzero map $\mathcal{F}' \to \omega_X$ by the universal
property (Dualizing Complexes, Lemma
\ref{dualizing-lemma-dualizing-module-proper-over-A}).
The image of the composition $\mathcal{F}' \to \omega_X \to \mathcal{F}$
is generated by global sections, hence is inside of $\mathcal{F}'$.
Thus we get a nonzero self map $\mathcal{F}' \to \mathcal{F}'$.
Since $\mathcal{F}'$ is torsion free of rank $1$ on a proper curve
this has to be an automorphism (details omitted). But then this implies that
$\mathcal{F}'$ is contained in $\omega_X \subset \mathcal{F}$
contradicting the surjectivity of $\mathcal{F}' \to \mathcal{Q}$.
\end{proof}

\begin{lemma}
\label{lemma-tensor-omega-with-globally-generated-invertible}
In Situation \ref{situation-Cohen-Macaulay-curve}. Let $\mathcal{L}$
be a very ample invertible $\mathcal{O}_X$-module with
$\deg(\mathcal{L}) \geq 2$. Then
$\omega_X \otimes_{\mathcal{O}_X} \mathcal{L}$ is globally generated.
\end{lemma}

\begin{proof}
Assume $k$ is algebraically closed. Let $x \in X$ be a closed point.
Let $C_i \subset X$ be the irreducible components and for each $i$
let $x_i \in C_i$ be the generic point. By
Varieties, Lemma \ref{varieties-lemma-very-ample-vanish-at-point}
we can choose a section $s \in H^0(X, \mathcal{L})$ such that $s$
vanishes at $x$ but not at $x_i$ for all $i$. The corresponding
module map $s : \mathcal{O}_X \to \mathcal{L}$ is injective with
cokernel $\mathcal{Q}$ supported in finitely many points and
with $H^0(X, \mathcal{Q}) \geq 2$. Consider the corresponding
exact sequence
$$
0 \to \omega_X \to \omega_X \otimes \mathcal{L} \to
\omega_X \otimes \mathcal{Q} \to 0
$$
By Lemma \ref{lemma-globally-generated} we see that the module generated
by global sections surjects onto $\omega_X \otimes \mathcal{Q}$.
Since $x$ was arbitrary this proves the lemma. Some details omitted.

\medskip\noindent
We will reduce the case where $k$ is not algebraically closed, to
the algebraically closed field case. We suggest the reader skip
the rest of the proof. Choose an algebraic closure $\overline{k}$
of $k$ and consider the base change $X_{\overline{k}}$. Let us
check that $X_{\overline{k}} \to \Spec(\overline{k})$ is an example
of Situation \ref{situation-Cohen-Macaulay-curve}. By flat base change
(Cohomology of Schemes, Lemma \ref{coherent-lemma-flat-base-change-cohomology})
we see that $H^0(X_{\overline{k}}, \mathcal{O}) = \overline{k}$.
By Varieties, Lemma \ref{varieties-lemma-CM-base-change}
we see that $X_{\overline{k}}$ is Cohen-Macaulay. The scheme
$X_{\overline{k}}$ is proper over $\overline{k}$ (Morphisms,
Lemma \ref{morphisms-lemma-base-change-proper}) and
equidimensional of dimension $1$
(Morphisms, Lemma \ref{morphisms-lemma-dimension-fibre-after-base-change}).
The pullback of $\omega_X$ to $X_{\overline{k}}$ is the dualizing
module of $X_{\overline{k}}$ by
Dualizing Complexes, Lemma \ref{dualizing-lemma-more-base-change}.
The pullback of $\mathcal{L}$ to $X_{\overline{k}}$ is very ample
(Morphisms, Lemma \ref{morphisms-lemma-very-ample-base-change}).
The degree of the pullback of $\mathcal{L}$ to $X_{\overline{k}}$
is equal to the degree of $\mathcal{L}$ on $X$ (Varieties, Lemma
\ref{varieties-lemma-degree-base-change}). Finally, we see that
$\omega_X \otimes \mathcal{L}$ is globally generated if and only
if its base change is so
(Varieties, Lemma \ref{varieties-lemma-globally-generated-base-change}).
In this way we see that the result follows from the result in the
case of an algebraically closed ground field.
\end{proof}





\section{The genus of a curve}
\label{section-genus}

\noindent
If $X$ is a smooth projective curve over an algebraically closed field,
then we've previously defined the genus of $X$ as the dimension of
$H^1(X, \mathcal{O}_X)$, see
Picard Schemes of Curves, Definition \ref{pic-definition-genus}.
Let us generalize this as follows.

\begin{definition}
\label{definition-genus}
Let $k$ be a field. Let $X$ be a proper scheme over $k$ having
dimension $1$ and $H^0(X, \mathcal{O}_X) = k$.
Then the {\it genus} of $X$ is $g = \dim_k H^1(X, \mathcal{O}_X)$.
\end{definition}

\noindent
This is sometimes called the {\it arithmetic genus} of $X$.
In the literature the arithmetic genus of a proper curve $X$
over $k$ is sometimes defined as
$$
p_a(X) = 1 - \chi(X, \mathcal{O}_X) =
1 - \dim_k H^0(X, \mathcal{O}_X) + \dim_k H^1(X, \mathcal{O}_X)
$$
This agrees with our definition when it applies because we assume
$H^0(X, \mathcal{O}_X) = k$. But note that
\begin{enumerate}
\item $p_a(X)$ can be negative, and
\item $p_a(X)$ depends on the base field $k$ and should be written $p_a(X/k)$.
\end{enumerate}
For example if $k = \mathbf{Q}$
and $X = \mathbf{P}^1_{\mathbf{Q}(i)}$ then
$p_a(X/\mathbf{Q}) = -1$ and $p_a(X/\mathbf{Q}(i)) = 0$.

\medskip\noindent
The assumption that $H^0(X, \mathcal{O}_X) = k$ in our definition has
two consequences. On the one hand, it means there is no confusion about
the base field. On the other hand, it implies the scheme $X$ is
Cohen-Macaulay and equidimensional of dimension $1$
(Lemma \ref{lemma-automatic}). Letting $\omega_X$ be the dualizing
module as in Dualizing Complexes, Example
\ref{dualizing-example-equidimensional-over-field}
we see that
\begin{equation}
\label{equation-genus}
g = \dim_k H^1(X, \mathcal{O}_X) = \dim_k H^0(X, \omega_X)
\end{equation}
by duality (see Remark \ref{remark-rework-duality-locally-free}).

\medskip\noindent
If $X$ is proper over $k$ of dimension $\leq 1$ and $H^0(X, \mathcal{O}_X)$
is not equal to the ground field $k$, instead of using the arithmetic genus
$p_a(X)$ given by the displayed formula above we shall use the invariant
$\chi(X, \mathcal{O}_X)$. In fact, it is advocated in
\cite[page 276]{FAC} and \cite[Introduction]{Hirzebruch}
that we should call $\chi(X, \mathcal{O}_X)$ the arithmetic genus.

\begin{lemma}
\label{lemma-genus-base-change}
Let $k'/k$ be a field extension. Let $X$ be a proper scheme over $k$ having
dimension $1$ and $H^0(X, \mathcal{O}_X) = k$. Then $X_{k'}$ is a
proper scheme over $k'$
having dimension $1$ and $H^0(X_{k'}, \mathcal{O}_{X_{k'}}) = k'$.
Moreover the genus of $X_{k'}$ is equal to the genus of $X$.
\end{lemma}

\begin{proof}
The dimension of $X_{k'}$ is $1$ for example by
Morphisms, Lemma \ref{morphisms-lemma-dimension-fibre-after-base-change}.
The morphism $X_{k'} \to \Spec(k')$ is proper by
Morphisms, Lemma \ref{morphisms-lemma-base-change-proper}.
The equality $H^0(X_{k'}, \mathcal{O}_{X_{k'}}) = k'$ follows from
Cohomology of Schemes, Lemma
\ref{coherent-lemma-flat-base-change-cohomology}.
The equality of the genus follows from the same lemma.
\end{proof}



\section{Geometric genus}
\label{section-geometric-genus}

\noindent
If $X$ is a proper and {\bf smooth} curve over $k$ with
$H^0(X, \mathcal{O}_X) = k$, then
$$
p_g(X) = \dim_k H^0(X, \Omega_{X/k})
$$
is called the {\it geometric genus} of $X$. By
Lemma \ref{lemma-duality-dim-1}
we have $\omega_X \cong \Omega_{X/k}$ hence we conclude from
(\ref{equation-genus}) that the geometric genus of $X$ agrees with
the (arithmetic) genus in this case.

\medskip\noindent
For singular curves, we will define the geometric genus as follows.

\begin{definition}
\label{definition-geometric-genus}
Let $k$ be a field. Let $X$ be a geometrically irreducible
curve over $k$. The {\it geometric genus} of $X$ is the genus
of a smooth projective model of $X$ possibly defined over
an extension field of $k$ as in
Lemma \ref{lemma-smooth-models}.
\end{definition}

\noindent
If $k$ is perfect, then the nonsingular projective model $Y$ of $X$
is smooth (Lemma \ref{lemma-nonsingular-model-smooth})
and the geometric genus of $X$ is just the genus of $Y$.
But if $k$ is not perfect, this may not be true.
In this case we choose an extension $K/k$ such that
the nonsingular projective model $Y_K$ of $(X_K)_{red}$ is
a smooth projective curve and we define the geometric genus
of $X$ to be the genus of $Y_K$. This is well defined by
Lemmas \ref{lemma-smooth-models} and \ref{lemma-genus-base-change}.

\begin{remark}
\label{remark-genus-higher-dimension}
Suppose that $X$ is a $d$-dimensional
proper smooth variety over field $k$ with $H^0(X, \mathcal{O}_X) = k$.
Then the {\it arithmetic genus} is often defined as
$p_a(X) = (-1)^d(\chi(X, \mathcal{O}_X) - 1)$ and the {\it geometric genus}
as $p_g(X) = \dim_k H^0(X, \Omega^d_{X/k})$. In this situation
the arithmetic geneus and the geometric genus no longer agree
even though it is still true that $\omega_X \cong \Omega_{X/k}^d$.
For example, if $d = 2$, then we have
\begin{align*}
p_a(X) - p_g(X) & =
h^0(X, \mathcal{O}_X) - h^1(X, \mathcal{O}_X) + h^2(X, \mathcal{O}_X) - 1
- h^0(X, \Omega^2_{X/k}) \\
& =
- h^1(X, \mathcal{O}_X) + h^2(X, \mathcal{O}_X) - h^0(X, \omega_X) \\
& =
- h^1(X, \mathcal{O}_X)
\end{align*}
where $h^i(X, \mathcal{F}) = \dim_k H^i(X, \mathcal{F})$ and
where the last equality follows from duality.
Hence for a surface the difference $p_g(X) - p_a(X)$ is always
nonnegative; it is sometimes called the irregularity of the surface.
If $X = C_1 \times C_2$ is a product of smooth projective curves of
genus $g_1$ and $g_2$, then the irregularity is $g_1 + g_2$.
\end{remark}













\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}
