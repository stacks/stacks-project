\input{preamble}

% OK, start here.
%
\begin{document}

\title{Formal Algebraic Spaces}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
Formal schemes were introduced in \cite{EGA}. A more general version
of formal schemes was introduced in \cite{McQuillan} and another
in \cite{Yasuda}. Formal algebraic spaces were introduced in \cite{Kn}.
Related material and much besides can be found in
\cite{Abbes} and \cite{Fujiwara-Kato}.
This chapter introduces the notion of formal algebraic spaces
we will work with. Our definition is general enough to allow most
classes of formal schemes/spaces in the literature as full subcategories.

\medskip\noindent
Although we do discuss the comparison of some of these alternative theories
with ours, we do not always give full details when it is not necessary for
the logical development of the theory.

\medskip\noindent
Besides introducing formal algebraic spaces, we also prove a few very
basic properties and we discuss a few types of morphisms.










\section{Formal schemes \`a la EGA}
\label{section-formal-schemes-EGA}

\noindent
In this section we review the construction of formal schemes in \cite{EGA}.
This notion, although very useful in algebraic geometry,
may not always be the correct one to consider. Perhaps it is better to say
that in the setup of the theory a number of choices are made, where for
different purposes others might work better. And indeed in the literature
one can find many different closely related theories
adapted to the problem the authors may want to consider. Still, one
of the major advantages of the theory as sketched here is that one
gets to work with definite geometric objects.

\medskip\noindent
Before we start we should point out an issue with the sheaf condition
for sheaves of topological rings or more generally sheaves of topological
spaces. Namely, the big categories
\begin{enumerate}
\item category of topological spaces,
\item category of topological groups,
\item category of topological rings,
\item category of topological modules over a given topological ring,
\end{enumerate}
endowed with their natural forgetful functors to $\textit{Sets}$ are not
examples of types of algebraic structures as defined in
Sheaves, Section \ref{sheaves-section-algebraic-structures}.
Thus we cannot blithely apply to them the machinery developed in that
chapter. On the other hand, each of the categories
listed above has limits and equalizers and the forgetful functor
to sets, groups, rings, modules commutes with them
(see Topology, Lemmas \ref{topology-lemma-limits},
\ref{topology-lemma-topological-group-limits},
\ref{topology-lemma-topological-ring-limits}, and
\ref{topology-lemma-topological-module-limits}).
Thus we can define the notion of a
sheaf as in Sheaves, Definition
\ref{sheaves-definition-sheaf-values-in-category}
and the underlying presheaf of sets, groups, rings, or modules
is a sheaf. The key difference is that for an open covering
$U = \bigcup_{i \in I} U_i$ the diagram
$$
\xymatrix{
\mathcal{F}(U) \ar[r]
&
\prod\nolimits_{i\in I}
\mathcal{F}(U_i)
\ar@<1ex>[r] \ar@<-1ex>[r]
&
\prod\nolimits_{(i_0, i_1) \in I \times I}
\mathcal{F}(U_{i_0} \cap U_{i_1})
}
$$
has to be an equalizer diagram in the category of topological
spaces, topological groups, topological rings, topological modules,
i.e., that the first map identifies
$\mathcal{F}(U)$ with a subspace of $\prod_{i \in I} \mathcal{F}(U_i)$
which is endowed with the product topology.

\medskip\noindent
The stalk $\mathcal{F}_x$ of a sheaf $\mathcal{F}$
of topological spaces, topological groups, topological rings, or
topological modules at a point $x \in X$ is defined as the colimit over
open neighbourhoods
$$
\mathcal{F}_x = \colim_{x\in U} \mathcal{F}(U)
$$
in the corresponding category. This is the same as taking
the colimit on the level of sets, groups, rings, or modules
(see Topology, Lemmas \ref{topology-lemma-colimits},
\ref{topology-lemma-topological-group-colimits},
\ref{topology-lemma-topological-ring-colimits}, and
\ref{topology-lemma-topological-module-colimits})
but comes equipped with a topology. Warning:
the topology one gets depends on which category one is working with, see
Examples, Section \ref{examples-section-colimit-topology}.
One can sheafify presheaves of topological spaces,
topological groups, topological rings, or topological modules
and taking stalks commutes with this operation, see
Remark \ref{remark-sheafification-of-presheaves-in-top}.

\medskip\noindent
Let $f : X \to Y$ be a continuous map of topological spaces.
There is a functor $f_*$ from the category of sheaves of topological
spaces, topological groups, topological rings, topological modules,
to the corresponding category of sheaves on $Y$ which is defined by setting
$f_*\mathcal{F}(V) = \mathcal{F}(f^{-1}V)$ as usual.
(We delay discussing the pullback in this setting till later.)
We define the notion of an $f$-map $\xi : \mathcal{G} \to \mathcal{F}$
between a sheaf of topological spaces $\mathcal{G}$ on $Y$ and
a sheaf of topological spaces $\mathcal{F}$ on $X$ in exactly the
same manner as in Sheaves, Definition \ref{sheaves-definition-f-map}
with the additional constraint that
$\xi_V : \mathcal{G}(V) \to \mathcal{F}(f^{-1}V)$ be continuous
for every open $V \subset Y$. We have
$$
\{f\text{-maps from }\mathcal{G}\text{ to }\mathcal{F}\} =
\Mor_{\Sh(Y, \textit{Top})}(\mathcal{G}, f_*\mathcal{F})
$$
as in Sheaves, Lemma \ref{sheaves-lemma-f-map}. Similarly for
sheaves of topological groups, topological rings, topological modules. Finally,
let $\xi : \mathcal{G} \to \mathcal{F}$ be an $f$-map as above.
Then given $x \in X$ with image $y = f(x)$ there is a continuous
map
$$
\xi_x : \mathcal{G}_y \longrightarrow \mathcal{F}_x
$$
of stalks defined in exactly the same manner as in the discussion
following Sheaves, Definition \ref{sheaves-definition-composition-f-maps}.

\medskip\noindent
Using the discussion above, we can define a category $LTRS$ of
``locally topologically ringed spaces''. An object is a pair
$(X, \mathcal{O}_X)$ consisting of a topological space
$X$ and a sheaf of topological rings $\mathcal{O}_X$ whose stalks
$\mathcal{O}_{X, x}$ are local rings (if one forgets about the topology).
A morphism $(X, \mathcal{O}_X) \to (Y, \mathcal{O}_Y)$ of
$LTRS$ is a pair $(f, f^\sharp)$ where $f : X \to Y$ is a continuous
map of topological spaces and $f^\sharp : \mathcal{O}_Y \to \mathcal{O}_X$
is an $f$-map such that for every $x \in X$ the induced map
$$
f^\sharp_x : \mathcal{O}_{Y, f(x)} \longrightarrow \mathcal{O}_{X, x}
$$
is a local homomorphism of local rings (forgetting about the topologies).
The composition works in exactly the same manner as composition of
morphisms of locally ringed spaces.

\medskip\noindent
Assume now that the topological space $X$ has a basis consisting
of quasi-compact opens. Given a sheaf $\mathcal{F}$ of sets, groups,
rings, modules over a ring, one can endow $\mathcal{F}$ with
the structure of a sheaf of topological spaces, topological groups,
topological rings, topological modules.
Namely, if $U \subset X$ is quasi-compact open,
we endow $\mathcal{F}(U)$ with the discrete topology. If $U \subset X$
is arbitrary, then we choose an open covering $U = \bigcup_{i \in I} U_i$
by quasi-compact opens and we endow $\mathcal{F}(U)$ with
the induced topology from $\prod_{i \in I} \mathcal{F}(U_i)$
(as we should do according to our discussion above).
The reader may verify (omitted) that we obtain a sheaf of topological spaces,
topological groups, topological rings, topological modules in this fashion.
Let us say that a sheaf of topological spaces, topological groups,
topological rings, topological modules is
{\it pseudo-discrete} if the topology on $\mathcal{F}(U)$ is
discrete for every quasi-compact open $U \subset X$. Then
the construction given above is an adjoint to the forgetful functor
and induces an equivalence between the category of sheaves
of sets and the category of pseudo-discrete sheaves of topological spaces
(similarly for groups, rings, modules).

\medskip\noindent
Grothendieck and Dieudonn\'e first define formal affine schemes.
These correspond to admissible topological rings $A$, see
More on Algebra, Definition \ref{more-algebra-definition-topological-ring}.
Namely, given $A$ one considers a fundamental system $I_\lambda$ of ideals
of definition for the ring $A$. (In any admissible topological ring
the family of all ideals of definition forms a fundamental system.)
For each $\lambda$ we can consider the
scheme $\Spec(A/I_\lambda)$. For $I_\lambda \subset I_\mu$ the induced
morphism
$$
\Spec(A/I_\mu) \to \Spec(A/I_\lambda)
$$
is a thickening because $I_\mu^n \subset I_\lambda$ for some $n$.
Another way to see this, is to notice that the image of each of the
maps
$$
\Spec(A/I_\lambda) \to \Spec(A)
$$
is a homeomorphism onto the set of open prime ideals of $A$.
This motivates the definition
$$
\text{Spf}(A) = \{\text{open prime ideals }\mathfrak p \subset A\}
$$
endowed with the topology coming from $\Spec(A)$. For each $\lambda$
we can consider the structure sheaf $\mathcal{O}_{\Spec(A/I_\lambda)}$
as a sheaf on $\text{Spf}(A)$. Let $\mathcal{O}_\lambda$ be the corresponding
pseudo-discrete sheaf of topological rings, see above.
Then we set
$$
\mathcal{O}_{\text{Spf}(A)} = \lim \mathcal{O}_\lambda
$$
where the limit is taken in the category of sheaves of topological rings.
The pair $(\text{Spf}(A), \mathcal{O}_{\text{Spf}(A)})$ is called the
{\it formal spectrum} of $A$.

\medskip\noindent
At this point one should check several things. The first is that
the stalks $\mathcal{O}_{\text{Spf}(A), x}$ are local rings
(forgetting about the topology). The second is that given
$f \in A$, for the corresponding open $D(f) \cap \text{Spf}(A)$
we have
$$
\Gamma(D(f) \cap \text{Spf}(A), \mathcal{O}_{\text{Spf}(A)})
= A_{\{f\}} = \lim (A/I_\lambda)_f
$$
as topological rings where $I_\lambda$ is a fundamental system of ideals
of definition as above. Moreover, the ring $A_{\{f\}}$ is admissible too and
$(\text{Spf}(A_f), \mathcal{O}_{\text{Spf}(A_{\{f\}})})$
is isomorphic to
$(D(f) \cap \text{Spf}(A),
\mathcal{O}_{\text{Spf}(A)}|_{D(f) \cap \text{Spf}(A)})$.
Finally, given a pair of admissible topological rings $A, B$
we have
\begin{equation}
\label{equation-morphisms-affine-formal-schemes}
\Mor_{LTRS}((\text{Spf}(B), \mathcal{O}_{\text{Spf}(B)}),
(\text{Spf}(A), \mathcal{O}_{\text{Spf}(A)}))
= \Hom_{cont}(A, B)
\end{equation}
where $LTRS$ is the category of ``locally topologically ringed spaces''
as defined above.

\medskip\noindent
Having said this, in \cite{EGA} a {\it formal scheme} is defined as a pair
$(\mathfrak X, \mathcal{O}_\mathfrak X)$ where $\mathfrak X$
is a topological space and $\mathcal{O}_\mathfrak X$ is a sheaf
of topological rings such that every point has an open neighbourhood
isomorphic (in $LTRS$) to an affine formal scheme.
A {\it morphism of formal schemes}
$f : (\mathfrak X, \mathcal{O}_\mathfrak X) \to
(\mathfrak Y, \mathcal{O}_\mathfrak Y)$
is a morphism in the category $LTRS$.

\medskip\noindent
Let $A$ be a ring endowed with the discrete topology. Then $A$ is
admissible and the formal scheme $\text{Spf}(A)$ is equal to
$\Spec(A)$. The structure sheaf $\mathcal{O}_{\text{Spf}(A)}$
is the pseudo-discrete sheaf of topological rings associated
to $\mathcal{O}_{\Spec(A)}$, in other words, its underlying
sheaf of rings is equal to $\mathcal{O}_{\Spec(A)}$ and the
ring $\mathcal{O}_{\text{Spf}(A)}(U) = \mathcal{O}_{\Spec(A)}(U)$
over a quasi-compact open $U$ has the discrete topology,
but not in general. Thus we can associate to every affine scheme
a formal affine scheme. In exactly the same manner we can start
with a general scheme $(X, \mathcal{O}_X)$ and associate to
it $(X, \mathcal{O}'_X)$ where $\mathcal{O}'_X$ is the
pseudo-discrete sheaf of topological rings whose underlying
sheaf of rings is $\mathcal{O}_X$. This construction is
compatible with morphisms and defines a functor
\begin{equation}
\label{equation-compare-schemes-formal-schemes}
\textit{Schemes} \longrightarrow \textit{Formal Schemes}
\end{equation}
It follows in a straightforward manner from
(\ref{equation-morphisms-affine-formal-schemes})
that this functor is fully faithful.

\medskip\noindent
Let $\mathfrak X$ be a formal scheme. Let us define the {\it size}
of the formal scheme by the formula
$\text{size}(\mathfrak X) = \max(\aleph_0, \kappa_1, \kappa_2)$
where $\kappa_1$ is the cardinality of the formal affine opens of
$\mathfrak X$ and $\kappa_2$ is the supremum of the cardinalities
of $\mathcal{O}_\mathfrak X(\mathfrak U)$ where
$\mathfrak U \subset \mathfrak X$ is such a formal affine open.

\begin{lemma}
\label{lemma-fully-faithful}
Choose a category of schemes $\Sch_\alpha$
as in Sets, Lemma \ref{sets-lemma-construct-category}.
Given a formal scheme $\mathfrak X$ let
$$
h_\mathfrak X : (\Sch_\alpha)^{opp} \longrightarrow \textit{Sets},\quad
h_\mathfrak X(S) = \Mor_{\textit{Formal Schemes}}(S, \mathfrak X)
$$
be its functor of points. Then we have
$$
\Mor_{\textit{Formal Schemes}}(\mathfrak X, \mathfrak Y) =
\Mor_{\textit{PSh}(\Sch_\alpha)}(h_\mathfrak X, h_\mathfrak Y)
$$
provided the size of $\mathfrak X$ is not too large.
\end{lemma}

\begin{proof}
First we observe that $h_\mathfrak X$ satisfies the sheaf property for
the Zariski topology for any formal scheme $\mathfrak X$ (see
Schemes, Definition \ref{schemes-definition-representable-by-open-immersions}).
This follows from the local nature of morphisms in the category
of formal schemes. Also, for an open immersion
$\mathfrak V \to \mathfrak W$ of formal schemes,
the corresponding transformation of functors $h_\mathfrak V \to h_\mathfrak W$
is injective and representable by open immersions (see
Schemes, Definition \ref{schemes-definition-representable-by-open-immersions}).
Choose an open covering $\mathfrak X = \bigcup \mathfrak U_i$
of a formal scheme by affine formal schemes $\mathfrak U_i$.
Then the collection of functors
$h_{\mathfrak U_i}$ covers $h_\mathfrak X$ (see
Schemes, Definition \ref{schemes-definition-representable-by-open-immersions}).
Finally, note that
$$
h_{\mathfrak U_i} \times_{h_\mathfrak X} h_{\mathfrak U_j} =
h_{\mathfrak U_i \cap \mathfrak U_j}
$$
Hence in order to give a map $h_\mathfrak X \to h_\mathfrak Y$
is equivalent to giving a family of maps
$h_{\mathfrak U_i} \to h_\mathfrak Y$ which agree on overlaps.
Thus we can reduce the bijectivity (resp.\ injectivity) of the map
of the lemma to bijectivity (resp.\ injectivity) for the pairs
$(\mathfrak U_i, \mathfrak Y)$
and injectivity (resp.\ nothing)
for $(\mathfrak U_i \cap \mathfrak U_j, \mathfrak Y)$.
In this way we reduce to the case where $\mathfrak X$ is an
affine formal scheme. Say $\mathfrak X = \text{Spf}(A)$
for some admissible topological ring $A$. Also, choose a
fundamental system of ideals of definition $I_\lambda \subset A$.

\medskip\noindent
We can also localize on $\mathfrak Y$.
Namely, suppose that $\mathfrak V \subset \mathfrak Y$ is an
open formal subscheme and $\varphi : h_\mathfrak X \to h_\mathfrak Y$.
Then
$$
h_\mathfrak V \times_{h_\mathfrak Y, \varphi} h_\mathfrak X \to h_\mathfrak X
$$
is representable by open immersions. Pulling back to
$\Spec(A/I_\lambda)$ for all $\lambda$ we find an open subscheme
$U_\lambda \subset \Spec(A/I_\lambda)$. However, for
$I_\lambda \subset I_\mu$ the morphism $\Spec(A/I_\lambda) \to \Spec(A/I_\mu)$
pulls back $U_\mu$ to $U_\lambda$. Thus these glue to give
an open formal subscheme $\mathfrak U \subset \mathfrak X$.
A straightforward argument (omitted) shows that
$$
h_\mathfrak U = h_\mathfrak V \times_{h_\mathfrak Y} h_\mathfrak X
$$
In this way we see that given an open covering
$\mathfrak Y = \bigcup \mathfrak V_j$ and a transformation
of functors $\varphi :  h_\mathfrak X \to h_\mathfrak Y$
we obtain a corresponding open covering of $\mathfrak X$.
Since $\mathfrak X$ is affine, we can refine this covering by
a finite open covering
$\mathfrak X = \mathfrak U_1 \cup \ldots \cup \mathfrak U_n$
by affine formal subschemes. In other words, for each $i$ there
is a $j$ and a map $\varphi_i : h_{\mathfrak U_i} \to h_{\mathfrak V_j}$
such that
$$
\xymatrix{
h_{\mathfrak U_i} \ar[r]_{\varphi_i} \ar[d] & h_{\mathfrak V_j} \ar[d] \\
h_{\mathfrak X} \ar[r]^\varphi & h_\mathfrak Y
}
$$
commutes. With a few additional arguments (which we omit) this implies
that it suffices to prove the bijectivity of the lemma in case
both $\mathfrak X$ and $\mathfrak Y$ are affine formal schemes.

\medskip\noindent
Assume $\mathfrak X$ and $\mathfrak Y$ are affine formal schemes.
Say $\mathfrak X = \text{Spf}(A)$ and $\mathfrak Y = \text{Spf}(B)$.
Let $\varphi : h_\mathfrak X \to h_\mathfrak Y$ be a transformation
of functors. Let $I_\lambda \subset A$ be a fundamental system of
ideals of definition. The canonical inclusion morphism
$i_\lambda : \Spec(A/I_\lambda) \to \mathfrak X$ maps to a morphism
$\varphi(i_\lambda) : \Spec(A/I_\lambda) \to \mathfrak Y$.
By (\ref{equation-morphisms-affine-formal-schemes}) this corresponds
to a continuous map $\chi_\lambda : B \to A/I_\lambda$.
Since $\varphi$ is a transformation of functors it follows
that for $I_\lambda \subset I_\mu$ the composition
$B \to A/I_\lambda \to A/I_\mu$ is equal to $\chi_\mu$.
In other words we obtain a ring map
$$
\chi = \lim \chi_\lambda : B \longrightarrow \lim A/I_\lambda = A
$$
This is a continuous homomorphism because the inverse image
of $I_\lambda$ is open for all $\lambda$ (as $A/I_\lambda$ has the discrete
topology and $\chi_\lambda$ is continuous). Thus we obtain
a morphism $\text{Spf}(\chi) : \mathfrak X \to \mathfrak Y$ by
(\ref{equation-morphisms-affine-formal-schemes}).
We omit the verification that this construction is the inverse
to the map of the lemma in this case.

\medskip\noindent
Set theoretic remarks. To make this work on the given category
of schemes $\Sch_\alpha$ we just have to make sure all the
schemes used in the proof above are isomorphic to objects of $\Sch_\alpha$.
In fact, a careful analysis shows that it suffices if the
schemes $\Spec(A/I_\lambda)$ occurring above are isomorphic to
objects of $\Sch_\alpha$. For this it certainly suffices to assume
the size of $\mathfrak X$ is at most the size of
a scheme contained in $\Sch_\alpha$.
\end{proof}

\begin{lemma}
\label{lemma-formal-scheme-sheaf-fppf}
Let $\mathfrak X$ be a formal scheme. The functor of points
$h_\mathfrak X$ (see Lemma \ref{lemma-fully-faithful})
satisfies the sheaf condition for fpqc coverings.
\end{lemma}

\begin{proof}
Topologies, Lemma \ref{topologies-lemma-sheaf-property-fpqc}
reduces us to the case of a Zariski covering and a covering
$\{\Spec(S) \to \Spec(R)\}$ with $R \to S$ faithfully flat.
We observed in the proof of Lemma \ref{lemma-fully-faithful} 
that $h_\mathfrak X$ satisfies the sheaf condition for Zariski coverings.

\medskip\noindent
Suppose that $R \to S$ is a faithfully flat ring map.
Denote $\pi : \Spec(S) \to \Spec(R)$ the
corresponding morphism of schemes. It is surjective and flat.
Let $f : \Spec(S) \to \mathfrak X$ be a morphism
such that $f \circ \text{pr}_1 = f \circ \text{pr}_2$
as maps $\Spec(S \otimes_R S) \to \mathfrak X$.
By Descent, Lemma \ref{descent-lemma-equiv-fibre-product}
we see that as a map on the underlying
sets $f$ is of the form $f = g \circ \pi$ for some
(set theoretic) map $g : \Spec(R) \to \mathfrak X$.
By Morphisms, Lemma \ref{morphisms-lemma-fpqc-quotient-topology}
and the fact that $f$ is continuous we see that $g$
is continuous.

\medskip\noindent
Pick $y \in \Spec(R)$. Choose $\mathfrak U \subset \mathfrak X$
an affine formal open subscheme containing $g(y)$.
Say $\mathfrak U = \text{Spf}(A)$ for some admissible topological
ring $A$. By the above we may choose an $r \in R$ such that
$y \in D(r) \subset g^{-1}(\mathfrak U)$.
The restriction of $f$ to $\pi^{-1}(D(r))$ into $\mathfrak U$
corresponds to a continuous ring map $A \to S_r$ by
(\ref{equation-morphisms-affine-formal-schemes}). The two induced ring maps
$A \to S_r \otimes_{R_r} S_r = (S \otimes_R S)_r$ are equal
by assumption on $f$.
Note that $R_r \to S_r$ is faithfully flat.
By Descent, Lemma \ref{descent-lemma-ff-exact} the equalizer of
the two arrows $S_r \to S_r \otimes_{R_r} S_r$ is $R_r$.
We conclude that $A \to S_r$ factors uniquely through a map $A \to R_r$
which is also continuous as it has the same (open) kernel as the
map $A \to S_r$. This map in turn gives a morphism $D(r) \to \mathfrak U$ by
(\ref{equation-morphisms-affine-formal-schemes}).

\medskip\noindent
What have we proved so far? We have shown that for any $y \in \Spec(R)$
there exists a standard affine open
$y \in D(r) \subset \Spec(R)$ such that the morphism
$f|_{\pi^{-1}(D(r))} : \pi^{-1}(D(r)) \to \mathfrak X$ factors uniquely
though some morphism $D(r) \to \mathfrak X$. We omit the
verification that these morphisms glue to the desired
morphism $\Spec(R) \to \mathfrak X$.
\end{proof}

\begin{remark}[McQuillan's variant]
\label{remark-mcquillan}
There is a variant of the construction of formal schemes due to
McQuillan, see \cite{McQuillan}.
He suggests a slight weakening of the condition of admissibility.
Namely, recall that an admissible topological ring is a complete
(and separated by our conventions) topological ring $A$
which is linearly topologized such that there exists an
ideal of definition: an
open ideal $I$ such that any neighbourhood of $0$ contains $I^n$
for some $n \geq 1$.
McQuillan works with what we will call {\it weakly admissible}
topological rings. A weakly admissible topological ring $A$ is a
complete (and separated by our conventions) topological ring
which is linearly topologized such that there exists an
{\it weak ideal of definition}: an open ideal $I$ such that
for all $f \in I$ we have
$f^n \to 0$ for $n \to \infty$. Similarly to the admissible case,
if $I$ is a weak ideal of definition and $J \subset A$ is an
open ideal, then $I \cap J$ is a weak ideal of definition.
Thus the weak ideals of definition form a fundamental system of
open neighbourhoods of $0$ and
one can proceed along much the same route as above
to define a larger category of formal schemes based
on this notion. The analogues of Lemmas \ref{lemma-fully-faithful} and
\ref{lemma-formal-scheme-sheaf-fppf}
still hold in this setting (with the same proof).
\end{remark}

\begin{remark}[Sheafification of presheaves of topological spaces]
\label{remark-sheafification-of-presheaves-in-top}
\begin{reference}
\cite{Gray}
\end{reference}
In this remark we briefly discuss sheafification of presheaves
of topological spaces. The exact same arguments work for
presheaves of topological abelian groups, topological rings, and
topological modules (over a given topological ring). In order to
do this in the correct generality let us work over a site
$\mathcal{C}$. The reader who is interested in the case of (pre)sheaves
over a topological space $X$ should think of objects of $\mathcal{C}$
as the opens of $X$, of morphisms of $\mathcal{C}$ as inclusions of
opens, and of coverings in $\mathcal{C}$ as coverings in $X$, see
Sites, Example \ref{sites-example-site-topological}.
Denote $\Sh(\mathcal{C}, \textit{Top})$ the category of sheaves
of topological spaces on $\mathcal{C}$ and denote
$\textit{PSh}(\mathcal{C}, \textit{Top})$ the category of presheaves
of topological spaces on $\mathcal{C}$.
Let $\mathcal{F}$ be a presheaf of topological spaces on $\mathcal{C}$.
The sheafification $\mathcal{F}^\#$ should satisfy the formula
$$
\Mor_{\textit{PSh}(\mathcal{C}, \textit{Top})}(\mathcal{F}, \mathcal{G})
=
\Mor_{\Sh(\mathcal{C}, \textit{Top})}(\mathcal{F}^\#, \mathcal{G})
$$
functorially in $\mathcal{G}$ from $\Sh(\mathcal{C}, \textit{Top})$.
In other words, we are trying to construct the left adjoint
to the inclusion functor
$\Sh(\mathcal{C}, \textit{Top}) \to \textit{PSh}(\mathcal{C}, \textit{Top})$.
We first claim that $\Sh(\mathcal{C}, \textit{Top})$ has limits
and that the inclusion functor commutes with them.
Namely, given a category $\mathcal{I}$ and a functor
$i \mapsto \mathcal{G}_i$ into $\Sh(\mathcal{C}, \textit{Top})$
we simply define
$$
(\lim \mathcal{G}_i)(U) = \lim \mathcal{G}_i(U)
$$
where we take the limit in the category of topological spaces
(Topology, Lemma \ref{topology-lemma-limits}). This defines a sheaf
because limits commute with limits
(Categories, Lemma \ref{categories-lemma-colimits-commute})
and in particular products and equalizers (which are the
operations used in the sheaf axiom). Finally, a morphism
of presheaves from $\mathcal{F} \to \lim \mathcal{G}_i$ is
clearly the same thing as a compatible system of morphisms
$\mathcal{F} \to \mathcal{G}_i$. In other words, the object
$\lim \mathcal{G}_i$ is the limit in the category
of presheaves of topological spaces and a fortiori in the
category of sheaves of topological spaces.
Our second claim is that any morphism of presheaves
$\mathcal{F} \to \mathcal{G}$ with $\mathcal{G}$ an object of
$\Sh(\mathcal{C}, \textit{Top})$ factors through a subsheaf
$\mathcal{G}' \subset \mathcal{G}$ whose size is bounded.
Here we define the {\it size} $|\mathcal{H}|$
of a sheaf of topological spaces $\mathcal{H}$ to be the cardinal
$\sup_{U \in \Ob(\mathcal{C})} |\mathcal{H}(U)|$.
To prove our claim we let
$$
\mathcal{G}'(U) =
\left\{
\quad
s \in \mathcal{G}(U)
\quad \middle| \quad
\begin{matrix}
\text{there exists a covering }\{U_i \to U\}_{i \in I} \\
\text{such that }
s|_{U_i} \in \Im(\mathcal{F}(U_i) \to \mathcal{G}(U_i))
\end{matrix}
\quad
\right\}
$$
We endow $\mathcal{G}'(U)$ with the induced topology.
Then $\mathcal{G}'$ is a sheaf of topological spaces (details omitted)
and $\mathcal{G}' \to \mathcal{G}$ is a morphism through which
the given map $\mathcal{F} \to \mathcal{G}$ factors. Moreover,
the size of $\mathcal{G}'$ is bounded by some cardinal
$\kappa$ depending only on $\mathcal{C}$ and the presheaf $\mathcal{F}$
(hint: use that coverings in $\mathcal{C}$
form a set by our conventions). Putting everything together we see
that the assumptions of Categories, Theorem
\ref{categories-theorem-adjoint-functor}
are satisfied and we obtain sheafification as the left
adjoint of the inclusion functor from sheaves to presheaves.
Finally, let $p$ be a point of the
site $\mathcal{C}$ given by a functor $u : \mathcal{C} \to \textit{Sets}$,
see Sites, Definition \ref{sites-definition-point}.
For a topological space $M$ the presheaf defined by the rule
$$
U \mapsto \text{Map}(u(U), M) = \prod\nolimits_{x \in u(U)} M
$$
endowed with the product topology is a sheaf of topological spaces.
Hence the exact same argument as given in the proof of
Sites, Lemma \ref{sites-lemma-point-pushforward-sheaf} shows that
$\mathcal{F}_p = \mathcal{F}^\#_p$, in other words, sheafification
commutes with taking stalks at a point.
\end{remark}




\section{Conventions and notation}
\label{section-conventions}

\noindent
The conventions from now on will be similar to the conventions in
Properties of Spaces, Section \ref{spaces-properties-section-conventions}.
Thus from now on the standing assumption is that all schemes are contained
in a big fppf site $\Sch_{fppf}$. And all rings $A$ considered have the
property that $\Spec(A)$ is (isomorphic) to an object of this big site.
For topological rings $A$ we assume only that all discrete quotients have
this property (but usually we assume more, compare with
Remark \ref{remark-set-theoretic}).

\medskip\noindent
Let $S$ be a scheme and let $X$ be a ``space'' over $S$, i.e., a sheaf on
$(\Sch/S)_{fppf}$. In this chapter we will write $X \times_S X$ for the
product of $X$ with itself in the category of sheaves on $(\Sch/S)_{fppf}$
instead of $X \times X$. Moreover, if $X$ and $Y$ are ``spaces'' then
we say "let $f : X \to Y$ be a morphism" to indicate that $f$ is a
natural transformation of functors, i.e., a map of sheaves on
$(\Sch/S)_{fppf}$. Similarly, if $U$ is a scheme over $S$ and
$X$ is a ``space'' over $S$, then we say
"let $f : U \to X$ be a morphism" or
"let $g : X \to U$ be a morphism" to indicate that $f$ or $g$
is a map of sheaves $h_U \to X$ or $X \to h_U$ where $h_U$ is as in
Categories, Example \ref{categories-example-hom-functor}.






\section{Topological rings and modules}
\label{section-topological-module}

\noindent
This section is a continuation of
More on Algebra, Section \ref{more-algebra-section-topological-ring}.
Let $R$ be a topological ring and let $M$ be a linearly topologized
$R$-module. When we say ``{\it let $M_\lambda$ be a fundamental system of
open submodules}'' we will mean that each $M_\lambda$ is an open submodule
and that any neighbourhood of $0$ contains one of the $M_\lambda$.
In other words, this means that $M_\lambda$ is a fundamental system
of neighbourhoods of $0$ in $M$ consisting of submodules.
Similarly, if $R$ is a linearly topologized ring, then we say
``{\it let $I_\lambda$ be a fundamental system of open ideals}''
to mean that $I_\lambda$ is a fundamental system
of neighbourhoods of $0$ in $R$ consisting of ideals.

\begin{example}
\label{example-what-does-it-mean}
Let $R$ be a linearly topologized ring and let $M$ be a linearly
topologized $A$-module. Let $I_\lambda$ be a fundamental system of
open ideals in $R$ and let $M_\mu$ be a fundamental system of
open submodules of $M$. The continuity of $+ : M \times M \to M$
is automatic and the continuity of $R \times M \to M$ signifies
$$
\forall f, x, \mu\ \exists \lambda, \nu,\ (f + I_\lambda)(x + M_\nu)
\subset fx + M_\mu
$$
Since $fM_\nu + I_\lambda M_\nu \subset M_\mu$ if
$M_\nu \subset M_\mu$ we see that the condition is equivalent to
$$
\forall x, \mu\ \exists \lambda\ I_\lambda x \subset M_\mu
$$
However, it need not be the case that given $\mu$ there is a $\lambda$
such that $I_\lambda M \subset M_\mu$. For example, consider
$R = k[[t]]$ with the $t$-adic topology and
$M = \bigoplus_{n \in \mathbf{N}} R$ with fundamental system of
open submodules given by
$$
M_m = \bigoplus\nolimits_{n \in \mathbf{N}} t^{nm}R
$$
Since every $x \in M$ has finitely many nonzero coordinates we see
that, given $m$ and $x$ there exists a $k$ such that $t^k x \in M_m$.
Thus $M$ is a linearly topologized $R$-module, but it isn't true
that given $m$ there is a $k$ such that $t^kM \subset M_m$.
On the other hand, if $R \to S$ is a continuous map of linearly
topologized rings, then the corresponding statement does hold, i.e.,
for every open ideal $J \subset S$ there exists an open ideal
$I \subset R$ such that $IS \subset J$ (as the reader can easily
deduce from continuity of the map $R \to S$).
\end{example}

\begin{lemma}
\label{lemma-closed}
Let $R$ be a topological ring. Let $M$ be a linearly topologized
$R$-module and let $M_\lambda$, $\lambda \in \Lambda$ be a fundamental
system of open submodules. Let $N \subset M$ be a submodule.
The closure of $N$ is $\bigcap_{\lambda \in \Lambda} (N + M_\lambda)$.
\end{lemma}

\begin{proof}
Since each $N + M_\lambda$ is open, it is also closed. Hence the
intersection is closed. If $x \in M$ is not in the closure of $N$,
then $(x + M_\lambda) \cap N = 0$ for some $\lambda$. Hence
$x \not \in N + M_\lambda$. This proves the lemma.
\end{proof}

\noindent
Unless otherwise mentioned we endow submodules and quotient modules
with the induced topology. Let $M$ be a linearly topologized module
over a topological ring $R$, and let $0 \to N \to M \to Q \to 0$
is a short exact sequence of $R$-modules. If $M_\lambda$ is a
fundamental system of open submodules of $M$, then
$N \cap M_\lambda$ is a fundamental system of open submodules of $N$.
If $\pi : M \to Q$ is the quotient map, then $\pi(M_\lambda)$ is a
fundamental system of open submodules of $Q$. In particular these induced
topologies are linear topologies.

\begin{lemma}
\label{lemma-closure}
Let $R$ be a topological ring. Let $M$ be a linearly topologized
$R$-module. Let $N \subset M$ be a submodule. Then
\begin{enumerate}
\item $0 \to N^\wedge \to M^\wedge \to (M/N)^\wedge$ is exact, and
\item $N^\wedge$ is the closure of the image of $N \to M^\wedge$.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $M_\lambda$, $\lambda \in \Lambda$ be a fundamental system of
open submodules. Then $N \cap M_\lambda$ is a fundamental system
of open submodules of $N$ and $M_\lambda + N/N$ is a fundamental system
of open submodules of $M/N$. Thus we see that (1) follows from
the exactness of the sequences
$$
0 \to N/N \cap M_\lambda \to M/M_\lambda \to M/(M_\lambda + N) \to 0
$$
and the fact that taking limits commutes with limits. The second
statement follows from this and the fact that $N \to N^\wedge$
has dense image and that the kernel of $M^\wedge \to (M/N)^\wedge$ is closed.
\end{proof}

\begin{lemma}
\label{lemma-quotient-by-closed}
Let $R$ be a topological ring. Let $M$ be a complete, linearly topologized
$R$-module. Let $N \subset M$ be a closed submodule. If $M$ has a
countable fundamental system of neighbourhoods of $0$, then
$M/N$ is complete and the map $M \to M/N$ is open.
\end{lemma}

\begin{proof}
Let $M_n$, $n \in \mathbf{N}$ be a fundamental system of open submodules of $M$.
We may assume $M_{n + 1} \subset M_n$
for all $n$. The $(M_n + N)/N$ is a fundamental system in $M/N$.
Hence we have to show that $M/N = \lim M/(M_n + N)$. Consider
the short exact sequences
$$
0 \to N/N \cap M_n \to M/M_n \to M/(M_n + N) \to 0
$$
Since the transition maps of the system $\{N/N\cap M_n\}$ are surjective
we see that $M = \lim M/M_n$ (by completeness of $M$) surjects onto
$\lim M/(M_n + N)$ by
Algebra, Lemma \ref{algebra-lemma-ML-exact-sequence}.
As $N$ is closed we see that the kernel of $M \to \lim M/(M_n + N)$
is $N$ (see Lemma \ref{lemma-closed}). Finally, $M \to M/N$
is open by definition of the quotient topology.
\end{proof}

\begin{lemma}
\label{lemma-ses}
\begin{reference}
\cite[Theorem 8.1]{Ma}
\end{reference}
Let $R$ be a topological ring. Let $M$ be a linearly topologized
$R$-module. Let $N \subset M$ be a submodule. Assume $M$ has a
countable fundamental system of neighbourhoods of $0$. Then
\begin{enumerate}
\item $0 \to N^\wedge \to M^\wedge \to (M/N)^\wedge \to 0$ is exact,
\item $N^\wedge$ is the closure of the image of $N \to M^\wedge$,
\item $M^\wedge \to (M/N)^\wedge$ is open.
\end{enumerate}
\end{lemma}

\begin{proof}
We have $0 \to N^\wedge \to M^\wedge \to (M/N)^\wedge$ is exact
and statement (2) by Lemma \ref{lemma-closure}.
This produces a canonical map $c : M^\wedge/N^\wedge \to (M/N)^\wedge$.
The module $M^\wedge/N^\wedge$ is complete and
$M^\wedge \to M^\wedge/N^\wedge$ is open by
Lemma \ref{lemma-quotient-by-closed}.
By the universal property of completion we obtain a canonical
map $b : (M/N)^\wedge \to M^\wedge/N^\wedge$.
Then $b$ and $c$ are mutually inverse as they are on a dense subset.
\end{proof}

\begin{definition}
\label{definition-toplogy-tensor-product}
Let $R$ be a topological ring. Let $M$ and $N$ be linearly
topologized $R$-modules. The {\it tensor product} of $M$ and $N$
is the (usual) tensor product $M \otimes_R N$ endowed
with the linear topology defined by declaring
$$
\Im(M_\mu \otimes_R N + M \otimes_R N_\nu \longrightarrow M \otimes_R N)
$$
to be a fundamental system of open submodules, where
$M_\mu \subset M$ and $N_\nu \subset N$ run through fundamental
systems of open submodules in $M$ and $N$.
The {\it completed tensor product}
$$
M \widehat{\otimes}_R N =
\lim M \otimes_R N/(M_\mu \otimes_R N + M \otimes_R N_\nu) =
\lim M/M_\mu \otimes_R N/N_\nu
$$
is the completion of the tensor product.
\end{definition}

\noindent
Observe that the topology on $R$ is immaterial for the construction
of the tensor product or the completed tensor product.
If $R \to A$ and $R \to B$ are continuous maps of
linearly topologized rings, then the construction above
gives a tensor product $A \otimes_R B$ and a completed
tensor product $A \widehat{\otimes}_R B$.

\medskip\noindent
We record here the notions introduced in Remark \ref{remark-mcquillan}.

\begin{definition}
\label{definition-weakly-admissible}
Let $A$ be a linearly topologized ring.
\begin{enumerate}
\item An element $f \in A$ is called {\it topologically nilpotent}
if $f^n \to 0$ as $n \to \infty$.
\item A {\it weak ideal of definition} for $A$ is an open ideal
$I \subset A$ consisting entirely of topologically nilpotent elements.
\item We say $A$ is {\it weakly pre-admissible} if $A$ has a weak
ideal of definition.
\item We say $A$ is {\it weakly admissible} if $A$ is weakly pre-admissible
and complete\footnote{By our conventions this includes separated.}.
\end{enumerate}
\end{definition}

\noindent
Given a weak ideal of definition $I$ in a linearly topologized ring
$A$ and an open ideal $J$ the intersection $I \cap J$ is a
weak ideal of definition. Hence if there is one weak ideal of definition,
then there is a fundamental system of open ideals
consisting of weak ideals of definition. In particular,
given a weakly admissible topological ring $A$ then
$A = \lim A/I_\lambda$ where $\{I_\lambda\}$ is a fundamental system
of weak ideals of definition.

\begin{lemma}
\label{lemma-weakly-admissible-henselian}
Let $A$ be a weakly admissible topological ring. Let $I \subset A$
be a weak ideal of definition. Then $(A, I)$ is a henselian pair.
\end{lemma}

\begin{proof}
Let $A \to A'$ be an \'etale ring map and let $\sigma : A' \to A/I$
be an $A$-algebra map. By More on Algebra, Lemma
\ref{more-algebra-lemma-characterize-henselian-pair} it suffices
to lift $\sigma$ to an $A$-algebra map $A' \to A$.
To do this, as $A$ is complete, it suffices to find,
for every open ideal $J \subset I$, a unique $A$-algebra map $A' \to A/J$
lifting $\sigma$. Since $I$ is a weak ideal of definition,
the ideal $I/J$ is locally nilpotent. We conclude by
More on Algebra, Lemma \ref{more-algebra-lemma-locally-nilpotent-henselian}.
\end{proof}

\begin{lemma}
\label{lemma-topologically-nilpotent}
Let $\varphi : A \to B$ be a continuous map of linearly topologized rings.
\begin{enumerate}
\item If $f \in A$ is topologically nilpotent, then $\varphi(f)$ is
topologically nilpotent.
\item If $I \subset A$ consists of topologically nilpotent elements,
then the closure of $\varphi(I)B$ consists of topologically nilpotent
elements.
\end{enumerate}
\end{lemma}

\begin{proof}
Part (1) is clear. Let $g$ be an element of the closure of $\varphi(I)B$.
Let $J \subset B$ be an open ideal. We have to show $g^e \in J$ for some $e$.
We have $g \in \varphi(I)B + J$ by Lemma \ref{lemma-closed}.
Hence $g = \sum_{i = 1, \ldots, n} f_ib_i + h$ for some $f_i \in I$,
$b_i \in B$ and $h \in J$. Pick $e_i$ such that
$\varphi(f_i^{e_i}) \in J$. Then $g^{e_1 + \ldots + e_n + 1} \in J$.
\end{proof}

\begin{definition}
\label{definition-taut}
Let $\varphi : A \to B$ be a continuous map of linearly topologized rings.
We say $\varphi$ is {\it taut}\footnote{This is nonstandard notation.
The definition generalizes to modules, by saying a linearly topologized
$A$-module $M$ is $A$-taut if for every open ideal $I \subset A$ the closure
of $IM$ in $M$ is open and these closures form a fundamental system of
neighbourhoods of $0$ in $M$.}
if for every open ideal $I \subset A$ the closure of the ideal $\varphi(I)B$
is open and these closures form a fundamental system of open ideals.
\end{definition}

\noindent
If $\varphi : A \to B$ is a continuous map of linearly topologized rings
and $I_\lambda$ a fundamental system of open ideals of $A$, then $\varphi$
is taut if and only if
the closures of $I_\lambda B$ are open and form a fundamental
system of open ideals in $A$.

\begin{lemma}
\label{lemma-taut-weakly-admissible}
Let $\varphi : A \to B$ be a continuous map of weakly admissible topological
rings. The following are equivalent
\begin{enumerate}
\item $\varphi$ is taut,
\item for every weak ideal of definition $I \subset A$ the closure of
$\varphi(I)B$ is a weak ideal of definition of $B$ and these form a
fundamental system of weak ideals of definition of $B$.
\end{enumerate}
\end{lemma}

\begin{proof}
It is clear that (2) implies (1). The other implication follows
from Lemma \ref{lemma-topologically-nilpotent}.
\end{proof}

\begin{lemma}
\label{lemma-closure-image-ideal}
Let $A \to B$ be a continuous map of linearly topologized rings.
Let $I \subset A$ be an ideal. The closure of $IB$
is the kernel of $B \to B \widehat{\otimes}_A A/I$.
\end{lemma}

\begin{proof}
Let $J_\mu$ be a fundamental system of open ideals of $B$.
The closure of $IB$ is $\bigcap (IB + J_\lambda)$ by Lemma \ref{lemma-closed}.
Let $I_\mu$ be a fundamental system of open ideals in $A$.
Then
$$
B \widehat{\otimes}_A A/I = \lim (B/J_\lambda \otimes_A A/(I_\mu + I)) =
\lim B/(J_\lambda + I_\mu B + I B)
$$
Since $A \to B$ is continuous, for every $\lambda$ there
is a $\mu$ such that $I_\mu B \subset J_\lambda$, see discussion in
Example \ref{example-what-does-it-mean}. Hence the limit
can be written as $\lim B/(J_\lambda + IB)$ and the result is clear.
\end{proof}

\begin{lemma}
\label{lemma-dense-image-surjective}
Let $\varphi : A \to B$ be a continuous homomorphism of
linearly topologized rings. If
\begin{enumerate}
\item $\varphi$ is taut,
\item $\varphi$ has dense image,
\item $A$ is complete,
\item $B$ is separated, and
\item $A$ has a countable fundamental system of neighbourhoods of $0$.
\end{enumerate}
Then $\varphi$ is surjective and open, $B$ is complete, and $B = A/K$ for
some closed ideal $K \subset A$.
\end{lemma}

\begin{proof}
We may choose a sequence of open ideals
$A \supset I_1 \supset I_2 \supset I_3 \supset \ldots$
which form a fundamental system of neighbourhoods of $0$.
For each $i$ let $J_i \subset B$ be the closure of $\varphi(I_i)B$.
As $\varphi$ is taut we see that these form a fundamental system
of open ideals of $B$. Set $I_0 = A$ and $J_0 = B$.
Let $n \geq 0$ and let $y_n \in J_n$. Since $J_n$ is the
closure of $\varphi(I_n)B$ we can write
$$
y_n = \sum\nolimits_t \varphi(f_t)b_t + y'_{n + 1}
$$
for some $f_t \in I_n$, $b_t \in B$, and $y'_{n + 1} \in J_{n + 1}$.
Since $\varphi$ has dense image we can choose $a_t \in A$ with
$\varphi(a_t) = b_t \bmod J_{n + 1}$. Thus
$$
y_n = \varphi(f_n) + y_{n + 1}
$$
with $f_n = \sum f_ta_t \in I_n$ and
$y_{n + 1} = y'_{n + 1} + \sum f_t(b_t - \varphi(a_t)) \in J_{n + 1}$.
Thus, starting with any $y = y_0 \in B$, we can find by induction
a sequence $f_m \in I_m$, $m \geq 0$ such that 
$$
y = y_0 = \varphi(f_0 + f_1 + \ldots + f_n) + y_{n + 1}
$$
with $y_{n + 1} \in J_{n + 1}$. Since $A$ is complete we see that
$$
x = x_0 = f_0 + f_1 + f_2 + \ldots
$$
exists. Since the partial sums approximate $x$ in $A$, since $\varphi$
is continuous, and since $B$ is separated we find that $\varphi(x) = y$
because above we've shown that the images of the partial sums approximate $y$
in $B$. Thus $\varphi$ is surjective. In exactly the same manner we
find that $\varphi(I_n) = J_n$ for all $n \geq 1$. This proves the lemma.
\end{proof}

\noindent
The next lemma says ``$\varphi$ is taut'' if and only if ``$\varphi$ is adic''
for continuous maps $\varphi : A \to B$ between adic rings if $A$
has a finitely generated ideal of definition. In some sense the previously
introduced notion of tautness for continuous ring maps supersedes the
notion of an adic map between adic rings. See also Section \ref{section-adic}.

\begin{lemma}
\label{lemma-taut-is-adic}
Let $\varphi : A \to B$ be a continuous map of linearly topologized rings.
Let $I \subset A$ be an ideal. Assume
\begin{enumerate}
\item $I$ is finitely generated,
\item $A$ has the $I$-adic topology,
\item $B$ is complete, and
\item $\varphi$ is taut.
\end{enumerate}
Then the topology on $B$ is the $I$-adic topology.
\end{lemma}

\begin{proof}
Let $J_n$ be the closure of $\varphi(I^n)B$ in $B$.
Since $B$ is complete we have $B = \lim B/J_n$.
Let $B' = \lim B/I^nB$ be the $I$-adic completion of $B$.
By Algebra, Lemma \ref{algebra-lemma-hathat-finitely-generated},
the $I$-adic topology on $B'$ is complete and
$B'/I^nB' = B/I^nB$. Thus the ring map $B' \to B$ is continuous
and has dense image as $B' \to B/I^nB \to B/J_n$ is surjective
for all $n$. Finally, the map $B' \to B$ is taut
because $(I^nB')B = I^nB$ and $A \to B$ is taut.
By Lemma \ref{lemma-dense-image-surjective} we see that $B' \to B$ is open
and surjective which implies the lemma.
\end{proof}



\section{Affine formal algebraic spaces}
\label{section-affine-formal-algebraic-spaces}

\noindent
In this section we introduce affine formal algebraic spaces.
These will in fact be the same as what are called affine
formal schemes in \cite{BVGD}. However, we will call
them affine formal algebraic spaces, in order to prevent confusion with
the notion of an affine formal scheme as defined in \cite{EGA}.

\medskip\noindent
Recall that a thickening of schemes is a closed
immersion which induces a surjection on underlying topological
spaces, see More on Morphisms, Definition
\ref{more-morphisms-definition-thickening}.

\begin{definition}
\label{definition-affine-formal-algebraic-space}
Let $S$ be a scheme. We say a sheaf $X$ on $(\Sch/S)_{fppf}$ is an
{\it affine formal algebraic space} if there exist
\begin{enumerate}
\item a directed set $\Lambda$,
\item a system $(X_\lambda, f_{\lambda \mu})$ over $\Lambda$
in $(\Sch/S)_{fppf}$ where
\begin{enumerate}
\item each $X_\lambda$ is affine,
\item each $f_{\lambda \mu} : X_\lambda \to X_\mu$ is a thickening,
\end{enumerate}
\end{enumerate}
such that
$$
X \cong \colim_{\lambda \in \Lambda} X_\lambda
$$
as fppf sheaves and $X$ satisfies a set theoretic condition
(see Remark \ref{remark-set-theoretic}). A
{\it morphism of affine formal algebraic spaces}
over $S$ is a map of sheaves.
\end{definition}

\noindent
Observe that the system $(X_\lambda, f_{\lambda \mu})$ is not
part of the data. Suppose that $U$ is a quasi-compact scheme over $S$.
Since the transition maps are monomorphisms, we see that
$$
X(U) = \colim X_\lambda(U)
$$
by Sites, Lemma \ref{sites-lemma-directed-colimits-sections}.
Thus the fppf sheafification inherent in the colimit of the
definition is a Zariski sheafification which does not do
anything for quasi-compact schemes.

\begin{lemma}
\label{lemma-diagonal-affine-formal-algebraic-space}
Let $S$ be a scheme. If $X$ is an affine formal algebraic space over
$S$, then the diagonal morphism $\Delta : X \to X \times_S X$
is representable and a closed immersion.
\end{lemma}

\begin{proof}
Suppose given $U \to X$ and $V \to X$ where $U, V$ are schemes over $S$.
Let us show that $U \times_X V$ is representable. Write $X = \colim X_\lambda$
as in Definition \ref{definition-affine-formal-algebraic-space}.
The discussion above shows that Zariski locally on $U$ and $V$ the morphisms
factors through some $X_\lambda$. In this case
$U \times_X V = U \times_{X_\lambda} V$ which is a scheme.
Thus the diagonal is representable, see
Spaces, Lemma \ref{spaces-lemma-representable-diagonal}.
Given $(a, b) : W \to X \times_S X$ where $W$ is a scheme over $S$
consider the map $X \times_{\Delta, X \times_S X, (a, b)} W \to W$.
As before locally on $W$ the morphisms $a$ and $b$ map into
the affine scheme $X_\lambda$ for some $\lambda$ and then
we get the morphism
$X_\lambda
\times_{\Delta_\lambda, X_\lambda \times_S X_\lambda, (a, b)} W \to W$.
This is the base change of
$\Delta_\lambda : X_\lambda \to X_\lambda \times_S X_\lambda$
which is a closed immersion as $X_\lambda \to S$ is separated
(because $X_\lambda$ is affine).
Thus $X \to X \times_S X$ is a closed immersion.
\end{proof}

\noindent
A morphism of schemes $X \to X'$ is a thickening if it is a closed immersion
and induces a surjection on underlying sets of points, see
(More on Morphisms, Definition
\ref{more-morphisms-definition-thickening}).
Hence the property of being a thickening is preserved under arbitrary
base change and fpqc local on the target, see
Spaces, Section \ref{spaces-section-lists}.
Thus Spaces, Definition \ref{spaces-definition-relative-representable-property}
applies to ``thickening'' and we know what it means for a
representable transformation $F \to G$ of
presheaves on $(\Sch/S)_{fppf}$ to be a thickening.
We observe that this does not clash with our definition
(More on Morphisms of Spaces, Definition
\ref{spaces-more-morphisms-definition-thickening})
of thickenings in case $F$ and $G$ are algebraic spaces.

\begin{lemma}
\label{lemma-covering-by-thickenings}
Let $X_\lambda, \lambda \in \Lambda$ and $X = \colim X_\lambda$
be as in Definition \ref{definition-affine-formal-algebraic-space}.
Then $X_\lambda \to X$ is representable and a thickening.
\end{lemma}

\begin{proof}
The statement makes sense by the discussion in
Spaces, Section \ref{spaces-section-representable} and
\ref{spaces-section-representable-properties}.
By Lemma \ref{lemma-diagonal-affine-formal-algebraic-space}
the morphisms $X_\lambda \to X$ are representable.
Given $U \to X$ where $U$ is a scheme,
then the discussion following
Definition \ref{definition-affine-formal-algebraic-space}
shows that Zariski locally on $U$ the
morphism factors through some $X_\mu$ with $\lambda \leq \mu$.
In this case $U \times_X X_\lambda = U \times_{X_\mu} X_\lambda$
so that $U \times_X X_\lambda \to U$ is a base change of
the thickening $X_\lambda \to X_\mu$.
\end{proof}

\begin{lemma}
\label{lemma-factor-through-thickening}
Let $X_\lambda, \lambda \in \Lambda$ and $X = \colim X_\lambda$
be as in Definition \ref{definition-affine-formal-algebraic-space}.
If $Y$ is a quasi-compact algebraic space over $S$, then any
morphism $Y \to X$ factors through an $X_\lambda$.
\end{lemma}

\begin{proof}
Choose an affine scheme $V$ and a surjective \'etale morphism
$V \to Y$. The composition $V \to Y \to X$ factors through
$X_\lambda$ for some $\lambda$ by the discussion following
Definition \ref{definition-affine-formal-algebraic-space}.
Since $V \to Y$ is a surjection of sheaves, we conclude.
\end{proof}

\begin{lemma}
\label{lemma-characterize-affine-formal-algebraic-space}
Let $S$ be a scheme. Let $X$ be a sheaf on $(\Sch/S)_{fppf}$.
Then $X$ is an affine formal algebraic space if and only if
the following hold
\begin{enumerate}
\item any morphism $U \to X$ where $U$ is an affine scheme over $S$
factors through a morphism $T \to X$ which is representable and a
thickening with $T$ an affine scheme over $S$, and
\item a set theoretic condition as in Remark \ref{remark-set-theoretic}.
\end{enumerate}
\end{lemma}

\begin{proof}
It follows from Lemmas \ref{lemma-covering-by-thickenings} and
\ref{lemma-factor-through-thickening} that an affine formal algebraic space
satisfies (1) and (2). In order to prove the converse we may
assume $X$ is not empty.
Let $\Lambda$ be the category of representable morphisms $T \to X$ which are
thickenings where $T$ is an affine scheme over $S$. This category
is directed. Since $X$ is not empty, $\Lambda$ contains at least one
object. If $T \to X$ and $T' \to X$ are in $\Lambda$, then we can
factor $T \amalg T' \to X$ through $T'' \to X$ in $\Lambda$. Between
any two objects of $\Lambda$ there is a unique arrow or none. Thus
$\Lambda$ is a directed set and by assumption
$X = \colim_{T \to X\text{ in }\Lambda} T$. To finish the proof
we need to show that any arrow $T \to T'$ in $\Lambda$ is a thickening.
This is true because $T' \to X$ is a monomorphism of sheaves, so that
$T = T \times_{T'} T' = T \times_X T'$ and hence the morphism
$T \to T'$ equals the projection $T \times_X T' \to T'$ which is
a thickening because $T \to X$ is a thickening.
\end{proof}

\noindent
For a general affine formal algebraic space $X$ there is no guarantee
that $X$ has enough functions to separate points (for example).
See Examples, Section \ref{examples-section-affine-formal-algebraic-space}.
To characterize those that do we offer the following lemma.

\begin{lemma}
\label{lemma-mcquillan-affine-formal-algebraic-space}
Let $S$ be a scheme. Let $X$ be an fppf sheaf on $(\Sch/S)_{fppf}$
which satisfies the set theoretic condition of
Remark \ref{remark-set-theoretic}.
The following are equivalent:
\begin{enumerate}
\item there exists a weakly admissible topological ring $A$ over $S$
(see Remark \ref{remark-mcquillan}) such that
$X = \colim_{I \subset A\text{ weak ideal of definition}} \Spec(A/I)$,
\item $X$ is an affine formal algebraic space and
there exists an $S$-algebra $A$ and a map $X \to \Spec(A)$
such that for a closed immersion $T \to X$ with $T$ an affine scheme
the composition $T \to \Spec(A)$ is a closed immersion,
\item $X$ is an affine formal algebraic space and
there exists an $S$-algebra $A$ and a map $X \to \Spec(A)$
such that for a closed immersion $T \to X$ with $T$ a scheme
the composition $T \to \Spec(A)$ is a closed immersion,
\item $X$ is an affine formal algebraic space and
for some choice of $X = \colim X_\lambda$ as in
Definition \ref{definition-affine-formal-algebraic-space}
the projections $\lim \Gamma(X_\lambda, \mathcal{O}_{X_\lambda})
\to \Gamma(X_\lambda, \mathcal{O}_{X_\lambda})$ are surjective,
\item $X$ is an affine formal algebraic space and for any choice
of $X = \colim X_\lambda$ as in
Definition \ref{definition-affine-formal-algebraic-space}
the projections $\lim \Gamma(X_\lambda, \mathcal{O}_{X_\lambda})
\to \Gamma(X_\lambda, \mathcal{O}_{X_\lambda})$ are surjective.
\end{enumerate}
Moreover, the weakly admissible topological ring is
$A = \lim \Gamma(X_\lambda, \mathcal{O}_{X_\lambda})$
endowed with its limit topology and the weak ideals of definition
classify exactly the morphisms $T \to X$ which are representable
and thickenings.
\end{lemma}

\begin{proof}
It is clear that (5) implies (4).

\medskip\noindent
Assume (4) for $X = \colim X_\lambda$ as in
Definition \ref{definition-affine-formal-algebraic-space}.
Set $A = \lim \Gamma(X_\lambda, \mathcal{O}_{X_\lambda})$.
Let $T \to X$ be a closed immersion with $T$ a scheme
(note that $T \to X$ is representable by
Lemma \ref{lemma-diagonal-affine-formal-algebraic-space}).
Since $X_\lambda \to X$ is a thickening, so is
$X_\lambda \times_X T \to T$. On the other hand,
$X_\lambda \times_X T \to X_\lambda$ is a closed immersion,
hence $X_\lambda \times_X T$ is affine. Hence $T$ is affine
by Limits, Proposition \ref{limits-proposition-affine}.
Then $T \to X$ factors through $X_\lambda$ for some $\lambda$
by Lemma \ref{lemma-factor-through-thickening}.
Thus $A \to \Gamma(X_\lambda, \mathcal{O}) \to \Gamma(T, \mathcal{O})$
is surjective. In this way we see that (3) holds.

\medskip\noindent
It is clear that (3) implies (2).

\medskip\noindent
Assume (2) for $A$ and $X \to \Spec(A)$. Write $X = \colim X_\lambda$
as in Definition \ref{definition-affine-formal-algebraic-space}.
Then $A_\lambda = \Gamma(X_\lambda, \mathcal{O})$ is a quotient
of $A$ by assumption (2). Hence $A^\wedge = \lim A_\lambda$
is a complete topological ring, see discussion in
More on Algebra, Section \ref{more-algebra-section-topological-ring}.
The maps $A^\wedge \to A_\lambda$ are surjective as $A \to A_\lambda$ is.
We claim that for any $\lambda$ the kernel $I_\lambda \subset A^\wedge$ of
$A^\wedge \to A_\lambda$ is a weak ideal of definition.
Namely, it is open by definition of the limit topology.
If $f \in I_\lambda$, then for any $\mu \in \Lambda$
the image of $f$ in $A_\mu$ is zero in all the residue fields
of the points of $X_\mu$. Hence it is a nilpotent element
of $A_\mu$. Hence some power $f^n \in I_\mu$. Thus $f^n \to 0$
as $n \to 0$. Thus $A^\wedge$ is weakly admissible.
Finally, suppose that $I \subset A^\wedge$ is a weak ideal
of definition. Then $I \subset A^\wedge$ is open and hence there exists
some $\lambda$ such that $I \supset I_\lambda$. Thus we obtain a morphism
$\Spec(A^\wedge/I) \to \Spec(A_\lambda) \to X$.
Then it follows that $X = \colim \Spec(A^\wedge/I)$ where now
the colimit is over all weak ideals of definition.
Thus (1) holds.

\medskip\noindent
Assume (1). In this case it is clear that $X$ is an affine formal
algebraic space. Let $X = \colim X_\lambda$ be any presentation as in
Definition \ref{definition-affine-formal-algebraic-space}.
For each $\lambda$ we can find a weak ideal of definition
$I \subset A$ such that $X_\lambda \to X$ factors through
$\Spec(A/I) \to X$, see Lemma \ref{lemma-factor-through-thickening}.
Then $X_\lambda = \Spec(A/I_\lambda)$ with $I \subset I_\lambda$.
Conversely, for any weak ideal of definition $I \subset A$
the morphism $\Spec(A/I) \to X$ factors through $X_\lambda$
for some $\lambda$, i.e., $I_\lambda \subset I$.
It follows that each $I_\lambda$ is a weak ideal of definition
and that they form a cofinal subset of the set of weak ideals
of definition. Hence $A = \lim A/I = \lim A/I_\lambda$
and we see that (5) is true and moreover that
$A = \lim \Gamma(X_\lambda, \mathcal{O}_{X_\lambda})$.
\end{proof}

\noindent
With this lemma in hand we can make the following definition.

\begin{definition}
\label{definition-types-affine-formal-algebraic-space}
Let $S$ be a scheme. Let $X$ be an affine formal algebraic space over $S$.
We say $X$ is {\it McQuillan} if $X$ satisfies the equivalent conditions
of Lemma \ref{lemma-mcquillan-affine-formal-algebraic-space}. Let $A$
be the weakly admissible topological ring associated to $X$. We say
\begin{enumerate}
\item $X$ is {\it classical} if $X$ is McQuillan and $A$ is admissible,
\item $X$ is {\it adic} if $X$ is McQuillan and $A$ is adic,
\item $X$ is {\it adic*} if $X$ is McQuillan, $A$ is adic, and $A$
has a finitely generated ideal of definition, and
\item $X$ is {\it Noetherian} if $X$ is McQuillan and $A$ is
both Noetherian and adic.
\end{enumerate}
\end{definition}

\noindent
In \cite{Fujiwara-Kato} they use the terminology ``of finite ideal type''
for the property that an adic topological ring $A$ contains a finitely
generated ideal of definition.

\begin{remark}
\label{remark-compare-with-affine-formal-schemes}
The classical affine formal algebraic spaces correspond to the
affine formal schemes considered in EGA (\cite{EGA}). To explain this
we assume our base scheme is $\Spec(\mathbf{Z})$. Let
$\mathfrak X = \text{Spf}(A)$ be an affine formal scheme.
Let $h_\mathfrak X$ be its functor of points as in
Lemma \ref{lemma-fully-faithful}.
Then $h_\mathfrak X = \colim h_{\Spec(A/I)}$ where the colimit
is over the collection of ideals of definition of the admissible
topological ring $A$. This follows from
(\ref{equation-morphisms-affine-formal-schemes})
when evaluating on affine schemes and it suffices to check
on affine schemes as both sides are fppf sheaves, see
Lemma \ref{lemma-formal-scheme-sheaf-fppf}.
Thus $h_\mathfrak X$ is an affine formal algebraic space.
In fact, it is a classical affine formal algebraic space
by Definition \ref{definition-types-affine-formal-algebraic-space}.
Thus Lemma \ref{lemma-fully-faithful} tells us
the category of affine formal schemes is equivalent to the category
of classical affine formal algebraic spaces.
\end{remark}

\noindent
Having made the connection with affine formal schemes above,
it seems natural to make the following definition.

\begin{definition}
\label{definition-affine-formal-spectrum}
Let $S$ be a scheme. Let $A$ be a weakly admissible topological ring over
$S$, see Definition \ref{definition-weakly-admissible}\footnote{See
More on Algebra, Definition
\ref{more-algebra-definition-topological-ring}
for the classical case and see Remark \ref{remark-mcquillan}
for a discussion of differences.}.
The {\it formal spectrum} of $A$ is the affine formal algebraic space
$$
\text{Spf}(A) = \colim \Spec(A/I)
$$
where the colimit is over the set of weak ideals of definition of $A$
and taken in the category $\Sh((\Sch/S)_{fppf})$.
\end{definition}

\noindent
Such a formal spectrum is McQuillan by construction and conversely
every McQuillan affine formal algebraic space is isomorphic to a
formal spectrum. To be sure, in our theory there exist affine formal
algebraic spaces which are not the formal spectrum of any
weakly admissible topological ring.
Following \cite{Yasuda} we could introduce $S$-pro-rings
to be pro-objects in the category of $S$-algebras, see Categories,
Remark \ref{categories-remark-pro-category}. Then every
affine formal algebraic space over $S$ would be the formal spectrum of such
an $S$-pro-ring. We will not do this and instead we will work directly with the
corresponding affine formal algebraic spaces.

\medskip\noindent
The construction of the formal spectrum is functorial. To explain this
let $\varphi : B \to A$ be a continuous map of weakly admissible
topological rings over $S$. Then
$$
\text{Spf}(\varphi) : \text{Spf}(B) \to \text{Spf}(A)
$$
is the unique morphism of affine formal algebraic spaces such that
the diagrams
$$
\xymatrix{
\Spec(B/J) \ar[d] \ar[r] & \Spec(A/I) \ar[d] \\
\text{Spf}(B) \ar[r] & \text{Spf}(A)
}
$$
commute for all weak ideals of definition $I \subset A$ and $J \subset B$
with $\varphi(I) \subset J$. Since continuity of $\varphi$
implies that for every weak ideal of definition $J \subset B$
there is a weak ideal of definition $I \subset A$ with the required
property, we see that the required commutativities uniquely
determine and define $\text{Spf}(\varphi)$.

\begin{lemma}
\label{lemma-morphism-between-formal-spectra}
Let $S$ be a scheme. Let $A$, $B$ be weakly admissible
topological rings over $S$. Any morphism $f : \text{Spf}(B) \to \text{Spf}(A)$
of affine formal algebraic spaces over $S$
is equal to $\text{Spf}(f^\sharp)$ for a unique continuous
$S$-algebra map $f^\sharp : A \to B$.
\end{lemma}

\begin{proof}
Let $f : \text{Spf}(B) \to \text{Spf}(A)$ be as in the lemma.
Let $J \subset B$ be a weak ideal of definition. By
Lemma \ref{lemma-factor-through-thickening}
there exists a weak ideal of definition $I \subset A$ such that
$\Spec(B/J) \to \text{Spf}(B) \to \text{Spf}(A)$
factors through $\Spec(A/I)$. By
Schemes, Lemma \ref{schemes-lemma-morphism-into-affine}
we obtain an $S$-algebra map $A/I \to B/J$.
These maps are compatible for varying $J$ and define the
map $f^\sharp : A \to B$. This map is continuous because
for every weak ideal of definition $J \subset B$ there is a
weak ideal of definition $I \subset A$ such that
$f^\sharp(I) \subset J$. The equality $f = \text{Spf}(f^\sharp)$
holds by our choice of the ring maps $A/I \to B/J$ which make up $f^\sharp$.
\end{proof}

\begin{lemma}
\label{lemma-presentation-representable}
Let $S$ be a scheme. Let $f : X \to Y$ be a map
of presheaves on $(\Sch/S)_{fppf}$. If $X$ is an affine formal algebraic
space and $f$ is representable by algebraic spaces and locally quasi-finite,
then $f$ is representable (by schemes).
\end{lemma}

\begin{proof}
Let $T$ be a scheme over $S$ and $T \to Y$ a map. We have to show that
the algebraic space $X \times_Y T$ is a scheme. Write $X = \colim X_\lambda$
as in Definition
\ref{definition-affine-formal-algebraic-space}.
Let $W \subset X \times_Y T$
be a quasi-compact open subspace. The restriction of the projection
$X \times_Y T \to X$ to $W$ factors through $X_\lambda$ for some $\lambda$.
Then
$$
W \to X_\lambda \times_S T
$$
is a monomorphism (hence separated) and locally quasi-finite (because
$W \to X \times_Y T \to T$ is locally quasi-finite by our assumption
on $X \to Y$, see Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-permanence-quasi-finite}).
Hence $W$ is a scheme by
Morphisms of Spaces, Proposition
\ref{spaces-morphisms-proposition-locally-quasi-finite-separated-over-scheme}.
Thus $X \times_Y T$ is a scheme by
Properties of Spaces, Lemma \ref{spaces-properties-lemma-subscheme}.
\end{proof}






\section{Countably indexed affine formal algebraic spaces}
\label{section-countably-indexed}

\noindent
These are the affine formal algebraic spaces as in the following lemma.

\begin{lemma}
\label{lemma-countable-affine-formal-algebraic-space}
Let $S$ be a scheme. Let $X$ be an affine formal algebraic space over $S$.
The following are equivalent
\begin{enumerate}
\item there exists a system $X_1 \to X_2 \to X_3 \to \ldots$
of thickenings of affine schemes over $S$ such that $X = \colim X_n$,
\item there exists a choice $X = \colim X_\lambda$ as in
Definition \ref{definition-affine-formal-algebraic-space}
such that $\Lambda$ is countable.
\end{enumerate}
\end{lemma}

\begin{proof}
This follows from the observation that a countable directed set
has a cofinal subset isomorphic to $(\mathbf{N}, \geq)$.
See proof of Algebra, Lemma \ref{algebra-lemma-ML-limit-nonempty}.
\end{proof}

\begin{definition}
\label{definition-countable}
Let $S$ be a scheme. Let $X$ be an affine formal algebraic space over $S$.
We say $X$ is {\it countably indexed} if the equivalent conditions of
Lemma \ref{lemma-countable-affine-formal-algebraic-space} are satisfied.
\end{definition}

\noindent
In the language of \cite{BVGD} this is expressed by saying that
$X$ is an $\aleph_0$-ind scheme.

\begin{lemma}
\label{lemma-implications-between-types}
Let $X$ be an affine formal algebraic space over a scheme $S$.
\begin{enumerate}
\item If $X$ is Noetherian, then $X$ is adic*.
\item If $X$ is adic*, then $X$ is adic.
\item If $X$ is adic, then $X$ is countably indexed.
\item If $X$ is countably indexed, then $X$ is McQuillan.
\end{enumerate}
\end{lemma}

\begin{proof}
Parts (1) and (2) are immediate from the definitions.

\medskip\noindent
Proof of (3). By definition there exists an adic topological ring $A$
such that $X = \colim \Spec(A/I)$ where the colimit is over the ideals
of definition of $A$. As $A$ is adic, there exits an ideal $I$
such that $\{I^n\}$ forms a fundamental system of neighbourhoods of $0$.
Then each $I^n$ is an ideal of definition and $X = \colim \Spec(A/I^n)$.
Thus $X$ is countably indexed.

\medskip\noindent
Proof of (4). Write $X = \colim X_n$
for some system $X_1 \to X_2 \to X_3 \to \ldots$ of thickenings of affine
schemes over $S$. Then
$$
A = \lim \Gamma(X_n, \mathcal{O}_{X_n})
$$
surjects onto each $\Gamma(X_n, \mathcal{O}_{X_n})$ because the transition
maps are surjections as the morphisms $X_n \to X_{n + 1}$ are closed
immersions.
\end{proof}

\begin{lemma}
\label{lemma-countably-indexed}
Let $S$ be a scheme. Let $X$ be a presheaf on $(\Sch/S)_{fppf}$.
The following are equivalent
\begin{enumerate}
\item $X$ is a countably indexed affine formal algebraic space,
\item $X = \text{Spf}(A)$ where $A$ is a weakly admissible topological
$S$-algebra which has a countable fundamental system of neighbourhoods of $0$,
\item $X = \text{Spf}(A)$ where $A$ is a weakly admissible topological
$S$-algebra which has a fundamental system
$A \supset I_1 \supset I_2 \supset I_3 \supset \ldots$
of weak ideals of definition,
\item $X = \text{Spf}(A)$ where $A$ is a complete topological $S$-algebra
with a fundamental system of open neighbourhoods of $0$ given by a
countable sequence $A \supset I_1 \supset I_2 \supset I_3 \supset \ldots$
of ideals such that $I_n/I_{n + 1}$ is locally nilpotent, and
\item $X = \text{Spf}(A)$ where $A = \lim B/J_n$ with the limit topology
where $B \supset J_1 \supset J_2 \supset J_3 \supset \ldots$ is a
sequence of ideals in an $S$-algebra $B$ with $J_n/J_{n + 1}$
locally nilpotent.
\end{enumerate}
\end{lemma}

\begin{proof}
Assume (1). By Lemma \ref{lemma-implications-between-types}
we can write $X = \text{Spf}(A)$ where $A$ is a weakly admissible
topological $S$-algebra. For any presentation $X = \colim X_n$ as in
Lemma \ref{lemma-countable-affine-formal-algebraic-space} part (1)
we see that $A = \lim A_n$ with $X_n = \Spec(A_n)$ and
$A_n = A/I_n$ for some weak ideal of definition $I_n \subset A$.
This follows from the final statement of
Lemma \ref{lemma-mcquillan-affine-formal-algebraic-space}
which moreover implies that $\{I_n\}$ is a fundamental system
of open neighbourhoods of $0$. Thus we have a sequence
$$
A \supset I_1 \supset I_2 \supset I_3 \supset \ldots
$$
of weak ideals of definition with $A = \lim A/I_n$. In this way
we see that condition (1) implies each of the conditions (2) -- (5).

\medskip\noindent
Assume (5). First note that the limit topology on
$A = \lim B/J_n$ is a linearly topologized, complete topology, see
More on Algebra, Section \ref{more-algebra-section-topological-ring}.
If $f \in A$ maps to zero in $B/J_1$, then some power maps to zero
in $B/J_2$ as its image in $J_1/J_2$ is nilpotent, then a further
power maps to zero in $J_2/J_3$, etc, etc. In this way we see
the open ideal $\Ker(A \to B/J_1)$ is a weak ideal of definition.
Thus $A$ is weakly admissible. In this way we see that (5) implies (2).

\medskip\noindent
It is clear that (4) is a special case of (5) by taking $B = A$.
It is clear that (3) is a special case of (2).

\medskip\noindent
Assume $A$ is as in (2). Let $E_n$ be a countable fundamental
system of neighbourhoods of $0$ in $A$. Since $A$ is a weakly
admissible topological ring we can find open ideals $I_n \subset E_n$.
We can also choose a weak ideal of definition $J \subset A$.
Then $J \cap I_n$ is a fundamental system of weak ideals of definition
of $A$ and we get
$X = \text{Spf}(A) = \colim \Spec(A/(J \cap I_n))$
which shows that $X$ is a countably indexed affine formal algebraic space.
\end{proof}

\begin{lemma}
\label{lemma-characterize-noetherian-affine}
Let $S$ be a scheme. Let $X$ be an affine formal algebraic space.
The following are equivalent
\begin{enumerate}
\item $X$ is Noetherian,
\item $X$ is adic* and for some choice of $X = \colim X_\lambda$ as in
Definition \ref{definition-affine-formal-algebraic-space}
the schemes $X_\lambda$ are Noetherian,
\item $X$ is adic* and for any closed immersion $T \to X$ with $T$
a scheme, $T$ is Noetherian.
\end{enumerate}
\end{lemma}

\begin{proof}
This follows from the fact that if $A$ is a ring complete with
respect to a finitely generated ideal $I$, then $A$ is Noetherian
if and only if $A/I$ is Noetherian, see
Algebra, Lemma \ref{algebra-lemma-completion-Noetherian}.
Details omitted.
\end{proof}





\section{Formal algebraic spaces}
\label{section-formal-algebraic-spaces}

\noindent
We take a break from our habit of introducing new concepts first
for rings, then for schemes, and then for algebraic spaces, by
introducing formal algebraic spaces without first introducing
formal schemes. The general idea will be that a formal algebraic space
is a sheaf in the fppf topology which \'etale locally is an
affine formal scheme in the sense of \cite{BVGD}.
Related material can be found in \cite{Yasuda}.

\medskip\noindent
In the definition of a formal algebraic space we are going to
borrow some terminology from
Bootstrap, Sections
\ref{bootstrap-section-morphism-representable-by-spaces} and
\ref{bootstrap-section-representable-by-spaces-properties}.

\begin{definition}
\label{definition-formal-algebraic-space}
Let $S$ be a scheme. We say a sheaf $X$ on $(\Sch/S)_{fppf}$ is a
{\it formal algebraic space} if there exist a family of maps
$\{X_i \to X\}_{i \in I}$ of sheaves such that
\begin{enumerate}
\item $X_i$ is an affine formal algebraic space,
\item $X_i \to X$ is representable by algebraic spaces and \'etale,
\item $\coprod X_i \to X$ is surjective as a map of sheaves
\end{enumerate}
and $X$ satisfies a set theoretic condition
(see Remark \ref{remark-set-theoretic}). A
{\it morphism of formal algebraic spaces}
over $S$ is a map of sheaves.
\end{definition}

\noindent
Discussion. Sanity check: an affine formal algebraic space is
a formal algebraic space. In the situation of the definition
the morphisms $X_i \to X$ are representable (by schemes), see
Lemma \ref{lemma-presentation-representable}.
By Bootstrap, Lemma
\ref{bootstrap-lemma-surjective-flat-locally-finite-presentation}
we could instead of asking $\coprod X_i \to X$
to be surjective as a map of sheaves, require that it be
surjective (which makes sense because it is representable).

\medskip\noindent
Our notion of a formal algebraic space is {\bf very general}.
In fact, even affine formal algebraic spaces as defined above
are very nasty objects. However, they do have an underlying
reduced algebraic space as the following lemma demonstrates.

\begin{lemma}
\label{lemma-reduction-formal-algebraic-space}
Let $S$ be a scheme. Let $X$ be a formal algebraic space over $S$.
There exists a reduced algebraic space $X_{red}$ and a representable
morphism $X_{red} \to X$ which is a thickening. A morphism $U \to X$
with $U$ a reduced algebraic space factors uniquely through $X_{red}$.
\end{lemma}

\begin{proof}
First assume that $X$ is an affine formal algebraic space.
Say $X = \colim X_\lambda$ as in
Definition \ref{definition-affine-formal-algebraic-space}.
Since the transition morphisms are thickenings, the affine
schemes $X_\lambda$ all have isomorphic reductions $X_{red}$.
The morphism $X_{red} \to X$ is representable and a thickening
by Lemma \ref{lemma-covering-by-thickenings} and the fact that
compositions of thickenings are thickenings. We omit the
verification of the universal
property (use Schemes, Definition
\ref{schemes-definition-reduced-induced-scheme},
Schemes, Lemma \ref{schemes-lemma-map-into-reduction},
Properties of Spaces, Definition
\ref{spaces-properties-definition-reduced-induced-space}, and
Properties of Spaces, Lemma \ref{spaces-properties-lemma-map-into-reduction}).

\medskip\noindent
Let $X$ and $\{X_i \to X\}_{i \in I}$ be as in
Definition \ref{definition-formal-algebraic-space}.
For each $i$ let $X_{i, red} \to X_i$ be the reduction as
constructed above. For $i, j \in I$ the projection
$X_{i, red} \times_X X_j \to X_{i, red}$ is an \'etale (by assumption)
morphism of schemes (by Lemma \ref{lemma-presentation-representable}).
Hence $X_{i, red} \times_X X_j$ is reduced (see
Descent, Lemma \ref{descent-lemma-reduced-local-smooth}).
Thus the projection $X_{i, red} \times_X X_j \to X_j$ factors
through $X_{j, red}$ by the universal property. We conclude that
$$
R_{ij} = X_{i, red} \times_X X_j = X_{i, red} \times_X X_{j, red} =
X_i \times_X X_{j, red}
$$
because the morphisms $X_{i, red} \to X_i$ are injections of sheaves.
Set $U = \coprod X_{i, red}$, set
$R = \coprod R_{ij}$, and denote $s, t : R \to U$ the two
projections. As a sheaf $R = U \times_X U$ and $s$ and $t$
are \'etale. Then $(t, s) : R \to U$ defines an \'etale equivalence
relation by our observations above. Thus $X_{red} = U/R$ is an
algebraic space by Spaces, Theorem \ref{spaces-theorem-presentation}.
By construction the diagram
$$
\xymatrix{
\coprod X_{i, red} \ar[r] \ar[d] & \coprod X_i \ar[d] \\
X_{red} \ar[r] & X
}
$$
is cartesian. Since the right vertical arrow is \'etale surjective
and the top horizontal arrow is representable and a thickening
we conclude that $X_{red} \to X$ is representable by
Bootstrap, Lemma \ref{bootstrap-lemma-after-fppf-sep-lqf}
(to verify the assumptions of the lemma use that a surjective
\'etale morphism is surjective, flat, and locally of finite
presentation and use that thickenings are separated and locally quasi-finite).
Then we can use Spaces, Lemma
\ref{spaces-lemma-descent-representable-transformations-property}
to conclude that $X_{red} \to X$ is a thickening
(use that being a thickening is equivalent to being
a surjective closed immersion).

\medskip\noindent
Finally, suppose that $U \to X$ is a morphism with
$U$ a reduced algebraic space over $S$. Then each $X_i \times_X U$
is \'etale over $U$ and therefore reduced (by our definition of
reduced algebraic spaces in Properties of Spaces, Section
\ref{spaces-properties-section-types-properties}).
Then $X_i \times_X U \to X_i$ factors through $X_{i, red}$.
Hence $U \to X$ factors through $X_{red}$ because
$\{X_i \times_X U \to U\}$ is an \'etale covering.
\end{proof}

\begin{lemma}
\label{lemma-diagonal-formal-algebraic-space}
Let $S$ be a scheme. If $X$ is a formal algebraic space over
$S$, then the diagonal morphism $\Delta : X \to X \times_S X$
is representable, a monomorphism, locally quasi-finite,
locally of finite type, and separated.
\end{lemma}

\begin{proof}
Suppose given $U \to X$ and $V \to X$ with $U, V$ schemes over $S$.
Then $U \times_X V$ is a sheaf. Choose $\{X_i \to X\}$ as in
Definition \ref{definition-formal-algebraic-space}.
For every $i$ the morphism
$$
(U \times_X X_i) \times_{X_i} (V \times_X X_i)
= (U \times_X V) \times_X X_i \to U \times_X V
$$
is representable and \'etale as a base change of $X_i \to X$
and its source is a scheme (use
Lemmas \ref{lemma-diagonal-affine-formal-algebraic-space} and
\ref{lemma-presentation-representable}). These maps are jointly surjective
hence $U \times_X V$ is an algebraic space by
Bootstrap, Theorem \ref{bootstrap-theorem-final-bootstrap}.
The morphism $U \times_X V \to U \times_S V$ is a monomorphism.
It is also locally quasi-finite, because on precomposing with
the morphism displayed above we obtain the composition
$$
(U \times_X X_i) \times_{X_i} (V \times_X X_i)
\to (U \times_X X_i) \times_S (V \times_X X_i)
\to U \times_S V
$$
which is locally quasi-finite as a composition of a closed
immersion (Lemma \ref{lemma-diagonal-affine-formal-algebraic-space})
and an \'etale morphism, see
Descent on Spaces, Lemma
\ref{spaces-descent-lemma-locally-quasi-finite-etale-local-source}.
Hence we conclude that $U \times_X V$ is a scheme by
Morphisms of Spaces, Proposition
\ref{spaces-morphisms-proposition-locally-quasi-finite-separated-over-scheme}.
Thus $\Delta$ is representable, see
Spaces, Lemma \ref{spaces-lemma-representable-diagonal}.

\medskip\noindent
In fact, since we've shown above that the morphisms of schemes
$U \times_X V \to U \times_S V$ are aways monomorphisms and
locally quasi-finite we conclude that $\Delta : X \to X \times_S X$
is a monomorphism and locally quasi-finite, see
Spaces, Lemma \ref{spaces-lemma-transformation-diagonal-properties}.
Then we can use the principle of
Spaces, Lemma
\ref{spaces-lemma-representable-transformations-property-implication}
to see that $\Delta$ is separated and locally of finite type.
Namely, a monomorphism of schemes is separated
(Schemes, Lemma \ref{schemes-lemma-monomorphism-separated})
and a locally quasi-finite morphism of schemes is
locally of finite type
(follows from the definition in
Morphisms, Section \ref{morphisms-section-quasi-finite}).
\end{proof}

\begin{lemma}
\label{lemma-space-to-formal-space}
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism from an
algebraic space over $S$ to a formal algebraic space over $S$.
Then $f$ is representable by algebraic spaces.
\end{lemma}

\begin{proof}
Let $Z \to Y$ be a morphism where $Z$ is a scheme over $S$.
We have to show that $X \times_Y Z$ is an algebraic space.
Choose a scheme $U$ and a surjective \'etale morphism $U \to X$.
Then $U \times_Y Z \to X \times_Y Z$ is representable surjective \'etale
(Spaces, Lemma
\ref{spaces-lemma-base-change-representable-transformations-property})
and $U \times_Y Z$ is a scheme by
Lemma \ref{lemma-diagonal-formal-algebraic-space}.
Hence the result by
Bootstrap, Theorem \ref{bootstrap-theorem-final-bootstrap}.
\end{proof}

\begin{remark}
\label{remark-compare-with-formal-schemes}
Modulo set theoretic issues the category of formal schemes \`a la EGA
(see Section \ref{section-formal-schemes-EGA}) is equivalent to a full
subcategory of the category of formal algebraic spaces. To explain this
we assume our base scheme is $\Spec(\mathbf{Z})$. By
Lemma \ref{lemma-formal-scheme-sheaf-fppf} the functor of points
$h_\mathfrak X$ associated to a formal scheme $\mathfrak X$ is a sheaf
in the fppf topology. By Lemma \ref{lemma-fully-faithful}
the assignment $\mathfrak X \mapsto h_\mathfrak X$ is a fully faithful
embedding of the category of formal schemes into the category of
fppf sheaves. Given a formal scheme $\mathfrak X$ we choose an open covering
$\mathfrak X = \bigcup \mathfrak X_i$ with $\mathfrak X_i$
affine formal schemes. Then $h_{\mathfrak X_i}$
is an affine formal algebraic space by
Remark \ref{remark-compare-with-affine-formal-schemes}.
The morphisms $h_{\mathfrak X_i} \to h_\mathfrak X$ are representable
and open immersions. Thus $\{h_{\mathfrak X_i} \to h_\mathfrak X\}$
is a family as in Definition \ref{definition-formal-algebraic-space}
and we see that $h_\mathfrak X$ is a formal algebraic space.
\end{remark}

\begin{remark}
\label{remark-set-theoretic}
Let $S$ be a scheme and let $(\Sch/S)_{fppf}$ be a big fppf site as
in Topologies, Definition \ref{topologies-definition-big-small-fppf}.
As our set theoretic condition on $X$ in
Definitions \ref{definition-affine-formal-algebraic-space} and
\ref{definition-formal-algebraic-space} we take:
there exist objects $U, R$ of $(\Sch/S)_{fppf}$, a
morphism $U \to X$ which is a surjection of fppf sheaves, and
a morphism $R \to U \times_X U$ which is a surjection of fppf sheaves.
In other words, we require our sheaf to be a coequalizer of
two maps between representable sheaves.
Here are some observations which imply this notion behaves
reasonably well:
\begin{enumerate}
\item Suppose $X = \colim_{\lambda \in \Lambda} X_\lambda$
and the system satisfies conditions (1) and (2) of
Definition \ref{definition-affine-formal-algebraic-space}. Then
$U = \coprod_{\lambda \in \Lambda} X_\lambda \to X$ is a surjection
of fppf sheaves. Moreover, $U \times_X U$ is a closed subscheme
of $U \times_S U$ by Lemma \ref{lemma-diagonal-affine-formal-algebraic-space}.
Hence if $U$ is representable by an object of $(\Sch/S)_{fppf}$
then $U \times_S U$ is too (see Sets, Lemma \ref{sets-lemma-what-is-in-it})
and the set theoretic condition is satisfied. This is always the case
if $\Lambda$ is countable, see Sets, Lemma \ref{sets-lemma-what-is-in-it}.
\item Sanity check. Let $\{X_i \to X\}_{i \in I}$ be as in
Definition \ref{definition-formal-algebraic-space}
(with the set theoretic condition as formulated above)
and assume that each $X_i$ is actually an affine scheme.
Then $X$ is an algebraic space. Namely, if we choose a larger
big fppf site $(\Sch'/S)_{fppf}$ such that $U' = \coprod X_i$
and $R' = \coprod X_i \times_X X_j$ are representable by objects
in it, then $X' = U'/R'$ will be an object of the category
of algebraic spaces for this choice. Then an application of
Spaces, Lemma \ref{spaces-lemma-fully-faithful} shows that
$X$ is an algebraic space for $(\Sch/S)_{fppf}$.
\item Let $\{X_i \to X\}_{i \in I}$ be a family of maps of sheaves
satisfying conditions (1), (2), (3) of
Definition \ref{definition-formal-algebraic-space}.
For each $i$ we can pick $U_i \in \Ob((\Sch/S)_{fppf})$
and $U_i \to X_i$ which is a surjection of sheaves.
Thus if $I$ is not too large (for example countable) then
$U = \coprod U_i \to X$ is a surjection of sheaves and
$U$ is representable by an object of $(\Sch/S)_{fppf}$.
To get $R \in \Ob((\Sch/S)_{fppf})$ surjecting onto $U \times_X U$
it suffices to assume the diagonal $\Delta : X \to X \times_S X$ is not
too wild, for example this always works if the diagonal of $X$ is
quasi-compact, i.e., $X$ is quasi-separated.
\end{enumerate}
\end{remark}






\section{Colimits of algebraic spaces along thickenings}
\label{section-global-colimits}

\noindent
A special type of formal algebraic space is one which can globally
be written as a cofiltered colimit of algebraic spaces along
thickenings as in the following lemma. We will see later
(in Section \ref{section-quasi-compact-quasi-separated})
that any quasi-compact and quasi-separated formal algebraic space
is such a global colimit.

\begin{lemma}
\label{lemma-colimit-is-formal}
Let $S$ be a scheme. Suppose given a directed set
$\Lambda$ and a system of algebraic spaces $(X_\lambda, f_{\lambda \mu})$
over $\Lambda$ where each $f_{\lambda \mu} : X_\lambda \to X_\mu$ is a
thickening. Then $X = \colim_{\lambda \in \Lambda} X_\lambda$
is a formal algebraic space over $S$.
\end{lemma}

\begin{proof}
Since we take the colimit in the category of fppf sheaves, we
see that $X$ is a sheaf. Choose and fix $\lambda \in \Lambda$. Choose an
\'etale covering $\{X_{i, \lambda} \to X_\lambda\}$ where $X_i$ is an affine
scheme over $S$, see Properties of Spaces, Lemma
\ref{spaces-properties-lemma-cover-by-union-affines}.
For each $\mu \geq \lambda$ there exists a cartesian diagram
$$
\xymatrix{
X_{i, \lambda} \ar[r] \ar[d] & X_{i, \mu} \ar[d] \\
X_\lambda \ar[r] & X_\mu
}
$$
with \'etale vertical arrows, see
More on Morphisms of Spaces, Theorem
\ref{spaces-more-morphisms-theorem-topological-invariance}
(this also uses that a thickening is a surjective closed immersion which
satisfies the conditions of the theorem). Moreover, these diagrams are
unique up to unique isomorphism and hence
$X_{i, \mu} = X_\mu \times_{X_{\mu'}} X_{i, \mu'}$ for
$\mu' \geq \mu$. The morphisms $X_{i, \mu} \to X_{i, \mu'}$
is a thickening as a base change of a thickening. Each $X_{i, \mu}$
is an affine scheme by Limits of Spaces, Proposition
\ref{spaces-limits-proposition-affine} and the fact that
$X_{i, \lambda}$ is affine.
Set $X_i = \colim_{\mu \geq \lambda} X_{i, \mu}$. Then $X_i$ is
an affine formal algebraic space. The morphism $X_i \to X$
is \'etale because given an affine scheme $U$ any $U \to X$
factors through $X_\mu$ for some $\mu \geq \lambda$ (details omitted).
In this way we see that $X$ is a formal algebraic space.
\end{proof}

\noindent
Let $S$ be a scheme. Let $X$ be a formal algebraic space over $S$.
How does one prove or check that $X$ is a global colimit as in
Lemma \ref{lemma-colimit-is-formal}? To do this we look for maps
$i : Z \to X$ where $Z$ is an algebraic space over $S$ and $i$ is
surjective and a closed immersion, in other words, $i$ is a thickening.
This makes sense as $i$ is representable by algebraic spaces
(Lemma \ref{lemma-space-to-formal-space}) and we can use
Bootstrap, Definition \ref{bootstrap-definition-property-transformation}
as before.

\begin{example}
\label{example-david-hansen}
Let $(A, \mathfrak m, \kappa)$ be a valuation ring, which is
$(\pi)$-adically complete for some nonzero $\pi \in \mathfrak m$.
Assume also that $\mathfrak m$ is not finitely generated.
An example is $A = \mathcal{O}_{\mathbf{C}_p}$ and $\pi = p$
where $\mathcal{O}_{\mathbf{C}_p}$ is the ring of integers
of the field of $p$-adic complex numbers $\mathbf{C}_p$
(this is the completion of the algebraic closure of
$\mathbf{Q}_p$). Another example is
$$
A =
\left\{
\sum\nolimits_{\alpha \in \mathbf{Q},\ \alpha \geq 0} a_\alpha t^\alpha
\middle|
\begin{matrix}
a_\alpha \in \kappa \text{ and for all }n\text{ there are only a} \\
\text{finite number of nonzero }a_\alpha
\text{ with }\alpha \leq n
\end{matrix}
\right\}
$$
and $\pi = t$. Then $X = \text{Spf}(A)$ is an affine formal algebraic
space and $\Spec(\kappa) \to X$ is a thickening which corresponds
to the weak ideal of definition $\mathfrak m \subset A$
which is however not an ideal of definition.
\end{example}

\begin{remark}[Weak ideals of definition]
\label{remark-weak-ideals-of-definition}
Let $\mathfrak X$ be a formal scheme in the sense of McQuillan, see
Remark \ref{remark-mcquillan}. An {\it weak ideal of definition}
for $\mathfrak X$ is an ideal sheaf
$\mathcal{I} \subset \mathcal{O}_\mathfrak X$ such that
for all $\mathfrak U \subset \mathfrak X$ affine formal open subscheme
the ideal
$\mathcal{I}(\mathfrak U) \subset \mathcal{O}_\mathfrak X(\mathfrak U)$
is a weak ideal of definition of the weakly admissible topological ring
$\mathcal{O}_\mathfrak X(\mathfrak U)$.
It suffices to check the condition on the members of an affine open covering.
There is a one-to-one correspondence
$$
\{\text{weak ideals of definition for }\mathfrak X\}
\leftrightarrow
\{\text{thickenings }i : Z \to h_\mathfrak X\text{ as above}\}
$$
This correspondence associates to $\mathcal{I}$ the scheme
$Z = (\mathfrak X, \mathcal{O}_\mathfrak X/\mathcal{I})$
together with the obvious morphism to $\mathfrak X$.
A {\it fundamental system of weak ideals of definition}
is a collection of weak ideals of definition
$\mathcal{I}_\lambda$ such that on every affine open
formal subscheme $\mathfrak U \subset \mathfrak X$ the
ideals
$$
I_\lambda = \mathcal{I}_\lambda(\mathfrak U) \subset
A = \Gamma(\mathfrak U, \mathcal{O}_\mathfrak X)
$$
form a fundamental system of weak ideals of definition of the
weakly admissible topological ring $A$. It suffices to check
on the members of an affine open covering. We conclude that
the formal algebraic space $h_\mathfrak X$ associated to
the McQuillan formal scheme $\mathfrak X$ is a colimit of schemes as
in Lemma \ref{lemma-colimit-is-formal} if and only if
there exists a fundamental system of weak ideals of definition
for $\mathfrak X$.
\end{remark}

\begin{remark}[Ideals of definition]
\label{remark-ideals-of-definition}
Let $\mathfrak X$ be a formal scheme \`a la EGA.
An {\it ideal of definition} for $\mathfrak X$ is an ideal sheaf
$\mathcal{I} \subset \mathcal{O}_\mathfrak X$ such that
for all $\mathfrak U \subset \mathfrak X$ affine formal open subscheme
the ideal
$\mathcal{I}(\mathfrak U) \subset \mathcal{O}_\mathfrak X(\mathfrak U)$
is an ideal of definition of the admissible topological ring
$\mathcal{O}_\mathfrak X(\mathfrak U)$.
It suffices to check the condition on the members of an affine open covering.
We do {\bf not} get the same correspondence between ideals of definition
and thickenings $Z \to h_\mathfrak X$ as in
Remark \ref{remark-weak-ideals-of-definition}; an example
is given in Example \ref{example-david-hansen}.
A {\it fundamental system of ideals of definition}
is a collection of ideals of definition
$\mathcal{I}_\lambda$ such that on every affine open
formal subscheme $\mathfrak U \subset \mathfrak X$ the
ideals
$$
I_\lambda = \mathcal{I}_\lambda(\mathfrak U) \subset
A = \Gamma(\mathfrak U, \mathcal{O}_\mathfrak X)
$$
form a fundamental system of ideals of definition of the
admissible topological ring $A$. It suffices to check
on the members of an affine open covering. Suppose that $\mathfrak X$
is quasi-compact and that $\{\mathcal{I}_\lambda\}_{\lambda \in \Lambda}$
is a fundamental system of weak ideals of definition.
If $A$ is an admissible topological ring then all
sufficiently small open ideals are ideals of definition
(namely any open ideal contained in an ideal of definition
is an ideal of definition). Thus since we only need to check
on the finitely many members of an affine open covering
we see that $\mathcal{I}_\lambda$ is an ideal of definition
for $\lambda$ sufficiently large. Using the discussion in
Remark \ref{remark-weak-ideals-of-definition} we conclude that
the formal algebraic space $h_\mathfrak X$ associated to
the quasi-compact formal scheme $\mathfrak X$ \`a la EGA
is a colimit of schemes as in Lemma \ref{lemma-colimit-is-formal}
if and only if there exists a fundamental system of ideals of definition
for $\mathfrak X$.
\end{remark}






\section{Completion along a closed subset}
\label{section-completion}

\noindent
Our notion of a formal algebraic space is well adapted to taking the
completion along a closed subset.

\begin{lemma}
\label{lemma-completion-affine-is-affine-formal-algebraic-space}
Let $S$ be a scheme. Let $X$ be an affine scheme over $S$.
Let $T \subset |X|$ be a closed subset. Then the functor
$$
(\Sch/S)_{fppf} \longrightarrow \textit{Sets},\quad
U \longmapsto \{f : U \to X \mid f(|U|) \subset T\}
$$
is a McQuillan affine formal algebraic space.
\end{lemma}

\begin{proof}
Say $X = \Spec(A)$ and $T$ corresponds to the radical ideal $I \subset A$.
Let $U = \Spec(B)$ be an affine scheme over $S$ and let
$f : U \to X$ be an element of $F(U)$. Then $f$ corresponds to a
ring map $\varphi : A \to B$ such that every prime of $B$ contains
$\varphi(I) B$. Thus every element of $\varphi(I)$ is nilpotent in $B$, see
Algebra, Lemma \ref{algebra-lemma-Zariski-topology}.
Setting $J = \Ker(\varphi)$ we conclude that $I/J$ is a locally nilpotent
ideal in $A/J$. Equivalently, $V(J) = V(I) = T$.
In other words, the functor of the lemma equals
$\colim \Spec(A/J)$ where the colimit is over the
collection of ideals $J$ with $V(J) = T$.
Thus our functor is an affine formal algebraic space. It is McQuillan
(Definition \ref{definition-types-affine-formal-algebraic-space})
because the maps $A \to A/J$ are surjective
and hence $A^\wedge = \lim A/J \to A/J$ is surjective, see
Lemma \ref{lemma-mcquillan-affine-formal-algebraic-space}.
\end{proof}

\begin{lemma}
\label{lemma-completion-is-formal-algebraic-space}
Let $S$ be a scheme. Let $X$ be an algebraic space over $S$.
Let $T \subset |X|$ be a closed subset. Then the functor
$$
(\Sch/S)_{fppf} \longrightarrow \textit{Sets},\quad
U \longmapsto \{f : U \to X \mid f(|U|) \subset T\}
$$
is a formal algebraic space.
\end{lemma}

\begin{proof}
Denote $F$ the functor. Let $\{U_i \to U\}$ be an fppf covering.
Then $\coprod |U_i| \to |U|$ is surjective. Since $X$ is an fppf
sheaf, it follows that $F$ is an fppf sheaf.

\medskip\noindent
Let $\{g_i : X_i \to X\}$ be an \'etale covering such that $X_i$ is affine
for all $i$, see Properties of Spaces, Lemma
\ref{spaces-properties-lemma-cover-by-union-affines}.
The morphisms $F \times_X X_i \to F$ are \'etale
(see Spaces, Lemma
\ref{spaces-lemma-base-change-representable-transformations-property})
and the map $\coprod F \times_X X_i \to F$ is a surjection of sheaves.
Thus it suffices to prove that $F \times_X X_i$ is an affine formal
algebraic space. A $U$-valued point of $F \times_X X_i$ is a
morphism $U \to X_i$ whose image is contained in the closed subset
$g_i^{-1}(T) \subset |X_i|$. Thus this follows from
Lemma \ref{lemma-completion-affine-is-affine-formal-algebraic-space}.
\end{proof}

\begin{definition}
\label{definition-completion}
Let $S$ be a scheme. Let $X$ be an algebraic space over $S$.
Let $T \subset |X|$ be a closed subset. The formal algebraic space
of Lemma \ref{lemma-completion-is-formal-algebraic-space}
is called the {\it completion of $X$ along $T$}.
\end{definition}

\noindent
In \cite[Chapter I, Section 10.8]{EGA} the notation $X_{/T}$
is used to denote the completion and we will occasionally use
this notation as well. Let $f : X \to X'$ be
a morphism of algebraic spaces over a scheme $S$. Suppose
that $T \subset |X|$ and $T' \subset |X'|$ are closed subsets
such that $|f|(T) \subset T'$. Then it is clear that
$f$ defines a morphism of formal algebraic spaces
$$
X_{/T} \longrightarrow X'_{/T'}
$$
between the completions.

\begin{lemma}
\label{lemma-map-completions-representable}
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism
of algebraic spaces over $S$. Let $T \subset |Y|$
be a closed subset and let $T' = |f|^{-1}(T) \subset |X|$.
Then $X_{/T'} \to Y_{/T}$ is representable by algebraic spaces.
\end{lemma}

\begin{proof}
Namely, suppose that $V \to Y$ is a morphism from a scheme into $Y$ such
that $|V|$ maps into $T$. Then $V \times_Y X \to X$ is a morphism of
algebraic spaces such that $|V \times_Y X|$ maps into $T'$. Hence the
functor $V \times_{Y_{/T'}} X_{/T}$ is represented by $V \times_Y X$
and we see that the lemma holds.
\end{proof}

\noindent
The following lemma is due to Ofer Gabber.

\begin{lemma}
\label{lemma-completion-countably-indexed}
\begin{reference}
Email by Ofer Gabber of September 11, 2014.
\end{reference}
Let $S$ be a scheme. Let $X = \Spec(A)$ be an affine scheme over $S$.
Let $T \subset X$ be a closed subscheme.
\begin{enumerate}
\item If the formal completion $X_{/T}$ is countably indexed
and there exist countably many $f_1, f_2, f_3, \ldots \in A$ such that
$T = V(f_1, f_2, f_3, \ldots)$, then $X_{/T}$ is adic*.
\item The conclusion of (1) is wrong if we omit the assumption that
$T$ can be cut out by countably many functions in $X$.
\end{enumerate}
\end{lemma}

\begin{proof}
The assumption that $X_{/T}$ is countably indexed means that there exists a
sequence of ideals
$$
A \supset J_1 \supset J_2 \supset J_3 \supset \ldots
$$
with $V(J_n) = T$ such that every ideal $J \subset A$ with $V(J) = T$
there exists an $n$ such that $J \supset J_n$.

\medskip\noindent
To construct an example for (2) let $\omega_1$ be the first uncountable
ordinal. Let $k$ be a field and let
$A$ be the $k$-algebra generated by $x_\alpha$, $\alpha \in \omega_1$
and $y_{\alpha \beta}$ with $\alpha \in \beta \in \omega_1$
subject to the relations $x_\alpha = y_{\alpha \beta} x_\beta$.
Let $T = V(x_\alpha)$. Let $J_n = (x_\alpha^n)$.
If $J \subset A$ is an ideal such that
$V(J) = T$, then $x_\alpha^{n_\alpha} \in J$ for some $n_\alpha \geq 1$.
One of the sets $\{\alpha \mid n_\alpha = n\}$ must be unbounded in
$\omega_1$. Then the relations imply that $J_n \subset J$.

\medskip\noindent
To see that (2) holds it now suffices to show that $A^\wedge = \lim A/J_n$
is not a ring complete with respect to a finitely generated ideal.
For $\gamma \in \omega_1$ let $A_\gamma$ be the quotient of $A$
by the ideal generated by $x_\alpha$, $\alpha \in \gamma$ and
$y_{\alpha \beta}$, $\alpha \in \gamma$. As $A/J_1$ is reduced,
every topologically nilpotent element $f$ of $\lim A/J_n$ is in
$J_1^\wedge = \lim J_1/J_n$. This means $f$ is an infinite series
involving only a countable number of generators. Hence $f$ dies in
$A_\gamma^\wedge = \lim A_\gamma/J_nA_\gamma$ for some $\gamma$.
Note that $A^\wedge \to A_\gamma^\wedge$ is continuous and open by
Lemma \ref{lemma-ses}.
If the topology on $A^\wedge$ was $I$-adic for some finitely generated ideal
$I \subset A^\wedge$, then $I$ would go to zero in some
$A_\gamma^\wedge$. This would mean that $A_\gamma^\wedge$ is discrete,
which is not the case as there is a surjective continuous and open
(by Lemma \ref{lemma-ses}) map
$A_\gamma^\wedge \to k[[t]]$ given by
$x_\alpha \mapsto t$, $y_{\alpha \beta} \mapsto 1$ for
$\gamma = \alpha$ or $\gamma \in \alpha$.

\medskip\noindent
Before we prove (1) we first prove the following: If $I \subset A^\wedge$ is
a finitely generated ideal whose closure $\bar I$ is open, then $I = \bar I$.
Since $V(J_n^2) = T$ there exists an $m$ such that $J_n^2 \supset J_m$.
Thus, we may assume that $J_n^2 \supset J_{n + 1}$ for all $n$ by passing
to a subsequence. Set $J_n^\wedge = \lim_{k \geq n} J_n/J_k \subset A^\wedge$.
Since the closure $\bar I = \bigcap (I + J_n^\wedge)$
(Lemma \ref{lemma-closed}) is open we see that there exists an $m$ such that
$I + J_n^\wedge \supset J_m^\wedge$ for all $n \geq m$. Fix such an $m$.
We have
$$
J_{n - 1}^\wedge I + J_{n + 1}^\wedge \supset
J_{n - 1}^\wedge (I + J_{n + 1}^\wedge) \supset
J_{n - 1}^\wedge J_m^\wedge
$$
for all $n \geq m + 1$. Namely, the first inclusion is trivial and the
second was shown above. Because $J_{n - 1}J_m \supset J_{n - 1}^2 \supset J_n$
these inclusions show that the image of $J_n$ in $A^\wedge$
is contained in the ideal $J_{n - 1}^\wedge I + J_{n + 1}^\wedge$.
Because this ideal is open we conclude that
$$
J_{n - 1}^\wedge I + J_{n + 1}^\wedge \supset J_n^\wedge.
$$
Say $I = (g_1, \ldots, g_t)$. Pick $f \in J_{m + 1}^\wedge$.
Using the last displayed inclusion, valid for all $n \geq m + 1$,
we can write by induction on $c \geq 0$
$$
f = \sum f_{i, c} g_i \mod J_{m + 1+ c}^\wedge
$$
with $f_{i, c} \in J_m^\wedge$ and
$f_{i, c} \equiv f_{i, c - 1} \bmod J_{m + c}^\wedge$.
It follows that $IJ_m^\wedge \supset J_{m + 1}^\wedge$.
Combined with $I + J_{m + 1}^\wedge \supset J_m^\wedge$
we conclude that $I$ is open.

\medskip\noindent
Proof of (1). Assume $T = V(f_1, f_2, f_3, \ldots)$.
Let $I_m \subset A^\wedge$ be the ideal generated by $f_1, \ldots, f_m$.
We distinguish two cases.

\medskip\noindent
Case I: For some $m$ the closure of $I_m$ is open.
Then $I_m$ is open by the result of the previous paragraph.
For any $n$ we have $(J_n)^2 \supset J_{n+1}$ by design, so
the closure of $(J_n^\wedge)^2$ contains $J_{n+1}^\wedge$
and thus is open.  Taking $n$ large, it follows that the closure
of the product of any two open ideals in $A^\wedge$ is open.
Let us prove $I_m^k$ is open for $k \ge 1$ by induction on $k$.
The case $k = 1$ is our hypothesis on $m$ in Case I.
For $k > 1$, suppose $I_m^{k - 1}$ is open. Then
$I_m^k = I_m^{k - 1} \cdot I_m$ is the product of two open ideals
and hence has open closure. But then since $I_m^k$
is finitely generated it follows that $I_m^k$
is open by the previous paragraph (applied to $I = I_m^k$),
so we can continue the induction on $k$.
As each element of $I_m$ is topologically nilpotent, we conclude
that $I_m$ is an ideal of definition which proves that $A^\wedge$
is adic with a finitely generated ideal of definition, i.e.,
$X_{/T}$ is adic*.

\medskip\noindent
Case II. For all $m$ the closure $\bar I_m$ of $I_m$ is not open.
Then the topology on $A^\wedge/\bar I_m$ is not discrete. This means
we can pick $\phi(m) \geq m$ such that
$$
\Im(J_{\phi(m)} \to A/(f_1, \ldots, f_m)) \not =
\Im(J_{\phi(m) + 1} \to A/(f_1, \ldots, f_m))
$$
To see this we have used that
$A^\wedge/(\bar I_m + J_n^\wedge) = A/((f_1, \ldots, f_m) + J_n)$.
Choose exponents $e_i > 0$ such that $f_i^{e_i} \in J_{\phi(m) + 1}$
for $0 < m < i$. Let $J = (f_1^{e_1}, f_2^{e_2}, f_3^{e_3}, \ldots)$.
Then $V(J) = T$. We claim that $J \not \supset J_n$ for all $n$
which is a contradiction proving Case II does not occur.
Namely, the image of $J$ in $A/(f_1, \ldots, f_m)$ is contained
in the image of $J_{\phi(m) + 1}$ which is properly contained in the
image of $J_m$.
\end{proof}




\section{Fibre products}
\label{section-fibre-products}

\noindent
Obligatory section about fibre products of formal algebraic spaces.

\begin{lemma}
\label{lemma-etale-covering-by-formal-algebraic-spaces}
Let $S$ be a scheme. Let $\{X_i \to X\}_{i \in I}$ be a family of maps
of sheaves on $(\Sch/S)_{fppf}$. Assume (a) $X_i$ is a
formal algebraic space over $S$, (b) $X_i \to X$ is representable
by algebraic spaces and \'etale, and (c) $\coprod X_i \to X$
is a surjection of sheaves. Then $X$ is a formal algebraic space
over $S$.
\end{lemma}

\begin{proof}
For each $i$ pick $\{X_{ij} \to X_i\}_{j \in J_i}$ as in
Definition \ref{definition-formal-algebraic-space}.
Then $\{X_{ij} \to X\}_{i \in I, j \in J_i}$ is a family
as in Definition \ref{definition-formal-algebraic-space}
for $X$.
\end{proof}

\begin{lemma}
\label{lemma-fibre-products-general}
Let $S$ be a scheme. Let $X, Y$ be formal algebraic spaces over $S$
and let $Z$ be a sheaf whose diagonal is representable by
algebraic spaces. Let $X \to Z$ and $Y \to Z$ be maps of sheaves.
Then $X \times_Z Y$ is a formal algebraic space.
\end{lemma}

\begin{proof}
Choose $\{X_i \to X\}$ and $\{Y_j \to Y\}$ as in
Definition \ref{definition-formal-algebraic-space}.
Then $\{X_i \times_Z Y_j \to X \times_Z Y\}$ is a family
of maps which are representable by algebraic spaces and \'etale.
Thus Lemma \ref{lemma-etale-covering-by-formal-algebraic-spaces}
tells us it suffices to show that $X \times_Z Y$ is a formal
algebraic space when $X$ and $Y$ are affine formal algebraic spaces.

\medskip\noindent
Assume $X$ and $Y$ are affine formal algebraic spaces.
Write $X = \colim X_\lambda$ and $Y = \colim Y_\mu$ as
in Definition \ref{definition-affine-formal-algebraic-space}.
Then $X \times_Z Y = \colim X_\lambda \times_Z Y_\mu$.
Each $X_\lambda \times_Z Y_\mu$ is an algebraic space.
For $\lambda \leq \lambda'$ and $\mu \leq \mu'$ the morphism
$$
X_\lambda \times_Z Y_\mu \to
X_\lambda \times_Z Y_{\mu'} \to
X_{\lambda'} \times_Z Y_{\mu'}
$$
is a thickening as a composition of base changes of thickenings.
Thus we conclude by applying Lemma \ref{lemma-colimit-is-formal}.
\end{proof}

\begin{lemma}
\label{lemma-fibre-products}
Let $S$ be a scheme. The category of formal algebraic spaces over $S$
has fibre products.
\end{lemma}

\begin{proof}
Special case of Lemma \ref{lemma-fibre-products-general}
because formal algebraic spaces have representable diagonals, see
Lemma \ref{lemma-diagonal-formal-algebraic-space}.
\end{proof}

\begin{lemma}
\label{lemma-reduction-fibre-products}
Let $S$ be a scheme. Let $X \to Z$ and $Y \to Z$ be morphisms of
formal algebraic spaces over $S$. Then
$(X \times_Z Y)_{red} = (X_{red} \times_{Z_{red}} Y_{red})_{red}$.
\end{lemma}

\begin{proof}
This follows from the universal property of the reduction
in Lemma \ref{lemma-reduction-formal-algebraic-space}.
\end{proof}

\noindent
We have already proved the following lemma (without knowing that
fibre products exist).

\begin{lemma}
\label{lemma-diagonal-morphism-formal-algebraic-spaces}
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of formal algebraic spaces
over $S$. The diagonal morphism $\Delta : X \to X \times_Y X$
is representable (by schemes), a monomorphism, locally quasi-finite,
locally of finite type, and separated.
\end{lemma}

\begin{proof}
Let $T$ be a scheme and let $T \to X \times_Y X$ be a morphism.
Then
$$
T \times_{(X \times_Y X)} X = T \times_{(X \times_S X)} X
$$
Hence the result follows immediately from
Lemma \ref{lemma-diagonal-formal-algebraic-space}.
\end{proof}






\section{Separation axioms for formal algebraic spaces}
\label{section-separation}

\noindent
This section is about ``absolute'' separation conditions on formal algebraic
spaces. We will discuss separation conditions for morphisms of formal
algebraic spaces later.

\begin{lemma}
\label{lemma-characterize-quasi-separated}
Let $S$ be a scheme. Let $X$ be a formal algebraic space over $S$.
The following are equivalent
\begin{enumerate}
\item the reduction of $X$
(Lemma \ref{lemma-reduction-formal-algebraic-space}) is a
quasi-separated algebraic space,
\item for $U \to X$, $V \to X$ with $U$, $V$ quasi-compact schemes
the fibre product $U \times_X V$ is quasi-compact,
\item for $U \to X$, $V \to X$ with $U$, $V$ affine
the fibre product $U \times_X V$ is quasi-compact.
\end{enumerate}
\end{lemma}

\begin{proof}
Observe that $U \times_X V$ is a scheme by
Lemma \ref{lemma-diagonal-formal-algebraic-space}.
Let $U_{red}, V_{red}, X_{red}$ be the reduction of $U, V, X$.
Then
$$
U_{red} \times_{X_{red}} V_{red} = U_{red} \times_X V_{red} \to U \times_X V
$$
is a thickening of schemes. From this the equivalence of (1) and (2)
is clear, keeping in mind the analogous lemma for algebraic spaces, see
Properties of Spaces, Lemma
\ref{spaces-properties-lemma-characterize-quasi-separated}.
We omit the proof of the equivalence of (2) and (3).
\end{proof}

\begin{lemma}
\label{lemma-characterize-separated}
Let $S$ be a scheme. Let $X$ be a formal algebraic space over $S$.
The following are equivalent
\begin{enumerate}
\item the reduction of $X$
(Lemma \ref{lemma-reduction-formal-algebraic-space}) is a separated
algebraic space,
\item for $U \to X$, $V \to X$ with $U$, $V$ affine
the fibre product $U \times_X V$ is affine and
$$
\mathcal{O}(U) \otimes_\mathbf{Z} \mathcal{O}(V)
\longrightarrow
\mathcal{O}(U \times_X V)
$$
is surjective.
\end{enumerate}
\end{lemma}

\begin{proof}
If (2) holds, then $X_{red}$ is a separated algebraic space
by applying Properties of Spaces, Lemma
\ref{spaces-properties-lemma-characterize-quasi-separated}
to morphisms $U \to X_{red}$ and $V \to X_{red}$
with $U, V$ affine and using that $U \times_{X_{red}} V = U \times_X V$.

\medskip\noindent
Assume (1). Let $U \to X$ and $V \to X$ be as in (2).
Observe that $U \times_X V$ is a scheme by
Lemma \ref{lemma-diagonal-formal-algebraic-space}.
Let $U_{red}, V_{red}, X_{red}$ be the reduction of $U, V, X$.
Then
$$
U_{red} \times_{X_{red}} V_{red} = U_{red} \times_X V_{red} \to U \times_X V
$$
is a thickening of schemes. It follows that
$(U \times_X V)_{red} = (U_{red} \times_{X_{red}} V_{red})_{red}$.
In particular, we see that $(U \times_X V)_{red}$ is an affine scheme
and that
$$
\mathcal{O}(U) \otimes_\mathbf{Z} \mathcal{O}(V)
\longrightarrow
\mathcal{O}((U \times_X V)_{red})
$$
is surjective, see Properties of Spaces, Lemma
\ref{spaces-properties-lemma-characterize-quasi-separated}.
Then $U \times_X V$ is affine by
Limits of Spaces, Proposition \ref{spaces-limits-proposition-affine}.
On the other hand, the morphism $U \times_X V \to U \times V$
of affine schemes is the composition
$$
U \times_X V = X \times_{(X \times_S X)} (U \times_S V)
\to U \times_S V \to U \times V
$$
The first morphism is a monomorphism and locally of finite type
(Lemma \ref{lemma-diagonal-formal-algebraic-space}).
The second morphism is an immersion
(Schemes, Lemma \ref{schemes-lemma-fibre-product-after-map}).
Hence the composition is a monomorphism which is locally of finite type.
On the other hand, the composition is integral as the map on
underlying reduced affine schemes is a closed immersion
by the above and hence universally closed (use
Morphisms, Lemma \ref{morphisms-lemma-integral-universally-closed}).
Thus the ring map
$$
\mathcal{O}(U) \otimes_\mathbf{Z} \mathcal{O}(V)
\longrightarrow
\mathcal{O}(U \times_X V)
$$
is an epimorphism which is integral of finite type
hence finite hence surjective (use
Morphisms, Lemma \ref{morphisms-lemma-finite-integral}
and
Algebra, Lemma \ref{algebra-lemma-finite-epimorphism-surjective}).
\end{proof}

\begin{definition}
\label{definition-separated}
Let $S$ be a scheme. Let $X$ be a formal algebraic space over $S$.
We say
\begin{enumerate}
\item $X$ is {\it quasi-separated} if the equivalent conditions of
Lemma \ref{lemma-characterize-quasi-separated} are satisfied.
\item $X$ is {\it separated} if the equivalent conditions of
Lemma \ref{lemma-characterize-separated} are satisfied.
\end{enumerate}
\end{definition}

\noindent
The following lemma implies in particular that the completed
tensor product of weakly admissible topological rings is
a weakly admissible topological ring.

\begin{lemma}
\label{lemma-fibre-product-affines-over-separated}
Let $S$ be a scheme. Let $X \to Z$ and $Y \to Z$ be morphisms
of formal algebraic spaces over $S$. Assume $Z$ separated.
\begin{enumerate}
\item If $X$ and $Y$ are affine formal algebraic spaces, then
so is $X \times_Z Y$.
\item If $X$ and $Y$ are McQuillan affine formal algebraic spaces, then
so is $X \times_Z Y$.
\item If $X$, $Y$, and $Z$ are McQuillan affine formal algebraic spaces
corresponding to the weakly admissible topological $S$-algebras
$A$, $B$, and $C$, then $X \times_Z Y$ corresponds to
$A \widehat{\otimes}_C B$.
\end{enumerate}
\end{lemma}

\begin{proof}
Write $X = \colim X_\lambda$ and $Y = \colim Y_\mu$ as
in Definition \ref{definition-affine-formal-algebraic-space}.
Then $X \times_Z Y = \colim X_\lambda \times_Z Y_\mu$.
Since $Z$ is separated the fibre products are affine, hence
we see that (1) holds. Assume $X$ and $Y$ corresponds to
the weakly admissible topological $S$-algebras $A$ and $B$
and $X_\lambda = \Spec(A/I_\lambda)$ and $Y_\mu = \Spec(B/J_\mu)$.
Then
$$
X_\lambda \times_Z Y_\mu \to
X_\lambda \times Y_\mu \to \Spec(A \otimes B)
$$
is a closed immersion. Thus one of the conditions of
Lemma \ref{lemma-mcquillan-affine-formal-algebraic-space}
holds and we conclude that $X \times_Z Y$ is McQuillan.
If also $Z$ is McQuillan corresponding to $C$, then
$$
X_\lambda \times_Z Y_\mu = \Spec(A/I_\lambda \otimes_C B/J_\mu)
$$
hence we see that the weakly admissible topological ring
corresponding to $X \times_Z Y$ is the completed tensor product
(see Definition \ref{definition-toplogy-tensor-product}).
\end{proof}

\begin{lemma}
\label{lemma-separated-from-separated}
Let $S$ be a scheme. Let $X$ be a formal algebraic space over $S$.
Let $U \to X$ be a morphism where $U$ is a separated algebraic
space over $S$. Then $U \to X$ is separated.
\end{lemma}

\begin{proof}
The statement makes sense because $U \to X$ is representable by
algebraic spaces (Lemma \ref{lemma-space-to-formal-space}).
Let $T$ be a scheme and $T \to X$ a morphism. We have to show
that $U \times_X T \to T$ is separated. Since $U \times_X T \to U \times_S T$
is a monomorphism, it suffices to show that $U \times_S T \to T$
is separated. As this is the base change of $U \to S$ this
follows. We used in the argument above:
Morphisms of Spaces, Lemmas
\ref{spaces-morphisms-lemma-base-change-separated},
\ref{spaces-morphisms-lemma-composition-separated},
\ref{spaces-morphisms-lemma-monomorphism-separated}, and
\ref{spaces-morphisms-lemma-separated-implies-morphism-separated}.
\end{proof}




\section{Quasi-compact formal algebraic spaces}
\label{section-quasi-compact}

\noindent
Here is the characterization of quasi-compact formal algebraic
spaces.

\begin{lemma}
\label{lemma-characterize-quasi-compact}
Let $S$ be a scheme. Let $X$ be a formal algebraic space over $S$.
The following are equivalent
\begin{enumerate}
\item the reduction of $X$
(Lemma \ref{lemma-reduction-formal-algebraic-space}) is a quasi-compact
algebraic space,
\item we can find $\{X_i \to X\}_{i \in I}$ as in
Definition \ref{definition-formal-algebraic-space} with $I$ finite,
\item there exists a morphism $Y \to X$ representable by algebraic
spaces which is \'etale and surjective and where
$Y$ is an affine formal algebraic space.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{definition}
\label{definition-quasi-compact}
Let $S$ be a scheme. Let $X$ be a formal algebraic space over $S$.
We say $X$ is {\it quasi-compact} if the equivalent conditions of
Lemma \ref{lemma-characterize-quasi-compact} are satisfied.
\end{definition}

\begin{lemma}
\label{lemma-characterize-quasi-compact-morphism}
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of formal algebraic
spaces over $S$. The following are equivalent
\begin{enumerate}
\item the induced map $f_{red} : X_{red} \to Y_{red}$ between reductions
(Lemma \ref{lemma-reduction-formal-algebraic-space}) is a quasi-compact
morphism of algebraic spaces,
\item for every quasi-compact scheme $T$ and morphism $T \to Y$
the fibre product $X \times_Y T$ is a quasi-compact formal
algebraic space,
\item for every affine scheme $T$ and morphism $T \to Y$
the fibre product $X \times_Y T$ is a quasi-compact formal
algebraic space, and
\item there exists a covering $\{Y_j \to Y\}$ as in
Definition \ref{definition-formal-algebraic-space}
such that each $X \times_Y Y_j$ is a quasi-compact formal algebraic space.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{definition}
\label{definition-quasi-compact-morphism}
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of
formal algebraic spaces over $S$.
We say $f$ is {\it quasi-compact} if the equivalent conditions of
Lemma \ref{lemma-characterize-quasi-compact-morphism} are satisfied.
\end{definition}

\noindent
This agrees with the already existing notion when the morphism
is representable by algebraic spaces (and in particular when it is
representable).

\begin{lemma}
\label{lemma-quasi-compact-representable}
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of formal algebraic
spaces over $S$ which is representable by algebraic spaces.
Then $f$ is quasi-compact in the sense of
Definition \ref{definition-quasi-compact-morphism}
if and only if $f$ is quasi-compact in the sense of
Bootstrap, Definition \ref{bootstrap-definition-property-transformation}.
\end{lemma}

\begin{proof}
This is immediate from the definitions and
Lemma \ref{lemma-characterize-quasi-compact-morphism}.
\end{proof}





\section{Quasi-compact and quasi-separated formal algebraic spaces}
\label{section-quasi-compact-quasi-separated}

\noindent
The following result is due to Yasuda, see
\cite[Proposition 3.32]{Yasuda}.

\begin{lemma}
\label{lemma-structure-quasi-compact-quasi-separated}
\begin{reference}
\cite[Proposition 3.32]{Yasuda}
\end{reference}
Let $S$ be a scheme. Let $X$ be a quasi-compact and quasi-separated
formal algebraic space over $S$. Then $X = \colim X_\lambda$
for a system of algebraic spaces $(X_\lambda, f_{\lambda \mu})$
over a directed set $\Lambda$ where each
$f_{\lambda \mu} : X_\lambda \to X_\mu$ is a thickening.
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-characterize-quasi-compact} we may choose an
affine formal algebraic space $Y$ and a representable surjective
\'etale morphism $Y \to X$. Write $Y = \colim Y_\lambda$ as in
Definition \ref{definition-affine-formal-algebraic-space}.

\medskip\noindent
Pick $\lambda \in \Lambda$. Then $Y_\lambda \times_X Y$ is a scheme by
Lemma \ref{lemma-presentation-representable}. The reduction
(Lemma \ref{lemma-reduction-formal-algebraic-space})
of $Y_\lambda \times_X Y$ is equal to the reduction of
$Y_{red} \times_{X_{red}} Y_{red}$ which is quasi-compact as $X$
is quasi-separated and $Y_{red}$ is affine.
Therefore $Y_\lambda \times_X Y$ is a quasi-compact scheme.
Hence there exists a $\mu \geq \lambda$ such that
$\text{pr}_2 : Y_\lambda \times_X Y \to Y$ factors
through $Y_\mu$, see Lemma \ref{lemma-factor-through-thickening}.
Let $Z_\lambda$ be the scheme theoretic image of the morphism
$\text{pr}_2 : Y_\lambda \times_X Y \to Y_\mu$.
This is independent of the choice of $\mu$ and we can and
will think of $Z_\lambda \subset Y$ as the scheme theoretic
image of the morphism $\text{pr}_2 : Y_\lambda \times_X Y \to Y$.
Observe that $Z_\lambda$ is also equal to the scheme theoretic image
of the morphism $\text{pr}_1 : Y \times_X Y_\lambda \to Y$ since
this is isomorphic to the morphism used to define $Z_\lambda$.
We claim that $Z_\lambda \times_X Y = Y \times_X Z_\lambda$ as subfunctors
of $Y \times_X Y$. Namely, since $Y \to X$ is \'etale we see that
$Z_\lambda \times_X Y$ is the scheme theoretic image of the morphism
$$
\text{pr}_{13} = \text{pr}_1 \times \text{id}_Y :
Y \times_X Y_\lambda \times_X Y \longrightarrow Y \times_X Y
$$
by Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-quasi-compact-scheme-theoretic-image}.
By the same token, $Y \times_X Z_\lambda$ is the scheme theoretic image
of the morphism
$$
\text{pr}_{13} = \text{id}_Y \times \text{pr}_2 : 
Y \times_X Y_\lambda \times_X Y \longrightarrow Y \times_X Y
$$
The claim follows. Then
$R_\lambda = Z_\lambda \times_X Y = Y \times_X Z_\lambda$
together with the morphism $R_\lambda \to Z_\lambda \times_S Z_\lambda$
defines an \'etale equivalence relation. In this way we obtain an algebraic
space $X_\lambda = Z_\lambda/R_\lambda$. By construction the diagram
$$
\xymatrix{
Z_\lambda \ar[r] \ar[d] & Y \ar[d] \\
X_\lambda \ar[r] & X
}
$$
is cartesian (because $X$ is the coequalizer of the two projections
$R = Y \times_X Y \to Y$, because $Z_\lambda \subset Y$ is $R$-invariant,
and because $R_\lambda$ is the restriction of $R$ to $Z_\lambda$).
Hence $X_\lambda \to X$ is representable and a closed immersion, see
Spaces, Lemma
\ref{spaces-lemma-morphism-sheaves-with-P-effective-descent-etale}.
On the other hand, since $Y_\lambda \subset Z_\lambda$ we see that
$(X_\lambda)_{red} = X_{red}$, in other words, $X_\lambda \to X$
is a thickening. Finally, we claim that
$$
X = \colim X_\lambda
$$
We have $Y \times_X X_\lambda = Z_\lambda \supset Y_\lambda$. Every
morphism $T \to X$ where $T$ is a scheme over $S$ lifts \'etale locally
to a morphism into $Y$ which lifts \'etale locally into a morphism
into some $Y_\lambda$. Hence $T \to X$ lifts \'etale locally on
$T$ to a morphism into $X_\lambda$. This finishes the proof.
\end{proof}

\begin{remark}
\label{remark-structure-quasi-compact-quasi-separated}
In this remark we translate the statement and proof of
Lemma \ref{lemma-structure-quasi-compact-quasi-separated}
into the language of formal schemes \`a la EGA.
Looking at Remark \ref{remark-ideals-of-definition} we see
that the lemma can be translated as follows
\begin{itemize}
\item[$(*)$] Every quasi-compact and quasi-separated formal
scheme has a fundamental system of ideals of definition.
\end{itemize}
To prove this we first use the induction principle (reformulated for
quasi-compact and quasi-separated formal schemes) of
Cohomology of Schemes, Lemma \ref{coherent-lemma-induction-principle}
to reduce to the following situation:
$\mathfrak X = \mathfrak U \cup \mathfrak V$
with $\mathfrak U$, $\mathfrak V$ open formal subschemes,
with $\mathfrak V$ affine, and the result is true for $\mathfrak U$,
$\mathfrak V$, and $\mathfrak U \cap \mathfrak V$. Pick any ideals
of definition $\mathcal{I} \subset \mathcal{O}_\mathfrak U$
and $\mathcal{J} \subset \mathcal{O}_\mathfrak V$.
By our assumption that we have a fundamental system of ideals
of definition on $\mathfrak U$ and $\mathfrak V$ and because
$\mathfrak U \cap \mathfrak V$ is quasi-compact, we can find
ideals of definition $\mathcal{I}' \subset \mathcal{I}$
and $\mathcal{J}' \subset \mathcal{J}$
such that
$$
\mathcal{I}'|_{\mathfrak U \cap \mathfrak V} \subset
\mathcal{J}|_{\mathfrak U \cap \mathfrak V}
\quad\text{and}\quad
\mathcal{J}'|_{\mathfrak U \cap \mathfrak V} \subset
\mathcal{I}|_{\mathfrak U \cap \mathfrak V}
$$
Let $U \to U' \to \mathfrak U$ and $V \to V' \to \mathfrak V$ be the
closed immersions determined by the ideals of definition
$\mathcal{I}' \subset \mathcal{I} \subset \mathcal{O}_\mathfrak U$
and
$\mathcal{J}' \subset \mathcal{J} \subset \mathcal{O}_\mathfrak V$.
Let $\mathfrak U \cap V$ denote the open subscheme of $V$ whose
underlying topological space is that of $\mathfrak U \cap \mathfrak V$.
By our choice of $\mathcal{I}'$ there is a factorization
$\mathfrak U \cap V \to U'$.
We define similarly $U \cap \mathfrak V$ which factors through $V'$.
Then we consider
$$
Z_U = \text{scheme theoretic image of }
U \amalg (\mathfrak U \cap V) \longrightarrow U'
$$
and
$$
Z_V = \text{scheme theoretic image of }
(U \cap \mathfrak V) \amalg V \longrightarrow V'
$$
Since taking scheme theoretic images of quasi-compact morphisms
commutes with restriction to opens (Morphisms, Lemma
\ref{morphisms-lemma-quasi-compact-scheme-theoretic-image})
we see that $Z_U \cap \mathfrak V = \mathfrak U \cap Z_V$.
Thus $Z_U$ and $Z_V$ glue to a scheme $Z$ which comes equipped
with a morphism $Z \to \mathfrak X$. Analogous to the discussion in
Remark \ref{remark-weak-ideals-of-definition}
we see that $Z$ corresponds to a weak ideal
of definition $\mathcal{I}_Z \subset \mathcal{O}_\mathfrak X$.
Note that $Z_U \subset U'$ and that
$Z_V \subset V'$. Thus the collection of all $\mathcal{I}_Z$
constructed in this manner forms a fundamental system of weak
ideals of definition. Hence a subfamily gives a fundamental system of ideals
of definition, see Remark \ref{remark-ideals-of-definition}.
\end{remark}

\begin{lemma}
\label{lemma-characterize-affine}
Let $S$ be a scheme. Let $X$ be a formal algebraic space over $S$.
Then $X$ is an affine formal algebraic space if and only if
its reduction $X_{red}$ (Lemma \ref{lemma-reduction-formal-algebraic-space})
is affine.
\end{lemma}

\begin{proof}
By Lemmas \ref{lemma-characterize-quasi-separated} and
\ref{lemma-characterize-quasi-compact} and
Definitions \ref{definition-separated} and \ref{definition-quasi-compact}
we see that $X$ is quasi-compact and quasi-separated.
By Yasuda's lemma (Lemma \ref{lemma-structure-quasi-compact-quasi-separated})
we can write $X = \colim X_\lambda$ as a filtered colimit
of thickenings of algebraic spaces. However, each $X_\lambda$
is affine by Limits of Spaces, Lemma
\ref{spaces-limits-lemma-reduction-scheme}
because $(X_\lambda)_{red} = X_{red}$.
Hence $X$ is an affine formal algebraic space by definition.
\end{proof}






\section{Morphisms representable by algebraic spaces}
\label{section-representable}

\noindent
Let $f : X \to Y$ be a morphism of formal algebraic spaces which
is representable by algebraic spaces. For these types of morphisms
we have a lot of theory at our disposal, thanks to the work done
in the chapters on algebraic spaces.

\begin{lemma}
\label{lemma-composition-representable}
The composition of morphisms representable by algebraic spaces is
representable by algebraic spaces. The same holds for representable
(by schemes).
\end{lemma}

\begin{proof}
See Bootstrap, Lemma \ref{bootstrap-lemma-composition-transformation}.
\end{proof}

\begin{lemma}
\label{lemma-base-change-representable}
A base change of a morphism representable by algebraic spaces is
representable by algebraic spaces. The same holds for representable
(by schemes).
\end{lemma}

\begin{proof}
See Bootstrap, Lemma \ref{bootstrap-lemma-base-change-transformation}.
\end{proof}

\begin{lemma}
\label{lemma-permanence-representable}
Let $S$ be a scheme. Let $f : X \to Y$ and $g : Y \to Z$ be morphisms of
formal algebraic spaces over $S$. If $g \circ f : X \to Z$ is representable
by algebraic spaces, then $f : X \to Y$ is representable by algebraic spaces.
\end{lemma}

\begin{proof}
Note that the diagonal of $Y \to Z$ is representable by
Lemma \ref{lemma-diagonal-morphism-formal-algebraic-spaces}.
Thus $X \to Y$ is representable by algebraic spaces by
Bootstrap, Lemma \ref{bootstrap-lemma-representable-by-spaces-permanence}.
\end{proof}

\noindent
The property of being representable by algebraic spaces is local on the
source and the target.

\begin{lemma}
\label{lemma-representable-by-algebraic-spaces-local}
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of formal algebraic
spaces over $S$. The following are equivalent:
\begin{enumerate}
\item the morphism $f$ is representable by algebraic spaces,
\item there exists a commutative diagram
$$
\xymatrix{
U \ar[d] \ar[r] & V \ar[d] \\
X \ar[r] & Y
}
$$
where $U$, $V$ are formal algebraic spaces, the vertical arrows are
representable by algebraic spaces, $U \to X$
is surjective \'etale, and $U \to V$ is representable by algebraic spaces,
\item for any commutative diagram
$$
\xymatrix{
U \ar[d] \ar[r] & V \ar[d] \\
X \ar[r] & Y
}
$$
where $U$, $V$ are formal algebraic spaces and the vertical arrows are
representable by algebraic spaces, the morphism $U \to V$ is
representable by algebraic spaces,
\item there exists a covering $\{Y_j \to Y\}$ as in
Definition \ref{definition-formal-algebraic-space}
and for each $j$ a covering $\{X_{ji} \to Y_j \times_Y X\}$ as in
Definition \ref{definition-formal-algebraic-space} such that
$X_{ji} \to Y_j$ is representable by algebraic spaces for each $j$ and $i$,
\item there exist a covering $\{X_i \to X\}$ as in
Definition \ref{definition-formal-algebraic-space}
and for each $i$ a factorization $X_i \to Y_i \to Y$ where $Y_i$
is an affine formal algebraic space, $Y_i \to Y$ is representable
by algebraic spaces, such that $X_i \to Y_i$ is representable by algebraic
spaces, and
\item add more here.
\end{enumerate}
\end{lemma}

\begin{proof}
It is clear that (1) implies (2) because we can take $U = X$ and $V = Y$.
Conversely, (2) implies (1) by
Bootstrap, Lemma \ref{bootstrap-lemma-representable-by-spaces-cover}
applied to $U \to X \to Y$.

\medskip\noindent
Assume (1) is true and consider a diagram as in (3).
Then $U \to Y$ is representable by algebraic spaces
(as the composition $U \to X \to Y$, see
Bootstrap, Lemma \ref{bootstrap-lemma-composition-transformation})
and factors through $V$. Thus $U \to V$ is representable by
algebraic spaces by Lemma \ref{lemma-permanence-representable}.

\medskip\noindent
It is clear that (3) implies (2). Thus now (1) -- (3) are equivalent.

\medskip\noindent
Observe that the condition in (4) makes sense as the fibre product
$Y_j \times_Y X$ is a formal algebraic space by
Lemma \ref{lemma-fibre-products}.
It is clear that (4) implies (5).

\medskip\noindent
Assume $X_i \to Y_i \to Y$ as in (5). Then we set
$V = \coprod Y_i$ and $U = \coprod X_i$ to see that
(5) implies (2).

\medskip\noindent
Finally, assume (1) -- (3) are true.
Thus we can choose any covering $\{Y_j \to Y\}$ as in
Definition \ref{definition-formal-algebraic-space}
and for each $j$ any covering $\{X_{ji} \to Y_j \times_Y X\}$ as in
Definition \ref{definition-formal-algebraic-space}.
Then $X_{ij} \to Y_j$ is representable by algebraic spaces by (3)
and we see that (4) is true. This concludes the proof.
\end{proof}

\begin{lemma}
\label{lemma-algebraic-space-over-affine-formal}
Let $S$ be a scheme. Let $Y$ be an affine formal algebraic space over $S$.
Let $f : X \to Y$ be a map of sheaves on $(\Sch/S)_{fppf}$ which is
representable by algebraic spaces. Then $X$ is a formal
algebraic space.
\end{lemma}

\begin{proof}
Write $Y = \colim Y_\lambda$ as in
Definition \ref{definition-affine-formal-algebraic-space}.
For each $\lambda$ the fibre product
$X \times_Y Y_\lambda$ is an algebraic space.
Hence $X = \colim X \times_Y Y_\lambda$ is a formal
algebraic space by Lemma \ref{lemma-colimit-is-formal}.
\end{proof}

\begin{lemma}
\label{lemma-representable-by-algebraic-spaces}
Let $S$ be a scheme. Let $Y$ be a formal algebraic space over $S$.
Let $f : X \to Y$ be a map of sheaves on $(\Sch/S)_{fppf}$ which is
representable by algebraic spaces. Then $X$ is a formal
algebraic space.
\end{lemma}

\begin{proof}
Let $\{Y_i \to Y\}$ be as in
Definition \ref{definition-formal-algebraic-space}.
Then $X \times_Y Y_i \to X$ is a family of morphisms
representable by algebraic spaces, \'etale, and jointly
surjective. Thus it suffices to show that
$X \times_Y Y_i$ is a formal algebraic space, see
Lemma \ref{lemma-etale-covering-by-formal-algebraic-spaces}.
This follows from Lemma \ref{lemma-algebraic-space-over-affine-formal}.
\end{proof}

\begin{lemma}
\label{lemma-affine-representable-by-algebraic-spaces}
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of
affine formal algebraic spaces which is representable by
algebraic spaces. Then $f$ is representable (by schemes) and affine.
\end{lemma}

\begin{proof}
The first assertion follows from Lemma \ref{lemma-presentation-representable}.
Write $Y = \colim Y_\mu$ and $X = \colim X_\lambda$ as in
Definition \ref{definition-affine-formal-algebraic-space}.
For the second, let $T \to Y$ be a morphism where $T$ is a scheme
over $S$. We have to show that $X \times_Y T \to T$ is affine, see
Spaces, Definition \ref{spaces-definition-relative-representable-property}.
To do this we may assume that $T$ is affine and we have to prove
that $X \times_Y T$ is affine. In this case $T \to Y$ factors
through $Y_\mu \to Y$ for some $\mu$, see
Lemma \ref{lemma-factor-through-thickening}.
Since $f$ is quasi-compact we see that $X \times_Y T$ is
quasi-compact (Lemma \ref{lemma-characterize-quasi-compact-morphism}).
Hence $X \times_Y T \to X$ factors through $X_\lambda$ for some
$\lambda$. Similarly $X_\lambda \to Y$ factors through $Y_\mu$
after increasing $\mu$. Then
$X \times_Y T = X_\lambda \times_{Y_\mu} T$.
We conclude as fibre products of affine schemes are affine.
\end{proof}

\begin{lemma}
\label{lemma-property-goes-up-affine-morphism}
Let $S$ be a scheme. Let $Y$ be an affine formal algebraic space.
Let $f : X \to Y$ be a map of sheaves on $(\Sch/S)_{fppf}$ which
is representable and affine. Then
\begin{enumerate}
\item $X$ is an affine formal algebraic space.
\item if $Y$ is countably indexed, then $X$ is countably indexed.
\item if $Y$ is adic*, then $X$ is adic*,
\item if $Y$ is Noetherian and $f$ is (locally) of finite type, then
$X$ is Noetherian.
\end{enumerate}
\end{lemma}

\begin{proof}
Proof of (1). Write $Y = \colim_{\lambda \in \Lambda} Y_\lambda$ as in
Definition \ref{definition-affine-formal-algebraic-space}.
Since $f$ is representable and affine, the fibre products
$X_\lambda = Y_\lambda \times_Y X$ are affine. And
$X = \colim Y_\lambda \times_Y X$.
Thus $X$ is an affine formal algebraic space.

\medskip\noindent
Proof of (2). If $Y$ is countably indexed, then in the argument above
we may assume $\Lambda$ is countable.
Then we immediately see that $X$ is countably indexed too.

\medskip\noindent
Proof of (3). Assume $Y$ is adic*. Then $Y = \text{Spf}(B)$ for some adic
topological ring $B$ which has a finitely generated
ideal $J$ such that $\{J^n\}$ is a fundamental system of open ideals.
Of course, then $Y = \colim \Spec(B/J^n)$.
The schemes $X \times_Y \Spec(B/J^n)$ are affine
and we can write $X \times_Y \Spec(B/J^n) = \Spec(A_n)$.
Then $X = \colim \Spec(A_n)$. The $B$-algebra maps $A_{n + 1} \to A_n$
are surjective and induce isomorphisms $A_{n + 1}/J^nA_{n + 1} \to A_n$.
By Algebra, Lemma \ref{algebra-lemma-limit-complete} the ring
$A = \lim A_n$ is $J$-adically complete and $A/J^n A = A_n$.
Hence $X = \text{Spf}(A^\wedge)$ is adic*.

\medskip\noindent
Proof of (4). Combining (3) with Lemma \ref{lemma-implications-between-types}
we see that $X$ is adic*. Thus we can use the criterion of
Lemma \ref{lemma-characterize-noetherian-affine}.
First, it tells us the affine schemes $Y_\lambda$ are Noetherian.
Then $X_\lambda \to Y_\lambda$ is of finite type, hence $X_\lambda$
is Noetherian too (Morphisms, Lemma
\ref{morphisms-lemma-finite-type-noetherian}).
Then the criterion tells us $X$ is Noetherian and the proof is
complete.
\end{proof}

\begin{lemma}
\label{lemma-property-goes-up-affine}
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of affine formal
algebraic spaces which is representable by algebraic spaces. Then
\begin{enumerate}
\item if $Y$ is countably indexed, then $X$ is countably indexed.
\item if $Y$ is adic*, then $X$ is adic*,
\item if $Y$ is Noetherian and $f$ is (locally) of finite type, then
$X$ is Noetherian.
\end{enumerate}
\end{lemma}

\begin{proof}
Combine Lemmas \ref{lemma-affine-representable-by-algebraic-spaces} and
\ref{lemma-property-goes-up-affine-morphism}.
\end{proof}

\begin{lemma}
\label{lemma-representable-affine}
Let $S$ be a scheme. Let $\varphi : A \to B$ be a continuous map of
weakly admissible topological rings over $S$. The following
are equivalent
\begin{enumerate}
\item $\text{Spf}(\varphi) : \text{Spf}(B) \to \text{Spf}(A)$
is representable by algebraic spaces,
\item $\text{Spf}(\varphi) : \text{Spf}(B) \to \text{Spf}(A)$
is representable (by schemes),
\item $\varphi$ is taut, see Definition \ref{definition-taut}.
\end{enumerate}
\end{lemma}

\begin{proof}
Parts (1) and (2) are equivalent by
Lemma \ref{lemma-affine-representable-by-algebraic-spaces}.

\medskip\noindent
Assume the equivalent conditions (1) and (2) hold.
If $I \subset A$ is a weak ideal of definition, then
$\Spec(A/I) \to \text{Spf}(A)$ is representable and a thickening
(this is clear from the construction of the formal spectrum
but it also follows from
Lemma \ref{lemma-mcquillan-affine-formal-algebraic-space}).
Then $\Spec(A/I) \times_{\text{Spf}(A)} \text{Spf}(B) \to \text{Spf}(B)$
is representable and a thickening as a base change.
Hence by
Lemma \ref{lemma-mcquillan-affine-formal-algebraic-space}
there is a weak ideal of definition $J(I) \subset B$ such that
$\Spec(A/I) \times_{\text{Spf}(A)} \text{Spf}(B) = \Spec(B/J(I))$
as subfunctors of $\text{Spf}(B)$. We obtain a cartesian diagram
$$
\xymatrix{
\Spec(B/J(I)) \ar[d] \ar[r] & \Spec(A/I) \ar[d] \\
\text{Spf}(B) \ar[r] & \text{Spf}(A)
}
$$
By Lemma \ref{lemma-fibre-product-affines-over-separated}
we see that $B/J(I) = B \widehat{\otimes}_A A/I$.
It follows that $J(I)$ is the closure of the ideal $\varphi(I)B$, see
Lemma \ref{lemma-closure-image-ideal}.
Since $\text{Spf}(A) = \colim \Spec(A/I)$ with $I$ as above,
we find that $\text{Spf}(B) = \colim \Spec(B/J(I))$.
Thus the ideals $J(I)$ form a fundamental system of weak
ideals of definition (see
Lemma \ref{lemma-mcquillan-affine-formal-algebraic-space}).
Hence (3) holds.

\medskip\noindent
Assume (3) holds. We are essentially just going to reverse the
arguments given in the previous paragraph.
Let $I \subset A$ be a weak ideal of definition.
By Lemma \ref{lemma-fibre-product-affines-over-separated}
we get a cartesian diagram
$$
\xymatrix{
\text{Spf}(B \widehat{\otimes}_A A/I) \ar[d] \ar[r] & \Spec(A/I) \ar[d] \\
\text{Spf}(B) \ar[r] & \text{Spf}(A)
}
$$
If $J(I)$ is the closure of $IB$, then $J(I)$ is open in $B$
by tautness of $\varphi$. Hence if $J$ is open in $B$ and $J \subset J(B)$,
then $B/J \otimes_A A/I = B/(IB + J) = B/J(I)$ because
$J(I) = \bigcap_{J \subset B\text{ open}} (IB + J)$ by Lemma \ref{lemma-closed}.
Hence the limit defining the completed tensor product collapses to give
$B \widehat{\otimes}_A A/I = B/J(I)$.
Thus $\text{Spf}(B \widehat{\otimes}_A A/I) = \Spec(B/J(I))$.
This proves that $\text{Spf}(B) \times_{\text{Spf}(A)} \Spec(A/I)$
is representable for every weak ideal of definition $I \subset A$.
Since every morphism $T \to \text{Spf}(A)$ with $T$ quasi-compact
factors through $\Spec(A/I)$ for some weak ideal of definition $I$
(Lemma \ref{lemma-factor-through-thickening})
we conclude that $\text{Spf}(\varphi)$ is representable, i.e.,
(2) holds. This finishes the proof.
\end{proof}

\begin{example}
\label{example-representable-morphism-from-completion}
Let $B$ be a weakly admissible topological ring. Let $B \to A$ be
a ring map (no topology). Then we can consider
$$
A^\wedge = \lim A/JA
$$
where the limit is over all weak ideals of definition $J$ of $B$.
Then $A^\wedge$ (endowed with the limit topology) is a
complete linearly topologized ring. The (open) kernel $I$
of the surjection $A^\wedge \to A/JA$ is the closure of $JA^\wedge$, see
Lemma \ref{lemma-closed}. By
Lemma \ref{lemma-topologically-nilpotent}
we see that $I$ consists of topologically nilpotent elements.
Thus $I$ is a weak ideal of definition of $A^\wedge$ and we conclude
$A^\wedge$ is a weakly admissible topological ring. Thus
$\varphi : B \to A^\wedge$ is taut map of weakly admissible
topological rings and
$$
\text{Spf}(A^\wedge) \longrightarrow \text{Spf}(B)
$$
is a special case of the phenomenon studied in
Lemma \ref{lemma-representable-affine}.
\end{example}

\begin{remark}[Warning]
\label{remark-warning}
Lemma \ref{lemma-representable-affine} is sharp in the following
two senses:
\begin{enumerate}
\item If $A$ and $B$ are weakly admissible rings and $\varphi : A \to B$
is a continuous map, then
$\text{Spf}(\varphi) : \text{Spf}(B) \to \text{Spf}(A)$ is in general
not representable.
\item If $f : Y \to X$ is a representable morphism of affine
formal algebraic spaces and $X = \text{Spf}(A)$ is McQuillan,
then it does not follow that $Y$ is McQuillan.
\end{enumerate}
An example for (1) is to take $A = k$ a field (with discrete topology)
and $B = k[[t]]$ with the $t$-adic topology.
An example for (2) is given in
Examples, Section \ref{examples-section-affine-formal-algebraic-space}.
\end{remark}

\noindent
The warning above notwithstanding, we do have the following result.

\begin{lemma}
\label{lemma-etale}
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of affine formal
algebraic spaces over $S$. Assume
\begin{enumerate}
\item $Y$ is McQuillan, i.e., equal to $\text{Spf}(B)$ for some
weakly admissible topological $S$-algebra $B$, and
\item $f : X \to Y$ is representable by algebraic spaces and \'etale.
\end{enumerate}
Then there exists an \'etale ring map $B \to A$ such that
$$
X = \text{Spf}(A^\wedge)
\quad\text{where}\quad
A^\wedge = \lim A/JA
$$
with $J \subset B$ running over the weak ideals of definition of $B$.
In particular, $X$ is McQuillan.
\end{lemma}

\begin{proof}
Choose a weak ideal of definition $J_0 \subset B$. Set
$Y_0 = \Spec(B/J_0)$ and $X_0 = Y_0 \times_Y X$. Then $X_0 \to Y_0$
is an \'etale morphism of affine schemes (see
Lemma \ref{lemma-affine-representable-by-algebraic-spaces}).
Say $X_0 = \Spec(A_0)$. By Algebra, Lemma \ref{algebra-lemma-lift-etale}
we can find an \'etale algebra map $B \to A$ such that
$A_0 \cong A/J_0A$. Consider an ideal of definition $J \subset J_0$.
As above we may write $\Spec(B/J) \times_Y X = \Spec(\bar A)$
for some \'etale ring map $B/J \to \bar A$. Then both
$B/J \to \bar A$ and $B/J \to A/JA$ are \'etale ring maps
lifting the \'etale ring map $B/J_0 \to A_0$. By
More on Algebra, Lemma \ref{more-algebra-lemma-locally-nilpotent-henselian}
there is a unique $B/J$-algebra isomorphism
$\varphi_J : A/JA \to \bar A$ lifting the identification modulo $J_0$.
Since the maps $\varphi_J$ are unique they are compatible for varying $J$.
Thus
$$
X = \colim \Spec(B/J) \times_Y X = \colim \Spec(A/JA)
$$
and we see that the lemma holds.
\end{proof}

\begin{lemma}
\label{lemma-etale-surjective}
With notation and assumptions as in Lemma \ref{lemma-etale}.
The following are equivalent
\begin{enumerate}
\item $f : X \to Y$ is surjective,
\item $B \to A$ is faithfully flat,
\item for every weak ideal of definition $J \subset B$
the ring map $B/J \to A/JA$ is faithfully flat, and
\item for some weak ideal of definition $J \subset B$
the ring map $B/J \to A/JA$ is faithfully flat.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $J \subset B$ be a weak ideal of definition. As every element of $J$
is topologically nilpotent, we see that every element of $1 + J$ is
a unit. It follows that $J$ is contained in the Jacobson radical of $B$
(Algebra, Lemma \ref{algebra-lemma-contained-in-radical}).
Hence a flat ring map $B \to A$ is faithfully flat if and only if
$B/J \to A/JA$ is faithfully flat
(Algebra, Lemma \ref{algebra-lemma-ff-rings}).
In this way we see that (2) -- (4) are equivalent.
If (1) holds, then for every weak ideal of definition $J \subset B$
the morphism
$\Spec(A/JA) = \Spec(B/J) \times_Y X \to \Spec(B/J)$ is surjective
which implies (3). Conversely, assume (3).
A morphism $T \to Y$ with $T$ quasi-compact
factors through $\Spec(B/J)$ for some ideal of definition $J$ of $B$
(Lemma \ref{lemma-factor-through-thickening}).
Hence $X \times_Y T = \Spec(A/JA) \times_{\Spec(B/J)} T \to T$
is surjective as a base change of the surjective morphism
$\Spec(A/JA) \to \Spec(B/J)$. Thus (1) holds.
\end{proof}





\section{Types of formal algebraic spaces}
\label{section-types}

\noindent
In this section we define Noetherian, adic*, and
countably indexed formal algebraic spaces. The types
adic, classical, and McQuillan are missing as we do not
know how to prove the analogue of the following lemmas
for those cases.

\begin{lemma}
\label{lemma-iff-countably-indexed}
Let $S$ be a scheme. Let $X \to Y$ be a morphism of affine
formal algebraic spaces which is representable by algebraic spaces,
surjective, and flat. Then $X$ is countably indexed if and only
if $Y$ is countably indexed.
\end{lemma}

\begin{proof}
Assume $X$ is countably indexed. We write $X = \colim X_n$ as in
Lemma \ref{lemma-countable-affine-formal-algebraic-space}.
Write $Y = \colim Y_\lambda$ as in
Definition \ref{definition-affine-formal-algebraic-space}.
For every $n$ we can pick a $\lambda_n$ such that
$X_n \to Y$ factors through $Y_{\lambda_n}$, see
Lemma \ref{lemma-factor-through-thickening}.
On the other hand, for every $\lambda$ the scheme
$Y_\lambda \times_Y X$ is affine
(Lemma \ref{lemma-affine-representable-by-algebraic-spaces})
and hence $Y_\lambda \times_Y X \to X$ factors through
$X_n$ for some $n$ (Lemma \ref{lemma-factor-through-thickening}).
Picture
$$
\xymatrix{
Y_\lambda \times_Y X \ar[r] \ar[d] & X_n \ar[r] \ar[d] & X \ar[d] \\
Y_\lambda \ar@{..>}[r] \ar@/_1pc/[rr] & Y_{\lambda_n} \ar[r] & Y
}
$$
If we can show the dotted arrow exists, then we conclude that
$Y = \colim Y_{\lambda_n}$ and $Y$ is countably indexed. To do this we
pick a $\mu$ with $\mu \geq \lambda$ and $\mu \geq \lambda_n$.
Thus both $Y_\lambda \to Y$ and $Y_{\lambda_n} \to Y$ factor
through $Y_\mu \to Y$.
Say $Y_\mu = \Spec(B_\mu)$, the closed subscheme $Y_\lambda$ corresponds to
$J \subset B_\mu$, and the closed subscheme $Y_{\lambda_n}$ corresponds to
$J' \subset B_\mu$. We are trying to show that $J' \subset J$.
By the diagram above we know $J'A_\mu \subset JA_\mu$
where $Y_\mu \times_Y X = \Spec(A_\mu)$.
Since $X \to Y$ is surjective and flat the morphism
$Y_\lambda \times_Y X \to Y_\lambda$ is a faithfully flat morphism
of affine schemes, hence $B_\mu \to A_\mu$ is
faithfully flat. Thus $J' \subset J$ as desired.

\medskip\noindent
Assume $Y$ is countably indexed. Then $X$ is countably indexed
by Lemma \ref{lemma-property-goes-up-affine}.
\end{proof}

\begin{lemma}
\label{lemma-iff-adic-star}
Let $S$ be a scheme. Let $X \to Y$ be a morphism of affine
formal algebraic spaces which is representable by algebraic spaces,
surjective, and flat. Then $X$ is adic* if and only if $Y$ is adic*.
\end{lemma}

\begin{proof}
Assume $Y$ is adic*. Then $X$ is adic* by
Lemma \ref{lemma-property-goes-up-affine}.

\medskip\noindent
Assume $X$ is adic*. Write $X = \text{Spf}(A)$ for some adic ring $A$
which has a finitely generated ideal $I$ such that $\{I^n\}$ is a
fundamental system of open ideals. By Lemmas \ref{lemma-iff-countably-indexed}
we see that $Y$ is countably indexed. Thus, by
Lemma \ref{lemma-countably-indexed},
we can write $Y = \text{Spf}(B)$ where $B$ is a weakly admissible
topological ring with a countable fundamental system $\{J_m\}$ of
weak ideals of definition. By Lemma \ref{lemma-morphism-between-formal-spectra}
the morphism $X \to Y$ corresponds to a continuous ring map
$B \to A$ which is taut by Lemma \ref{lemma-representable-affine}.
Our first goal is to reduce to the case where $J_m A$ is equal to $I^m$.

\medskip\noindent
Set $Y_m = \Spec(B/J_m)$ so that
$Y = \colim Y_m$. The scheme $Y_m \times_Y X$ is affine
(Lemma \ref{lemma-affine-representable-by-algebraic-spaces})
and we have $X = \colim Y_m \times_Y X$. Say $Y_m \times_Y X = \Spec(A_m)$
so that $B/J_m \to A_m$ is a faithfully flat ring map.
It follows from Lemma \ref{lemma-fibre-product-affines-over-separated}
that $\Ker(A \to A_m)$ is the closure of $J_mA$.

\medskip\noindent
Choose $n \geq 1$. There exists an $m$ such that $\Spec(A/I^n) \to Y$
factors through $Y_m$. In terms of ideals
\begin{equation}
\label{equation-first}
\forall n\ \exists m,\ J_m A \subset I^n.
\end{equation}
Choose $m \geq 1$. We can find an $n$ such that the morphism
$\Spec(A_m) \to X$ factors through $\Spec(A/I^n)$. In terms of ideals
\begin{equation}
\label{equation-second}
\forall m\ \exists n,\ I^n \subset \Ker(A \to A_m).
\end{equation}
Given an $m$ we can pick an $n = n(m)$ such that
$I^n \subset \Ker(A \to A_m)$ by (\ref{equation-second}).
Choose generators $f_1, \ldots, f_r$ of $I$.
For any $E = (e_1, \ldots, e_r)$ with $|E| = \sum e_i = n$ write
$$
f_1^{e_1} \ldots f_r^{e_r} =
\sum g_{E, j} a_{E, j} + \delta_E
$$
with $g_{E, j} \in J_m$, $a_{E, j} \in A$, and $\delta_E \in I^{n + 1}$
(possible by the above). Let $J = (g_{E, j}) \subset J_m \subset B$.
Then we see that
$$
I^n \subset J A + I^{n + 1}
$$
As $I$ is contained in the Jacobson radical of $A$ and
$I^n$ is finitely generated
we see that $I^n \subset JA$ by Nakayama's lemma. More precisely
apply part (2) of Algebra, Lemma \ref{algebra-lemma-NAK}
to see that $M = (I^n + JA)/JA$ is zero.

\medskip\noindent
We first apply what we just proved as follows: since for every $m$ there
is an $n(m)$ with $I^{n(m)} \subset J_mA$ we see that
$J_mA$ is open in $A$, hence closed, hence $\Ker(A \to A_m) = J_mA$,
in other words, $A_m = A/J_mA$. This holds for every $m$.

\medskip\noindent
Next, we pick $m$ with $J_mA \subset I$ (\ref{equation-first}).
Then choose $n = n(m)$ and finitely generated ideal $J \subset J_m$
with $I^n \subset JA \subset I$ as above.
For every $k \geq 1$ we define $\mathfrak b_k = \Ker(B \to A/J^kA)$.
Observe that $\mathfrak b_k \supset \mathfrak b_{k + 1}$.
For every $k$ there exists
an $m'$ with $J_{m'} \subset \mathfrak b_k$ as we have
$I^{nk} \subset J^kA$ and we can apply (\ref{equation-first}).
On the other hand, for every $m'$ there exists a $k$ such that
$I^k \subset J_{m'}A$ because $J_{m'}A$ is open. Then
$\mathfrak b_k$ maps to zero in $A/J_{m'}A$ which is faithfully
flat over $B/J_{m'}$. Hence $\mathfrak b_k \subset J_{m'}$.
In other words, we see that the topology on $B$ is defined by the
sequence of ideals $\mathfrak b_k$. Note that $J^k \subset \mathfrak b_k$
which implies that $\mathfrak b_k A = J^kA$.
In other words, we have reduced the problem to the
situation discussed in the following paragraph.

\medskip\noindent
We are given a ring map $B \to A$ where
\begin{enumerate}
\item $B$ is a weakly admissible topological ring with a fundamental system
$J_1 \supset J_2 \supset J_3 \supset \ldots$ of ideals of definition,
\item $A$ is a ring complete with respect to a finitely generated
ideal $I$,
\item we have $J_k A = I^k$ for all $k$, and
\item $B/J_k \to A/I^k$ is faithfully flat.
\end{enumerate}
We want to deduce that $B$ is adic*.
Pick $g_1, \ldots, g_r \in J_1$
whose images in $A/I^2$ generate $I/I^2$; this is possible because
$J_1A/J_2A = I/I^2$. Then for all $k \geq 1$ we see that the elements
$g^E = g_1^{e_1} \ldots g_r^{e_r}$ with $|E| = k$ are in $J_k$
because $B/J_k \to A/I^k$ is faithfully flat and $J_1A = I$.
Also we have $J_1 J_k \subset J_{k + 1}$ by similar reasoning.
The classes of $g^E$ with $|E| = k$ in $J_k/J_{k + 1}$ map to
generators of $I^k/I^{k + 1}$ because the images of $g_1, \ldots, g_r$
generate $I/I^2$. Since $B/J_{k + 1} \to A/I^{k + 1}$
is flat we see that
$$
J_k/J_{k + 1} \otimes_{B/J_1} A/I =
J_k/J_{k + 1} \otimes_{B/J_{k + 1}} A/I^{k + 1} \to I^k/I^{k + 1}
$$
is an isomorphism (see More on Morphisms, Lemma
\ref{more-morphisms-lemma-deform}). Since $B/J_1 \to A/I$ is
faithfully flat, we conclude that the classes of the elements
$g^E$, $|E| = k$ generate $J_k/J_{k + 1}$. We claim that
$J_k = (g^E, |E| = k)$. Namely, suppose that $x_k \in J_k$.
By the above we can write
$$
x_k = \sum\nolimits_{|E| = k} b_{E, 0} g^E + x_{k + 1}
$$
with $x_{k + 1} \in J_{k + 1}$ and some $b_{E, 0} \in B$. Now we can write
$x_{k + 1}$ as follows
$$
x_{k + 1} =
\sum\nolimits_{|E| = k}
\left(\sum\nolimits_{|E'| = 1} b_{E, E'}g^{E'}\right) g^E + x_{k + 2}
$$
because every multi-index of degree $k + 1$ is a sum of a multi-index
of degree $k$ and a multi-index of degree $1$. Continuing in this
manner we can find $b_{E, E'} \in B$ such that for every $l > 1$
we have
$$
x_k = \sum\nolimits_{|E| = k}
\left(\sum\nolimits_{0 \leq |E'| < l} b_{E, E'} g^{E'}\right) g^E + x_{k + l}
$$
with some $x_{k + l} \in J_{k + l}$. Then we can finally define
$$
b_E = \sum\nolimits_{E'} b_{E, E'} g^{E'}
$$
as an element in $B$ and we see that $x_k = \sum b_E g^E$ as desired.
This finishes the proof as now $J_1$ is finitely generated and $J_k = J_1^k$
for all $k \geq 1$.
\end{proof}

\begin{lemma}
\label{lemma-iff-noetherian}
Let $S$ be a scheme. Let $X \to Y$ be a morphism of affine
formal algebraic spaces which is representable by algebraic spaces,
surjective, flat, and (locally) of finite type. Then $X$ is Noetherian
if and only if $Y$ is Noetherian.
\end{lemma}

\begin{proof}
Observe that a Noetherian affine formal algebraic space is adic*, see
Lemma \ref{lemma-implications-between-types}. Thus by
Lemma \ref{lemma-iff-adic-star} we may assume that both $X$ and $Y$
are adic*. We will use the criterion of
Lemma \ref{lemma-characterize-noetherian-affine}
to see that the lemma holds. Namely, write $Y = \colim Y_n$
as in Lemma \ref{lemma-countable-affine-formal-algebraic-space}.
For each $n$ set $X_n = Y_n \times_Y X$. Then $X_n$ is an
affine scheme (Lemma \ref{lemma-affine-representable-by-algebraic-spaces})
and $X = \colim X_n$. Each of the morphisms $X_n \to Y_n$ is
faithfully flat and of finite type. Thus the lemma follows from the
fact that in this situation $X_n$ is Noetherian if and only if $Y_n$
is Noetherian, see
Algebra, Lemma \ref{algebra-lemma-descent-Noetherian} (to go down)
and
Algebra, Lemma \ref{algebra-lemma-Noetherian-permanence} (to go up).
\end{proof}

\begin{lemma}
\label{lemma-type-local}
Let $S$ be a scheme. Let $P \in \{countably\ indexed, adic*, Noetherian\}$.
Let $X$ be a formal algebraic space over $S$.
The following are equivalent
\begin{enumerate}
\item if $Y$ is an affine formal algebraic space and
$f : Y \to X$ is representable by algebraic spaces and \'etale,
then $Y$ has property $P$,
\item for some $\{X_i \to X\}_{i \in I}$ as in
Definition \ref{definition-formal-algebraic-space}
each $X_i$ has property $P$.
\end{enumerate}
\end{lemma}

\begin{proof}
It is clear that (1) implies (2). Assume (2) and let
$Y \to X$ be as in (1). Since the fibre products $X_i \times_X Y$
are formal algebraic spaces (Lemma \ref{lemma-fibre-products-general})
we can pick coverings $\{X_{ij} \to X_i \times_X Y\}$ as in
Definition \ref{definition-formal-algebraic-space}.
Since $Y$ is quasi-compact, there exist
$(i_1, j_1), \ldots, (i_n, j_n)$ such that
$$
X_{i_1 j_1} \amalg \ldots \amalg X_{i_n j_n} \longrightarrow Y
$$
is surjective and \'etale. Then $X_{i_kj_k} \to X_{i_k}$ is representable
by algebraic spaces and \'etale hence $X_{i_kj_k}$ has property $P$ by
Lemma \ref{lemma-property-goes-up-affine}.
Then $X_{i_1 j_1} \amalg \ldots \amalg X_{i_n j_n}$ is an
affine formal algebraic space with property $P$ (small detail
omitted on finite disjoint unions of affine formal algebraic spaces).
Hence we conclude by applying one of
Lemmas \ref{lemma-iff-countably-indexed},
\ref{lemma-iff-adic-star}, and
\ref{lemma-iff-noetherian}.
\end{proof}

\noindent
The previous lemma clears the way for the following definition.

\begin{definition}
\label{definition-types-formal-algebraic-spaces}
Let $S$ be a scheme. Let $X$ be a formal algebraic space over $S$.
We say $X$ is {\it locally countably indexed},
{\it locally adic*}, or {\it locally Noetherian}
if the equivalent conditions of Lemma \ref{lemma-type-local}
hold for the corresponding property.
\end{definition}

\noindent
The formal completion of a locally Noetherian algebraic space
along a closed subset is a locally Noetherian formal algebraic space.

\begin{lemma}
\label{lemma-formal-completion-types}
Let $S$ be a scheme. Let $X$ be an algebraic space over $S$.
Let $T \subset |X|$ be a closed subset. Let $X_{/T}$ be the
formal completion of $X$ along $T$.
\begin{enumerate}
\item If $X \setminus T \to X$ is quasi-compact,
then $X_{/T}$ is locally adic*.
\item If $X$ is locally Noetherian, then $X_{/T}$ is locally
Noetherian.
\end{enumerate}
\end{lemma}

\begin{proof}
Choose a surjective \'etale morphism $U \to X$ with $U = \coprod U_i$
a disjoint union of affine schemes, see Properties of Spaces, Lemma
\ref{spaces-properties-lemma-cover-by-union-affines}.
Let $T_i \subset U_i$ be the inverse image of $T$.
We have $X_{/T} \times_X U_i = (U_i)_{/T_i}$ (small detail omitted).
Hence $\{(U_i)_{/T_i} \to X_{/T}\}$ is a covering as in
Definition \ref{definition-formal-algebraic-space}.
Moreover, if $X \setminus T \to X$ is quasi-compact, so is
$U_i \setminus T_i \to U_i$ and if $X$ is locally Noetherian, so is
$U_i$. Thus it suffices to prove the lemma in case $X$ is affine.

\medskip\noindent
Assume $X = \Spec(A)$ is affine and $X \setminus T \to X$ is quasi-compact.
Then there exists a finitely generated ideal
$I = (f_1, \ldots, f_r) \subset A$ cutting out $T$
(Algebra, Lemma \ref{algebra-lemma-qc-open}).
If $Z = \Spec(B)$ is an affine scheme and $g : Z \to X$ is
a morphism with $g(Z) \subset T$ (set theoretically), then
$g^\sharp(f_i)$ is nilpotent in $B$ for each $i$. Thus
$I^n$ maps to zero in $B$ for some $n$. Hence we see that
$X_{/T} = \colim \Spec(A/I^n)$ and $X$ is adic*.

\medskip\noindent
Assume $X = \Spec(A)$ is affine with $A$ Noetherian. By the above
we see that $X_{/T} = \text{Spf}(A^\wedge)$ where $A^\wedge$
is the $I$-adic completion of $A$ with respect to some ideal
$I \subset A$. Then $X_{/T}$ is Noetherian because
$A^\wedge$ is so, see
Algebra, Lemma \ref{algebra-lemma-completion-Noetherian-Noetherian}.
\end{proof}

\begin{remark}[Warning]
\label{remark-warning-completion}
Suppose $X = \Spec(A)$ and $T \subset X$ is the zero locus of a
finitely generated ideal $I \subset A$. Let $J = \sqrt{I}$ be
the radical of $I$. Then from the definitions we see that
$X_{/T} = \text{Spf}(A^\wedge)$ where $A^\wedge = \lim A/I^n$ is
the $I$-adic completion of $A$. On the other hand, the map
$A^\wedge \to \lim A/J^n$ from the $I$-adic completion to
the $J$-adic completion can fail to be a ring isomorphisms.
As an example let
$$
A = \bigcup\nolimits_{n \geq 1} \mathbf{C}[t^{1/n}]
$$
and $I = (t)$. Then $J = \mathfrak m$ is the maximal ideal
of the valuation ring $A$ and $J^2 = J$. Thus the $J$-adic completion
of $A$ is $\mathbf{C}$ whereas the $I$-adic completion
is the valuation ring described in Example \ref{example-david-hansen}
(but in particular it is easy to see that $A \subset A^\wedge$).
\end{remark}








\section{Morphisms and continuous ring maps}
\label{section-morphisms-rings}

\noindent
In this section we denote $\textit{WAdm}$ the category of
weakly admissible topological rings and continuous ring homomorphisms.
We define full subcategories
$$
\textit{WAdm} \supset \textit{WAdm}^{count} \supset
\textit{WAdm}^{adic*} \supset \textit{WAdm}^{Noeth}
$$
whose objects are
\begin{enumerate}
\item $\textit{WAdm}^{count}$: those weakly admissible topological rings
$A$ which have a countable fundamental system of neighbourhoods of $0$,
\item $\textit{WAdm}^{adic*}$: the adic topological rings which have
a finitely generated ideal of definition, and
\item $\textit{WAdm}^{Noeth}$: the adic topological rings which
are Noetherian.
\end{enumerate}
Clearly, the formal spectra of these types of rings are the basic
building blocks of locally countably indexed, locally adic*, and
locally Noetherian formal algebraic spaces.

\medskip\noindent
We briefly review the relationship between morphisms of
countably indexed, affine formal algebraic spaces and
morphisms of $\textit{WAdm}^{count}$.
Let $S$ be a scheme. Let $X$ and $Y$ be countably indexed,
affine formal algebraic spaces. Write $X = \text{Spf}(A)$
and $Y = \text{Spf}(B)$ topological $S$-algebras
$A$ and $B$ in $\textit{WAdm}^{count}$, see
Lemma \ref{lemma-countably-indexed}.
By Lemma \ref{lemma-morphism-between-formal-spectra}
there is a 1-to-1 correspondence between morphisms
$f : X \to Y$ and continuous maps
$$
\varphi : B \longrightarrow A
$$
of topological $S$-algebras. The relationship is given by
$f \mapsto f^\sharp$ and $\varphi \mapsto \text{Spf}(\varphi)$.

\medskip\noindent
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of
locally countably indexed formal algebraic spaces. Consider a
commutative diagram
$$
\xymatrix{
U \ar[d] \ar[r] & V \ar[d] \\
X \ar[r] & Y
}
$$
with $U$ and $V$ affine formal algebraic spaces and $U \to X$ and $V \to Y$
representable by algebraic spaces and \'etale. By
Definition \ref{definition-types-formal-algebraic-spaces} (and hence via
Lemma \ref{lemma-type-local}) we see that $U$ and $V$ are countably indexed
affine formal algebraic spaces. By the discussion in the previous
paragraph we see that $U \to V$ is isomorphic to $\text{Spf}(\varphi)$
for some continuous map
$$
\varphi : B \longrightarrow A
$$
of topological $S$-algebras in $\textit{WAdm}^{count}$.

\begin{lemma}
\label{lemma-completion-in-sub}
Let $A \in \Ob(\textit{WAdm})$. Let $A \to A'$ be a ring
map (no topology). Let $(A')^\wedge = \lim_{I \subset A\text{ w.i.d}} A'/IA'$
be the object of $\textit{WAdm}$ constructed in
Example \ref{example-representable-morphism-from-completion}.
\begin{enumerate}
\item If $A$ is in $\textit{WAdm}^{count}$, so is $(A')^\wedge$.
\item If $A$ is in $\textit{WAdm}^{adic*}$, so is $(A')^\wedge$.
\item If $A$ is in $\textit{WAdm}^{Noeth}$ and $A'$ is Noetherian, then
$(A')^\wedge$ is in $\textit{WAdm}^{Noeth}$.
\end{enumerate}
\end{lemma}

\begin{proof}
Part (1) is clear from the construction.
Assume $A$ has a finitely generated ideal of definition $I \subset A$.
Then $I^n(A')^\wedge =  \Ker((A')^\wedge \to A'/I^nA')$ by Algebra, Lemma
\ref{algebra-lemma-hathat-finitely-generated}.
Thus $I(A')^\wedge$ is a finitely generated ideal of definition
and we see that (2) holds.
Finally, assume that $A$ is Noetherian and adic.
By (2) we know that $(A')^\wedge$ is adic.
By Algebra, Lemma \ref{algebra-lemma-completion-Noetherian-Noetherian}
we see that $(A')^\wedge$ is Noetherian. Hence (3) holds.
\end{proof}

\begin{situation}
\label{situation-local-property}
Let $P$ be a property of morphisms of $\textit{WAdm}^{count}$.
Consider commutative diagrams
\begin{equation}
\label{equation-localize}
\vcenter{
\xymatrix{
A \ar[r] & (A')^\wedge \\
B \ar[r] \ar[u]^\varphi & (B')^\wedge \ar[u]_{\varphi'}
}
}
\end{equation}
satisfying the following conditions
\begin{enumerate}
\item $A$ and $B$ are objects of $\textit{WAdm}^{count}$,
\item $A \to A'$ and $B \to B'$ are \'etale ring maps,
\item $(A')^\wedge = \lim A'/IA'$, resp.\  $(B')^\wedge = \lim B'/JB'$
where $I \subset A$, resp.\ $J \subset B$
runs through the weakly admissible ideals of definition of $A$, resp.\ $B$,
\item $\varphi : A \to B$ and $\varphi' : (A')^\wedge \to (B')^\wedge$
are continuous.
\end{enumerate}
By Lemma \ref{lemma-completion-in-sub} the topological rings
$(A')^\wedge$ and $(B')^\wedge$ are objects of $\textit{WAdm}^{count}$.
We say $P$ is a {\it local property} if the following axioms hold:
\begin{enumerate}
\item
\label{item-axiom-1}
for any diagram (\ref{equation-localize}) we have
$P(\varphi) \Rightarrow P(\varphi')$,
\item
\label{item-axiom-2}
for any diagram (\ref{equation-localize}) with $A \to A'$
faithfully flat we have
$P(\varphi') \Rightarrow P(\varphi)$,
\item
\label{item-axiom-3}
if $P(B \to A_i)$ for $i = 1, \ldots, n$, then
$P(B \to \prod_{i = 1, \ldots, n} A_i)$.
\end{enumerate}
Axiom (\ref{item-axiom-3})
makes sense as $\textit{WAdm}^{count}$ has finite products.
\end{situation}

\begin{lemma}
\label{lemma-property-defines-property-morphisms}
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of
locally countably indexed formal algebraic spaces over $S$.
Let $P$ be a local property of morphisms of $\textit{WAdm}^{count}$.
The following are equivalent
\begin{enumerate}
\item for every commutative diagram
$$
\xymatrix{
U \ar[d] \ar[r] & V \ar[d] \\
X \ar[r] & Y
}
$$
with $U$ and $V$ affine formal algebraic spaces, $U \to X$ and $V \to Y$
representable by algebraic spaces and \'etale, the morphism $U \to V$
corresponds to a morphism of $\textit{WAdm}^{count}$ with property $P$,
\item there exists a covering $\{Y_j \to Y\}$ as in
Definition \ref{definition-formal-algebraic-space} and for each $j$
a covering $\{X_{ji} \to Y_j \times_Y X\}$ as in
Definition \ref{definition-formal-algebraic-space}
such that each $X_{ji} \to Y_j$  corresponds
to a morphism of $\textit{WAdm}^{count}$ with property $P$, and
\item there exist a covering $\{X_i \to X\}$ as in
Definition \ref{definition-formal-algebraic-space}
and for each $i$ a factorization $X_i \to Y_i \to Y$ where $Y_i$
is an affine formal algebraic space, $Y_i \to Y$ is representable
by algebraic spaces and \'etale, and $X_i \to Y_i$ corresponds
to a morphism of $\textit{WAdm}^{count}$ with property $P$.
\end{enumerate}
\end{lemma}

\begin{proof}
It is clear that (1) implies (2) and that (2) implies (3).
Assume $\{X_i \to X\}$ and $X_i \to Y_i \to Y$ as in (3)
and let a diagram as in (1) be given.
Since $Y_i \times_Y V$ is a formal algebraic space
(Lemma \ref{lemma-fibre-products-general}) we may pick
coverings $\{Y_{ij} \to Y_i \times_Y V\}$ as in
Definition \ref{definition-formal-algebraic-space}.
For each $(i, j)$ we may similarly choose coverings
$\{X_{ijk} \to Y_{ij} \times_{Y_i} X_i \times_X U\}$
as in Definition \ref{definition-formal-algebraic-space}.
Since $U$ is quasi-compact we can choose
$(i_1, j_1, k_1), \ldots, (i_n, j_n, k_n)$ such that
$$
X_{i_1 j_1 k_1} \amalg \ldots \amalg X_{i_n j_n k_n} \longrightarrow U
$$
is surjective. For $s = 1, \ldots, n$ consider the commutative diagram
$$
\xymatrix{
& & & X_{i_s j_s k_s} \ar[ld] \ar[d] \ar[rd] \\
X \ar[d] & X_{i_s} \ar[l] \ar[d] &
X_{i_s} \times_X U \ar[l] \ar[d] & Y_{i_s j_s} \ar[ld] \ar[rd] &
X_{i_s} \times_X U \ar[d] \ar[r] &
U \ar[d] \ar[r] & X \ar[d] \\
Y & Y_{i_s} \ar[l] &
Y_{i_s} \times_Y V \ar[l] & &
Y_{i_s} \times_Y V \ar[r] &
V \ar[r] & Y
}
$$
Let us say that $P$ holds for a morphism of countably indexed
affine formal algebraic spaces if it holds for the corresponding
morphism of $\textit{WAdm}^{count}$. Observe that the maps
$X_{i_s j_s k_s} \to X_{i_s}$, $Y_{i_s j_s} \to Y_{i_s}$
are given by completions of \'etale ring maps, see Lemma \ref{lemma-etale}.
Hence we see that $P(X_{i_s} \to Y_{i_s})$ implies
$P(X_{i_s j_s k_s} \to Y_{i_s j_s})$ by axiom (\ref{item-axiom-1}).
Observe that the maps $Y_{i_s j_s} \to V$ are given by completions of
\'etale rings maps (same lemma as before).
By axiom (\ref{item-axiom-2}) applied to the diagram
$$
\xymatrix{
X_{i_s j_s k_s} \ar@{=}[r] \ar[d] & X_{i_s j_s k_s} \ar[d] \\
Y_{i_s j_s} \ar[r] & V
}
$$
(this is permissible as identities are faithfully flat ring maps)
we conclude that $P(X_{i_s j_s k_s} \to V)$ holds.
By axiom (\ref{item-axiom-3}) we find that
$P(\coprod_{s = 1, \ldots, n} X_{i_s j_s k_s} \to V)$ holds.
Since the morphism $\coprod X_{i_s j_s k_s} \to U$ is surjective
by construction, the corresponding morphism of $\textit{WAdm}^{count}$
is the completion of a faithfully flat \'etale ring map, see
Lemma \ref{lemma-etale-surjective}.
One more application of axiom (\ref{item-axiom-2})
(with $B' = B$) implies that $P(U \to V)$ is true as desired.
\end{proof}

\begin{remark}[Variant for adic-star]
\label{remark-variant-adic-star}
Let $P$ be a property of morphisms of $\textit{WAdm}^{adic*}$.
We say $P$ is a {\it local property} if axioms
(\ref{item-axiom-1}), (\ref{item-axiom-2}), (\ref{item-axiom-3})
of Situation \ref{situation-local-property}
hold for morphisms of $\textit{WAdm}^{adic*}$. In exactly the same way
we obtain a variant of Lemma \ref{lemma-property-defines-property-morphisms}
for morphisms between locally adic* formal algebraic spaces over $S$.
\end{remark}

\begin{remark}[Variant for Noetherian]
\label{remark-variant-Noetherian}
Let $P$ be a property of morphisms of $\textit{WAdm}^{Noeth}$.
We say $P$ is a {\it local property} if axioms
(\ref{item-axiom-1}), (\ref{item-axiom-2}), (\ref{item-axiom-3}),
of Situation \ref{situation-local-property}
hold for morphisms of $\textit{WAdm}^{Noeth}$. In exactly the same way
we obtain a variant of Lemma \ref{lemma-property-defines-property-morphisms}
for morphisms between locally Noetherian formal algebraic spaces over $S$.
\end{remark}

\begin{lemma}
\label{lemma-representable-property-rings}
Let $B \to A$ be an arrow of $\textit{WAdm}^{count}$.
The following are equivalent
\begin{enumerate}
\item[(a)] $B \to A$ is taut (Definition \ref{definition-taut}),
\item[(b)] for $B \supset J_1 \supset J_2 \supset J_3 \supset \ldots$
a fundamental system of weak ideals of definitions there exist
a commutative diagram
$$
\xymatrix{
A \ar[r] & \ldots \ar[r] & A_3 \ar[r] & A_2 \ar[r] & A_1 \\
B \ar[r] \ar[u] & \ldots \ar[r] & B/J_3 \ar[r] \ar[u] &
B/J_2 \ar[r] \ar[u] & B/J_1 \ar[u]
}
$$
such that $A_{n + 1}/J_nA_{n + 1} = A_n$ and $A = \lim A_n$
as topological ring.
\end{enumerate}
Moreover, these equivalent conditions define a local property,
i.e., they satisfy axioms (\ref{item-axiom-1}), (\ref{item-axiom-2}),
(\ref{item-axiom-3}).
\end{lemma}

\begin{proof}
The equivalence of (a) and (b) is immediate. Below we will give an
algebraic proof of the axioms, but it turns out we've already proven
them. Namely, using Lemma \ref{lemma-representable-affine}
(a) and (b) translate to saying the corresponding morphism of
affine formal algebraic spaces is representable, and this condition is
``\'etale local on the source and target'' by
Lemma \ref{lemma-representable-by-algebraic-spaces-local}.

\medskip\noindent
Let a diagram (\ref{equation-localize}) as in
Situation \ref{situation-local-property} be given.
By Example \ref{example-representable-morphism-from-completion}
the maps $A \to (A')^\wedge$ and $B \to (B')^\wedge$
satisfy (a) and (b).

\medskip\noindent
Assume (a) and (b) hold for $\varphi$. Let $J \subset B$ be a weak ideal
of definition. Then the closure of $JA$, resp.\ $J(B')^\wedge$
is a weak ideal of definition $I \subset A$, resp.\ $J' \subset (B')^\wedge$.
Then the closure of $I(A')^\wedge$ is a weak ideal of definition
$I' \subset (A')^\wedge$. A topological argument shows that $I'$ is also
the closure of $J(A')^\wedge$ and of $J'(A')^\wedge$.
Finally, as $J$ runs over a fundamental system of weak ideals of definition
of $B$ so do the ideals $I$ and $I'$ in $A$ and $(A')^\wedge$.
It follows that (a) holds for $\varphi'$. This proves (\ref{item-axiom-1}).

\medskip\noindent
Assume $A \to A'$ is faithfully flat and that (a) and (b) hold for $\varphi'$.
Let $J \subset B$ be a weak ideal of definition. Using (a) and (b)
for the maps $B \to (B')^\wedge \to (A')^\wedge$ we find that the
closure $I'$ of $J(A')^\wedge$ is a weak ideal of definition.
In particular, $I'$ is open and hence the inverse image of $I'$
in $A$ is open. Now we have (explanation below)
\begin{align*}
A \cap I'
& =
A \cap \bigcap (J(A')^\wedge + \Ker((A')^\wedge \to A'/I_0A')) \\
& =
A \cap \bigcap \Ker((A')^\wedge \to A'/JA' + I_0 A') \\
& = \bigcap (JA + I_0)
\end{align*}
which is the closure of $JA$ by Lemma \ref{lemma-closed}.
The intersections are over weak ideals of definition $I_0 \subset A$.
The first equality because a fundamental system of neighbourhoods of
$0$ in $(A')^\wedge$ are the kernels of the maps $(A')^\wedge \to A'/I_0A'$.
The second equality is trivial. The third equality because $A \to A'$
is faithfully flat, see
Algebra, Lemma \ref{algebra-lemma-faithfully-flat-universally-injective}.
Thus the closure of $JA$ is open. By Lemma \ref{lemma-topologically-nilpotent}
the closure of $JA$
is a weak ideal of definition of $A$. Finally, given a weak
ideal of definition $I \subset A$ we can find $J$ such that
$J(A')^\wedge$ is contained in the closure of $I(A')^\wedge$
by property (a) for $B \to (B')^\wedge$ and $\varphi'$.
Thus we see that (a) holds for $\varphi$. This proves (\ref{item-axiom-2}).

\medskip\noindent
We omit the proof of (\ref{item-axiom-3}).
\end{proof}

\begin{lemma}
\label{lemma-representable-local-property}
Let $P=$"taut" viewed as a property of morphisms of $\textit{WAdm}^{count}$.
Then under the assumptions of
Lemma \ref{lemma-property-defines-property-morphisms} the equivalent conditions
(1), (2), and (3) are also equivalent to the condition
\begin{enumerate}
\item[(4)] $f$ is representable by algebraic spaces.
\end{enumerate}
\end{lemma}

\begin{proof}
Property $P$ is a local property by
Lemma \ref{lemma-representable-property-rings}.
By Lemma \ref{lemma-representable-affine} condition $P$ on morphisms
of $\textit{WAdm}^{count}$ corresponds to ``representable
by algebraic spaces'' for the corresponding morphisms of
countably indexed affine formal algebraic spaces.
Thus the lemma follows from
Lemma \ref{lemma-representable-by-algebraic-spaces-local}.
\end{proof}









\section{Adic morphisms}
\label{section-adic}

\noindent
Suppose that $\varphi : A \to B$ is a continuous map between
adic topological rings. One says $\varphi$ is {\it adic}
if there exists an ideal of definition $I \subset A$ such that
the topology on $B$ is $I$-adic. However, this is not a good notion
unless we assume $A$ has a finitely generated ideal of definition.
In this case, the condition is equivalent
to $\varphi$ being taut, see Lemma \ref{lemma-taut-is-adic}.

\medskip\noindent
Let $P$ be the property of morphisms $\varphi : A \to B$
of $\textit{WAdm}^{adic*}$ defined by
$$
P(\varphi)=\text{``}\varphi\text{ is adic''}=\text{``}\varphi\text{ is taut''}
$$
(see above for the equivalence).
Since $\textit{WAdm}^{adic*}$ is a full subcategory of
$\textit{WAdm}^{count}$ it follows trivially from
Lemma \ref{lemma-representable-property-rings} that $P$
is a local property on morphisms of $\textit{WAdm}^{adic*}$,
see Remark \ref{remark-variant-adic-star}. Combining
Lemmas \ref{lemma-property-defines-property-morphisms} and
\ref{lemma-representable-local-property}
we obtain the result stated in the next paragraph.

\medskip\noindent
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of
locally adic* formal algebraic spaces over $S$. Then the following
are equivalent
\begin{enumerate}
\item $f$ is representable by algebraic spaces (in other words, the
equivalent conditions of
Lemma \ref{lemma-representable-by-algebraic-spaces-local} hold),
\item for every commutative diagram
$$
\xymatrix{
U \ar[d] \ar[r] & V \ar[d] \\
X \ar[r] & Y
}
$$
with $U$ and $V$ affine formal algebraic spaces, $U \to X$ and $V \to Y$
representable by algebraic spaces and \'etale, the morphism $U \to V$
corresponds to an adic map in $\textit{WAdm}^{adic*}$
(in other words, the equivalent conditions of
Lemma \ref{lemma-property-defines-property-morphisms}
hold with $P$ as above).
\end{enumerate}
In this situation we will sometimes say that {\it $f$ is an adic morphism}.
Here it is understood that this notion is only defined for morphisms
between formal algebraic spaces which are locally adic*.

\begin{definition}
\label{definition-adic-morphism}
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of formal algebraic
spaces over $S$. Assume $X$ and $Y$ are locally adic*. We say $f$ is
an {\it adic morphism} if $f$ is representable by algebraic spaces.
See discussion above.
\end{definition}











\section{Morphisms of finite type}
\label{section-finite-type}

\noindent
Due to how things are setup in the Stacks project, the following
is really the correct thing to do and stronger notions should have
a different name.

\begin{definition}
\label{definition-finite-type}
Let $S$ be a scheme. Let $f : Y \to X$ be a morphism of formal algebraic
spaces over $S$.
\begin{enumerate}
\item We say $f$ is {\it locally of finite type}
if $f$ is representable by algebraic spaces and is locally
of finite type in the sense of
Bootstrap, Definition \ref{bootstrap-definition-property-transformation}.
\item We say $f$ is of {\it finite type} if $f$ is locally of finite type and
quasi-compact (Definition \ref{definition-quasi-compact-morphism}).
\end{enumerate}
\end{definition}

\noindent
We will discuss the relationship between finite type morphisms of
certain formal algebraic spaces and
continuous ring maps $A \to B$ which are topologically of finite type
in Section \ref{section-tft}.

\begin{lemma}
\label{lemma-characterize-finite-type}
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of formal algebraic
spaces over $S$. The following are equivalent
\begin{enumerate}
\item $f$ is of finite type,
\item $f$ is representable by algebraic spaces and is of finite type in
the sense of
Bootstrap, Definition \ref{bootstrap-definition-property-transformation}.
\end{enumerate}
\end{lemma}

\begin{proof}
This follows from Bootstrap, Lemma
\ref{bootstrap-lemma-transformations-property-implication},
the implication ``quasi-compact $+$ locally of finite type
$\Rightarrow$ finite type'' for morphisms of algebraic spaces, and
Lemma \ref{lemma-quasi-compact-representable}.
\end{proof}

\begin{lemma}
\label{lemma-composition-finite-type}
The composition of finite type morphisms is of finite type.
The same holds for locally of finite type.
\end{lemma}

\begin{proof}
See Bootstrap, Lemma \ref{bootstrap-lemma-composition-transformation-property}
and use Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-composition-finite-type}.
\end{proof}

\begin{lemma}
\label{lemma-base-change-finite-type}
A base change of a finite type morphism is finite type.
The same holds for locally of finite type.
\end{lemma}

\begin{proof}
See Bootstrap, Lemma \ref{bootstrap-lemma-base-change-transformation-property}
and use Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-base-change-finite-type}.
\end{proof}

\begin{lemma}
\label{lemma-permanence-finite-type}
Let $S$ be a scheme. Let $f : X \to Y$ and $g : Y \to Z$ be morphisms of
formal algebraic spaces over $S$. If $g \circ f : X \to Z$ is locally of
finite type, then $f : X \to Y$ is locally of finite type.
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-permanence-representable} we see that $f$ is
representable by algebraic spaces. Let $T$ be a scheme and let
$T \to Z$ be a morphism. Then we can apply
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-permanence-finite-type}
to the morphisms
$T \times_Z X \to T \times_Z Y \to T$ of algebraic spaces to conclude.
\end{proof}

\noindent
Being locally of finite type is local on the source and the target.

\begin{lemma}
\label{lemma-finite-type-local}
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of formal algebraic
spaces over $S$. The following are equivalent:
\begin{enumerate}
\item the morphism $f$ is locally of finite type,
\item there exists a commutative diagram
$$
\xymatrix{
U \ar[d] \ar[r] & V \ar[d] \\
X \ar[r] & Y
}
$$
where $U$, $V$ are formal algebraic spaces, the vertical arrows are
representable by algebraic spaces and \'etale, $U \to X$
is surjective, and $U \to V$ is locally of finite type,
\item for any commutative diagram
$$
\xymatrix{
U \ar[d] \ar[r] & V \ar[d] \\
X \ar[r] & Y
}
$$
where $U$, $V$ are formal algebraic spaces and vertical arrows
representable by algebraic spaces and \'etale, the morphism
$U \to V$ is locally of finite type,
\item there exists a covering $\{Y_j \to Y\}$ as in
Definition \ref{definition-formal-algebraic-space}
and for each $j$ a covering $\{X_{ji} \to Y_j \times_Y X\}$ as in
Definition \ref{definition-formal-algebraic-space} such that
$X_{ji} \to Y_j$ is locally of finite type for each $j$ and $i$,
\item there exist a covering $\{X_i \to X\}$ as in
Definition \ref{definition-formal-algebraic-space}
and for each $i$ a factorization $X_i \to Y_i \to Y$ where $Y_i$
is an affine formal algebraic space, $Y_i \to Y$ is representable
by algebraic spaces and \'etale, such that $X_i \to Y_i$ is
locally of finite type, and
\item add more here.
\end{enumerate}
\end{lemma}

\begin{proof}
In each of the 5 cases the morphism $f : X \to Y$ is representable
by algebraic spaces, see
Lemma \ref{lemma-representable-by-algebraic-spaces-local}.
We will use this below without further mention.

\medskip\noindent
It is clear that (1) implies (2) because we can take $U = X$ and $V = Y$.
Conversely, assume given a diagram as in (2). Let $T$ be a scheme and
let $T \to Y$ be a morphism. Then we can consider
$$
\xymatrix{
U \times_Y T \ar[d] \ar[r] & V \times_Y T \ar[d] \\
X \times_Y T \ar[r] & T
}
$$
The vertical arrows are \'etale and the top horizontal arrow
is locally of finite type as base changes of such morphisms.
Hence by Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-finite-type-local} we conclude that
$X \times_Y T \to T$ is locally of finite type. In other words
(1) holds.

\medskip\noindent
Assume (1) is true and consider a diagram as in (3).
Then $U \to Y$ is locally of finite type
(as the composition $U \to X \to Y$, see
Bootstrap, Lemma \ref{bootstrap-lemma-composition-transformation-property}).
Let $T$ be a scheme and let $T \to V$ be a morphism.
Then the projection $T \times_V U \to T$ factors as
$$
T \times_V U = (T \times_Y U) \times_{(V \times_Y V)} V
\to T \times_Y U \to T
$$
The second arrow is locally of finite type (as a base change
of the composition $U \to X \to Y$) and
the first is the base change of the diagonal $V \to V \times_Y V$
which is locally of finite type by
Lemma \ref{lemma-diagonal-morphism-formal-algebraic-spaces}.

\medskip\noindent
It is clear that (3) implies (2). Thus now (1) -- (3) are equivalent.

\medskip\noindent
Observe that the condition in (4) makes sense as the fibre product
$Y_j \times_Y X$ is a formal algebraic space by
Lemma \ref{lemma-fibre-products}.
It is clear that (4) implies (5).

\medskip\noindent
Assume $X_i \to Y_i \to Y$ as in (5). Then we set
$V = \coprod Y_i$ and $U = \coprod X_i$ to see that
(5) implies (2).

\medskip\noindent
Finally, assume (1) -- (3) are true.
Thus we can choose any covering $\{Y_j \to Y\}$ as in
Definition \ref{definition-formal-algebraic-space}
and for each $j$ any covering $\{X_{ji} \to Y_j \times_Y X\}$ as in
Definition \ref{definition-formal-algebraic-space}.
Then $X_{ij} \to Y_j$ is locally of finite type by (3)
and we see that (4) is true. This concludes the proof.
\end{proof}

\begin{example}
\label{example-finite-type-from-finite-type-ring-map}
Let $S$ be a scheme. Let $A$ be a weakly admissible topological ring over $S$.
Let $A \to A'$ be a finite type ring map. Then
$$
(A')^\wedge = \lim_{I \subset A\ w.i.d.} A'/IA'
$$
is a weakly admissible ring and the corresponding morphism
$\text{Spf}((A')^\wedge) \to \text{Spf}(A)$ is representable,
see Example \ref{example-representable-morphism-from-completion}.
If $T \to \text{Spf}(A)$ is a morphism where $T$ is a quasi-compact
scheme, then this factors through $\Spec(A/I)$ for some weak
ideal of definition $I \subset A$ (Lemma \ref{lemma-factor-through-thickening}).
Then $T \times_{\text{Spf}(A)} \text{Spf}((A')^\wedge)$
is equal to $T \times_{\Spec(A/I)} \Spec(A'/IA')$ and
we see that $\text{Spf}((A')^\wedge) \to \text{Spf}(A)$ is
of finite type.
\end{example}

\begin{lemma}
\label{lemma-locally-finite-type-locally-noetherian}
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of
formal algebraic spaces over $S$. If $Y$ is locally Noetherian and
$f$ locally of finite type, then $X$ is locally Noetherian.
\end{lemma}

\begin{proof}
Pick $\{Y_j \to Y\}$ and $\{X_{ij} \to Y_j \times_Y X\}$
as in Lemma \ref{lemma-finite-type-local}. Then it follows
from Lemma \ref{lemma-property-goes-up-affine-morphism}
that each $X_{ij}$ is Noetherian. This proves the lemma.
\end{proof}

\begin{lemma}
\label{lemma-fibre-product-Noetherian}
Let $S$ be a scheme. Let $f : X \to Y$ and $Z \to Y$ be morphisms
of formal algebraic spaces over $S$. If $Z$ is locally
Noetherian and $f$ locally of finite type, then
$Z \times_Y X$ is locally Noetherian.
\end{lemma}

\begin{proof}
The morphism $Z \times_Y X \to Z$ is locally of finite type by
Lemma \ref{lemma-base-change-finite-type}. Hence this follows
from Lemma \ref{lemma-locally-finite-type-locally-noetherian}.
\end{proof}

\begin{lemma}
\label{lemma-map-completions-finite-type}
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism
of algebraic spaces over $S$ which is locally of finite type.
Let $T \subset |Y|$ be a closed subset and let $T' = |f|^{-1}(T) \subset |X|$.
Then $X_{/T'} \to Y_{/T}$ is locally of finite type.
\end{lemma}

\begin{proof}
Namely, suppose that $V \to Y$ is a morphism from a scheme into $Y$ such
that $|V|$ maps into $T$. In the proof of
Lemma \ref{lemma-map-completions-representable}
we have seen that $V \times_Y X \to X$ is an algebraic space
representing $V \times_{Y_{/T}} X_{/T'}$.
Since $V \times_Y X \to V$ is locally of finite type
(by Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-base-change-finite-type}) we conclude.
\end{proof}





\section{Monomorphisms}
\label{section-monomorphisms}

\noindent
Here is the definition.

\begin{definition}
\label{definition-monomorphism}
Let $S$ be a scheme.
A morphism of formal algebraic spaces over $S$ is called a
{\it monomorphism} if it is an injective map of sheaves.
\end{definition}

\noindent
An example is the following. Let $X$ be an algebraic space and let
$T \subset |X|$ be a closed subset. Then the morphism
$X_{/T} \to X$ from the formal completion of $X$ along $T$ to $X$
is a monomorphism. In particular, monomorphisms of formal algebraic
spaces are in general not representable.



\section{Closed immersions}
\label{section-closed-immersions}

\noindent
Here is the definition.

\begin{definition}
\label{definition-closed-immersion}
Let $S$ be a scheme. Let $f : Y \to X$ be a morphism of formal algebraic
spaces over $S$. We say $f$ is a {\it closed immersion}
if $f$ is representable by algebraic spaces and a closed immersion
in the sense of
Bootstrap, Definition \ref{bootstrap-definition-property-transformation}.
\end{definition}

\begin{lemma}
\label{lemma-closed-immersion-into-McQuillan}
Let $S$ be a scheme. Let $X$ be a McQuillan affine formal algebraic space
over $S$. Let $f : Y \to X$ be a closed immersion of formal algebraic spaces
over $S$. Then $Y$ is a McQuillan affine formal algebraic space and
$f$ corresponds to a continuous homomorphism $A \to B$ of weakly admissible
topological $S$-algebras which is taut, has closed kernel, and has
dense image.
\end{lemma}

\begin{proof}
Write $X = \text{Spf}(A)$ where $A$ is a weakly admissible topological ring.
Let $I_\lambda$ be a fundamental system of weakly admissible ideals
of definition in $A$. Then $Y \times_X \Spec(A/I_\lambda)$ is
a closed subscheme of $\Spec(A/I_\lambda)$
and hence affine (Definition \ref{definition-closed-immersion}).
Say $Y \times_X \Spec(A/I_\lambda) = \Spec(B_\lambda)$.
The ring map $A/I_\lambda \to B_\lambda$
is surjective. Hence the projections
$$
B = \lim B_\lambda \longrightarrow B_\lambda
$$
are surjective as the compositions $A \to B \to B_\lambda$ are surjective.
It follows that $Y$ is McQuillan by
Lemma \ref{lemma-mcquillan-affine-formal-algebraic-space}.
The ring map $A \to B$ is taut by Lemma \ref{lemma-representable-affine}.
The kernel is closed because $B$ is complete and $A \to B$ is
continuous. Finally, as $A \to B_\lambda$ is surjective for all $\lambda$
we see that the image of $A$ in $B$ is dense.
\end{proof}

\noindent
Even though we have the result above, in general we do not know how
closed immersions behave when the target is a
McQuillan affine formal algebraic space, see Remark \ref{remark-questions}.

\begin{example}
\label{example-closed-immersion-from-quotient}
Let $S$ be a scheme. Let $A$ be a weakly admissible topological ring over $S$.
Let $K \subset A$ be a closed ideal. Setting
$$
B = (A/K)^\wedge = \lim_{I \subset A\ w.i.d.} A/(I + K)
$$
the morphism $\text{Spf}(B) \to \text{Spf}(A)$ is representable, see
Example \ref{example-representable-morphism-from-completion}.
If $T \to \text{Spf}(A)$ is a morphism where $T$ is a quasi-compact
scheme, then this factors through $\Spec(A/I)$ for some weak
ideal of definition $I \subset A$ (Lemma \ref{lemma-factor-through-thickening}).
Then $T \times_{\text{Spf}(A)} \text{Spf}(B)$
is equal to $T \times_{\Spec(A/I)} \Spec(A/(K + I))$ and
we see that $\text{Spf}(B) \to \text{Spf}(A)$ is a closed immersion.
The kernel of $A \to B$ is $K$ as $K$ is closed, but
beware that in general the ring map $A \to B = (A/K)^\wedge$
need not be surjective.
\end{example}






\section{Restricted power series}
\label{section-restricted-power-series}

\noindent
Let $A$ be a topological ring complete with respect to a linear
topology (More on Algebra, Definition
\ref{more-algebra-definition-topological-ring}).
Let $I_\lambda$ be a fundamental system of open ideals.
Let $r \geq 0$ be an integer. In this setting one often
denotes
$$
A\{x_1, \ldots, x_r\} =
\lim_\lambda A/I_\lambda[x_1, \ldots, x_r] =
\lim_\lambda (A[x_1, \ldots, x_r]/I_\lambda A[x_1, \ldots, x_r])
$$
endowed with the limit topology. In other words, this is
the completion of the polynomial ring with respect to the
ideals $I_\lambda$. We can think of elements of $A\{x_1, \ldots, x_r\}$ as
power series
$$
f = \sum\nolimits_{E = (e_1, \ldots, e_r)} a_E x_1^{e_1} \ldots x_r^{e_r}
$$
in $x_1, \ldots, x_r$ with coefficients $a_E \in A$ which tend
to zero in the topology of $A$. In other words, for any $\lambda$
all but a finite number of $a_E$ are in $I_\lambda$.
For this reason elements of $A\{x_1, \ldots, x_r\}$ are sometimes
called {\it restricted power series}.
Sometimes this ring is denoted $A\langle x_1, \ldots, x_r\rangle$;
we will refrain from using this notation.

\begin{remark}[Universal property restricted power series]
\label{remark-universal-property}
\begin{reference}
\cite[Chapter 0, 7.5.3]{EGA}
\end{reference}
Let $A \to C$ be a continuous map of complete linearly topologized rings.
Then any $A$-algebra map $A[x_1, \ldots x_r] \to C$ extends uniquely to a
continuous map $A\{x_1, \ldots, x_r\} \to C$ on restricted power series.
\end{remark}

\begin{remark}
\label{remark-I-adic-completion-and-restricted-power-series}
Let $A$ be a ring and let $I \subset A$ be an ideal. If $A$ is $I$-adically
complete, then the $I$-adic completion $A[x_1, \ldots, x_r]^\wedge$ of
$A[x_1, \ldots, x_r]$ is the restricted power series ring over $A$ as a
ring. However, it is not clear that $A[x_1, \ldots, x_r]^\wedge$ is
$I$-adically complete. We think of the topology on $A\{x_1, \ldots, x_r\}$
as the limit topology (which is always complete) whereas we often think of
the topology on $A[x_1, \ldots, x_r]^\wedge$ as the $I$-adic topology
(not always complete). If $I$ is finitely generated, then
$A\{x_1, \ldots, x_r\} = A[x_1, \ldots, x_r]^\wedge$ as topological
rings, see Algebra, Lemma \ref{algebra-lemma-hathat-finitely-generated}.
\end{remark}





\section{Algebras topologically of finite type}
\label{section-tft}

\noindent
Here is our definition. This definition is not generally agreed upon.
Many authors impose further conditions, often because they are only
interested in specific types of rings and not the most general case.

\begin{definition}
\label{definition-topologically-finite-type}
Let $A \to B$ be a continuous map of topological rings
(More on Algebra, Definition \ref{more-algebra-definition-topological-ring}).
We say $B$ is {\it topologically of finite type over} $A$ if
there exists an $A$-algebra map $A[x_1, \ldots, x_n] \to B$ whose
image is dense in $B$.
\end{definition}

\noindent
If $A$ is a complete, linearly topologized ring, then the restricted
power series ring $A\{x_1, \ldots, x_r\}$ is topologically of finite
type over $A$. For continuous taut maps of weakly admissible topological rings,
this notion corresponds exactly to morphisms of finite type
between the associated affine formal algebraic spaces.

\begin{lemma}
\label{lemma-topologically-finite-type-finite-type}
Let $S$ be a scheme. Let $\varphi : A \to B$ be a continuous map of
weakly admissible topological rings over $S$. The following
are equivalent
\begin{enumerate}
\item $\text{Spf}(\varphi) : Y = \text{Spf}(B) \to \text{Spf}(A) = X$
is of finite type,
\item $\varphi$ is taut and $B$ is topologically of finite type over $A$.
\end{enumerate}
\end{lemma}

\begin{proof}
We can use Lemma \ref{lemma-representable-affine} to relate tautness of
$\varphi$ to representability of $\text{Spf}(\varphi)$. We will use this
without further mention below. It follows that $X = \colim \Spec(A/I)$
and $Y = \colim \Spec(B/J(I))$ where $I \subset A$ runs over the weak
ideals of definition of $A$ and $J(I)$ is the closure of $IB$ in $B$.

\medskip\noindent
Assume (2).
Choose a ring map $A[x_1, \ldots, x_r] \to B$ whose image is dense.
Then $A[x_1, \ldots, x_r] \to B \to B/J(I)$ has dense image too
which means that it is surjective. Therefore $B/J(I)$ is of
finite type over $A/I$. Let $T \to X$ be a morphism with
$T$ a quasi-compact scheme. Then $T \to X$ factors through
$\Spec(A/I)$ for some $I$ (Lemma \ref{lemma-factor-through-thickening}).
Then $T \times_X Y = T \times_{\Spec(A/I)} \Spec(B/J(I))$, see proof of
Lemma \ref{lemma-representable-affine}.
Hence $T \times_Y X \to T$ is of finite type as the base change of
the morphism $\Spec(B/J(I)) \to \Spec(A/I)$ which is of finite
type. Thus (1) is true.

\medskip\noindent
Assume (1). Pick any $I \subset A$ as above. Since
$\Spec(A/I) \times_X Y = \Spec(B/J(I))$ we see that $A/I \to B/J(I)$
is of finite type. Choose $b_1, \ldots, b_r \in B$
mapping to generators of $B/J(I)$ over $A/I$. We claim that the image
of the ring map $A[x_1, \ldots, x_r] \to B$ sending $x_i$ to $b_i$
is dense. To prove this, let $I' \subset I$ be a second weak ideal
of definition. Then we have
$$
B/(J(I') + IB) = B/J(I)
$$
because $J(I)$ is the closure of $IB$ and because $J(I')$ is open.
Hence we may apply Algebra, Lemma
\ref{algebra-lemma-surjective-mod-locally-nilpotent}
to see that $(A/I')[x_1, \ldots, x_r] \to B/J(I')$ is surjective.
Thus (2) is true, concluding the proof.
\end{proof}

\noindent
Let $A$ be a topological ring complete with respect to a linear
topology. Let $(I_\lambda)$ be a fundamental system of open ideals.
Let $\mathcal{C}$ be the category of inverse systems $(B_\lambda)$ where
\begin{enumerate}
\item $B_\lambda$ is a finite type $A/I_\lambda$-algebra, and
\item $B_\mu \to B_\lambda$ is an $A/I_\mu$-algebra homomorphism
which induces an isomorphism $B_\mu/I_\lambda B_\mu \to B_\lambda$.
\end{enumerate}
Morphisms in $\mathcal{C}$ are given by compatible systems of homomorphisms.

\begin{lemma}
\label{lemma-category-affine-over}
Let $S$ be a scheme. Let $X$ be an affine formal algebraic space over $S$.
Assume $X$ is McQuillan and let $A$ be the weakly admissible topological
ring associated to $X$. Then there is an anti-equivalence of categories
between
\begin{enumerate}
\item the category $\mathcal{C}$ introduced above, and
\item the category of maps $Y \to X$ of finite type of
affine formal algebraic spaces.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $(I_\lambda)$ be a fundamental system of weakly admissible ideals
of definition in $A$. Consider $Y$ as in (2). Then
$Y \times_X \Spec(A/I_\lambda)$ is affine
(Definition \ref{definition-finite-type}
and Lemma \ref{lemma-affine-representable-by-algebraic-spaces}).
Say $Y \times_X \Spec(A/I_\lambda) = \Spec(B_\lambda)$.
The ring map $A/I_\lambda \to B_\lambda$ is of finite type
because $\Spec(B_\lambda) \to \Spec(A/I_\lambda)$ is of
finite type
(by Definition \ref{definition-finite-type}).
Then $(B_\lambda)$ is an object of $\mathcal{C}$.

\medskip\noindent
Conversely, given an object $(B_\lambda)$ of $\mathcal{C}$ we can set
$Y = \colim \Spec(B_\lambda)$. This is an affine formal algebraic
space. We claim that
$$
Y \times_X \Spec(A/I_\lambda) =
\left(\colim_\mu \Spec(B_\mu)\right) \times_X \Spec(A/I_\lambda) =
\Spec(B_\lambda)
$$
To show this it suffices we get the same values if we evaluate
on a quasi-compact scheme $U$. A morphism
$U \to \left(\colim_\mu \Spec(B_\mu)\right) \times_X \Spec(A/I_\lambda)$
comes from a morphism
$U \to \Spec(B_\mu) \times_{\Spec(A/I_\mu)} \Spec(A/I_\lambda)$
for some $\mu \geq \lambda$ (use
Lemma \ref{lemma-factor-through-thickening} two times). Since
$\Spec(B_\mu) \times_{\Spec(A/I_\mu)} \Spec(A/I_\lambda) = \Spec(B_\lambda)$
by our second assumption on objects of $\mathcal{C}$
this proves what we want. Using this we can show the morphism
$Y \to X$ is of finite type. Namely, we note that
for any morphism $U \to X$ with $U$ a quasi-compact scheme, we get
a factorization $U \to \Spec(A/I_\lambda) \to X$ for some $\lambda$
(see lemma cited above). Hence
$$
Y \times_X U =
Y \times_X \Spec(A/I_\lambda)) \times_{\Spec(A/I_\lambda)} U =
\Spec(B_\lambda) \times_{\Spec(A/I_\lambda)} U
$$
is a scheme of finite type over $U$ as desired. Thus the construction
$(B_\lambda) \mapsto \colim \Spec(B_\lambda)$ does give a functor
from category (1) to category (2).

\medskip\noindent
To finish the proof we show that the above constructions
define quasi-inverse functors between the categories (1) and (2).
In one direction you have to show that
$$
\left(\colim_\mu \Spec(B_\mu)\right) \times_X \Spec(A/I_\lambda) =
\Spec(B_\lambda)
$$
for any object $(B_\lambda)$ in the category $\mathcal{C}$.
This we proved above. For
the other direction you have to show that
$$
Y = \colim (Y \times_X \Spec(A/I_\lambda))
$$
given $Y$ in the category (2). Again this is true by evaluating on
quasi-compact test objects and because $X = \colim \Spec(A/I_\lambda)$.
\end{proof}

\begin{remark}
\label{remark-questions}
Let $A$ be a weakly admissible topological ring and let $(I_\lambda)$
be a fundamental system of weak ideals of definition. Let $X = \text{Spf}(A)$,
in other words, $X$ is a McQuillan affine formal algebraic space.
Let $f : Y \to X$ be a morphism of affine formal algebraic spaces.
In general it will not be true that $Y$ is McQuillan. More specifically,
we can ask the following questions:
\begin{enumerate}
\item Assume that $f : Y \to X$ is a closed immersion. Then
$Y$ is McQuillan and $f$ corresponds to a continuous map
$\varphi : A \to B$ of weakly admissible topological rings
which is taut, whose kernel $K \subset A$ is a closed ideal, and
whose image $\varphi(A)$ is dense in $B$, see
Lemma \ref{lemma-closed-immersion-into-McQuillan}.
What conditions on $A$ guarantee that $B = (A/K)^\wedge$ as in
Example \ref{example-closed-immersion-from-quotient}?
\item What conditions on $A$ guarantee that closed immersions
$f : Y \to X$ correspond to quotients $A/K$ of $A$ by closed ideals,
in other words, the corresponding continuous map $\varphi$ is surjective
and open?
\item Suppose that $f : Y \to X$ is of finite type. Then we get
$Y = \colim \Spec(B_\lambda)$ where $(B_\lambda)$ is an object of
$\mathcal{C}$ by Lemma \ref{lemma-category-affine-over}.
In this case it is true that there exists a fixed integer $r$ such
that $B_\lambda$ is generated by $r$ elements over $A/I_\lambda$ for
all $\lambda$ (the argument is essentially already given in the proof of
(1) $\Rightarrow$ (2) in
Lemma \ref{lemma-topologically-finite-type-finite-type}).
However, it is not clear that the projections
$\lim B_\lambda \to B_\lambda$ are surjective, i.e.,
it is not clear that $Y$ is McQuillan.
Is there an example where $Y$ is not McQuillan?
\item Suppose that $f : Y \to X$ is of finite type and $Y$ is McQuillan.
Then $f$ corresponds to a continuous map $\varphi : A \to B$ of weakly
admissible topological rings. In fact $\varphi$ is taut and
$B$ is topologically of finite type over $A$, see
Lemma \ref{lemma-topologically-finite-type-finite-type}.
In other words, $f$ factors as
$$
Y \longrightarrow \mathbf{A}^r_X \longrightarrow X
$$
where the first arrow is a closed immersion of McQuillan affine
formal algebraic spaces. However, then questions (1) and
(2) are in force for $Y \to \mathbf{A}^r_X$.
\end{enumerate}
Below we will answer these questions when
$X$ is countably indexed, i.e., when $A$ has a countable fundamental
system of open ideals. If you have answers to these questions
in greater generality, or if you have counter examples, please email
\href{mailto:stacks.project@gmail.com}{stacks.project@gmail.com}.
\end{remark}

\begin{lemma}
\label{lemma-closed-immersion-into-countably-indexed}
Let $S$ be a scheme. Let $X$ be a countably indexed affine formal algebraic
space over $S$. Let $f : Y \to X$ be a closed immersion of formal algebraic
spaces over $S$. Then $Y$ is a countably indexed affine formal algebraic space
and $f$ corresponds to $A \to A/K$ where $A$ is an object of
$\textit{WAdm}^{count}$
(Section \ref{section-morphisms-rings})
and $K \subset A$ is a closed ideal.
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-countably-indexed}
we see that $X = \text{Spf}(A)$ where $A$ is an object of
$\textit{WAdm}^{count}$. Since a closed immersion is representable
and affine, we conclude by Lemma \ref{lemma-property-goes-up-affine-morphism}
that $Y$ is an affine formal algebraic space and countably index.
Thus applying Lemma \ref{lemma-countably-indexed}
again we see that $Y = \text{Spf}(B)$ with $B$ an object of
$\textit{WAdm}^{count}$. By Lemma \ref{lemma-closed-immersion-into-McQuillan}
we conclude that $f$ is given by a morphism $A \to B$ of
$\textit{WAdm}^{count}$ which is taut and has dense image.
To finish the proof we apply
Lemma \ref{lemma-dense-image-surjective}.
\end{proof}

\begin{lemma}
\label{lemma-quotient-restricted-power-series}
Let $B \to A$ be an arrow of $\textit{WAdm}^{count}$, see
Section \ref{section-morphisms-rings}.
The following are equivalent
\begin{enumerate}
\item[(a)] $B \to A$ is taut and $B/J \to A/I$ is of finite type for
every weak ideal of definition $J \subset B$ where $I \subset A$ is the
closure of $JA$,
\item[(b)] $B \to A$ is taut and $B/J_\lambda \to A/I_\lambda$
is of finite type for a cofinal system $(J_\lambda)$
of weak ideals of definition of $B$ where
$I_\lambda \subset A$ is the closure of $J_\lambda A$,
\item[(c)] $B \to A$ is taut and $A$ is topologically of finite
type over $B$,
\item[(d)] $A$ is isomorphic as a topological $B$-algebra to a quotient of
$B\{x_1, \ldots, x_n\}$ by a closed ideal.
\end{enumerate}
Moreover, these equivalent conditions define a local property,
i.e., they satisfy
Axioms (\ref{item-axiom-1}), (\ref{item-axiom-2}), (\ref{item-axiom-3}).
\end{lemma}

\begin{proof}
The implications (a) $\Rightarrow$ (b), (c) $\Rightarrow$ (a),
(d) $\Rightarrow$ (c) are straightforward from the definitions.
Assume (b) holds and let $J \subset B$ and $I \subset A$ be as in (b).
Choose a commutative diagram
$$
\xymatrix{
A \ar[r] & \ldots \ar[r] & A_3 \ar[r] & A_2 \ar[r] & A_1 \\
B \ar[r] \ar[u] & \ldots \ar[r] & B/J_3 \ar[r] \ar[u] &
B/J_2 \ar[r] \ar[u] & B/J_1 \ar[u]
}
$$
such that $A_{n + 1}/J_nA_{n + 1} = A_n$ and such that $A = \lim A_n$ as in
Lemma \ref{lemma-representable-property-rings}.
For every $m$ there exists a $\lambda$ such that $J_\lambda \subset J_m$.
Since $B/J_\lambda \to A/I_\lambda$ is of finite type, this implies
that $B/J_m \to A/I_m$ is of finite type.
Let $\alpha_1, \ldots, \alpha_n \in A_1$ be generators of $A_1$ over
$B/J_1$. Since $A$ is a countable limit of a system with surjective
transition maps, we can find $a_1, \ldots, a_n \in A$ mapping to
$\alpha_1, \ldots, \alpha_n$ in $A_1$. By
Remark \ref{remark-universal-property} we find a continuous map
$B\{x_1, \ldots, x_n\} \to A$ mapping $x_i$ to $a_i$. This map
induces surjections $(B/J_m)[x_1, \ldots, x_n] \to A_m$ by
Algebra, Lemma \ref{algebra-lemma-surjective-mod-locally-nilpotent}.
For $m \geq 1$ we obtain a short exact sequence
$$
0 \to K_m \to (B/J_m)[x_1, \ldots, x_n] \to A_m \to 0
$$
The induced transition maps $K_{m + 1} \to K_m$ are surjective because
$A_{m + 1}/J_mA_{m + 1} = A_m$. Hence the inverse limit of these
short exact sequences is exact, see
Algebra, Lemma \ref{algebra-lemma-ML-exact-sequence}.
Since $B\{x_1, \ldots, x_n\} = \lim (B/J_m)[x_1, \ldots, x_n]$
and $A = \lim A_m$
we conclude that $B\{x_1, \ldots, x_n\} \to A$ is surjective and open.
As $A$ is complete the kernel is a closed ideal. In this way we see that
(a), (b), (c), and (d) are equivalent.

\medskip\noindent
Let a diagram (\ref{equation-localize}) as in
Situation \ref{situation-local-property}
be given. By Example \ref{example-finite-type-from-finite-type-ring-map}
the maps $A \to (A')^\wedge$ and $B \to (B')^\wedge$
satisfy (a), (b), (c), and (d). Moreover, by
Lemma \ref{lemma-representable-property-rings}
in order to prove Axioms (\ref{item-axiom-1}) and (\ref{item-axiom-2})
we may assume both $B \to A$ and $(B')^\wedge \to (A')^\wedge$
are taut. Now pick a weak ideal of definition $J \subset B$. Let
$J' \subset (B')^\wedge$, $I \subset A$, $I' \subset (A')^\wedge$
be the closure of $J(B')^\wedge$, $JA$, $J(A')^\wedge$.
By what was said above, it suffices to consider the commutative
diagram
$$
\xymatrix{
A/I \ar[r] & (A')^\wedge/I' \\
B/J \ar[r] \ar[u]^{\overline{\varphi}} &
(B')^\wedge/J' \ar[u]_{\overline{\varphi}'}
}
$$
and to show (1) $\overline{\varphi}$ finite type
$\Rightarrow \overline{\varphi}'$
finite type, and (2) if $A \to A'$ is faithfully flat, then
$\overline{\varphi}'$ finite type $\Rightarrow \overline{\varphi}$
finite type. Note that $(B')^\wedge/J' = B'/JB'$ and
$(A')^\wedge/I' = A'/IA'$ by the construction of the topologies on
$(B')^\wedge$ and $(A')^\wedge$. In particular the horizontal
maps in the diagram are \'etale. Part (1) now follows from
Algebra, Lemma \ref{algebra-lemma-compose-finite-type}
and part (2) from
Descent, Lemma \ref{descent-lemma-finite-type-local-source-fppf-algebra}
as the ring map $A/I \to (A')^\wedge/I' = A'/IA'$ is faithfully flat
and \'etale.

\medskip\noindent
We omit the proof of Axiom (\ref{item-axiom-3}).
\end{proof}

\begin{lemma}
\label{lemma-quotient-restricted-power-series-admissible}
In Lemma \ref{lemma-quotient-restricted-power-series}
if $B$ is admissible (for example adic), then the equivalent conditions
(a) -- (d) are also equivalent to
\begin{enumerate}
\item[(e)] $B \to A$ is taut and $B/J \to A/I$ is of finite type for
some ideal of definition $J \subset B$ where $I \subset A$ is
the closure of $JA$.
\end{enumerate}
\end{lemma}

\begin{proof}
It is enough to show that (e) implies (a). Let $J' \subset B$ be a weak ideal
of definition and let $I' \subset A$ be the closure of $J'A$. We have
to show that $B/J' \to A/I'$ is of finite type. If the corresponding statement
holds for the smaller weak ideal of definition $J'' = J' \cap J$, then it
holds for $J'$. Thus we may assume $J' \subset J$. As $J$ is an ideal
of definition (and not just a weak ideal of definition), we get
$J^n \subset J'$ for some $n \geq 1$. Thus we can consider the
diagram
$$
\xymatrix{
0 \ar[r] & I/I' \ar[r] & A/I' \ar[r] & A/I \ar[r] & 0 \\
0 \ar[r] & J/J' \ar[r] \ar[u] & B/J' \ar[r] \ar[u] & B/J \ar[r] \ar[u] & 0
}
$$
with exact rows. Since $I' \subset A$ is open and since
$I$ is the closure of $J A$ we see that $I/I' = (J/J') \cdot A/I'$.
By assumption we can find a surjection $(B/J)[x_1, \ldots, x_n] \to A/I$.
We can lift this to $(B/J')[x_1, \ldots, x_n] \to A'/I'$.
Because $J/J'$ is a nilpotent ideal, we may apply part (11) of
Algebra, Lemma \ref{algebra-lemma-NAK} to the map of $B/J'$-modules
$$
(B/J')[x_1, \ldots, x_n] \to A'/I'
$$
to see that it is surjective. Thus $A/I'$ is of finite type over $B/J'$
as desired.
\end{proof}

\begin{lemma}
\label{lemma-representable-affine-finite-type}
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of
affine formal algebraic spaces. Assume $Y$ countably indexed.
The following are equivalent
\begin{enumerate}
\item $f$ is locally of finite type,
\item $f$ is of finite type,
\item $f$ corresponds to a morphism $B \to A$ of $\textit{WAdm}^{count}$
(Section \ref{section-morphisms-rings})
satisfying the equivalent conditions of
Lemma \ref{lemma-quotient-restricted-power-series}.
\end{enumerate}
\end{lemma}

\begin{proof}
Since $X$ and $Y$ are affine it is clear that conditions (1)
and (2) are equivalent. In cases (1) and (2) the morphism $f$
is representable by algebraic spaces by definition, hence
affine by Lemma \ref{lemma-affine-representable-by-algebraic-spaces}.
Thus if (1) or (2) holds we see that
$X$ is countably indexed by
Lemma \ref{lemma-property-goes-up-affine-morphism}.
Write $X = \text{Spf}(A)$ and $Y = \text{Spf}(B)$
for topological $S$-algebras $A$ and $B$ in $\textit{WAdm}^{count}$, see
Lemma \ref{lemma-countably-indexed}. By
Lemma \ref{lemma-morphism-between-formal-spectra}
we see that $f$ corresponds to a continuous map $B \to A$.
Hence now the result follows from
Lemma \ref{lemma-topologically-finite-type-finite-type}.
\end{proof}

\begin{lemma}
\label{lemma-finite-type-local-property}
Let $P$ be the property of morphisms of $\textit{WAdm}^{count}$
(Section \ref{section-morphisms-rings})
defined by the
equivalent conditions (a), (b), (c), and (d) of
Lemma \ref{lemma-quotient-restricted-power-series}.
Then under the assumptions of
Lemma \ref{lemma-property-defines-property-morphisms}
the equivalent conditions
(1), (2), and (3) are also equivalent to the condition
\begin{enumerate}
\item[(4)] $f$ is locally of finite type.
\end{enumerate}
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-representable-affine-finite-type}
the condition on morphisms of $\textit{WAdm}^{count}$
translates into morphisms of countably indexed, affine
formal algebraic spaces being of finite type.
Thus the lemma follows from
Lemma \ref{lemma-finite-type-local}.
\end{proof}







\section{Separation axioms for morphisms}
\label{section-separation-axioms}

\noindent
This section is the analogue of
Morphisms of Spaces, Section \ref{spaces-morphisms-section-separation-axioms}
for morphisms of formal algebraic spaces.

\begin{definition}
\label{definition-separated-morphism}
Let $S$ be a scheme.
Let $f : X \to Y$ be a morphism of formal algebraic spaces over $S$.
Let $\Delta_{X/Y} : X \to X \times_Y X$ be the diagonal morphism.
\begin{enumerate}
\item We say $f$ is {\it separated} if $\Delta_{X/Y}$ is a closed immersion.
\item We say $f$ is {\it quasi-separated} if $\Delta_{X/Y}$ is quasi-compact.
\end{enumerate}
\end{definition}

\noindent
Since $\Delta_{X/Y}$ is representable (by schemes) by
Lemma \ref{lemma-diagonal-morphism-formal-algebraic-spaces}
we can test this by considering morphisms $T \to X \times_Y X$
from affine schemes $T$ and checking whether
$$
E = T \times_{X \times_Y X} X \longrightarrow T
$$
is quasi-compact or a closed immersion, see
Lemma \ref{lemma-quasi-compact-representable} or
Definition \ref{definition-closed-immersion}.
Note that the scheme $E$ is the equalizer of two morphisms
$a, b : T \to X$ which agree as morphisms into $Y$
and that $E \to T$ is a monomorphism and locally of finite type.

\begin{lemma}
\label{lemma-base-change-separated}
All of the separation axioms listed in
Definition \ref{definition-separated-morphism}
are stable under base change.
\end{lemma}

\begin{proof}
Let $f : X \to Y$ and $Y' \to Y$ be morphisms of formal algebraic spaces.
Let $f' : X' \to Y'$ be the base change of $f$ by $Y' \to Y$. Then
$\Delta_{X'/Y'}$ is the base change of $\Delta_{X/Y}$ by
the morphism $X' \times_{Y'} X' \to X \times_Y X$. Each of the properties
of the diagonal used in Definition \ref{definition-separated-morphism}
is stable under base change. Hence the lemma is true.
\end{proof}

\begin{lemma}
\label{lemma-fibre-product-after-map}
Let $S$ be a scheme. Let $f : X \to Z$, $g : Y \to Z$ and $Z \to T$
be morphisms of formal algebraic spaces over $S$. Consider the induced
morphism $i : X \times_Z Y \to X \times_T Y$. Then
\begin{enumerate}
\item $i$ is representable (by schemes), locally of finite type,
locally quasi-finite, separated, and a monomorphism,
\item if $Z \to T$ is separated, then $i$ is a closed immersion, and
\item if $Z \to T$ is quasi-separated, then $i$ is quasi-compact.
\end{enumerate}
\end{lemma}

\begin{proof}
By general category theory the following diagram
$$
\xymatrix{
X \times_Z Y \ar[r]_i \ar[d] & X \times_T Y \ar[d] \\
Z \ar[r]^-{\Delta_{Z/T}} \ar[r] & Z \times_T Z
}
$$
is a fibre product diagram. Hence $i$ is the base change of the
diagonal morphism $\Delta_{Z/T}$. Thus the lemma follows
from Lemma \ref{lemma-diagonal-morphism-formal-algebraic-spaces}.
\end{proof}

\begin{lemma}
\label{lemma-composition-separated}
All of the separation axioms listed in
Definition \ref{definition-separated-morphism}
are stable under composition of morphisms.
\end{lemma}

\begin{proof}
Let $f : X \to Y$ and $g : Y \to Z$ be morphisms of formal algebraic spaces
to which the axiom in question applies.
The diagonal $\Delta_{X/Z}$ is the composition
$$
X \longrightarrow X \times_Y X \longrightarrow X \times_Z X.
$$
Our separation axiom is defined by requiring the diagonal
to have some property $\mathcal{P}$. By
Lemma \ref{lemma-fibre-product-after-map} above we see that
the second arrow also has this property. Hence the lemma follows
since the composition of (representable) morphisms with property
$\mathcal{P}$ also is a morphism with property $\mathcal{P}$.
\end{proof}

\begin{lemma}
\label{lemma-separated-local}
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of formal algebraic spaces
over $S$. Let $\mathcal{P}$ be any of the separation axioms of
Definition \ref{definition-separated-morphism}.
The following are equivalent
\begin{enumerate}
\item $f$ is $\mathcal{P}$,
\item for every scheme $Z$ and morphism $Z \to Y$ the
base change $Z \times_Y X \to Z$ of $f$ is $\mathcal{P}$,
\item for every affine scheme $Z$ and every morphism $Z \to Y$ the
base change $Z \times_Y X \to Z$ of $f$ is $\mathcal{P}$,
\item for every affine scheme $Z$ and every morphism $Z \to Y$ the
formal algebraic space $Z \times_Y X$ is $\mathcal{P}$ (see
Definition \ref{definition-separated}),
\item there exists a covering $\{Y_j \to Y\}$ as in
Definition \ref{definition-formal-algebraic-space}
such that the base change $Y_j \times_Y X \to Y_j$ has
$\mathcal{P}$ for all $j$.
\end{enumerate}
\end{lemma}

\begin{proof}
We will repeatedly use
Lemma \ref{lemma-base-change-separated}
without further mention. In particular, it is clear that
(1) implies (2) and (2) implies (3).

\medskip\noindent
Assume (3) and let $Z \to Y$ be a morphism where $Z$ is an affine scheme.
Let $U$, $V$ be affine schemes and let $a : U \to Z \times_Y X$
and $b : V \to Z \times_Y X$ be morphisms. Then
$$
U \times_{Z \times_Y X} V =
(Z \times_Y X) \times_{\Delta, (Z \times_Y X) \times_Z (Z \times_Y X)}
(U \times_Z V)
$$
and we see that this is quasi-compact if $\mathcal{P} =$``quasi-separated''
or an affine scheme equipped with a closed immersion into
$U \times_Z V$ if $\mathcal{P} =$``separated''. Thus (4) holds.

\medskip\noindent
Assume (4) and let $Z \to Y$ be a morphism where $Z$ is an affine scheme.
Let $U$, $V$ be affine schemes and let $a : U \to Z \times_Y X$
and $b : V \to Z \times_Y X$ be morphisms. Reading the argument above
backwards, we see that $U \times_{Z \times_Y X} V \to U \times_Z V$
is quasi-compact if $\mathcal{P} =$``quasi-separated'' or a closed
immersion if $\mathcal{P} =$``separated''. Since we can choose $U$ and
$V$ as above such that $U$ varies through an
\'etale covering of $Z \times_Y X$, we find
that the corresponding morphisms
$$
U \times_Z V \to (Z \times_Y X) \times_Z (Z \times_Y X)
$$
form an \'etale covering by affines. Hence we conclude that
$\Delta : (Z \times_Y X) \to (Z \times_Y X) \times_Z (Z \times_Y X)$
is quasi-compact, resp.\ a closed immersion. Thus (3) holds.

\medskip\noindent
Let us prove that (3) implies (5). Assume (3) and let
$\{Y_j \to Y\}$ be as in
Definition \ref{definition-formal-algebraic-space}.
We have to show that the morphisms
$$
\Delta_j :
Y_j \times_Y X
\longrightarrow
(Y_j \times_Y X) \times_{Y_j} (Y_j \times_Y X) =
Y_j \times_Y X \times_Y X
$$
has the corresponding property (i.e., is quasi-compact or a closed immersion).
Write $Y_j = \colim Y_{j, \lambda}$ as in
Definition \ref{definition-affine-formal-algebraic-space}.
Replacing $Y_j$ by $Y_{j, \lambda}$ in the formula above, we have the
property by our assumption that (3) holds. Since the displayed arrow
is the colimit of the arrows $\Delta_{j, \lambda}$ and since we
can test whether $\Delta_j$ has the corresponding property by
testing after base change by affine schemes mapping into
$Y_j \times_Y X \times_Y X$, we conclude by
Lemma \ref{lemma-factor-through-thickening}.

\medskip\noindent
Let us prove that (5) implies (1). Let $\{Y_j \to Y\}$ be as in (5).
Then we have the fibre product diagram
$$
\xymatrix{
\coprod Y_j \times_Y X \ar[r] \ar[d] &
X \ar[d] \\
\coprod Y_j \times_Y X \times_Y X \ar[r] &
X \times_Y X
}
$$
By assumption the left vertical arrow is quasi-compact or a closed immersion.
It follows from
Spaces, Lemma \ref{spaces-lemma-descent-representable-transformations-property}
that also the right vertical arrow is quasi-compact or a
closed immersion.
\end{proof}







\section{Proper morphisms}
\label{section-proper}

\noindent
Here is the definition we will use.

\begin{definition}
\label{definition-proper}
Let $S$ be a scheme. Let $f : Y \to X$ be a morphism of formal algebraic
spaces over $S$. We say $f$ is {\it proper}
if $f$ is representable by algebraic spaces and is proper in the sense of
Bootstrap, Definition \ref{bootstrap-definition-property-transformation}.
\end{definition}

\noindent
It follows from the definitions that a proper morphism is of finite type.

\begin{lemma}
\label{lemma-proper-local}
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of formal algebraic spaces
over $S$. The following are equivalent
\begin{enumerate}
\item $f$ is proper,
\item for every scheme $Z$ and morphism $Z \to Y$ the
base change $Z \times_Y X \to Z$ of $f$ is proper,
\item for every affine scheme $Z$ and every morphism $Z \to Y$ the
base change $Z \times_Y X \to Z$ of $f$ is proper,
\item for every affine scheme $Z$ and every morphism $Z \to Y$ the
formal algebraic space $Z \times_Y X$ is an algebraic space proper over $Z$,
\item there exists a covering $\{Y_j \to Y\}$ as in
Definition \ref{definition-formal-algebraic-space}
such that the base change $Y_j \times_Y X \to Y_j$ is proper for all $j$.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}





\section{Formal algebraic spaces and fpqc coverings}
\label{section-fpqc}

\noindent
This section is the analogue of Properties of Spaces, Section
\ref{spaces-properties-section-fpqc}. Please read that section
first.

\begin{lemma}
\label{lemma-sheaf-fpqc}
Let $S$ be a scheme. Let $X$ be a formal algebraic space over $S$. Then
$X$ satisfies the sheaf property for the fpqc topology.
\end{lemma}

\begin{proof}
The proof is {\bf identical} to the proof of
Properties of Spaces, Proposition
\ref{spaces-properties-proposition-sheaf-fpqc}.
Since $X$ is a sheaf for the Zariski topology it
suffices to show the following. Given a surjective
flat morphism of affines $f : T' \to T$ we have:
$X(T)$ is the equalizer of the two maps $X(T') \to X(T' \times_T T')$.
See Topologies, Lemma \ref{topologies-lemma-sheaf-property-fpqc}.

\medskip\noindent
Let $a, b : T \to X$ be two morphisms such that $a \circ f = b \circ f$.
We have to show $a = b$. Consider the fibre product
$$
E = X \times_{\Delta_{X/S}, X \times_S X, (a, b)} T.
$$
By Lemma \ref{lemma-diagonal-formal-algebraic-space}
the morphism $\Delta_{X/S}$ is a representable monomorphism. Hence
$E \to T$ is a monomorphism of schemes. Our assumption that
$a \circ f = b \circ f$ implies that $T' \to T$ factors (uniquely) through $E$.
Consider the commutative diagram
$$
\xymatrix{
T' \times_T E \ar[r] \ar[d] & E \ar[d] \\
T' \ar[r] \ar@/^5ex/[u] \ar[ru] & T
}
$$
Since the projection $T' \times_T E \to T'$ is a monomorphism
with a section we conclude it is an isomorphism. Hence we conclude that
$E \to T$ is an isomorphism by
Descent, Lemma \ref{descent-lemma-descending-property-isomorphism}.
This means $a = b$ as desired.

\medskip\noindent
Next, let $c : T' \to X$ be a morphism such that the two compositions
$T' \times_T T' \to T' \to X$ are the same. We have to find a morphism
$a : T \to X$ whose composition with $T' \to T$ is $c$. Choose a
formal affine scheme $U$ and an \'etale morphism $U \to X$ such that the image
of $|U| \to |X_{red}|$ contains the image of $|c| : |T'| \to |X_{red}|$.
This is possible by
Definition \ref{definition-formal-algebraic-space},
Properties of Spaces, Lemma \ref{spaces-properties-lemma-topology-points},
the fact that a finite union of formal affine algebraic spaces is a
formal affine algebraic space, and the fact that $|T'|$ is quasi-compact
(small argument omitted). The morphism $U \to X$ is representable
by schemes (Lemma \ref{lemma-presentation-representable}) and
separated (Lemma \ref{lemma-separated-from-separated}). Thus
$$
V = U \times_{X, c} T' \longrightarrow T'
$$
is an \'etale and separated morphism of schemes. It is also surjective
by our choice of $U \to X$ (if you do not want to argue this you can
replace $U$ by a disjoint union of formal affine algebraic spaces so that
$U \to X$ is surjective everything else still works as well). The fact that
$c \circ \text{pr}_0 = c \circ \text{pr}_1$ means that we obtain a
descent datum on $V/T'/T$
(Descent, Definition \ref{descent-definition-descent-datum})
because
\begin{align*}
V \times_{T'} (T' \times_T T')
& =
U \times_{X, c \circ \text{pr}_0} (T' \times_T T') \\
& =
(T' \times_T T') \times_{c \circ \text{pr}_1, X} U \\
& =
(T' \times_T T') \times_{T'} V
\end{align*}
The morphism $V \to T'$ is ind-quasi-affine by
More on Morphisms, Lemma
\ref{more-morphisms-lemma-etale-separated-ind-quasi-affine}
(because \'etale morphisms are locally quasi-finite, see
Morphisms, Lemma \ref{morphisms-lemma-etale-locally-quasi-finite}).
By More on Groupoids, Lemma \ref{more-groupoids-lemma-ind-quasi-affine}
the descent datum is effective. Say $W \to T$ is a morphism
such that there is an isomorphism $\alpha : T' \times_T W \to V$
compatible with the given descent datum on $V$ and the canonical descent
datum on $T' \times_T W$. Then $W \to T$ is surjective and \'etale
(Descent, Lemmas \ref{descent-lemma-descending-property-surjective} and
\ref{descent-lemma-descending-property-etale}).
Consider the composition
$$
b' : T' \times_T W \longrightarrow V = U \times_{X, c} T' \longrightarrow U
$$
The two compositions
$b' \circ (\text{pr}_0, 1), 
b' \circ (\text{pr}_1, 1) :
(T' \times_T T') \times_T W \to T' \times_T W \to U$
agree by our choice of $\alpha$ and the corresponding property of $c$
(computation omitted). Hence $b'$ descends to a morphism $b : W \to U$ by
Descent, Lemma \ref{descent-lemma-fpqc-universal-effective-epimorphisms}.
The diagram
$$
\xymatrix{
T' \times_T W \ar[r] \ar[d] & W \ar[r]_b & U \ar[d] \\
T' \ar[rr]^c &  & X
}
$$
is commutative. What this means is that we have proved the existence
of $a$ \'etale locally on $T$, i.e., we have an $a' : W \to X$.
However, since we have proved uniqueness
in the first paragraph, we find that this \'etale local solution
satisfies the glueing condition, i.e., we have
$\text{pr}_0^*a' = \text{pr}_1^*a'$ as elements of $X(W \times_T W)$.
Since $X$ is an \'etale sheaf we find an unique $a \in X(T)$ restricting
to $a'$ on $W$.
\end{proof}





\section{Maps out of affine formal schemes}
\label{section-map-out-of}

\noindent
We prove a few results that will be useful later.
In the paper \cite{Bhatt-Algebraize} the reader can find
very general results of a similar nature.

\begin{lemma}
\label{lemma-map-into-affine}
Let $S$ be a scheme. Let $A$ be a weakly admissible topological
$S$-algebra. Let $X$ be an affine scheme over $S$. Then
the natural map
$$
\Mor_S(\Spec(A), X)
\longrightarrow
\Mor_S(\text{Spf}(A), X)
$$
is bijective.
\end{lemma}

\begin{proof}
If $X$ is affine, say $X = \Spec(B)$, then we see from
Lemma \ref{lemma-morphism-between-formal-spectra}
that morphisms $\text{Spf}(A) \to \Spec(B)$ correspond to continuous
$S$-algebra maps $B \to A$ where $B$ has the discrete topology.
These are just $S$-algebra maps, which correspond to morphisms
$\Spec(A) \to \Spec(B)$.
\end{proof}

\begin{lemma}
\label{lemma-map-into-scheme}
Let $S$ be a scheme. Let $A$ be a weakly admissible topological
$S$-algebra such that $A/I$ is a local ring for some weak ideal
of definition $I \subset A$. Let $X$ be a scheme over $S$. Then
the natural map
$$
\Mor_S(\Spec(A), X)
\longrightarrow
\Mor_S(\text{Spf}(A), X)
$$
is bijective.
\end{lemma}

\begin{proof}
Let $\varphi : \text{Spf}(A) \to X$ be a morphism. Since $\Spec(A/I)$
is local we see that $\varphi$ maps $\Spec(A/I)$ into an affine
open $U \subset X$. However, this then implies that $\Spec(A/J)$
maps into $U$ for every ideal of definition $J$. Hence we may
apply Lemma \ref{lemma-map-into-affine} to see that $\varphi$ comes
from a morphism $\Spec(A) \to X$. This proves surjectivity of the map.
We omit the proof of injectivity.
\end{proof}

\begin{lemma}
\label{lemma-map-into-algebraic-space}
Let $S$ be a scheme. Let $R$ be a complete local Noetherian $S$-algebra.
Let $X$ be an algebraic space over $S$. Then the natural map
$$
\Mor_S(\Spec(R), X)
\longrightarrow
\Mor_S(\text{Spf}(R), X)
$$
is bijective.
\end{lemma}

\begin{proof}
Let $\mathfrak m$ be the maximal ideal of $R$. We have to show that
$$
\Mor_S(\Spec(R), X) \longrightarrow \lim \Mor_S(\Spec(R/\mathfrak m^n), X)
$$
is bijective for $R$ as above.

\medskip\noindent
Injectivity: Let $x, x' : \Spec(R) \to X$
be two morphisms mapping to the same element in the right hand side.
Consider the fibre product
$$
T = \Spec(R) \times_{(x, x'), X \times_S X, \Delta} X
$$
Then $T$ is a scheme and $T \to \Spec(R)$ is locally of finite type,
monomorphism, separated, and locally quasi-finite, see
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-properties-diagonal}.
In particular $T$ is locally Noetherian, see
Morphisms, Lemma \ref{morphisms-lemma-finite-type-noetherian}.
Let $t \in T$ be the unique point mapping to the closed point of $\Spec(R)$
which exists as $x$ and $x'$ agree over $R/\mathfrak m$. Then
$R \to \mathcal{O}_{T, t}$ is a local ring map of Noetherian rings such that
$R/\mathfrak m^n \to \mathcal{O}_{T, t}/\mathfrak m^n\mathcal{O}_{T, t}$
is an isomorphism for all $n$ (because $x$ and $x'$ agree over
$\Spec(R/\mathfrak m^n)$ for all $n$). Since $\mathcal{O}_{T, t}$
maps injectively into its completion (see
Algebra, Lemma \ref{algebra-lemma-intersect-powers-ideal-module-zero})
we conclude that $R = \mathcal{O}_{T, t}$. Hence $x$ and $x'$ agree
over $R$.

\medskip\noindent
Surjectivity: Let $(x_n)$ be an element of the right hand side.
Choose a scheme $U$ and a surjective \'etale morphism $U \to X$. 
Denote $x_0 : \Spec(k) \to X$ the morphism induced on the residue field
$k = R/\mathfrak m$. The morphism of schemes
$U \times_{X, x_0} \Spec(k) \to \Spec(k)$ is surjective \'etale.
Thus $U \times_{X, x_0} \Spec(k)$ is a nonempty disjoint union of spectra
of finite separable field extensions of $k$, see
Morphisms, Lemma \ref{morphisms-lemma-etale-over-field}.
Hence we can find a finite separable field extension $k \subset k'$
and a $k'$-point $u_0 : \Spec(k') \to U$ such that
$$
\xymatrix{
\Spec(k') \ar[d] \ar[r]_-{u_0} & U \ar[d] \\
\Spec(k) \ar[r]^-{x_0} & X
}
$$
commutes. Let $R \subset R'$ be the finite \'etale extension of Noetherian
complete local rings which induces $k \subset k'$ on residue fields
(see Algebra, Lemmas \ref{algebra-lemma-henselian-cat-finite-etale} and
\ref{algebra-lemma-complete-henselian}). Denote $x'_n$ the restriction
of $x_n$ to $\Spec(R'/\mathfrak m^nR')$. By
More on Morphisms of Spaces, Lemma
\ref{spaces-more-morphisms-lemma-etale-formally-etale}
we can find an element
$(u'_n) \in \lim \Mor_S(\Spec(R'/\mathfrak m^nR'), U)$
mapping to $(x'_n)$. By Lemma \ref{lemma-map-into-scheme}
the family $(u'_n)$ comes from a unique
morphism $u' : \Spec(R') \to U$. Denote $x' : \Spec(R') \to X$ the
composition. Note that $R' \otimes_R R'$ is a finite product of spectra of
Noetherian complete local rings to which our current discussion applies.
Hence the diagram
$$
\xymatrix{
\Spec(R' \otimes_R R') \ar[r] \ar[d] & \Spec(R') \ar[d]^{x'} \\
\Spec(R') \ar[r]^{x'} & X
}
$$
is commutative by the injectivity shown above and the fact that
$x'_n$ is the restriction of $x_n$ which is defined over $R/\mathfrak m^n$.
Since $\{\Spec(R') \to \Spec(R)\}$ is an fppf covering we conclude
that $x'$ descends to a morphism $x : \Spec(R) \to X$.
We omit the proof that $x_n$ is the restriction of $x$ to
$\Spec(R/\mathfrak m^n)$.
\end{proof}







\section{The small \'etale site of a formal algebraic space}
\label{section-etale-sites}

\noindent
The motivation for the following definition comes from classical
formal schemes: the underlying topological space of a formal scheme
$(\mathfrak X, \mathcal{O}_\mathfrak X)$
is the underlying topological space of the reduction $\mathfrak X_{red}$.

\medskip\noindent
An important remark is the following. Suppose that $X$ is an algebraic space
with reduction $X_{red}$ (Properties of Spaces, Definition
\ref{spaces-properties-definition-reduced-induced-space}).
Then we have
$$
X_{spaces, \etale} = X_{red, spaces, \etale},\quad
X_\etale = X_{red, \etale},\quad
X_{affine, \etale} = X_{red, affine, \etale}
$$
by More on Morphisms of Spaces, Theorem
\ref{spaces-more-morphisms-theorem-topological-invariance} and
Lemma \ref{spaces-more-morphisms-lemma-topological-invariance}.
Therefore the following definition does not conflict with the already
existing notion in case our formal algebraic space happens to be
an algebraic space.

\begin{definition}
\label{definition-etale-sites}
Let $S$ be a scheme. Let $X$ be a formal algebraic space with
reduction $X_{red}$ (Lemma \ref{lemma-reduction-formal-algebraic-space}).
\begin{enumerate}
\item The {\it small \'etale site} $X_\etale$ of $X$ is
the site $X_{red, \etale}$ of Properties of Spaces, Definition
\ref{spaces-properties-definition-etale-site}.
\item The site $X_{spaces, \etale}$ is the site
$X_{red, spaces, \etale}$ of Properties of Spaces, Definition
\ref{spaces-properties-definition-spaces-etale-site}.
\item The site $X_{affine, \etale}$ is the site
$X_{red, affine, \etale}$ of Properties of Spaces, Lemma
\ref{spaces-properties-lemma-alternative}.
\end{enumerate}
\end{definition}

\noindent
In Lemma \ref{lemma-identify-spaces-etale} we will see that
$X_{spaces, \etale}$ can be described by in terms of
morphisms of formal algebraic spaces which are representable
by algebraic spaces and \'etale.
By Properties of Spaces, Lemmas
\ref{spaces-properties-lemma-compare-etale-sites} and
\ref{spaces-properties-lemma-alternative}
we have identifications
\begin{equation}
\label{equation-etale-topos}
\Sh(X_\etale) = \Sh(X_{spaces, \etale}) = \Sh(X_{affine, \etale})
\end{equation}
We will call this the {\it (small) \'etale topos} of $X$.

\begin{lemma}
\label{lemma-functoriality-etale-site}
Let $S$ be a scheme.
Let $f : X \to Y$ be a morphism of formal algebraic spaces over $S$.
\begin{enumerate}
\item There is a continuous functor
$Y_{spaces, \etale} \to X_{spaces, \etale}$
which induces a morphism of sites
$$
f_{spaces, \etale} : X_{spaces, \etale} \to Y_{spaces, \etale}.
$$
\item The rule $f \mapsto f_{spaces, \etale}$ is compatible with
compositions, in other words $(f \circ g)_{spaces, \etale}
= f_{spaces, \etale} \circ g_{spaces, \etale}$ (see
Sites, Definition \ref{sites-definition-composition-morphisms-sites}).
\item The morphism of topoi associated to $f_{spaces, \etale}$
induces, via (\ref{equation-etale-topos}), a morphism of topoi
$f_{small} : \Sh(X_\etale) \to \Sh(Y_\etale)$
whose construction is compatible with compositions.
\end{enumerate}
\end{lemma}

\begin{proof}
The only point here is that $f$ induces a morphism of reductions
$X_{red} \to Y_{red}$ by Lemma \ref{lemma-reduction-formal-algebraic-space}.
Hence this lemma is immediate from the corresponding lemma for
morphisms of algebraic spaces (Properties of Spaces,
Lemma \ref{spaces-properties-lemma-functoriality-etale-site}).
\end{proof}

\noindent
If the morphism of formal algebraic spaces $X \to Y$ is \'etale,
then the morphism of topoi $\Sh(X_\etale) \to \Sh(Y_\etale)$
is a localization. Here is a statement.

\begin{lemma}
\label{lemma-etale-morphism-topoi}
Let $S$ be a scheme, and let $f : X \to Y$ be a morphism of
formal algebraic spaces over $S$. Assume $f$ is representable
by algebraic spaces and \'etale. In this case there is a
cocontinuous functor $j : X_\etale \to Y_\etale$.
The morphism of topoi $f_{small}$ is the
morphism of topoi associated to $j$, see
Sites, Lemma \ref{sites-lemma-cocontinuous-morphism-topoi}.
Moreover, $j$ is continuous as well, hence
Sites, Lemma \ref{sites-lemma-when-shriek} applies.
\end{lemma}

\begin{proof}
This will follow immediately from the case of algebraic spaces
(Properties of Spaces, Lemma
\ref{spaces-properties-lemma-etale-morphism-topoi})
if we can show that the induced morphism $X_{red} \to Y_{red}$
is \'etale. Observe that $X \times_Y Y_{red}$ is an
algebraic space, \'etale over the reduced algebraic space $Y_{red}$,
and hence reduced itself (by our definition of reduced algebraic
spaces in Properties of Spaces, Section
\ref{spaces-properties-section-types-properties}.
Hence $X_{red} = X \times_Y Y_{red}$ as desired.
\end{proof}

\begin{lemma}
\label{lemma-affine-identify-affine-etale}
Let $S$ be a scheme. Let $X$ be an affine formal algebraic space over $S$.
Then $X_{affine, \etale}$ is equivalent to the category whose objects
are morphisms $\varphi : U \to X$ of formal algebraic spaces such that
\begin{enumerate}
\item $U$ is an affine formal algebraic space,
\item $\varphi$ is representable by algebraic spaces and \'etale.
\end{enumerate}
\end{lemma}

\begin{proof}
Denote $\mathcal{C}$ the category introduced in the lemma.
Observe that for $\varphi : U \to X$ in $\mathcal{C}$ the
morphism $\varphi$ is representable (by schemes) and affine, see
Lemma \ref{lemma-affine-representable-by-algebraic-spaces}.
Recall that $X_{affine, \etale} = X_{red, affine, \etale}$.
Hence we can define a functor
$$
\mathcal{C} \longrightarrow X_{affine, \etale},\quad
(U \to X) \longmapsto U \times_X X_{red}
$$
because $U \times_X X_{red}$ is an affine scheme.

\medskip\noindent
To finish the proof we will construct a quasi-inverse.
Namely, write $X = \colim X_\lambda$ as in
Definition \ref{definition-affine-formal-algebraic-space}.
For each $\lambda$ we have $X_{red} \subset X_\lambda$
is a thickening. Thus for every $\lambda$ we have an
equivalence
$$
X_{red, affine, \etale} = X_{\lambda, affine, \etale}
$$
for example by
More on Algebra, Lemma \ref{more-algebra-lemma-locally-nilpotent-henselian}.
Hence if $U_{red} \to X_{red}$ is an \'etale morphism with
$U_{red}$ affine, then we obtain a system of \'etale morphisms
$U_\lambda \to X_\lambda$ of affine schemes compatible with the
transition morphisms in the system defining $X$. Hence we can take
$$
U = \colim U_\lambda
$$
as our affine formal algebraic space over $X$. The construction gives that
$U \times_X X_\lambda = U_\lambda$. This shows that $U \to X$ is
representable and \'etale. We omit the verification that the constructions
are mutually inverse to each other.
\end{proof}

\begin{lemma}
\label{lemma-affine-etale-mcquillan}
Let $S$ be a scheme. Let $X$ be an affine formal
algebraic space over $S$. Assume $X$ is McQuillan, i.e.,
equal to $\text{Spf}(A)$ for some
weakly admissible topological $S$-algebra $A$.
Then $(X_{affine, \etale})^{opp}$ is equivalent to
the category whose
\begin{enumerate}
\item objects are $A$-algebras of the form
$B^\wedge = \lim B/JB$ where $A \to B$ is an \'etale ring map
and $J$ runs over the weak ideals of definition of $A$, and
\item morphisms are continuous $A$-algebra homomorphisms.
\end{enumerate}
\end{lemma}

\begin{proof}
Combine Lemmas \ref{lemma-affine-identify-affine-etale} and \ref{lemma-etale}.
\end{proof}

\begin{lemma}
\label{lemma-identify-spaces-etale}
Let $S$ be a scheme. Let $X$ be a formal algebraic space over $S$.
Then $X_{spaces, \etale}$ is equivalent to the category whose objects
are morphisms $\varphi : U \to X$ of formal algebraic spaces such that
$\varphi$ is representable by algebraic spaces and \'etale.
\end{lemma}

\begin{proof}
Denote $\mathcal{C}$ the category introduced in the lemma.
Recall that $X_{spaces, \etale} = X_{red, spaces, \etale}$.
Hence we can define a functor
$$
\mathcal{C} \longrightarrow X_{spaces, \etale},\quad
(U \to X) \longmapsto U \times_X X_{red}
$$
because $U \times_X X_{red}$ is an algebraic space \'etale over $X_{red}$.

\medskip\noindent
To finish the proof we will construct a quasi-inverse.
Choose an object $\psi : V \to X_{red}$ of $X_{red, spaces, \etale}$.
Consider the functor
$U_{V, \psi} : (\Sch/S)_{fppf} \to \textit{Sets}$ given by
$$
U_{V, \psi}(T) = \{(a, b) \mid
a : T \to X,
\ b : T \times_{a, X} X_{red} \to V,
\ \psi \circ b = a|_{T \times_{a, X} X_{red}}\}
$$
We claim that the transformation $U_{V, \psi} \to X$, $(a, b) \mapsto a$
defines an object of the category $\mathcal{C}$.
First, let's prove that $U_{V, \psi}$ is a formal algebraic space.
Observe that $U_{V, \psi}$ is a sheaf for the fppf topology (some details
omitted). Next, suppose that $X_i \to X$ is an \'etale covering by
affine formal algebraic spaces as in
Definition \ref{definition-formal-algebraic-space}.
Set $V_i = V \times_{X_{red}} X_{i, red}$ and denote
$\psi_i : V_i \to X_{i, red}$ the projection. Then 
we have
$$
U_{V, \psi} \times_X X_i = U_{V_i, \psi_i}
$$
by a formal argument because $X_{i, red} = X_i \times_X X_{red}$
(as $X_i \to X$ is representable by algebraic spaces and \'etale).
Hence it suffices to show that $U_{V_i, \psi_i}$ is an
affine formal algebraic space, because then we will have
a covering $U_{V_i, \psi_i} \to U_{V, \psi}$ as in
Definition \ref{definition-formal-algebraic-space}.
On the other hand, we have seen in the proof of
Lemma \ref{lemma-etale-morphism-topoi}
that $\psi_i : V_i \to X_i$ is the base
change of a representable and \'etale morphism
$U_i \to X_i$ of affine formal algebraic spaces.
Then it is not hard to see that $U_i = U_{V_i, \psi_i}$
as desired.

\medskip\noindent
We omit the verification that $U_{V, \psi} \to X$
is representable by algebraic spaces and \'etale.
Thus we obtain our functor $(V, \psi) \mapsto (U_{V, \psi} \to X)$
in the other direction.
We omit the verification that the constructions
are mutually inverse to each other.
\end{proof}

\begin{lemma}
\label{lemma-identify-affine-etale}
Let $S$ be a scheme. Let $X$ be a formal algebraic space over $S$.
Then $X_{affine, \etale}$ is equivalent to the category whose objects
are morphisms $\varphi : U \to X$ of formal algebraic spaces such that
\begin{enumerate}
\item $U$ is an affine formal algebraic space,
\item $\varphi$ is representable by algebraic spaces and \'etale.
\end{enumerate}
\end{lemma}

\begin{proof}
This follows by combining Lemmas \ref{lemma-identify-spaces-etale} and
\ref{lemma-characterize-affine}.
\end{proof}






\section{The structure sheaf}
\label{section-structure-sheaf}

\noindent
Let $X$ be a formal algebraic space. A structure sheaf for $X$
is a sheaf of topological rings $\mathcal{O}_X$ on the \'etale site
$X_\etale$ (which we defined in Section \ref{section-etale-sites}) such that
$$
\mathcal{O}_X(U_{red}) = \lim \Gamma(U_\lambda, \mathcal{O}_{U_\lambda})
$$
as topological rings whenever
\begin{enumerate}
\item $\varphi : U \to X$ is a morphism of formal algebraic spaces,
\item $U$ is an affine formal algebraic space,
\item $\varphi$ is representable by algebraic spaces and \'etale,
\item $U_{red} \to X_{red}$ is the corresponding affine object of
$X_\etale$, see
Lemma \ref{lemma-identify-affine-etale},
\item $U = \colim U_\lambda$ is a colimit representation for $U$ as in
Definition \ref{definition-affine-formal-algebraic-space}.
\end{enumerate}
Structure sheaves exist but may behave in unexpected manner.

\begin{lemma}
\label{lemma-structure-sheaf}
Every formal algebraic space has a structure sheaf.
\end{lemma}

\begin{proof}
Let $S$ be a scheme. Let $X$ be a formal algebraic space over $S$.
By (\ref{equation-etale-topos}) it suffices to construct $\mathcal{O}_X$
as a sheaf of topological rings on $X_{affine, \etale}$.
Denote $\mathcal{C}$ the category whose objects
are morphisms $\varphi : U \to X$ of formal algebraic spaces such that
$U$ is an affine formal algebraic space and
$\varphi$ is representable by algebraic spaces and \'etale.
By Lemma \ref{lemma-identify-affine-etale}
the functor $U \mapsto U_{red}$ is an equivalence of categories
$\mathcal{C} \to X_{affine, \etale}$. Hence by the rule given
above the lemma, we already have $\mathcal{O}_X$ as a presheaf of
topological rings on $X_{affine, \etale}$. Thus it suffices to check
the sheaf condition.

\medskip\noindent
By definition of $X_{affine, \etale}$ a covering corresponds to a finite
family $\{g_i : U_i \to U\}_{i = 1, \ldots, n}$ of morphisms of $\mathcal{C}$
such that $\{U_{i, red} \to U_{red}\}$ is an \'etale covering.
The morphisms $g_i$ are representably by algebraic spaces
(Lemma \ref{lemma-permanence-representable}) hence affine
(Lemma \ref{lemma-affine-representable-by-algebraic-spaces}).
Then $g_i$ is \'etale (follows formally from
Properties of Spaces, Lemma \ref{spaces-properties-lemma-etale-permanence}
as $U_i$ and $U$ are \'etale over $X$ in the sense of
Bootstrap, Section \ref{bootstrap-section-representable-by-spaces-properties}).
Finally, write $U = \colim U_\lambda$ as in
Definition \ref{definition-affine-formal-algebraic-space}.

\medskip\noindent
With these preparations out of the way, we can prove the sheaf
property as follows. For each $\lambda$ we set
$U_{i, \lambda} = U_i \times_U U_\lambda$ and
$U_{ij, \lambda} = (U_i \times_U U_j) \times_U U_\lambda$.
By the above, these are affine schemes, $\{U_{i, \lambda} \to U_\lambda\}$
is an \'etale covering, and
$U_{ij, \lambda} = U_{i, \lambda} \times_{U_\lambda} U_{j, \lambda}$.
Also we have $U_i = \colim U_{i, \lambda}$ and
$U_i \times_U U_j = \colim U_{ij, \lambda}$.
For each $\lambda$ we have an exact sequence
$$
0 \to
\Gamma(U_\lambda, \mathcal{O}_{U_\lambda}) \to
\prod\nolimits_i \Gamma(U_{i, \lambda}, \mathcal{O}_{U_{i, \lambda}}) \to
\prod\nolimits_{i, j} \Gamma(U_{ij, \lambda}, \mathcal{O}_{U_{ij, \lambda}})
$$
as we have the sheaf condition for the structure sheaf
on $U_\lambda$ and the \'etale topology
(see \'Etale Cohomology, Proposition
\ref{etale-cohomology-proposition-quasi-coherent-sheaf-fpqc}).
Since limits commute with limits, the inverse limit of these
exact sequences is an exact sequence
$$
0 \to
\lim \Gamma(U_\lambda, \mathcal{O}_{U_\lambda}) \to
\prod\nolimits_i \lim \Gamma(U_{i, \lambda}, \mathcal{O}_{U_{i, \lambda}}) \to
\prod\nolimits_{i, j} \lim
\Gamma(U_{ij, \lambda}, \mathcal{O}_{U_{ij, \lambda}})
$$
which exactly means that
$$
0 \to
\mathcal{O}_X(U_{red}) \to
\prod\nolimits_i \mathcal{O}_X(U_{i, red}) \to
\prod\nolimits_{i, j} \mathcal{O}_X((U_i \times_U U_j)_{red})
$$
is exact and hence the sheaf propery holds as desired.
\end{proof}

\begin{remark}
\label{remark-not-enough-sections}
The structure sheaf does not always have ``enough sections''.
In Examples, Section \ref{examples-section-affine-formal-algebraic-space}
we have seen that there exist affine formal algebraic spaces which
aren't McQuillan and there are even examples whose points are not
separated by regular functions.
\end{remark}

\noindent
In the next lemma we prove that the structure sheaf on a countably
indexed affine formal scheme has vanishing higher cohomology.
For non-countably indexed ones, presumably this generally doesn't hold.

\begin{lemma}
\label{lemma-higher-vanishing-structure-sheaf}
If $X$ is a countably indexed affine formal algebraic space, then
we have $H^n(X_\etale, \mathcal{O}_X) = 0$ for $n > 0$.
\end{lemma}

\begin{proof}
We may work with $X_{affine, \etale}$ as this gives the same topos.
We will apply Cohomology on Sites, Lemma
\ref{sites-cohomology-lemma-cech-vanish-collection}
to show we have vanishing. Since $X_{affine, \etale}$
has finite disjoint unions, this reduces us to the {\v C}ech
complex of a covering given by a single arrow $\{U_{red} \to V_{red}\}$
in $X_{affine, \etale} = X_{red, affine, \etale}$
(see \'Etale Cohomology, Lemma \ref{etale-cohomology-lemma-cech-complex}).
Thus we have to show that
$$
0 \to \mathcal{O}_X(V_{red}) \to \mathcal{O}_X(U_{red}) \to
\mathcal{O}_X(U_{red} \times_{V_{red}} U_{red}) \to \ldots
$$
is exact. We will do this below in the case $V_{red} = X_{red}$.
The general case is proven in exactly the same way.

\medskip\noindent
Recall that $X = \text{Spf}(A)$ where $A$ is a
weakly admissible topological ring having a countable
fundamental system of weak ideals of definition.
We have seen in Lemmas
\ref{lemma-affine-identify-affine-etale} and
\ref{lemma-affine-etale-mcquillan}
that the object $U_{red}$ in $X_{affine, \etale}$
corresponds to a morphism $U \to X$ of affine formal
algebraic spaces which is representable by algebraic space and \'etale
and $U = \text{Spf}(B^\wedge)$ where $B$ is an \'etale $A$-algebra.
By our rule for the structure sheaf we see
$$
\mathcal{O}_X(U_{red}) = B^\wedge
$$
We recall that $B^\wedge = \lim B/JB$ where the limit is over weak
ideals of definition $J \subset A$.
Working through the definitions we obtain
$$
\mathcal{O}_X(U_{red} \times_{X_{red}} U_{red}) = (B \otimes_A B)^\wedge
$$
and so on. Since $U \to X$ is a covering the map $A \to B$
is faithfully flat, see Lemma \ref{lemma-etale-surjective}.
Hence the complex
$$
0 \to A \to B \to B \otimes_A B \to B \otimes_A B \otimes_A B \to \ldots
$$
is {\bf universally} exact, see Descent, Lemma \ref{descent-lemma-ff-exact}.
Our goal is to show that
$$
H^n(0 \to A^\wedge \to B^\wedge \to (B \otimes_A B)^\wedge
\to (B \otimes_A B \otimes_A B)^\wedge \to \ldots)
$$
is zero for $p > 0$. To see what is going on, let's split our
exact complex (before completion) into short exact sequences
$$
0 \to A \to B \to M_1 \to 0,\quad
0 \to M_i \to B^{\otimes_A i + 1} \to M_{i + 1} \to 0
$$
By what we said above, these are universally exact short exact
sequences. Hence $JM_i = M_i \cap J(B^{\otimes_A i + 1})$ for
every ideal $J$ of $A$. In particular, the
topology on $M_i$ as a submodule of $B^{\otimes_A i + 1}$
is the same as the topology on $M_i$ as a quotient module of
$B^{\otimes_A i}$. Therefore, since there exists a countable fundamental system
of weak ideals of definition in $A$, the sequences
$$
0 \to A^\wedge \to B^\wedge \to M_1^\wedge \to 0,\quad
0 \to M_i^\wedge \to (B^{\otimes_A i + 1})^\wedge \to M_{i + 1}^\wedge \to 0
$$
remain exact by Lemma \ref{lemma-ses}. This proves the lemma.
\end{proof}

\begin{remark}
\label{remark-bad-quasi-coherent}
Even if the structure sheaf has good properties, this does not
mean there is a good theory of quasi-coherent modules. For example,
in Examples, Section \ref{examples-section-nonabelian-QCoh}
we have seen that for almost any Noetherian affine formal algebraic spaces
the most natural notion of a quasi-coherent module leads to a
category of modules which is not abelian.
\end{remark}



\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}

