\input{preamble}

% OK, start here.
%
\begin{document}

\title{Derived Categories}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
We first discuss triangulated categories and localization in triangulated
categories. Next, we prove that the homotopy category of complexes in an
additive category is a triangulated category. Once this is done we define
the derived category of an abelian category as the localization of the
homotopy category with respect to quasi-isomorphisms.
A good reference is Verdier's thesis \cite{Verdier}.



\section{Triangulated categories}
\label{section-triangulated-categories}

\noindent
Triangulated categories are a convenient tool to describe the type
of structure inherent in the derived category of an abelian category.
Some references are \cite{Verdier}, \cite{KS}, and \cite{Neeman}.




\section{The definition of a triangulated category}
\label{section-triangulated-definitions}

\noindent
In this section we collect most of the definitions concerning triangulated
and pre-triangulated categories.

\begin{definition}
\label{definition-triangle}
Let $\mathcal{D}$ be an additive category.
Let $[n] : \mathcal{D} \to \mathcal{D}$, $E \mapsto E[n]$
be a collection of additive functors indexed by $n \in \mathbf{Z}$ such that
$[n] \circ [m] = [n + m]$  and $[0] = \text{id}$ (equality as functors).
In this situation we define a {\it triangle} to be a sextuple
$(X, Y, Z, f, g, h)$ where $X, Y, Z \in \Ob(\mathcal{D})$ and
$f : X \to Y$, $g : Y \to Z$ and $h : Z \to X[1]$ are morphisms
of $\mathcal{D}$.
A {\it morphism of triangles}
$(X, Y, Z, f, g, h) \to (X', Y', Z', f', g', h')$
is given by morphisms $a : X \to X'$, $b : Y \to Y'$ and $c : Z \to Z'$
of $\mathcal{D}$ such that
$b \circ f = f' \circ a$, $c  \circ g = g' \circ b$ and
$a[1] \circ h = h' \circ c$.
\end{definition}

\noindent
A morphism of triangles is visualized by the following
commutative diagram
$$
\xymatrix{
X \ar[r] \ar[d]^a &
Y \ar[r] \ar[d]^b &
Z \ar[r] \ar[d]^c &
X[1] \ar[d]^{a[1]} \\
X' \ar[r] &
Y' \ar[r] &
Z' \ar[r] &
X'[1]
}
$$
Here is the definition of a triangulated category as given in
Verdier's thesis.

\begin{definition}
\label{definition-triangulated-category}
A {\it triangulated category} consists of a triple
$(\mathcal{D}, \{[n]\}_{n\in \mathbf{Z}}, \mathcal{T})$
where
\begin{enumerate}
\item $\mathcal{D}$ is an additive category,
\item $[n] : \mathcal{D} \to \mathcal{D}$, $E \mapsto E[n]$
is a collection of additive functors indexed by $n \in \mathbf{Z}$ such that
$[n] \circ [m] = [n + m]$ and $[0] = \text{id}$ (equality as functors), and
\item $\mathcal{T}$ is a set of triangles called the
{\it distinguished triangles}
\end{enumerate}
subject to the following conditions
\begin{enumerate}
\item[TR1] Any triangle isomorphic to a distinguished triangle is
a distinguished triangle. Any triangle of the form
$(X, X, 0, \text{id}, 0, 0)$ is distinguished.
For any morphism $f : X \to Y$ of $\mathcal{D}$ there exists a
distinguished triangle of the form $(X, Y, Z, f, g, h)$.
\item[TR2] The triangle $(X, Y, Z, f, g, h)$ is distinguished
if and only if the triangle $(Y, Z, X[1], g, h, -f[1])$ is.
\item[TR3] Given a solid diagram
$$
\xymatrix{
X \ar[r]^f \ar[d]^a &
Y \ar[r]^g \ar[d]^b &
Z \ar[r]^h \ar@{-->}[d] &
X[1] \ar[d]^{a[1]} \\
X' \ar[r]^{f'} &
Y' \ar[r]^{g'} &
Z' \ar[r]^{h'} &
X'[1]
}
$$
whose rows are distinguished triangles and which satisfies
$b \circ f = f' \circ a$, there exists a morphism
$c : Z \to Z'$ such that $(a, b, c)$ is a morphism of triangles.
\item[TR4] Given objects $X$, $Y$, $Z$ of $\mathcal{D}$, and morphisms
$f : X \to Y$, $g : Y \to Z$, and distinguished triangles
$(X, Y, Q_1, f, p_1, d_1)$,
$(X, Z, Q_2, g \circ f, p_2, d_2)$,
and
$(Y, Z, Q_3, g, p_3, d_3)$,
there exist
morphisms $a : Q_1 \to Q_2$ and $b : Q_2 \to Q_3$ such
that
\begin{enumerate}
\item $(Q_1, Q_2, Q_3, a, b, p_1[1] \circ d_3)$ is a
distinguished triangle,
\item the triple $(\text{id}_X, g, a)$ is
a morphism of triangles
$(X, Y, Q_1, f, p_1, d_1) \to (X, Z, Q_2, g \circ f, p_2, d_2)$, and
\item the triple $(f, \text{id}_Z, b)$ is a morphism of triangles
$(X, Z, Q_2, g \circ f, p_2, d_2) \to (Y, Z, Q_3, g, p_3, d_3)$.
\end{enumerate}
\end{enumerate}
We will call $(\mathcal{D}, [\ ], \mathcal{T})$ a
{\it pre-triangulated category} if TR1, TR2 and TR3
hold.\footnote{We use $[\ ]$ as an abbreviation for the
family $\{[n]\}_{n\in \mathbf{Z}}$.}
\end{definition}

\noindent
The explanation of TR4 is that if you think of $Q_1$ as
$Y/X$, $Q_2$ as $Z/X$ and $Q_3$ as $Z/Y$, then TR4(a) expresses
the isomorphism $(Z/X)/(Y/X) \cong Z/Y$ and TR4(b) and TR4(c)
express that we can compare the triangles $X \to Y \to Q_1 \to X[1]$
etc with morphisms of triangles. For a more precise reformulation
of this idea see the proof of Lemma \ref{lemma-two-split-injections}.

\medskip\noindent
The sign in TR2 means that if $(X, Y, Z, f, g, h)$ is a distinguished triangle
then in the long sequence
\begin{equation}
\label{equation-rotate}
\ldots \to
Z[-1] \xrightarrow{-h[-1]}
X \xrightarrow{f}
Y \xrightarrow{g}
Z \xrightarrow{h}
X[1] \xrightarrow{-f[1]}
Y[1] \xrightarrow{-g[1]}
Z[1] \to \ldots
\end{equation}
each four term sequence gives a distinguished triangle.

\medskip\noindent
As usual we abuse notation and we simply speak of a (pre-)triangulated
category $\mathcal{D}$ without explicitly introducing notation for the
additional data. The notion of a pre-triangulated category is
useful in finding statements equivalent to TR4.

\medskip\noindent
We have the following definition of a triangulated functor.

\begin{definition}
\label{definition-exact-functor-triangulated-categories}
Let $\mathcal{D}$, $\mathcal{D}'$ be pre-triangulated
categories. An {\it exact functor}, or a {\it triangulated functor}
from $\mathcal{D}$ to $\mathcal{D}'$ is a functor
$F : \mathcal{D} \to \mathcal{D}'$ together
with given functorial isomorphisms $\xi_X : F(X[1]) \to F(X)[1]$
such that for every distinguished triangle
$(X, Y, Z, f, g, h)$ of $\mathcal{D}$ the triangle
$(F(X), F(Y), F(Z), F(f), F(g), \xi_X \circ F(h))$
is a distinguished triangle of $\mathcal{D}'$.
\end{definition}

\noindent
An exact functor is additive, see
Lemma \ref{lemma-exact-functor-additive}.
When we say two triangulated categories are equivalent we mean that
they are equivalent in the $2$-category of triangulated categories.
A $2$-morphism $a : (F, \xi) \to (F', \xi')$ in this $2$-category is
simply a transformation of functors $a : F \to F'$ which is compatible
with $\xi$ and $\xi'$, i.e.,
$$
\xymatrix{
F \circ [1] \ar[r]_\xi \ar[d]_{a \star 1} & [1] \circ F \ar[d]^{1 \star a} \\
F' \circ [1] \ar[r]^{\xi'} & [1] \circ F'
}
$$
commutes.

\begin{definition}
\label{definition-triangulated-subcategory}
Let $(\mathcal{D}, [\ ], \mathcal{T})$ be a pre-triangulated category.
A {\it pre-triangulated subcategory}\footnote{This definition may be
nonstandard. If $\mathcal{D}'$ is a full subcategory then $\mathcal{T}'$
is the intersection of the set of triangles in $\mathcal{D}'$ with
$\mathcal{T}$, see
Lemma \ref{lemma-triangulated-subcategory}.
In this case we drop $\mathcal{T}'$ from the notation.}
is a pair $(\mathcal{D}', \mathcal{T}')$ such that
\begin{enumerate}
\item $\mathcal{D}'$ is an additive subcategory of $\mathcal{D}$
which is preserved under $[1]$ and $[-1]$,
\item $\mathcal{T}' \subset \mathcal{T}$ is a subset such that for every
$(X, Y, Z, f, g, h) \in \mathcal{T}'$ we have
$X, Y, Z \in \Ob(\mathcal{D}')$ and
$f, g, h \in \text{Arrows}(\mathcal{D}')$, and
\item $(\mathcal{D}', [\ ], \mathcal{T}')$ is a pre-triangulated
category.
\end{enumerate}
If $\mathcal{D}$ is a triangulated category, then we say
$(\mathcal{D}', \mathcal{T}')$ is a {\it triangulated subcategory} if
it is a pre-triangulated subcategory and
$(\mathcal{D}', [\ ], \mathcal{T}')$ is a triangulated category.
\end{definition}

\noindent
In this situation the inclusion functor
$\mathcal{D}' \to \mathcal{D}$ is an exact functor
with $\xi_X : X[1] \to X[1]$ given by the identity on $X[1]$.

\medskip\noindent
We will see in
Lemma \ref{lemma-composition-zero}
that for a distinguished triangle $(X, Y, Z, f, g, h)$
in a pre-triangulated category the composition $g \circ f : X \to Z$ is zero.
Thus the sequence (\ref{equation-rotate}) is a complex.
A homological functor is one that turns this complex into a long
exact sequence.

\begin{definition}
\label{definition-homological}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $\mathcal{A}$ be an abelian category.
An additive functor $H : \mathcal{D} \to \mathcal{A}$ is called
{\it homological} if for every distinguished triangle
$(X, Y, Z, f, g, h)$ the sequence
$$
H(X) \to H(Y) \to H(Z)
$$
is exact in the abelian category $\mathcal{A}$. An additive functor
$H : \mathcal{D}^{opp} \to \mathcal{A}$ is called {\it cohomological}
if the corresponding functor $\mathcal{D} \to \mathcal{A}^{opp}$ is
homological.
\end{definition}

\noindent
If $H : \mathcal{D} \to \mathcal{A}$ is a homological functor
we often write $H^n(X) = H(X[n])$ so that $H(X) = H^0(X)$.
Our discussion of TR2 above implies that a distinguished triangle
$(X, Y, Z, f, g, h)$ determines a long exact sequence
\begin{equation}
\label{equation-long-exact-cohomology-sequence}
\xymatrix@C=3pc{
H^{-1}(Z) \ar[r]^{H(h[-1])} &
H^0(X) \ar[r]^{H(f)} &
H^0(Y) \ar[r]^{H(g)} &
H^0(Z) \ar[r]^{H(h)} &
H^1(X)
}
\end{equation}
This will be called the {\it long exact sequence} associated to the
distinguished triangle and the homological functor. As indicated
we will not use any signs for the morphisms in the long exact
sequence. This has the side effect that maps in the long exact sequence
associated to the rotation (TR2) of a distinguished triangle differ
from the maps in the sequence above by some signs.

\begin{definition}
\label{definition-delta-functor}
Let $\mathcal{A}$ be an abelian category.
Let $\mathcal{D}$ be a triangulated category.
A {\it $\delta$-functor from $\mathcal{A}$ to $\mathcal{D}$} is
given by a functor $G : \mathcal{A} \to \mathcal{D}$ and
a rule which assigns to every short exact sequence
$$
0 \to A \xrightarrow{a} B \xrightarrow{b} C \to 0
$$
a morphism $\delta = \delta_{A \to B \to C} : G(C) \to G(A)[1]$
such that
\begin{enumerate}
\item the triangle
$(G(A), G(B), G(C), G(a), G(b), \delta_{A \to B \to C})$
is a distinguished triangle of $\mathcal{D}$
for any short exact sequence as above, and
\item for every morphism $(A \to B \to C) \to (A' \to B' \to C')$
of short exact sequences the diagram
$$
\xymatrix{
G(C) \ar[d] \ar[rr]_{\delta_{A \to B \to C}} & &
G(A)[1] \ar[d] \\
G(C') \ar[rr]^{\delta_{A' \to B' \to C'}} & &
G(A')[1]
}
$$
is commutative.
\end{enumerate}
In this situation we call
$(G(A), G(B), G(C), G(a), G(b), \delta_{A \to B \to C})$
the {\it image of the short exact sequence under the
given $\delta$-functor}.
\end{definition}

\noindent
Note how a $\delta$-functor comes equipped with additional structure.
Strictly speaking it does not make sense to say that a given
functor $\mathcal{A} \to \mathcal{D}$ is a $\delta$-functor, but we
will often do so anyway.












\section{Elementary results on triangulated categories}
\label{section-elementary-results}

\noindent
Most of the results in this section are proved for pre-triangulated categories
and a fortiori hold in any triangulated category.

\begin{lemma}
\label{lemma-composition-zero}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $(X, Y, Z, f, g, h)$ be a distinguished triangle.
Then $g \circ f = 0$,
$h \circ g = 0$ and $f[1] \circ h = 0$.
\end{lemma}

\begin{proof}
By TR1 we know $(X, X, 0, 1, 0, 0)$ is a distinguished triangle.
Apply TR3 to
$$
\xymatrix{
X \ar[r] \ar[d]^1 &
X \ar[r] \ar[d]^f &
0 \ar[r] \ar@{-->}[d] &
X[1] \ar[d]^{1[1]} \\
X \ar[r]^f &
Y \ar[r]^g &
Z \ar[r]^h &
X[1]
}
$$
Of course the dotted arrow is the zero map. Hence the commutativity of
the diagram implies that $g \circ f = 0$. For the other cases
rotate the triangle, i.e., apply TR2.
\end{proof}

\begin{lemma}
\label{lemma-representable-homological}
Let $\mathcal{D}$ be a pre-triangulated category.
For any object $W$ of $\mathcal{D}$ the functor
$\Hom_\mathcal{D}(W, -)$ is homological, and the functor
$\Hom_\mathcal{D}(-, W)$ is cohomological.
\end{lemma}

\begin{proof}
Consider a distinguished triangle $(X, Y, Z, f, g, h)$.
We have already seen that $g \circ f = 0$, see
Lemma \ref{lemma-composition-zero}.
Suppose $a : W \to Y$ is a morphism such that $g \circ a = 0$.
Then we get a commutative diagram
$$
\xymatrix{
W \ar[r]_1 \ar@{..>}[d]^b &
W \ar[r] \ar[d]^a &
0 \ar[r] \ar[d]^0 &
W[1] \ar@{..>}[d]^{b[1]} \\
X \ar[r] & Y \ar[r] & Z \ar[r] & X[1]
}
$$
Both rows are distinguished triangles (use TR1 for the top row).
Hence we can fill the dotted arrow $b$ (first rotate using TR2,
then apply TR3, and then rotate back). This proves the lemma.
\end{proof}

\begin{lemma}
\label{lemma-third-isomorphism-triangle}
Let $\mathcal{D}$ be a pre-triangulated category.
Let
$$
(a, b, c) : (X, Y, Z, f, g, h) \to (X', Y', Z', f', g', h')
$$
be a morphism of distinguished triangles. If two among $a, b, c$
are isomorphisms so is the third.
\end{lemma}

\begin{proof}
Assume that $a$ and $c$ are isomorphisms.
For any object $W$ of $\mathcal{D}$ write
$H_W( - ) = \Hom_\mathcal{D}(W, -)$.
Then we get a commutative diagram of abelian groups
$$
\xymatrix{
H_W(Z[-1]) \ar[r] \ar[d] &
H_W(X) \ar[r] \ar[d] &
H_W(Y) \ar[r] \ar[d] &
H_W(Z) \ar[r] \ar[d] &
H_W(X[1]) \ar[d] \\
H_W(Z'[-1]) \ar[r] &
H_W(X') \ar[r] &
H_W(Y') \ar[r] &
H_W(Z') \ar[r] &
H_W(X'[1])
}
$$
By assumption the right two and left two vertical arrows are bijective.
As $H_W$ is homological by
Lemma \ref{lemma-representable-homological}
and the five lemma
(Homology, Lemma \ref{homology-lemma-five-lemma})
it follows that the middle vertical arrow is an isomorphism.
Hence by Yoneda's lemma, see
Categories, Lemma \ref{categories-lemma-yoneda}
we see that $b$ is an isomorphism.
This implies the other cases by rotating (using TR2).
\end{proof}

\begin{remark}
\label{remark-special-triangles}
Let $\mathcal{D}$ be an additive category with translation functors $[n]$
as in Definition \ref{definition-triangle}. Let us call a triangle
$(X, Y, Z, f, g, h)$ {\it special}\footnote{This is nonstandard notation.}
if for every object $W$ of $\mathcal{D}$
the long sequence of abelian groups
$$
\ldots \to
\Hom_\mathcal{D}(W, X) \to
\Hom_\mathcal{D}(W, Y) \to
\Hom_\mathcal{D}(W, Z) \to
\Hom_\mathcal{D}(W, X[1]) \to \ldots
$$
is exact.  The proof of Lemma \ref{lemma-third-isomorphism-triangle}
shows that if
$$
(a, b, c) : (X, Y, Z, f, g, h) \to (X', Y', Z', f', g', h')
$$
is a morphism of special triangles and if two among $a, b, c$
are isomorphisms so is the third. There is a dual statement for
{\it co-special} triangles, i.e., triangles which turn into long
exact sequences on applying the functor $\Hom_\mathcal{D}(-, W)$.
Thus distinguished triangles are special and co-special, but in
general there are many more (co-)special triangles, than there are
distinguished triangles.
\end{remark}

\begin{lemma}
\label{lemma-third-map-square-zero}
Let $\mathcal{D}$ be a pre-triangulated category.
Let
$$
(0, b, 0), (0, b', 0) : (X, Y, Z, f, g, h) \to (X, Y, Z, f, g, h)
$$
be endomorphisms of a distinguished triangle. Then $bb' = 0$.
\end{lemma}

\begin{proof}
Picture
$$
\xymatrix{
X \ar[r] \ar[d]^0 &
Y \ar[r] \ar[d]^{b, b'} \ar@{..>}[ld]^\alpha &
Z \ar[r] \ar[d]^0 \ar@{..>}[ld]^\beta &
X[1] \ar[d]^0 \\
X \ar[r] & Y \ar[r] & Z \ar[r] & X[1]
}
$$
Applying
Lemma \ref{lemma-representable-homological}
we find dotted arrows $\alpha$ and $\beta$ such that
$b' = f \circ \alpha$ and $b = \beta \circ g$. Then
$bb' = \beta \circ g \circ f \circ \alpha = 0$
as $g \circ f = 0$ by
Lemma \ref{lemma-composition-zero}.
\end{proof}

\begin{lemma}
\label{lemma-third-map-idempotent}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $(X, Y, Z, f, g, h)$ be a distinguished triangle.
If
$$
\xymatrix{
Z \ar[r]_h \ar[d]_c & X[1] \ar[d]^{a[1]} \\
Z \ar[r]^h & X[1]
}
$$
is commutative and $a^2 = a$, $c^2 = c$, then there exists a
morphism $b : Y \to Y$ with $b^2 = b$ such that
$(a, b, c)$ is an endomorphism of the triangle $(X, Y, Z, f, g, h)$.
\end{lemma}

\begin{proof}
By TR3 there exists a morphism $b'$ such that
$(a, b', c)$ is an endomorphism of $(X, Y, Z, f, g, h)$.
Then $(0, (b')^2 - b', 0)$ is also an endomorphism. By
Lemma \ref{lemma-third-map-square-zero}
we see that $(b')^2 - b'$ has square zero.
Set $b = b' - (2b' - 1)((b')^2 - b') = 3(b')^2 - 2(b')^3$.
A computation shows that $(a, b, c)$ is an endomorphism and
that $b^2 - b = (4(b')^2 - 4b' - 3)((b')^2 - b')^2 = 0$.
\end{proof}

\begin{lemma}
\label{lemma-cone-triangle-unique-isomorphism}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $f : X \to Y$ be a morphism of $\mathcal{D}$.
There exists a distinguished triangle $(X, Y, Z, f, g, h)$ which
is unique up to (nonunique) isomorphism of triangles.
More precisely, given a second such distinguished triangle
$(X, Y, Z', f, g', h')$ there exists an isomorphism
$$
(1, 1, c) : (X, Y, Z, f, g, h) \longrightarrow (X, Y, Z', f, g', h')
$$
\end{lemma}

\begin{proof}
Existence by TR1. Uniqueness up to isomorphism by TR3 and
Lemma \ref{lemma-third-isomorphism-triangle}.
\end{proof}

\begin{lemma}
\label{lemma-uniqueness-third-arrow}
Let $\mathcal{D}$ be a pre-triangulated category. Let
$$
(a, b, c) : (X, Y, Z, f, g, h) \to (X', Y', Z', f', g', h')
$$
be a morphism of distinguished triangles. If one of the following
conditions holds
\begin{enumerate}
\item $\Hom(Y, X') = 0$,
\item $\Hom(Z', Y) = 0$,
\item $\Hom(X, X') = \Hom(Z, X') = 0$,
\item $\Hom(Z', X) = \Hom(Z', Z) = 0$, or
\item $\Hom(X[1], Z') = \Hom(Z, X') = 0$
\end{enumerate}
then $b$ is the unique morphism from $Y \to Y'$ such that
$(a, b, c)$ is a morphism of triangles.
\end{lemma}

\begin{proof}
If we have a second morphism of triangles $(a, b', c)$
then $(0, b - b', 0)$ is a morphism of triangles. Hence we
have to show: the only morphism $b : Y \to Y'$ such that the 
$X \to Y \to Y'$ and $Y \to Y' \to Z'$ are zero is $0$.
We will use Lemma \ref{lemma-representable-homological}
without further mention. In particular, condition (3) implies (1).
Given condition (1) if the composition $b : Y \to Y' \to Z'$
is zero, then $b$ lifts to a morphism $Y \to X'$ which has to be zero.
This proves (1).

\medskip\noindent
The proof of (2) and (4) are dual to this argument.

\medskip\noindent
Assume (5). Consider the diagram
$$
\xymatrix{
X \ar[r]_f \ar[d]^0 &
Y \ar[r]_g \ar[d]^b &
Z \ar[r]_h \ar[d]^0 \ar@{..>}[ld]^\epsilon &
X[1] \ar[d]^0 \\
X' \ar[r]^{f'} &
Y' \ar[r]^{g'} &
Z' \ar[r]^{h'} &
X'[1]
}
$$
We may choose $\epsilon$ such that $b = g \circ \epsilon$.
Then $g' \circ \epsilon \circ g = 0$ which implies that
$g' \circ \epsilon = \delta \circ h$ for some
$\delta \in \Hom(X[1], Z')$. Since $\Hom(X[1], Z') = 0$
we conclude that $g' \circ \epsilon = 0$. Hence
$\epsilon = f' \circ \gamma$ for some $\gamma : \Hom(Z, X')$.
Since $\Hom(Z, X') = 0$ we conclude that $\epsilon = 0$
and hence $b = 0$ as desired.
\end{proof}

\begin{lemma}
\label{lemma-third-object-zero}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $f : X \to Y$ be a morphism of $\mathcal{D}$.
The following are equivalent
\begin{enumerate}
\item $f$ is an isomorphism,
\item $(X, Y, 0, f, 0, 0)$ is a distinguished triangle, and
\item for any distinguished triangle $(X, Y, Z, f, g, h)$ we have $Z = 0$.
\end{enumerate}
\end{lemma}

\begin{proof}
By TR1 the triangle $(X, X, 0, 1, 0, 0)$ is distinguished.
Let $(X, Y, Z, f, g, h)$ be a distinguished triangle.
By TR3 there is a map of distinguished triangles
$(1, f, 0) : (X, X, 0) \to (X, Y, Z)$.
If $f$ is an isomorphism, then $(1, f, 0)$ is an isomorphism
of triangles by Lemma \ref{lemma-third-isomorphism-triangle}
and $Z = 0$. Conversely, if $Z = 0$, then $(1, f, 0)$ is an
isomorphism of triangles as well, hence $f$ is an isomorphism.
\end{proof}

\begin{lemma}
\label{lemma-direct-sum-triangles}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $(X, Y, Z, f, g, h)$ and $(X', Y', Z', f', g', h')$ be triangles.
The following are equivalent
\begin{enumerate}
\item $(X \oplus X', Y \oplus Y', Z \oplus Z',
f \oplus f', g \oplus g', h \oplus h')$
is a distinguished triangle,
\item both $(X, Y, Z, f, g, h)$ and $(X', Y', Z', f', g', h')$ are
distinguished triangles.
\end{enumerate}
\end{lemma}

\begin{proof}
Assume (2). By TR1 we may choose a distinguished triangle
$(X \oplus X', Y \oplus Y', Q, f \oplus f', g'', h'')$.
By TR3 we can find morphisms of distinguished triangles
$(X, Y, Z, f, g, h) \to
(X \oplus X', Y \oplus Y', Q, f \oplus f', g'', h'')$
and
$(X', Y', Z', f', g', h') \to
(X \oplus X', Y \oplus Y', Q, f \oplus f', g'', h'')$.
Taking the direct sum of these morphisms
we obtain a morphism of triangles
$$
\xymatrix{
(X \oplus X', Y \oplus Y', Z \oplus Z',
f \oplus f', g \oplus g', h \oplus h')
\ar[d]^{(1, 1, c)} \\
(X \oplus X', Y \oplus Y', Q, f \oplus f', g'', h'').
}
$$
In the terminology of Remark \ref{remark-special-triangles}
this is a map of special triangles (because a direct sum of special
triangles is special) and we conclude
that $c$ is an isomorphism. Thus (1) holds.

\medskip\noindent
Assume (1). We will show that $(X, Y, Z, f, g, h)$ is a distinguished
triangle. First observe that $(X, Y, Z, f, g, h)$ is a special triangle
(terminology from Remark \ref{remark-special-triangles})
as a direct summand of the distinguished hence special
triangle $(X \oplus X', Y \oplus Y', Z \oplus Z',
f \oplus f', g \oplus g', h \oplus h')$. Using TR1 let
$(X, Y, Q, f, g'', h'')$ be a distinguished triangle. By TR3 there exists
a morphism of distinguished triangles
 $(X \oplus X', Y \oplus Y', Z \oplus Z',
f \oplus f', g \oplus g', h \oplus h') \to (X, Y, Q, f, g'', h'')$.
Composing this with the inclusion map we get a morphism of triangles
$$
(1, 1, c) :
(X, Y, Z, f, g, h)
\longrightarrow
(X, Y, Q, f, g'', h'')
$$
By Remark \ref{remark-special-triangles}
we find that $c$ is an isomorphism and we conclude
that (2) holds.
\end{proof}

\begin{lemma}
\label{lemma-split}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $(X, Y, Z, f, g, h)$ be a distinguished triangle.
\begin{enumerate}
\item If $h = 0$, then there exists a right inverse $s : Z \to Y$ to $g$.
\item For any right inverse $s : Z \to Y$ of $g$ the map
$f \oplus s : X \oplus Z \to Y$ is an isomorphism.
\item For any objects $X', Z'$ of $\mathcal{D}$ the triangle
$(X', X' \oplus Z', Z', (1, 0), (0, 1), 0)$ is distinguished.
\end{enumerate}
\end{lemma}

\begin{proof}
To see (1) use that
$\Hom_\mathcal{D}(Z, Y) \to \Hom_\mathcal{D}(Z, Z) \to
\Hom_\mathcal{D}(Z, X[1])$
is exact by
Lemma \ref{lemma-representable-homological}.
By the same token, if $s$ is as in (2), then $h = 0$ and the sequence
$$
0 \to \Hom_\mathcal{D}(W, X) \to \Hom_\mathcal{D}(W, Y)
\to \Hom_\mathcal{D}(W, Z) \to 0
$$
is split exact (split by $s : Z \to Y$). Hence by Yoneda's lemma we
see that $X \oplus Z \to Y$ is an isomorphism. The last assertion follows
from TR1 and
Lemma \ref{lemma-direct-sum-triangles}.
\end{proof}

\begin{lemma}
\label{lemma-when-split}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $f : X \to Y$ be a morphism of $\mathcal{D}$.
The following are equivalent
\begin{enumerate}
\item $f$ has a kernel,
\item $f$ has a cokernel,
\item $f$ is the isomorphic to a composition
$K \oplus Z \to Z \to Z \oplus Q$ of a projection and coprojection
for some objects $K, Z, Q$ of $\mathcal{D}$.
\end{enumerate}
\end{lemma}

\begin{proof}
Any morphism isomorphic to a map of the form
$X' \oplus Z \to Z \oplus Y'$ has both a kernel and a cokernel.
Hence (3) $\Rightarrow$ (1), (2).
Next we prove (1) $\Rightarrow$ (3).
Suppose first that $f : X \to Y$ is a monomorphism, i.e., its kernel is zero.
By TR1 there exists a distinguished triangle $(X, Y, Z, f, g, h)$.
By Lemma \ref{lemma-composition-zero} the composition
$f \circ h[-1] = 0$. As $f$ is a monomorphism we see that $h[-1] = 0$
and hence $h = 0$. Then
Lemma \ref{lemma-split}
implies that $Y = X \oplus Z$, i.e., we see that (3) holds.
Next, assume $f$ has a kernel $K$. As $K \to X$ is a monomorphism we
conclude $X = K \oplus X'$ and $f|_{X'} : X' \to Y$ is a monomorphism.
Hence $Y = X' \oplus Y'$ and we win.
The implication (2) $\Rightarrow$ (3) is dual to this.
\end{proof}

\begin{lemma}
\label{lemma-products-sums-shifts-triangles}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $I$ be a set.
\begin{enumerate}
\item Let $X_i$, $i \in I$ be a family of objects of $\mathcal{D}$.
\begin{enumerate}
\item If $\prod X_i$ exists, then $(\prod X_i)[1] = \prod X_i[1]$.
\item If $\bigoplus X_i$ exists, then $(\bigoplus X_i)[1] = \bigoplus X_i[1]$.
\end{enumerate}
\item Let $X_i \to Y_i \to Z_i \to X_i[1]$ be a family of distinguished
triangles of $\mathcal{D}$.
\begin{enumerate}
\item If $\prod X_i$, $\prod Y_i$, $\prod Z_i$ exist, then
$\prod X_i \to \prod Y_i \to \prod Z_i \to \prod X_i[1]$
is a distinguished triangle.
\item If $\bigoplus X_i$, $\bigoplus Y_i$,
$\bigoplus Z_i$ exist, then
$\bigoplus X_i \to \bigoplus Y_i \to \bigoplus Z_i \to \bigoplus X_i[1]$
is a distinguished triangle.
\end{enumerate}
\end{enumerate}
\end{lemma}

\begin{proof}
Part (1) is true because $[1]$ is an autoequivalence of $\mathcal{D}$
and because direct sums and products are defined in terms of the
category structure. Let us prove (2)(a). Choose a distinguished triangle
$\prod X_i \to \prod Y_i \to Z \to \prod X_i[1]$. For each $j$ we can
use TR3 to choose a morphism $p_j : Z \to Z_j$
fitting into a morphism of distinguished
triangles with the projection maps $\prod X_i \to X_j$ and $\prod Y_i \to Y_j$.
Using the definition of products we obtain a map
$\prod p_i : Z \to \prod Z_i$ fitting into a morphism
of triangles from the distinguished triangle to the triangle
made out of the products. Observe that the ``product'' triangle
$\prod X_i \to \prod Y_i \to \prod Z_i \to \prod X_i[1]$
is special in the terminology of Remark \ref{remark-special-triangles}
because products of exact sequences of abelian groups are exact.
Hence Remark \ref{remark-special-triangles} shows that
the morphism of triangles is an isomorphism and we conclude by TR1.
The proof of (2)(b) is dual.
\end{proof}

\begin{lemma}
\label{lemma-projectors-have-images-triangulated}
Let $\mathcal{D}$ be a pre-triangulated category.
If $\mathcal{D}$ has countable products, then $\mathcal{D}$
is Karoubian.
If $\mathcal{D}$ has countable coproducts, then $\mathcal{D}$
is Karoubian.
\end{lemma}

\begin{proof}
Assume $\mathcal{D}$ has countable products. By
Homology, Lemma \ref{homology-lemma-projectors-have-images}
it suffices to check that morphisms which have a right inverse have kernels.
Any morphism which has a right inverse is an epimorphism, hence
has a kernel by
Lemma \ref{lemma-when-split}.
The second statement is dual to the first.
\end{proof}

\noindent
The following lemma makes it slightly easier to prove that a
pre-triangulated category is triangulated.

\begin{lemma}
\label{lemma-easier-axiom-four}
Let $\mathcal{D}$ be a pre-triangulated category.
In order to prove TR4 it suffices to show that given
any pair of composable morphisms
$f : X \to Y$ and $g : Y \to Z$ there exist
\begin{enumerate}
\item isomorphisms $i : X' \to X$, $j : Y' \to Y$ and
$k : Z' \to Z$, and then setting $f' = j^{-1}fi : X' \to Y'$ and
$g' = k^{-1}gj : Y' \to Z'$ there exist
\item distinguished triangles
$(X', Y', Q_1, f', p_1, d_1)$,
$(X', Z', Q_2, g' \circ f', p_2, d_2)$
and
$(Y', Z', Q_3, g', p_3, d_3)$,
such that the assertion of TR4 holds.
\end{enumerate}
\end{lemma}

\begin{proof}
The replacement of $X, Y, Z$ by $X', Y', Z'$ is harmless by our
definition of distinguished triangles and their isomorphisms.
The lemma follows from the fact that the distinguished triangles
$(X', Y', Q_1, f', p_1, d_1)$,
$(X', Z', Q_2, g' \circ f', p_2, d_2)$
and
$(Y', Z', Q_3, g', p_3, d_3)$
are unique up to isomorphism by
Lemma \ref{lemma-cone-triangle-unique-isomorphism}.
\end{proof}

\begin{lemma}
\label{lemma-triangulated-subcategory}
Let $\mathcal{D}$ be a pre-triangulated category.
Assume that $\mathcal{D}'$ is an additive full subcategory of $\mathcal{D}$.
The following are equivalent
\begin{enumerate}
\item there exists a set of triangles $\mathcal{T}'$ such that
$(\mathcal{D}', \mathcal{T}')$ is a pre-triangulated subcategory
of $\mathcal{D}$,
\item $\mathcal{D}'$ is preserved under $[1], [-1]$ and
given any morphism $f : X \to Y$ in $\mathcal{D}'$ there exists
a distinguished triangle $(X, Y, Z, f, g, h)$ in $\mathcal{D}$
such that $Z$ is isomorphic to an object of $\mathcal{D}'$.
\end{enumerate}
In this case $\mathcal{T}'$ as in (1) is the set of distinguished triangles
$(X, Y, Z, f, g, h)$ of $\mathcal{D}$ such that
$X, Y, Z \in \Ob(\mathcal{D}')$. Finally, if $\mathcal{D}$
is a triangulated category, then (1) and (2) are also equivalent to
\begin{enumerate}
\item[(3)] $\mathcal{D}'$ is a triangulated subcategory.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-exact-functor-additive}
An exact functor of pre-triangulated categories is additive.
\end{lemma}

\begin{proof}
Let $F : \mathcal{D} \to \mathcal{D}'$ be an exact functor of
pre-triangulated categories. Since
$(0, 0, 0, 1_0, 1_0, 0)$ is a distinguished triangle of $\mathcal{D}$
the triangle
$$
(F(0), F(0), F(0), 1_{F(0)}, 1_{F(0)}, F(0))
$$
is distinguished in $\mathcal{D}'$.
This implies that $1_{F(0)} \circ 1_{F(0)}$ is zero, see
Lemma \ref{lemma-composition-zero}.
Hence $F(0)$ is the zero object of $\mathcal{D}'$. This also implies
that $F$ applied to any zero morphism is zero (since a morphism in
an additive category is zero if and only if it factors through the
zero object). Next, using that
$(X, X \oplus Y, Y, (1, 0), (0, 1), 0)$ is a distinguished triangle,
we see that $(F(X), F(X \oplus Y), F(Y), F(1, 0), F(0, 1), 0)$ is
one too. This implies that the map
$F(1, 0) \oplus F(0, 1) : F(X) \oplus F(Y) \to F(X \oplus Y)$
is an isomorphism, see
Lemma \ref{lemma-split}.
We omit the rest of the argument.
\end{proof}

\begin{lemma}
\label{lemma-exact-equivalence}
Let $F : \mathcal{D} \to \mathcal{D}'$ be a fully faithful exact functor
of pre-triangulated categories. Then a triangle $(X, Y, Z, f, g, h)$
of $\mathcal{D}$ is distinguished if and only if
$(F(X), F(Y), F(Z), F(f), F(g), F(h))$ is distinguished in $\mathcal{D}'$.
\end{lemma}

\begin{proof}
The ``only if'' part is clear. Assume $(F(X), F(Y), F(Z))$ is
distinguished in $\mathcal{D}'$. Pick a distinguished triangle
$(X, Y, Z', f, g', h')$ in $\mathcal{D}$. By
Lemma \ref{lemma-cone-triangle-unique-isomorphism}
there exists an isomorphism of triangles
$$
(1, 1, c') : (F(X), F(Y), F(Z)) \longrightarrow (F(X), F(Y), F(Z')).
$$
Since $F$ is fully faithful, there exists a morphism $c : Z \to Z'$
such that $F(c) = c'$. Then $(1, 1, c)$ is an isomorphism between
$(X, Y, Z)$ and $(X, Y, Z')$. Hence $(X, Y, Z)$ is distinguished
by TR1.
\end{proof}

\begin{lemma}
\label{lemma-composition-exact}
Let $\mathcal{D}, \mathcal{D}', \mathcal{D}''$ be pre-triangulated categories.
Let $F : \mathcal{D} \to \mathcal{D}'$ and
$F' : \mathcal{D}' \to \mathcal{D}''$ be exact functors.
Then $F' \circ F$ is an exact functor.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-exact-compose-homological-functor}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $\mathcal{A}$ be an abelian category.
Let $H : \mathcal{D} \to \mathcal{A}$ be a homological functor.
\begin{enumerate}
\item Let $\mathcal{D}'$ be a pre-triangulated category.
Let $F : \mathcal{D}' \to \mathcal{D}$ be an exact functor.
Then the composition $H \circ F$ is a homological functor as well.
\item Let $\mathcal{A}'$ be an abelian category. Let
$G : \mathcal{A} \to \mathcal{A}'$ be an exact functor.
Then $G \circ H$ is a homological functor as well.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-exact-compose-delta-functor}
Let $\mathcal{D}$ be a triangulated category.
Let $\mathcal{A}$ be an abelian category.
Let $G : \mathcal{A} \to \mathcal{D}$ be a $\delta$-functor.
\begin{enumerate}
\item Let $\mathcal{D}'$ be a triangulated category.
Let $F : \mathcal{D} \to \mathcal{D}'$ be an exact functor.
Then the composition $F \circ G$ is a $\delta$-functor as well.
\item Let $\mathcal{A}'$ be an abelian category. Let
$H : \mathcal{A}' \to \mathcal{A}$ be an exact functor.
Then $G \circ H$ is a $\delta$-functor as well.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-compose-delta-functor-homological}
Let $\mathcal{D}$ be a triangulated category.
Let $\mathcal{A}$ and $\mathcal{B}$ be abelian categories.
Let $G : \mathcal{A} \to \mathcal{D}$ be a $\delta$-functor.
Let $H : \mathcal{D} \to \mathcal{B}$ be a homological functor.
Assume that $H^{-1}(G(A)) = 0$ for all $A$ in $\mathcal{A}$.
Then the collection
$$
\{H^n \circ G, H^n(\delta_{A \to B \to C})\}_{n \geq 0}
$$
is a $\delta$-functor from $\mathcal{A} \to \mathcal{B}$, see
Homology, Definition \ref{homology-definition-cohomological-delta-functor}.
\end{lemma}

\begin{proof}
The notation signifies the following. If
$0 \to A \xrightarrow{a} B \xrightarrow{b} C \to 0$ is
a short exact sequence in $\mathcal{A}$, then
$$
\delta = \delta_{A \to B \to C} : G(C) \to G(A)[1]
$$
is a morphism in $\mathcal{D}$ such that
$(G(A), G(B), G(C), a, b, \delta)$ is
a distinguished triangle, see
Definition \ref{definition-delta-functor}.
Then $H^n(\delta) : H^n(G(C)) \to H^n(G(A)[1]) = H^{n + 1}(G(A))$
is clearly functorial in the short exact sequence.
Finally, the long exact cohomology sequence
(\ref{equation-long-exact-cohomology-sequence})
combined with the vanishing of $H^{-1}(G(C))$
gives a long exact sequence
$$
0 \to H^0(G(A)) \to H^0(G(B)) \to H^0(G(C))
\xrightarrow{H^0(\delta)} H^1(G(A)) \to \ldots
$$
in $\mathcal{B}$ as desired.
\end{proof}

\noindent
The proof of the following result uses TR4.

\begin{proposition}
\label{proposition-9}
Let $\mathcal{D}$ be a triangulated category. Any commutative diagram
$$
\xymatrix{
X \ar[r] \ar[d] & Y \ar[d] \\
X' \ar[r] & Y'
}
$$
can be extended to a diagram
$$
\xymatrix{
X \ar[r] \ar[d] & Y \ar[r] \ar[d] & Z \ar[r] \ar[d] & X[1] \ar[d] \\
X' \ar[r] \ar[d] & Y' \ar[r] \ar[d] & Z' \ar[r] \ar[d] & X'[1] \ar[d] \\
X'' \ar[r] \ar[d] & Y'' \ar[r] \ar[d] & Z'' \ar[r] \ar[d] & X''[1] \ar[d] \\
X[1] \ar[r] & Y[1] \ar[r] & Z[1] \ar[r] & X[2]
}
$$
where all the squares are commutative, except for the lower right square
which is anticommutative. Moreover, each of the rows and columns are
distinguished triangles. Finally, the morphisms on the bottom row
(resp.\ right column) are obtained from the morphisms of the top row
(resp.\ left column) by applying $[1]$.
\end{proposition}

\begin{proof}
During this proof we avoid writing the arrows in order to make the proof
legible. Choose distinguished triangles
$(X, Y, Z)$, $(X', Y', Z')$, $(X, X', X'')$, $(Y, Y', Y'')$, and
$(X, Y', A)$. Note that the morphism $X \to Y'$ is both equal
to the composition $X \to Y \to Y'$ and equal to the composition
$X \to X' \to Y'$. Hence, we can find morphisms
\begin{enumerate}
\item $a : Z \to A$ and $b : A \to Y''$, and
\item $a' : X'' \to A$ and $b' : A \to Z'$
\end{enumerate}
as in TR4. Denote $c : Y'' \to Z[1]$ the composition
$Y'' \to Y[1] \to Z[1]$ and denote $c' : Z' \to X''[1]$ the composition
$Z' \to X'[1] \to X''[1]$. The conclusion of our application TR4
are that
\begin{enumerate}
\item $(Z, A, Y'', a, b, c)$, $(X'', A, Z', a', b', c')$
are distinguished triangles,
\item $(X, Y, Z) \to (X, Y', A)$,
$(X, Y', A) \to (Y, Y', Y'')$,
$(X, X', X'') \to (X, Y', A)$,
$(X, Y', A) \to (X', Y', Z')$
are morphisms of triangles.
\end{enumerate}
First using that
$(X, X', X'') \to (X, Y', A)$ and $(X, Y', A) \to (Y, Y', Y'')$.
are morphisms of triangles we see the first of the diagrams
$$
\vcenter{
\xymatrix{
X' \ar[r] \ar[d] & Y' \ar[d] \\
X'' \ar[r]^{b \circ a'} \ar[d] & Y'' \ar[d] \\
X[1] \ar[r] & Y[1]
}
}
\quad\text{and}\quad
\vcenter{
\xymatrix{
Y \ar[r] \ar[d] & Z \ar[d]^{b' \circ a} \ar[r] & X[1] \ar[d] \\
Y' \ar[r] & Z' \ar[r] & X'[1]
}
}
$$
is commutative. The second is commutative too using that
$(X, Y, Z) \to (X, Y', A)$ and $(X, Y', A) \to (X', Y', Z')$ are morphisms
of triangles. At this point we choose a distinguished triangle
$(X'', Y'' , Z'')$ starting with the map $b \circ a' : X'' \to Y''$.

\medskip\noindent
Next we apply TR4 one more time to the morphisms
$X'' \to A \to Y''$ and the triangles
$(X'', A, Z', a', b', c')$,
$(X'', Y'', Z'')$, and
$(A, Y'', Z[1], b, c , -a[1])$ to get morphisms
$a'' : Z' \to Z''$ and $b'' : Z'' \to Z[1]$.
Then $(Z', Z'', Z[1], a'', b'', - b'[1] \circ a[1])$ is a distinguished
triangle, hence also $(Z, Z', Z'', -b' \circ a, a'', -b'')$
and hence also $(Z, Z', Z'', b' \circ a, a'', b'')$.
Moreover, $(X'', A, Z') \to (X'', Y'', Z'')$ and
$(X'', Y'', Z'') \to (A, Y'', Z[1], b, c , -a[1])$
are morphisms of triangles.
At this point we have defined all the distinguished triangles
and all the morphisms, and all that's left is to verify some
commutativity relations.

\medskip\noindent
To see that the middle square in the diagram commutes, note
that the arrow $Y' \to Z'$ factors as $Y' \to A \to Z'$
because $(X, Y', A) \to (X', Y', Z')$ is a morphism of triangles.
Similarly, the morphism $Y' \to Y''$ factors as
$Y' \to A \to Y''$ because $(X, Y', A) \to (Y, Y', Y'')$ is a
morphism of triangles. Hence the middle square commutes because
the square with sides $(A, Z', Z'', Y'')$ commutes as
$(X'', A, Z') \to (X'', Y'', Z'')$ is a morphism of triangles (by TR4).
The square with sides $(Y'', Z'', Y[1], Z[1])$ commutes
because $(X'', Y'', Z'') \to (A, Y'', Z[1], b, c , -a[1])$
is a morphism of triangles and $c : Y'' \to Z[1]$ is the composition
$Y'' \to Y[1] \to Z[1]$.
The square with sides $(Z', X'[1], X''[1], Z'')$ is commutative
because $(X'', A, Z') \to (X'', Y'', Z'')$ is a morphism of triangles
and $c' : Z' \to X''[1]$ is the composition $Z' \to X'[1] \to X''[1]$.
Finally, we have to show that the square with sides
$(Z'', X''[1], Z[1], X[2])$ anticommutes. This holds because
$(X'', Y'', Z'') \to (A, Y'', Z[1], b, c , -a[1])$
is a morphism of triangles and we're done.
\end{proof}








\section{Localization of triangulated categories}
\label{section-localization}

\noindent
In order to construct the derived category starting from the homotopy
category of complexes, we will use a localization process.

\begin{definition}
\label{definition-localization}
Let $\mathcal{D}$ be a pre-triangulated category. We say a multiplicative
system $S$ is {\it compatible with the triangulated structure} if
the following two conditions hold:
\begin{enumerate}
\item[MS5] For $s \in S$ we have $s[n] \in S$ for all $n \in \mathbf{Z}$.
\item[MS6] Given a solid commutative square
$$
\xymatrix{
X \ar[r] \ar[d]^s &
Y \ar[r] \ar[d]^{s'} &
Z \ar[r] \ar@{-->}[d] &
X[1] \ar[d]^{s[1]} \\
X' \ar[r] &
Y' \ar[r] &
Z' \ar[r] &
X'[1]
}
$$
whose rows are distinguished triangles with $s, s' \in S$
there exists a morphism $s'' : Z \to Z'$ in $S$ such that
$(s, s', s'')$ is a morphism of triangles.
\end{enumerate}
\end{definition}

\noindent
It turns out that these axioms are not independent of the
axioms defining multiplicative systems.

\begin{lemma}
\label{lemma-localization-conditions}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $S$ be a set of morphisms of $\mathcal{D}$ and assume that axioms
MS1, MS5, MS6 hold (see
Categories, Definition \ref{categories-definition-multiplicative-system}
and
Definition \ref{definition-localization}).
Then MS2 holds.
\end{lemma}

\begin{proof}
Suppose that $f : X \to Y$ is a morphism of $\mathcal{D}$ and
$t : X \to X'$ an element of $S$. Choose a distinguished triangle
$(X, Y, Z, f, g, h)$. Next, choose a distinguished triangle
$(X', Y', Z, f', g', t[1] \circ h)$ (here we use TR1 and TR2).
By MS5, MS6 (and TR2 to rotate) we can find the dotted arrow
in the commutative diagram
$$
\xymatrix{
X \ar[r] \ar[d]^t &
Y \ar[r] \ar@{..>}[d]^{s'} &
Z \ar[r] \ar[d]^1 &
X[1] \ar[d]^{t[1]} \\
X' \ar[r] &
Y' \ar[r] &
Z \ar[r] &
X'[1]
}
$$
with moreover $s' \in S$. This proves LMS2. The proof of RMS2 is dual.
\end{proof}

\begin{lemma}
\label{lemma-triangle-functor-localize}
Let $F : \mathcal{D} \to \mathcal{D}'$ be an exact functor of
pre-triangulated categories.  Let
$$
S = \{f \in \text{Arrows}(\mathcal{D})
\mid F(f)\text{ is an isomorphism}\}
$$
Then $S$ is a saturated (see
Categories,
Definition \ref{categories-definition-saturated-multiplicative-system})
multiplicative system compatible with the
triangulated structure on $\mathcal{D}$.
\end{lemma}

\begin{proof}
We have to prove axioms MS1 -- MS6, see
Categories, Definitions \ref{categories-definition-multiplicative-system} and
\ref{categories-definition-saturated-multiplicative-system}
and
Definition \ref{definition-localization}.
MS1, MS4, and MS5 are direct from the definitions. MS6 follows from TR3 and
Lemma \ref{lemma-third-isomorphism-triangle}.
By
Lemma \ref{lemma-localization-conditions}
we conclude that MS2 holds. To finish the proof we have to show that
MS3 holds. To do this let $f, g : X \to Y$ be morphisms of $\mathcal{D}$,
and let $t : Z \to X$ be an element of $S$ such that $f \circ t = g \circ t$.
As $\mathcal{D}$ is additive this simply means that $a \circ t = 0$ with
$a = f - g$. Choose a distinguished triangle $(Z, X, Q, t, d, h)$ using TR1.
Since $a \circ t = 0$ we see by
Lemma \ref{lemma-representable-homological}
there exists a morphism $i : Q \to Y$ such that $i \circ d = a$.
Finally, using TR1 again we can choose a triangle
$(Q, Y, W, i, j, k)$. Here is a picture
$$
\xymatrix{
Z \ar[r]_t & X \ar[r]_d \ar[d]^1 & Q \ar[r] \ar[d]^i & Z[1] \\
& X \ar[r]_a & Y \ar[d]^j \\
& & W
}
$$
OK, and now we apply the functor $F$ to this diagram.
Since $t \in S$ we see that $F(Q) = 0$, see
Lemma \ref{lemma-third-object-zero}.
Hence $F(j)$ is an isomorphism by the same lemma, i.e., $j \in S$.
Finally, $j \circ a = j \circ i \circ d = 0$ as $j \circ i = 0$.
Thus $j \circ f = j \circ g$ and we see that LMS3 holds.
The proof of RMS3 is dual.
\end{proof}

\begin{lemma}
\label{lemma-homological-functor-localize}
Let $H : \mathcal{D} \to \mathcal{A}$ be a homological functor between a
pre-triangulated category and an abelian category. Let
$$
S = \{f \in \text{Arrows}(\mathcal{D})
\mid H^i(f)\text{ is an isomorphism for all }i \in \mathbf{Z}\}
$$
Then $S$ is a saturated (see
Categories,
Definition \ref{categories-definition-saturated-multiplicative-system})
multiplicative system compatible with the
triangulated structure on $\mathcal{D}$.
\end{lemma}

\begin{proof}
We have to prove axioms MS1 -- MS6, see
Categories, Definitions \ref{categories-definition-multiplicative-system} and
\ref{categories-definition-saturated-multiplicative-system}
and
Definition \ref{definition-localization}.
MS1, MS4, and MS5 are direct from the definitions.
MS6 follows from TR3 and the long exact cohomology sequence
(\ref{equation-long-exact-cohomology-sequence}).
By
Lemma \ref{lemma-localization-conditions}
we conclude that MS2 holds. To finish the proof we have to show that
MS3 holds. To do this let $f, g : X \to Y$ be morphisms of $\mathcal{D}$,
and let $t : Z \to X$ be an element of $S$ such that $f \circ t = g \circ t$.
As $\mathcal{D}$ is additive this simply means that $a \circ t = 0$ with
$a = f - g$. Choose a distinguished triangle $(Z, X, Q, t, g, h)$ using
TR1 and TR2. Since $a \circ t = 0$ we see by
Lemma \ref{lemma-representable-homological}
there exists a morphism $i : Q \to Y$ such that $i \circ g = a$.
Finally, using TR1 again we can choose a triangle
$(Q, Y, W, i, j, k)$. Here is a picture
$$
\xymatrix{
Z \ar[r]_t & X \ar[r]_g \ar[d]^1 & Q \ar[r] \ar[d]^i & Z[1] \\
& X \ar[r]_a & Y \ar[d]^j \\
& & W
}
$$
OK, and now we apply the functors $H^i$ to this diagram.
Since $t \in S$ we see that $H^i(Q) = 0$ by the long exact cohomology
sequence (\ref{equation-long-exact-cohomology-sequence}).
Hence $H^i(j)$ is an isomorphism for all $i$ by the same argument,
i.e., $j \in S$. Finally, $j \circ a = j \circ i \circ g = 0$ as
$j \circ i = 0$. Thus $j \circ f = j \circ g$ and we see that LMS3 holds.
The proof of RMS3 is dual.
\end{proof}

\begin{proposition}
\label{proposition-construct-localization}
Let $\mathcal{D}$ be a pre-triangulated category. Let $S$ be a multiplicative
system compatible with the triangulated structure.
Then there exists a unique structure of a pre-triangulated category on
$S^{-1}\mathcal{D}$ such that the localization functor
$Q : \mathcal{D} \to S^{-1}\mathcal{D}$ is exact.
Moreover, if $\mathcal{D}$ is a triangulated category, so is
$S^{-1}\mathcal{D}$.
\end{proposition}

\begin{proof}
We have seen that $S^{-1}\mathcal{D}$ is an additive category
and that the localization functor $Q$ is additive in
Homology, Lemma \ref{homology-lemma-localization-additive}.
It is clear that we may define $Q(X)[n] = Q(X[n])$ since
$\mathcal{S}$ is preserved under the shift functors $[n]$ by
MS5. Finally, we say a triangle of $S^{-1}\mathcal{D}$ is distinguished
if it is isomorphic to the image of a distinguished triangle under
the localization functor $Q$.

\medskip\noindent
Proof of TR1. The only thing to prove here is that if
$a : Q(X) \to Q(Y)$ is a morphism of $S^{-1}\mathcal{D}$, then
$a$ fits into a distinguished triangle. Write $a = Q(s)^{-1} \circ Q(f)$ for
some $s : Y \to Y'$ in $S$ and $f : X \to Y'$. Choose a distinguished
triangle $(X, Y', Z, f, g, h)$ in $\mathcal{D}$. Then we see that
$(Q(X), Q(Y), Q(Z), a, Q(g) \circ Q(s), Q(h))$ is a distinguished triangle
of $S^{-1}\mathcal{D}$.

\medskip\noindent
Proof of TR2. This is immediate from the definitions.

\medskip\noindent
Proof of TR3. Note that the existence of the dotted arrow which is
required to exist may be proven after replacing the two triangles
by isomorphic triangles. Hence we may assume given distinguished
triangles $(X, Y, Z, f, g, h)$ and $(X', Y', Z', f', g', h')$ of
$\mathcal{D}$ and a commutative diagram
$$
\xymatrix{
Q(X) \ar[r]_{Q(f)} \ar[d]_a & Q(Y) \ar[d]^b \\
Q(X') \ar[r]^{Q(f')} & Q(Y')
}
$$
in $S^{-1}\mathcal{D}$. Now we apply
Categories, Lemma \ref{categories-lemma-left-localization-diagram}
to find a morphism $f'' : X'' \to Y''$ in $\mathcal{D}$ and a commutative
diagram
$$
\xymatrix{
X \ar[d]_f \ar[r]_k & X'' \ar[d]^{f''} & X' \ar[d]^{f'} \ar[l]^s \\
Y \ar[r]^l & Y'' & Y' \ar[l]_t
}
$$
in $\mathcal{D}$ with $s, t \in S$ and $a = s^{-1}k$, $b = t^{-1}l$.
At this point we can use TR3 for $\mathcal{D}$ and MS6 to find
a commutative diagram
$$
\xymatrix{
X \ar[r] \ar[d]^k &
Y \ar[r] \ar[d]^l &
Z \ar[r] \ar[d]^m &
X[1] \ar[d]^{g[1]} \\
X'' \ar[r] &
Y'' \ar[r] &
Z'' \ar[r] &
X''[1] \\
X' \ar[r] \ar[u]_s &
Y' \ar[r] \ar[u]_t &
Z' \ar[r] \ar[u]_r &
X'[1] \ar[u]_{s[1]}
}
$$
with $r \in S$. It follows that setting $c = Q(r)^{-1}Q(m)$ we obtain
the desired morphism of triangles
$$
\xymatrix{
(Q(X), Q(Y), Q(Z), Q(f), Q(g), Q(h))
\ar[d]^{(a, b, c)} \\
(Q(X'), Q(Y'), Q(Z'), Q(f'), Q(g'), Q(h'))
}
$$

\medskip\noindent
This proves the first statement of the lemma. If $\mathcal{D}$ is also
a triangulated category, then we still have to prove TR4 in order to show
that $S^{-1}\mathcal{D}$ is triangulated as well. To do this we reduce by
Lemma \ref{lemma-easier-axiom-four}
to the following statement: Given composable morphisms
$a : Q(X) \to Q(Y)$ and $b : Q(Y) \to Q(Z)$ we have to produce
an octahedron after possibly replacing $Q(X), Q(Y), Q(Z)$ by isomorphic
objects. To do this we may first replace $Y$ by an object such that
$a = Q(f)$ for some morphism $f : X \to Y$ in $\mathcal{D}$. (More precisely,
write $a = s^{-1}f$ with $s : Y \to Y'$ in $S$ and $f : X \to Y'$. Then
replace $Y$ by $Y'$.) After this we similarly replace $Z$ by an object such
that $b = Q(g)$ for some morphism $g : Y \to Z$. Now we can find
distinguished triangles $(X, Y, Q_1, f, p_1, d_1)$,
$(X, Z, Q_2, g \circ f, p_2, d_2)$, and
$(Y, Z, Q_3, g, p_3, d_3)$ in $\mathcal{D}$ (by TR1), and
morphisms $a : Q_1 \to Q_2$ and $b : Q_2 \to Q_3$ as in TR4.
Then it is immediately verified that applying the functor $Q$ to
all these data gives a corresponding structure in $S^{-1}\mathcal{D}$
\end{proof}

\noindent
The universal property of the localization of a triangulated category
is as follows (we formulate this for pre-triangulated categories, hence
it holds a fortiori for triangulated categories).

\begin{lemma}
\label{lemma-universal-property-localization}
Let $\mathcal{D}$ be a pre-triangulated category. Let $S$ be a multiplicative
system compatible with the triangulated category. Let
$Q : \mathcal{D} \to S^{-1}\mathcal{D}$ be the localization functor, see
Proposition \ref{proposition-construct-localization}.
\begin{enumerate}
\item If $H : \mathcal{D} \to \mathcal{A}$ is a homological functor into
an abelian category $\mathcal{A}$ such that $H(s)$ is an isomorphism for
all $s \in S$, then the unique factorization
$H' : S^{-1}\mathcal{D} \to \mathcal{A}$ such that $H = H' \circ Q$ (see
Categories, Lemma \ref{categories-lemma-properties-left-localization})
is a homological functor too.
\item If $F : \mathcal{D} \to \mathcal{D}'$ is an exact functor into
a pre-triangulated category $\mathcal{D}'$ such that $F(s)$ is an isomorphism
for all $s \in S$, then the unique factorization
$F' : S^{-1}\mathcal{D} \to \mathcal{D}'$ such that $F = F' \circ Q$ (see
Categories, Lemma \ref{categories-lemma-properties-left-localization})
is an exact functor too.
\end{enumerate}
\end{lemma}

\begin{proof}
This lemma proves itself. Details omitted.
\end{proof}

\noindent
The following lemma describes the kernel (see
Definition \ref{definition-kernel-category})
of the localization functor.

\begin{lemma}
\label{lemma-kernel-localization}
Let $\mathcal{D}$ be a pre-triangulated category. Let $S$ be a multiplicative
system compatible with the triangulated structure. Let $Z$ be an object
of $\mathcal{D}$. The following are equivalent
\begin{enumerate}
\item $Q(Z) = 0$ in $S^{-1}\mathcal{D}$,
\item there exists $Z' \in \Ob(\mathcal{D})$ such that
$0 : Z \to Z'$ is an element of $S$,
\item there exists $Z' \in \Ob(\mathcal{D})$ such that
$0 : Z' \to Z$ is an element of $S$, and
\item there exists an object $Z'$ and a distinguished triangle
$(X, Y, Z \oplus Z', f, g, h)$ such that $f \in S$.
\end{enumerate}
If $S$ is saturated, then these are also equivalent to
\begin{enumerate}
\item[(4)] the morphism $0 \to Z$ is an element of $S$,
\item[(5)] the morphism $Z \to 0$ is an element of $S$,
\item[(6)] there exists a distinguished triangle $(X, Y, Z, f, g, h)$
such that $f \in S$.
\end{enumerate}
\end{lemma}

\begin{proof}
The equivalence of (1), (2), and (3) is
Homology, Lemma \ref{homology-lemma-kernel-localization}.
If (2) holds, then $(Z'[-1], Z'[-1] \oplus Z, Z, (1, 0), (0, 1), 0)$
is a distinguished triangle (see
Lemma \ref{lemma-split})
with ``$0 \in S$''. By rotating we conclude that (4) holds.
If $(X, Y, Z \oplus Z', f, g, h)$ is a distinguished triangle with $f \in S$
then $Q(f)$ is an isomorphism hence $Q(Z \oplus Z') = 0$ hence $Q(Z) = 0$.
Thus (1) -- (4) are all equivalent.

\medskip\noindent
Next, assume that $S$ is saturated. Note that each of (4), (5), (6)
implies one of the equivalent conditions (1) -- (4). Suppose that
$Q(Z) = 0$. Then $0 \to Z$ is a morphism of $\mathcal{D}$ which becomes
an isomorphism in $S^{-1}\mathcal{D}$. According to
Categories, Lemma \ref{categories-lemma-what-gets-inverted}
the fact that $S$ is saturated implies that $0 \to Z$ is in $S$.
Hence (1) $\Rightarrow$ (4). Dually (1) $\Rightarrow$ (5).
Finally, if $0 \to Z$ is in $S$, then the triangle
$(0, Z, Z, 0, \text{id}_Z, 0)$ is distinguished by TR1 and TR2 and
is a triangle as in (4).
\end{proof}

\begin{lemma}
\label{lemma-limit-triangles}
Let $\mathcal{D}$ be a triangulated category.
Let $S$ be a saturated multiplicative system in $\mathcal{D}$
that is compatible with the triangulated structure.
Let $(X, Y, Z, f, g, h)$ be a distinguished triangle in $\mathcal{D}$.
Consider the category of morphisms of triangles
$$
\mathcal{I} =
\{(s, s', s'') : (X, Y, Z, f, g, h) \to (X', Y', Z', f', g', h')
\mid s, s', s'' \in S\}
$$
Then $\mathcal{I}$ is a filtered category and the functors
$\mathcal{I} \to X/S$, $\mathcal{I} \to Y/S$, and $\mathcal{I} \to Z/S$
are cofinal.
\end{lemma}

\begin{proof}
We strongly suggest the reader skip the proof of this lemma and instead
work it out on a napkin.

\medskip\noindent
The first remark is that using rotation of distinguished triangles (TR2)
gives an equivalence of categories between $\mathcal{I}$ and the
corresponding category for the distinguished triangle
$(Y, Z, X[1], g, h, -f[1])$. Using this we see for example that if
we prove the functor $\mathcal{I} \to X/S$ is cofinal, then
the same thing is true for the functors $\mathcal{I} \to Y/S$ and
$\mathcal{I} \to Z/S$.

\medskip\noindent
Note that if $s : X \to X'$ is a morphism of $S$, then using
MS2 we can find $s' : Y \to Y'$ and $f' : X' \to Y'$ such that
$f' \circ s = s' \circ f$, whereupon we can use MS6 to complete
this into an object of $\mathcal{I}$. Hence the functor
$\mathcal{I} \to X/S$ is surjective on objects. Using rotation as above
this implies the same thing is true for the functors
$\mathcal{I} \to Y/S$ and $\mathcal{I} \to Z/S$.

\medskip\noindent
Suppose given objects $s_1 : X \to X_1 $ and $s_2 : X \to X_2$ in
$X/S$ and a morphism $a : X_1 \to X_2$ in $X/S$. Since $S$ is saturated,
we see that $a \in S$, see
Categories, Lemma \ref{categories-lemma-what-gets-inverted}.
By the argument of the previous paragraph we can complete
$s_1 : X \to X_1$ to an object
$(s_1, s'_1, s''_1) : (X, Y, Z, f, g, h) \to (X_1, Y_1, Z_1, f_1, g_1, h_1)$
in $\mathcal{I}$. Then we can repeat and find
$(a, b, c) : (X_1, Y_1, Z_1, f_1, g_1, h_1) \to (X_2, Y_2, Z_2, f_2, g_2, h_2)$
with $a, b, c \in S$ completing the given $a : X_1 \to X_2$.
But then $(a, b, c)$ is a morphism in $\mathcal{I}$.
In this way we conclude that the functor $\mathcal{I} \to X/S$ is
also surjective on arrows. Using rotation as above,
this implies the same thing is true for the functors
$\mathcal{I} \to Y/S$ and $\mathcal{I} \to Z/S$.

\medskip\noindent
The category $\mathcal{I}$ is nonempty as the identity provides an object.
This proves the condition (1) of the definition of a filtered category, see
Categories, Definition \ref{categories-definition-directed}.

\medskip\noindent
We check condition (2) of
Categories, Definition \ref{categories-definition-directed}
for the category $\mathcal{I}$. Suppose given objects
$(s_1, s'_1, s''_1) : (X, Y, Z, f, g, h) \to (X_1, Y_1, Z_1, f_1, g_1, h_1)$
and
$(s_2, s'_2, s''_2) : (X, Y, Z, f, g, h) \to (X_2, Y_2, Z_2, f_2, g_2, h_2)$
in $\mathcal{I}$. We want to find an object of $\mathcal{I}$
which is the target of an arrow from both
$(X_1, Y_1, Z_1, f_1, g_1, h_1)$ and $(X_2, Y_2, Z_2, f_2, g_2, h_2)$.
By Categories, Remark
\ref{categories-remark-left-localization-morphisms-colimit}
the categories $X/S$, $Y/S$, $Z/S$ are filtered.
Thus we can find $X \to X_3$ in $X/S$ and morphisms
$s : X_2 \to X_3$ and $a : X_1 \to X_3$. By the above we can find a morphism
$(s, s', s'') : (X_2, Y_2, Z_2, f_2, g_2, h_2) \to
(X_3, Y_3, Z_3, f_3, g_3, h_3)$ with $s', s'' \in S$.
After replacing $(X_2, Y_2, Z_2)$ by $(X_3, Y_3, Z_3)$ we may
assume that there exists a morphism $a : X_1 \to X_2$ in $X/S$.
Repeating the argument for $Y$ and $Z$ (by rotating as above)
we may assume there is a morphism
$a : X_1 \to X_2$ in $X/S$,
$b : Y_1 \to Y_2$ in $Y/S$, and
$c : Z_1 \to Z_2$ in $Z/S$.
However, these morphisms do not necessarily give rise to a morphism of
distinguished triangles. On the other hand, the necessary diagrams
do commute in $S^{-1}\mathcal{D}$. Hence we see (for example) that
there exists a morphism $s'_2 : Y_2 \to Y_3$ in $S$ such that
$s'_2 \circ f_2 \circ a = s'_2 \circ b \circ f_1$. Another replacement
of $(X_2, Y_2, Z_2)$ as above then gets us to the situation where
$f_2 \circ a = b \circ f_1$. Rotating and applying the same argument
two more times we see that we may assume $(a, b, c)$ is a morphism
of triangles. This proves condition (2).

\medskip\noindent
Next we check condition (3) of
Categories, Definition \ref{categories-definition-directed}.
Suppose $(s_1, s_1', s_1'') : (X, Y, Z) \to (X_1, Y_1, Z_1)$ and
$(s_2, s_2', s_2'') : (X, Y, Z) \to (X_2, Y_2, Z_2)$
are objects of $\mathcal{I}$, and suppose $(a, b, c), (a', b', c')$
are two morphisms between them. Since $a \circ s_1 = a' \circ s_1$
there exists a morphism $s_3 : X_2 \to X_3$ such that
$s_3 \circ a = s_3 \circ a'$. Using the surjectivity statement
we can complete this to a morphism of triangles
$(s_3, s_3', s_3'') : (X_2, Y_2, Z_2) \to (X_3, Y_3, Z_3)$
with $s_3, s_3', s_3'' \in S$. Thus
$(s_3 \circ s_2, s_3' \circ s_2', s_3'' \circ s_2'') :
(X, Y, Z) \to (X_3, Y_3, Z_3)$ is also an object of $\mathcal{I}$
and after composing the maps $(a, b, c), (a', b', c')$ with
$(s_3, s_3', s_3'')$ we obtain $a = a'$. By rotating we may do the
same to get $b = b'$ and $c = c'$.

\medskip\noindent
Finally, we check that $\mathcal{I} \to X/S$ is cofinal, see
Categories, Definition \ref{categories-definition-cofinal}.
The first condition is true as the functor is surjective.
Suppose that we have an object $s : X \to X'$ in $X/S$ and
two objects
$(s_1, s'_1, s''_1) : (X, Y, Z, f, g, h) \to (X_1, Y_1, Z_1, f_1, g_1, h_1)$
and
$(s_2, s'_2, s''_2) : (X, Y, Z, f, g, h) \to (X_2, Y_2, Z_2, f_2, g_2, h_2)$
in $\mathcal{I}$ as well as morphisms $t_1 : X' \to X_1$ and
$t_2 : X' \to X_2$ in $X/S$. By property (2) of $\mathcal{I}$
proved above we can find morphisms
$(s_3, s'_3, s''_3) : (X_1, Y_1, Z_1, f_1, g_1, h_1) \to
(X_3, Y_3, Z_3, f_3, g_3, h_3)$
and
$(s_4, s'_4, s''_4) : (X_2, Y_2, Z_2, f_2, g_2, h_2) \to
(X_3, Y_3, Z_3, f_3, g_3, h_3)$ in $\mathcal{I}$.
We would be done if the compositions
$X' \to X_1 \to X_3$ and $X' \to X_1 \to X_3$ where equal
(see displayed equation in 
Categories, Definition \ref{categories-definition-cofinal}).
If not, then, because $X/S$ is filtered, we can choose
a morphism $X_3 \to X_4$ in $S$ such that the compositions
$X' \to X_1 \to X_3 \to X_4$ and $X' \to X_1 \to X_3 \to X_4$ are equal.
Then we finally complete $X_3 \to X_4$ to a morphism
$(X_3, Y_3, Z_3) \to (X_4, Y_4, Z_4)$ in $\mathcal{I}$
and compose with that morphism to see that the result is true.
\end{proof}









\section{Quotients of triangulated categories}
\label{section-quotients}

\noindent
Given a triangulated category and a triangulated subcategory we can
construct another triangulated category by taking the ``quotient''.
The construction uses a localization. This is similar to the quotient
of an abelian category by a Serre subcategory, see
Homology, Section \ref{homology-section-serre-subcategories}.
Before we do the actual construction we briefly discuss kernels
of exact functors.

\begin{definition}
\label{definition-saturated}
Let $\mathcal{D}$ be a pre-triangulated category. We say a full
pre-triangulated subcategory $\mathcal{D}'$ of $\mathcal{D}$ is
{\it saturated} if whenever $X \oplus Y$ is isomorphic to an object
of $\mathcal{D}'$ then both $X$ and $Y$ are isomorphic to objects
of $\mathcal{D}'$.
\end{definition}

\noindent
A saturated triangulated subcategory is sometimes called a
{\it thick triangulated subcategory}. In some references, this is
only used for strictly full triangulated subcategories (and sometimes
the definition is written such that it implies strictness).
There is another notion, that of an {\it \'epaisse triangulated
subcategory}. The definition is that given a commutative diagram
$$
\xymatrix{
& S \ar[rd] \\
X \ar[ru] \ar[rr] & & Y \ar[r] & T \ar[r] & X[1]
}
$$
where the second line is a distinguished triangle and $S$ and $T$ isomorphic
to objects of $\mathcal{D}'$, then also $X$ and $Y$ are isomorphic to objects
of $\mathcal{D}'$. It turns out that this is equivalent to being
saturated (this is elementary and can be found in \cite{Rickard-derived})
and the notion of a saturated category is easier to work with.

\begin{lemma}
\label{lemma-triangle-functor-kernel}
Let $F : \mathcal{D} \to \mathcal{D}'$ be an exact functor of
pre-triangulated categories. Let $\mathcal{D}''$ be the full subcategory
of $\mathcal{D}$ with objects
$$
\Ob(\mathcal{D}'') =
\{X \in \Ob(\mathcal{D}) \mid F(X) = 0\}
$$
Then $\mathcal{D}''$ is a strictly full saturated pre-triangulated
subcategory of $\mathcal{D}$. If $\mathcal{D}$ is a triangulated category,
then $\mathcal{D}''$ is a triangulated subcategory.
\end{lemma}

\begin{proof}
It is clear that $\mathcal{D}''$ is preserved under $[1]$ and $[-1]$.
If $(X, Y, Z, f, g, h)$ is a distinguished triangle of $\mathcal{D}$
and $F(X) = F(Y) = 0$, then also $F(Z) = 0$ as
$(F(X), F(Y), F(Z), F(f), F(g), F(h))$ is distinguished.
Hence we may apply
Lemma \ref{lemma-triangulated-subcategory}
to see that $\mathcal{D}''$ is a pre-triangulated subcategory (respectively
a triangulated subcategory if $\mathcal{D}$ is a triangulated category).
The final assertion of being saturated follows from
$F(X) \oplus F(Y) = 0 \Rightarrow F(X) = F(Y) = 0$.
\end{proof}

\begin{lemma}
\label{lemma-homological-functor-kernel}
Let $H : \mathcal{D} \to \mathcal{A}$ be a homological functor of
a pre-triangulated category into an abelian category.
Let $\mathcal{D}'$ be the full subcategory of $\mathcal{D}$ with objects
$$
\Ob(\mathcal{D}') =
\{X \in \Ob(\mathcal{D}) \mid
H(X[n]) = 0\text{ for all }n \in \mathbf{Z}\}
$$
Then $\mathcal{D}'$ is a strictly full saturated pre-triangulated subcategory
of $\mathcal{D}$. If $\mathcal{D}$ is a triangulated category, then
$\mathcal{D}'$ is a triangulated subcategory.
\end{lemma}

\begin{proof}
It is clear that $\mathcal{D}'$ is preserved under $[1]$ and $[-1]$.
If $(X, Y, Z, f, g, h)$ is a distinguished triangle of $\mathcal{D}$
and $H(X[n]) = H(Y[n]) = 0$ for all $n$, then also $H(Z[n]) = 0$ for all $n$
by the long exact sequence (\ref{equation-long-exact-cohomology-sequence}).
Hence we may apply
Lemma \ref{lemma-triangulated-subcategory}
to see that $\mathcal{D}'$ is a pre-triangulated subcategory (respectively
a triangulated subcategory if $\mathcal{D}$ is a triangulated category).
The assertion of being saturated follows from
\begin{align*}
H((X \oplus Y)[n]) = 0 & \Rightarrow H(X[n] \oplus Y[n]) = 0 \\
& \Rightarrow H(X[n]) \oplus H(Y[n]) = 0 \\
& \Rightarrow H(X[n]) = H(Y[n]) = 0
\end{align*}
for all $n \in \mathbf{Z}$.
\end{proof}

\begin{lemma}
\label{lemma-homological-functor-bounded}
Let $H : \mathcal{D} \to \mathcal{A}$ be a homological functor of
a pre-triangulated category into an abelian category.
Let $\mathcal{D}_H^{+}, \mathcal{D}_H^{-}, \mathcal{D}_H^b$
be the full subcategory of $\mathcal{D}$ with objects
$$
\begin{matrix}
\Ob(\mathcal{D}_H^{+}) =
\{X \in \Ob(\mathcal{D}) \mid
H(X[n]) = 0\text{ for all }n \ll 0\} \\
\Ob(\mathcal{D}_H^{-}) =
\{X \in \Ob(\mathcal{D}) \mid
H(X[n]) = 0\text{ for all }n \gg 0\} \\
\Ob(\mathcal{D}_H^b) =
\{X \in \Ob(\mathcal{D}) \mid
H(X[n]) = 0\text{ for all }|n| \gg 0\}
\end{matrix}
$$
Each of these is a strictly full saturated pre-triangulated subcategory
of $\mathcal{D}$. If $\mathcal{D}$ is a triangulated category, then
each is a triangulated subcategory.
\end{lemma}

\begin{proof}
Let us prove this for $\mathcal{D}_H^{+}$.
It is clear that it is preserved under $[1]$ and $[-1]$.
If $(X, Y, Z, f, g, h)$ is a distinguished triangle of $\mathcal{D}$
and $H(X[n]) = H(Y[n]) = 0$ for all $n \ll 0$, then also $H(Z[n]) = 0$
for all $n \ll 0$ by the long exact sequence
(\ref{equation-long-exact-cohomology-sequence}).
Hence we may apply
Lemma \ref{lemma-triangulated-subcategory}
to see that $\mathcal{D}_H^{+}$ is a pre-triangulated subcategory
(respectively a triangulated subcategory if $\mathcal{D}$ is a
triangulated category). The assertion of being saturated follows from
\begin{align*}
H((X \oplus Y)[n]) = 0 & \Rightarrow H(X[n] \oplus Y[n]) = 0 \\
& \Rightarrow H(X[n]) \oplus H(Y[n]) = 0 \\
& \Rightarrow H(X[n]) = H(Y[n]) = 0
\end{align*}
for all $n \in \mathbf{Z}$.
\end{proof}

\begin{definition}
\label{definition-kernel-category}
Let $\mathcal{D}$ be a (pre-)triangulated category.
\begin{enumerate}
\item Let $F : \mathcal{D} \to \mathcal{D}'$ be an exact functor.
The {\it kernel of $F$} is the strictly full saturated
(pre-)triangulated subcategory described in
Lemma \ref{lemma-triangle-functor-kernel}.
\item Let $H : \mathcal{D} \to \mathcal{A}$ be a homological functor.
The {\it kernel of $H$} is the strictly full saturated
(pre-)triangulated subcategory described in
Lemma \ref{lemma-homological-functor-kernel}.
\end{enumerate}
These are sometimes denoted $\Ker(F)$ or $\Ker(H)$.
\end{definition}

\noindent
The proof of the following lemma uses TR4.

\begin{lemma}
\label{lemma-construct-multiplicative-system}
Let $\mathcal{D}$ be a triangulated category.
Let $\mathcal{D}' \subset \mathcal{D}$ be a full triangulated
subcategory. Set
\begin{equation}
\label{equation-multiplicative-system}
S =
\left\{
\begin{matrix}
f \in \text{Arrows}(\mathcal{D})
\text{ such that there exists a distinguished triangle }\\
(X, Y, Z, f, g, h) \text{ of }\mathcal{D}\text{ with }
Z\text{ isomorphic to an object of }\mathcal{D}'
\end{matrix}
\right\}
\end{equation}
Then $S$ is a multiplicative system compatible with the triangulated
structure on $\mathcal{D}$. In this situation the following are equivalent
\begin{enumerate}
\item $S$ is a saturated multiplicative system,
\item $\mathcal{D}'$ is a saturated triangulated subcategory.
\end{enumerate}
\end{lemma}

\begin{proof}
To prove the first assertion we have to prove that
MS1, MS2, MS3 and MS5, MS6 hold.

\medskip\noindent
Proof of MS1. It is clear that identities are in $S$ because
$(X, X, 0, 1, 0, 0)$ is distinguished for every object $X$ of $\mathcal{D}$
and because $0$ is an object of $\mathcal{D}'$. Let $f : X \to Y$
and $g : Y \to Z$ be composable morphisms contained in $S$.
Choose distinguished triangles $(X, Y, Q_1, f, p_1, d_1)$,
$(X, Z, Q_2, g \circ f, p_2, d_2)$, and $(Y, Z, Q_3, g, p_3, d_3)$.
By assumption we know that $Q_1$ and $Q_3$ are isomorphic to objects
of $\mathcal{D}'$. By TR4 we know there exists a distinguished
triangle $(Q_1, Q_2, Q_3, a, b, c)$. Since $\mathcal{D}'$ is a
triangulated subcategory we conclude that $Q_2$ is isomorphic to
an object of $\mathcal{D}'$. Hence $g \circ f \in S$.

\medskip\noindent
Proof of MS3. Let $a : X \to Y$ be a morphism and let $t : Z \to X$ be
an element of $S$ such that $a \circ t = 0$. To prove LMS3 it suffices to
find an $s \in S$ such that $s \circ a = 0$, compare with the proof of
Lemma \ref{lemma-triangle-functor-localize}. Choose a distinguished
triangle $(Z, X, Q, t, g, h)$ using TR1 and TR2. Since $a \circ t = 0$
we see by
Lemma \ref{lemma-representable-homological}
there exists a morphism $i : Q \to Y$ such that $i \circ g = a$.
Finally, using TR1 again we can choose a triangle
$(Q, Y, W, i, s, k)$. Here is a picture
$$
\xymatrix{
Z \ar[r]_t & X \ar[r]_g \ar[d]^1 & Q \ar[r] \ar[d]^i & Z[1] \\
& X \ar[r]_a & Y \ar[d]^s \\
& & W
}
$$
Since $t \in S$ we see that $Q$ is isomorphic to an object of $\mathcal{D}'$.
Hence $s \in S$. Finally, $s \circ a = s \circ i \circ g = 0$ as
$s \circ i = 0$ by Lemma \ref{lemma-composition-zero}.
We conclude that LMS3 holds.
The proof of RMS3 is dual.

\medskip\noindent
Proof of MS5. Follows as distinguished triangles and $\mathcal{D}'$
are stable under translations

\medskip\noindent
Proof of MS6. Suppose given a commutative diagram
$$
\xymatrix{
X \ar[r] \ar[d]^s &
Y \ar[d]^{s'} \\
X' \ar[r] &
Y'
}
$$
with $s, s' \in S$. By
Proposition \ref{proposition-9}
we can extend this to a nine square diagram. As $s, s'$ are elements of $S$
we see that $X'', Y''$ are isomorphic to objects of $\mathcal{D}'$.
Since $\mathcal{D}'$ is a full triangulated subcategory we see that
$Z''$ is also isomorphic to an object of $\mathcal{D}'$.
Whence the morphism $Z \to Z'$
is an element of $S$. This proves MS6.

\medskip\noindent
MS2 is a formal consequence of MS1, MS5, and MS6, see
Lemma \ref{lemma-localization-conditions}.
This finishes the proof of the first assertion of the lemma.

\medskip\noindent
Let's assume that $S$ is saturated. (In the following we will use
rotation of distinguished triangles without further mention.)
Let $X \oplus Y$ be an object isomorphic to an object of $\mathcal{D}'$.
Consider the morphism $f : 0 \to X$. The composition
$0 \to X \to X \oplus Y$ is an element
of $S$ as $(0, X \oplus Y, X \oplus Y, 0, 1, 0)$ is a distinguished
triangle. The composition $Y[-1] \to 0 \to X$ is an element of $S$
as $(X, X \oplus Y, Y, (1, 0), (0, 1), 0)$ is a distinguished triangle, see
Lemma \ref{lemma-split}.
Hence $0 \to X$ is an element of $S$ (as $S$ is saturated).
Thus $X$ is isomorphic to an object of $\mathcal{D}'$ as desired.

\medskip\noindent
Finally, assume $\mathcal{D}'$ is a saturated triangulated subcategory.
Let
$$
W \xrightarrow{h}
X \xrightarrow{g}
Y \xrightarrow{f} Z
$$
be composable morphisms of $\mathcal{D}$ such that $fg, gh \in S$.
We will build up a picture of objects as in the diagram below.
$$
\xymatrix{
 & &
Q_{12} \ar[rd] & &
Q_{23} \ar[rd] \\
 &
Q_1 \ar[ld]_{\! + \! 1} \ar[ru] & &
Q_2 \ar[ld]_{\! + \! 1} \ar[ll]_{\! + \! 1} \ar[ru] & &
Q_3 \ar[ld]_{\! + \! 1} \ar[ll]_{\! + \! 1} \\
W \ar[rr] & &
X \ar[lu] \ar[rr] & &
Y \ar[lu] \ar[rr] & &
Z \ar[lu]
}
$$
First choose distinguished triangles
$(W, X, Q_1)$, $(X, Y, Q_2)$, $(Y, Z, Q_3)$ $(W, Y, Q_{12})$, and
$(X, Z, Q_{23})$. Denote $s : Q_2 \to Q_1[1]$ the composition
$Q_2 \to X[1] \to Q_1[1]$. Denote $t : Q_3 \to Q_2[1]$ the
composition $Q_3 \to Y[1] \to Q_2[1]$.
By TR4 applied to the composition $W \to X \to Y$
and the composition $X \to Y \to Z$ there exist
distinguished triangles $(Q_1, Q_{12}, Q_2)$ and $(Q_2, Q_{23}, Q_3)$
which use the morphisms $s$ and $t$.
The objects $Q_{12}$ and $Q_{23}$ are isomorphic to objects of
$\mathcal{D}'$ as $W \to Y$ and $X \to Z$ are assumed in $S$.
Hence also $s[1]t$ is an element of $S$ as $S$ is closed under compositions
and shifts.
Note that $s[1]t = 0$ as $Y[1] \to Q_2[1] \to X[2]$ is zero, see
Lemma \ref{lemma-composition-zero}.
Hence $Q_3[1] \oplus Q_1[2]$ is isomorphic to an object of
$\mathcal{D}'$, see Lemma \ref{lemma-split}.
By assumption on $\mathcal{D}'$ we conclude that $Q_3$ and $Q_1$ are isomorphic
to objects of $\mathcal{D}'$. Looking at the distinguished triangle
$(Q_1, Q_{12}, Q_2)$ we conclude that $Q_2$ is also isomorphic to
an object of $\mathcal{D}'$. Looking at the distinguished triangle
$(X, Y, Q_2)$ we finally conclude that $g \in S$. (It is also
follows that $h, f \in S$, but we don't need this.)
\end{proof}

\begin{definition}
\label{definition-quotient-category}
Let $\mathcal{D}$ be a triangulated category.
Let $\mathcal{B}$ be a full triangulated subcategory.
We define the {\it quotient category $\mathcal{D}/\mathcal{B}$}
by the formula $\mathcal{D}/\mathcal{B} = S^{-1}\mathcal{D}$, where
$S$ is the multiplicative system of $\mathcal{D}$ associated to
$\mathcal{B}$ via
Lemma \ref{lemma-construct-multiplicative-system}.
The localization functor $Q : \mathcal{D} \to \mathcal{D}/\mathcal{B}$
is called the {\it quotient functor} in this case.
\end{definition}

\noindent
Note that the quotient functor
$Q : \mathcal{D} \to \mathcal{D}/\mathcal{B}$
is an exact functor of triangulated categories, see
Proposition \ref{proposition-construct-localization}.
The universal property of this construction is the following.

\begin{lemma}
\label{lemma-universal-property-quotient}
\begin{slogan}
The universal property of the Verdier quotient.
\end{slogan}
Let $\mathcal{D}$ be a triangulated category. Let $\mathcal{B}$
be a full triangulated subcategory of $\mathcal{D}$. Let
$Q : \mathcal{D} \to \mathcal{D}/\mathcal{B}$ be the quotient functor.
\begin{enumerate}
\item If $H : \mathcal{D} \to \mathcal{A}$ is a homological functor into
an abelian category $\mathcal{A}$ such that
$\mathcal{B} \subset \Ker(H)$ then there exists a unique factorization
$H' : \mathcal{D}/\mathcal{B} \to \mathcal{A}$ such that $H = H' \circ Q$
and $H'$ is a homological functor too.
\item If $F : \mathcal{D} \to \mathcal{D}'$ is an exact functor into
a pre-triangulated category $\mathcal{D}'$ such that
$\mathcal{B} \subset \Ker(F)$ then there exists a unique factorization
$F' : \mathcal{D}/\mathcal{B} \to \mathcal{D}'$ such that $F = F' \circ Q$
and $F'$ is an exact functor too.
\end{enumerate}
\end{lemma}

\begin{proof}
This lemma follows from
Lemma \ref{lemma-universal-property-localization}.
Namely, if $f : X \to Y$ is a morphism of $\mathcal{D}$
such that for some distinguished triangle $(X, Y, Z, f, g, h)$
the object $Z$ is isomorphic to an object of $\mathcal{B}$, then
$H(f)$, resp.\ $F(f)$ is an isomorphism under the assumptions of
(1), resp.\ (2). Details omitted.
\end{proof}

\noindent
The kernel of the quotient functor can be described as follows.

\begin{lemma}
\label{lemma-kernel-quotient}
Let $\mathcal{D}$ be a triangulated category.
Let $\mathcal{B}$ be a full triangulated subcategory.
The kernel of the quotient functor
$Q : \mathcal{D} \to \mathcal{D}/\mathcal{B}$
is the strictly full subcategory of $\mathcal{D}$ whose objects are
$$
\Ob(\Ker(Q)) =
\left\{
\begin{matrix}
Z \in \Ob(\mathcal{D})
\text{ such that there exists a }Z' \in \Ob(\mathcal{D}) \\
\text{ such that }Z \oplus Z'\text{ is isomorphic to an object of }\mathcal{B}
\end{matrix}
\right\}
$$
In other words it is the smallest strictly full saturated triangulated
subcategory of $\mathcal{D}$ containing $\mathcal{B}$.
\end{lemma}

\begin{proof}
First note that the kernel is automatically a strictly full
triangulated subcategory containing summands of any of its objects, see
Lemma \ref{lemma-triangle-functor-kernel}.
The description of its objects follows from the definitions and
Lemma \ref{lemma-kernel-localization} part (4).
\end{proof}

\noindent
Let $\mathcal{D}$ be a triangulated category.
At this point we have constructions which induce order
preserving maps between
\begin{enumerate}
\item the partially ordered set of multiplicative systems $S$ in $\mathcal{D}$
compatible with the triangulated structure, and
\item the partially ordered set of full triangulated subcategories
$\mathcal{B} \subset \mathcal{D}$.
\end{enumerate}
Namely, the constructions are given by
$S \mapsto \mathcal{B}(S) = \Ker(Q : \mathcal{D} \to S^{-1}\mathcal{D})$
and $\mathcal{B} \mapsto S(\mathcal{B})$
where $S(\mathcal{B})$ is the multiplicative set of
(\ref{equation-multiplicative-system}), i.e.,
$$
S(\mathcal{B}) =
\left\{
\begin{matrix}
f \in \text{Arrows}(\mathcal{D})
\text{ such that there exists a distinguished triangle }\\
(X, Y, Z, f, g, h) \text{ of }\mathcal{D}\text{ with }
Z\text{ isomorphic to an object of }\mathcal{B}
\end{matrix}
\right\}
$$
Note that it is not the case that these operations are mutually inverse.

\begin{lemma}
\label{lemma-operations}
Let $\mathcal{D}$ be a triangulated category. The operations described above
have the following properties
\begin{enumerate}
\item $S(\mathcal{B}(S))$ is the ``saturation'' of $S$, i.e., it is the
smallest saturated multiplicative system in $\mathcal{D}$ containing $S$, and
\item $\mathcal{B}(S(\mathcal{B}))$ is the ``saturation'' of $\mathcal{B}$,
i.e., it is the smallest strictly full saturated triangulated subcategory of
$\mathcal{D}$ containing $\mathcal{B}$.
\end{enumerate}
In particular, the constructions define mutually inverse maps between
the (partially ordered) set of saturated multiplicative systems in
$\mathcal{D}$ compatible with the triangulated structure on $\mathcal{D}$
and
the (partially ordered) set of strictly full saturated triangulated
subcategories of $\mathcal{D}$.
\end{lemma}

\begin{proof}
First, let's start with a full triangulated subcategory $\mathcal{B}$. Then
$\mathcal{B}(S(\mathcal{B})) =
\Ker(Q : \mathcal{D} \to \mathcal{D}/\mathcal{B})$
and hence (2) is the content of
Lemma \ref{lemma-kernel-quotient}.

\medskip\noindent
Next, suppose that $S$ is multiplicative system in $\mathcal{D}$ compatible
with the triangulation on $\mathcal{D}$. Then
$\mathcal{B}(S) = \Ker(Q : \mathcal{D} \to S^{-1}\mathcal{D})$.
Hence (using
Lemma \ref{lemma-third-object-zero}
in the localized category)
\begin{align*}
S(\mathcal{B}(S))
& =
\left\{
\begin{matrix}
f \in \text{Arrows}(\mathcal{D})
\text{ such that there exists a distinguished}\\
\text{triangle }(X, Y, Z, f, g, h) \text{ of }\mathcal{D}\text{ with }Q(Z) = 0
\end{matrix}
\right\}
\\
& =
\{f \in \text{Arrows}(\mathcal{D}) \mid Q(f)\text{ is an isomorphism}\} \\
& = \hat S = S'
\end{align*}
in the notation of
Categories, Lemma \ref{categories-lemma-what-gets-inverted}.
The final statement of that lemma finishes the proof.
\end{proof}

\begin{lemma}
\label{lemma-acyclic-general}
Let $H : \mathcal{D} \to \mathcal{A}$ be a homological functor from a
triangulated category $\mathcal{D}$ to an abelian category $\mathcal{A}$, see
Definition \ref{definition-homological}.
The subcategory $\Ker(H)$ of $\mathcal{D}$ is a strictly full
saturated triangulated subcategory of $\mathcal{D}$ whose corresponding
saturated multiplicative system (see
Lemma \ref{lemma-operations})
is the set
$$
S = \{f \in \text{Arrows}(\mathcal{D}) \mid
H^i(f)\text{ is an isomorphism for all }i \in \mathbf{Z}\}.
$$
The functor $H$ factors through the quotient functor
$Q : \mathcal{D} \to \mathcal{D}/\Ker(H)$.
\end{lemma}

\begin{proof}
The category $\Ker(H)$ is a strictly full saturated triangulated
subcategory of $\mathcal{D}$ by
Lemma \ref{lemma-homological-functor-kernel}.
The set $S$ is a saturated multiplicative system compatible with the
triangulated structure by
Lemma \ref{lemma-homological-functor-localize}.
Recall that the multiplicative system corresponding to
$\Ker(H)$ is the set
$$
\left\{
\begin{matrix}
f \in \text{Arrows}(\mathcal{D})
\text{ such that there exists a distinguished triangle }\\
(X, Y, Z, f, g, h)\text{ with } H^i(Z) = 0 \text{ for all }i
\end{matrix}
\right\}
$$
By the long exact cohomology sequence, see
(\ref{equation-long-exact-cohomology-sequence}),
it is clear that $f$ is an element of this set if and only if $f$ is
an element of $S$. Finally, the factorization of $H$ through $Q$ is a
consequence of
Lemma \ref{lemma-universal-property-quotient}.
\end{proof}










\section{Adjoints for exact functors}
\label{section-adjoints}

\noindent
Results on adjoint functors between triangulated categories.

\begin{lemma}
\label{lemma-adjoint-is-exact}
Let $F : \mathcal{D} \to \mathcal{D}'$ be an exact functor between
triangulated categories. If $F$ admits a right adjoint
$G: \mathcal{D'} \to \mathcal{D}$, then $G$ is also an exact functor.
\end{lemma}

\begin{proof}
Let $X$ be an object of $\mathcal{D}$ and
$A$ an object of $\mathcal{D}'$. Since $F$ is an exact functor we see that
\begin{align*}
\Mor_\mathcal{D}(X, G(A[1])
& =
\Mor_{\mathcal{D}'}(F(X), A[1]) \\
& =
\Mor_{\mathcal{D}'}(F(X)[-1], A) \\
& =
\Mor_{\mathcal{D}'}(F(X[-1]), A) \\
& =
\Mor_\mathcal{D}(X[-1], G(A)) \\
& =
\Mor_\mathcal{D}(X, G(A)[1])
\end{align*}
By Yoneda's lemma (Categories, Lemma \ref{categories-lemma-yoneda})
we obtain a canonical isomorphism $G(A)[1] = G(A[1])$.
Let $A \to B \to C \to A[1]$ be a distinguished triangle in $\mathcal{D}'$.
Choose a distinguished triangle
$$
G(A) \to G(B) \to X \to G(A)[1]
$$
in $\mathcal{D}$. Then $F(G(A)) \to F(G(B)) \to F(X) \to F(G(A))[1]$
is a distinguished triangle in $\mathcal{D}'$. By TR3 we can choose
a morphism of distinguished triangles
$$
\xymatrix{
F(G(A)) \ar[r] \ar[d] & F(G(B)) \ar[r] \ar[d] & F(X) \ar[r] \ar[d] &
F(G(A))[1] \ar[d] \\
A \ar[r] & B \ar[r] & C \ar[r] & A[1]
}
$$
Since $G$ is the adjoint the new morphism determines a morphism $X \to G(C)$
such that the diagram
$$
\xymatrix{
G(A) \ar[r] \ar[d] & G(B) \ar[r] \ar[d] & X \ar[r] \ar[d] & G(A)[1] \ar[d] \\
G(A) \ar[r] & G(B) \ar[r] & G(C) \ar[r] & G(A)[1]
}
$$
commutes. Applying the homological functor $\Hom_{\mathcal{D}'}(W, -)$
for an object $W$ of $\mathcal{D}'$ we deduce from the $5$ lemma that
$$
\Hom_{\mathcal{D}'}(W, X) \to \Hom_{\mathcal{D}'}(W, G(C))
$$
is a bijection and using the Yoneda lemma once more we conclude that
$X \to G(C)$ is an isomorphism. Hence we conclude that
$G(A) \to G(B) \to G(C) \to G(A)[1]$ is a distinguished triangle
which is what we wanted to show.
\end{proof}

\begin{lemma}
\label{lemma-fully-faithful-adjoint-kernel-zero}
Let $\mathcal{D}$, $\mathcal{D}'$ be triangulated categories.
Let $F : \mathcal{D} \to \mathcal{D}'$ and
$G : \mathcal{D}' \to \mathcal{D}$ be functors. Assume that
\begin{enumerate}
\item $F$ and $G$ are exact functors,
\item $F$ is fully faithful,
\item $G$ is a right adjoint to $F$, and
\item the kernel of $G$ is zero.
\end{enumerate}
Then $F$ is an equivalence of categories.
\end{lemma}

\begin{proof}
Since $F$ is fully faithful the adjunction map $\text{id} \to G \circ F$
is an isomorphism (Categories, Lemma
\ref{categories-lemma-adjoint-fully-faithful}).
Let $X$ be an object of $\mathcal{D}'$.
Choose a distinguished triangle
$$
F(G(X)) \to X \to Y \to F(G(X))[1]
$$
in $\mathcal{D}'$. Applying $G$ and using that $G(F(G(X))) = G(X)$
we find a distinguished triangle
$$
G(X) \to G(X) \to G(Y) \to G(X)[1]
$$
Hence $G(Y) = 0$. Thus $Y = 0$. Thus $F(G(X)) \to X$ is an isomorphism.
\end{proof}









\section{The homotopy category}
\label{section-homotopy}

\noindent
Let $\mathcal{A}$ be an additive category. The homotopy category
$K(\mathcal{A})$ of $\mathcal{A}$ is the category of complexes of
$\mathcal{A}$ with morphisms given by morphisms of complexes up to homotopy.
Here is the formal definition.

\begin{definition}
\label{definition-complexes-notation}
Let $\mathcal{A}$ be an additive category.
\begin{enumerate}
\item We set $\text{Comp}(\mathcal{A}) = \text{CoCh}(\mathcal{A})$
be the {\it category of (cochain) complexes}.
\item A complex $K^\bullet$ is said to be
{\it bounded below} if $K^n = 0$ for all $n \ll 0$.
\item A complex $K^\bullet$ is said to be
{\it bounded above} if $K^n = 0$ for all $n \gg 0$.
\item A complex $K^\bullet$ is said to be
{\it bounded} if $K^n = 0$ for all $|n| \gg 0$.
\item We let
$\text{Comp}^{+}(\mathcal{A})$, $\text{Comp}^{-}(\mathcal{A})$,
resp.\ $\text{Comp}^b(\mathcal{A})$ be the full subcategory
of $\text{Comp}(\mathcal{A})$ whose objects are the complexes
which are bounded below, bounded above, resp.\ bounded.
\item We let $K(\mathcal{A})$ be the category with the same objects
as $\text{Comp}(\mathcal{A})$ but as morphisms homotopy classes of
maps of complexes (see
Homology, Lemma \ref{homology-lemma-compose-homotopy-cochain}).
\item We let $K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$,
resp.\ $K^b(\mathcal{A})$ be the full subcategory of $K(\mathcal{A})$
whose objects are bounded below, bounded above, resp.\ bounded
complexes of $\mathcal{A}$.
\end{enumerate}
\end{definition}

\noindent
It will turn out that the categories $K(\mathcal{A})$,
$K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, and $K^b(\mathcal{A})$
are triangulated categories. To prove this we first develop
some machinery related to cones and split exact sequences.




\section{Cones and termwise split sequences}
\label{section-cones}

\noindent
Let $\mathcal{A}$ be an additive category, and let
$K(\mathcal{A})$ denote the category of complexes of
$\mathcal{A}$ with morphisms given by morphisms of
complexes up to homotopy. Note that the shift functors
$[n]$ on complexes, see
Homology, Definition \ref{homology-definition-shift-cochain},
give rise to functors $[n] : K(\mathcal{A}) \to K(\mathcal{A})$
such that $[n] \circ [m] = [n + m]$ and $[0] = \text{id}$.

\begin{definition}
\label{definition-cone}
Let $\mathcal{A}$ be an additive category.
Let $f : K^\bullet \to L^\bullet$ be a morphism of
complexes of $\mathcal{A}$. The {\it cone} of $f$
is the complex $C(f)^\bullet$ given by
$C(f)^n = L^n \oplus K^{n + 1}$ and
differential
$$
d_{C(f)}^n =
\left(
\begin{matrix}
d^n_L & f^{n + 1} \\
0 & -d_K^{n + 1}
\end{matrix}
\right)
$$
It comes equipped with canonical morphisms of complexes
$i : L^\bullet \to C(f)^\bullet$ and $p : C(f)^\bullet \to K^\bullet[1]$
induced by the obvious maps $L^n \to C(f)^n \to K^{n + 1}$.
\end{definition}

\noindent
In other words $(K, L, C(f), f, i, p)$ forms a triangle:
$$
K^\bullet \to L^\bullet \to C(f)^\bullet \to K^\bullet[1]
$$
The formation of this triangle is
functorial in the following sense.

\begin{lemma}
\label{lemma-functorial-cone}
Suppose that
$$
\xymatrix{
K_1^\bullet \ar[r]_{f_1} \ar[d]_a & L_1^\bullet \ar[d]^b \\
K_2^\bullet \ar[r]^{f_2} & L_2^\bullet
}
$$
is a diagram of morphisms of complexes which is commutative
up to homotopy. Then there exists a morphism
$c : C(f_1)^\bullet \to C(f_2)^\bullet$ which gives rise to
a morphism of triangles
$(a, b, c) : (K_1^\bullet, L_1^\bullet, C(f_1)^\bullet, f_1, i_1, p_1)
\to
(K_2^\bullet, L_2^\bullet, C(f_2)^\bullet, f_2, i_2, p_2)$
of $K(\mathcal{A})$.
\end{lemma}

\begin{proof}
Let $h^n : K_1^n \to L_2^{n - 1}$ be a family of morphisms such that
$b \circ f_1 - f_2 \circ a= d \circ h + h \circ d$.
Define $c^n$ by the matrix
$$
c^n =
\left(
\begin{matrix}
b^n & h^{n + 1} \\
0 & a^{n + 1}
\end{matrix}
\right) :
L_1^n \oplus K_1^{n + 1} \to L_2^n \oplus K_2^{n + 1}
$$
A matrix computation show that $c$ is a morphism of complexes.
It is trivial that $c \circ i_1 = i_2 \circ b$, and it is
trivial also to check that $p_2 \circ c = a \circ p_1$.
\end{proof}

\noindent
Note that the morphism $c : C(f_1)^\bullet \to C(f_2)^\bullet$
constructed in the
proof of Lemma \ref{lemma-functorial-cone} in general depends on the
chosen homotopy $h$ between $f_2 \circ a$ and $b \circ f_1$.

\begin{lemma}
\label{lemma-map-from-cone}
Suppose that $f: K^\bullet \to L^\bullet$ and $g : L^\bullet \to M^\bullet$
are morphisms of complexes such that $g \circ f$ is homotopic to zero.
Then
\begin{enumerate}
\item $g$ factors through a morphism $C(f)^\bullet \to M^\bullet$, and
\item $f$ factors through a morphism $K^\bullet \to C(g)^\bullet[-1]$.
\end{enumerate}
\end{lemma}

\begin{proof}
The assumptions say that the diagram
$$
\xymatrix{
K^\bullet \ar[r]_f \ar[d] & L^\bullet \ar[d]^g \\
0 \ar[r] & M^\bullet
}
$$
commutes up to homotopy.
Since the cone on $0 \to M^\bullet$ is $M^\bullet$ the
map $C(f)^\bullet \to C(0 \to M^\bullet) = M^\bullet$
of Lemma \ref{lemma-functorial-cone}
is the map in (1). The cone on $K^\bullet \to 0$ is
$K^\bullet[1]$ and applying Lemma \ref{lemma-functorial-cone}
gives a map $K^\bullet[1] \to C(g)^\bullet$. Applying
$[-1]$ we obtain the map in (2).
\end{proof}

\noindent
Note that the morphisms $C(f)^\bullet \to M^\bullet$ and
$K^\bullet \to C(g)^\bullet[-1]$ constructed in the proof
of Lemma \ref{lemma-map-from-cone} in general depend on the
chosen homotopy.

\begin{definition}
\label{definition-termwise-split-map}
Let $\mathcal{A}$ be an additive category.
A {\it termwise split injection $\alpha : A^\bullet \to B^\bullet$}
is a morphism of complexes such that each $A^n \to B^n$
is isomorphic to the inclusion of a direct summand.
A {\it termwise split surjection $\beta : B^\bullet \to C^\bullet$}
is a morphism of complexes such that each $B^n \to C^n$
is isomorphic to the projection onto a direct summand.
\end{definition}

\begin{lemma}
\label{lemma-make-commute-map}
Let $\mathcal{A}$ be an additive category.
Let
$$
\xymatrix{
A^\bullet \ar[r]_f \ar[d]_a & B^\bullet \ar[d]^b \\
C^\bullet \ar[r]^g & D^\bullet
}
$$
be a diagram of morphisms of complexes commuting up to homotopy.
If $f$ is a termwise split injection, then $b$ is homotopic to a
morphism which makes the diagram commute.
If $g$ is a split surjection, then $a$ is homotopic to a
morphism which makes the diagram commute.
\end{lemma}

\begin{proof}
Let $h^n : A^n \to D^{n - 1}$ be a collection of morphisms
such that $bf - ga = dh + hd$. Suppose that $\pi^n : B^n \to A^n$
are morphisms splitting the morphisms $f^n$.
Take $b' = b - dh\pi - h\pi d$.
Suppose $s^n : D^n \to C^n$ are morphisms splitting the morphisms
$g^n : C^n \to D^n$. Take $a' = a + dsh + shd$.
Computations omitted.
\end{proof}

\noindent
The following lemma can be used to replace a morphism of complexes
by a morphism where in each degree the map is the injection of a
direct summand.

\begin{lemma}
\label{lemma-make-injective}
Let $\mathcal{A}$ be an additive category.
Let $\alpha : K^\bullet \to L^\bullet$ be a morphism
of complexes of $\mathcal{A}$.
There exists a factorization
$$
\xymatrix{
K^\bullet \ar[r]^{\tilde \alpha} \ar@/_1pc/[rr]_\alpha &
\tilde L^\bullet \ar[r]^\pi &
L^\bullet
}
$$
such that
\begin{enumerate}
\item $\tilde \alpha$ is a termwise split injection (see
Definition \ref{definition-termwise-split-map}),
\item there is a map of complexes $s : L^\bullet \to \tilde L^\bullet$
such that $\pi \circ s = \text{id}_{L^\bullet}$ and such that
$s \circ \pi$ is homotopic to $\text{id}_{\tilde L^\bullet}$.
\end{enumerate}
Moreover, if both $K^\bullet$ and $L^\bullet$ are in
$K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, or $K^b(\mathcal{A})$,
then so is $\tilde L^\bullet$.
\end{lemma}

\begin{proof}
We set
$$
\tilde L^n = L^n \oplus K^n \oplus K^{n + 1}
$$
and we define
$$
d^n_{\tilde L} =
\left(
\begin{matrix}
d^n_L & 0 & 0 \\
0 & d^n_K & \text{id}_{K^{n + 1}} \\
0 & 0 & -d^{n + 1}_K
\end{matrix}
\right)
$$
In other words, $\tilde L^\bullet = L^\bullet \oplus C(1_{K^\bullet})$.
Moreover, we set
$$
\tilde \alpha =
\left(
\begin{matrix}
\alpha \\
\text{id}_{K^n} \\
0
\end{matrix}
\right)
$$
which is clearly a split injection. It is also clear that it defines a morphism
of complexes. We define
$$
\pi =
\left(
\begin{matrix}
\text{id}_{L^n} &
0 &
0
\end{matrix}
\right)
$$
so that clearly $\pi \circ \tilde \alpha = \alpha$. We set
$$
s =
\left(
\begin{matrix}
\text{id}_{L^n} \\
0 \\
0
\end{matrix}
\right)
$$
so that $\pi \circ s = \text{id}_{L^\bullet}$. Finally,
let $h^n : \tilde L^n \to \tilde L^{n - 1}$ be the map
which maps the summand $K^n$ of $\tilde L^n$ via the identity morphism
to the summand $K^n$ of $\tilde L^{n - 1}$. Then it is a trivial matter
(see computations in remark below) to prove that
$$
\text{id}_{\tilde L^\bullet} - s \circ \pi
=
d \circ h + h \circ d
$$
which finishes the proof of the lemma.
\end{proof}

\begin{remark}
\label{remark-compute-modules}
To see the last displayed equality in the proof above we can argue
with elements as follows. We have
$s\pi(l, k, k^{+}) = (l, 0, 0)$.
Hence the morphism of the left hand side maps
$(l, k, k^{+})$ to $(0, k, k^{+})$.
On the other hand $h(l, k, k^{+}) = (0, 0, k)$ and
$d(l, k, k^{+}) = (dl, dk + k^{+}, -dk^{+})$.
Hence $(dh + hd)(l, k, k^{+}) =
d(0, 0, k) + h(dl, dk + k^{+}, -dk^{+}) =
(0, k, -dk) + (0, 0, dk + k^{+}) = (0, k, k^{+})$
as desired.
\end{remark}

\begin{lemma}
\label{lemma-make-surjective}
Let $\mathcal{A}$ be an additive category.
Let $\alpha : K^\bullet \to L^\bullet$ be a morphism
of complexes of $\mathcal{A}$.
There exists a factorization
$$
\xymatrix{
K^\bullet \ar[r]^i \ar@/_1pc/[rr]_\alpha &
\tilde K^\bullet \ar[r]^{\tilde \alpha} &
L^\bullet
}
$$
such that
\begin{enumerate}
\item $\tilde \alpha$ is a termwise split surjection (see
Definition \ref{definition-termwise-split-map}),
\item there is a map of complexes $s : \tilde K^\bullet \to K^\bullet$
such that $s \circ i = \text{id}_{K^\bullet}$ and such that
$i \circ s$ is homotopic to $\text{id}_{\tilde K^\bullet}$.
\end{enumerate}
Moreover, if both $K^\bullet$ and $L^\bullet$ are in
$K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, or $K^b(\mathcal{A})$,
then so is $\tilde K^\bullet$.
\end{lemma}

\begin{proof}
Dual to Lemma \ref{lemma-make-injective}.
Take
$$
\tilde K^n = K^n \oplus L^{n - 1} \oplus L^n
$$
and we define
$$
d^n_{\tilde K} =
\left(
\begin{matrix}
d^n_K & 0 & 0 \\
0 & - d^{n - 1}_L & \text{id}_{L^n} \\
0 & 0 & d^n_L
\end{matrix}
\right)
$$
in other words $\tilde K^\bullet = K^\bullet \oplus C(1_{L^\bullet[-1]})$.
Moreover, we set
$$
\tilde \alpha =
\left(
\begin{matrix}
\alpha &
0 &
\text{id}_{L^n}
\end{matrix}
\right)
$$
which is clearly a split surjection. It is also clear that it defines a
morphism of complexes. We define
$$
i =
\left(
\begin{matrix}
\text{id}_{K^n} \\
0 \\
0
\end{matrix}
\right)
$$
so that clearly $\tilde \alpha \circ i = \alpha$. We set
$$
s =
\left(
\begin{matrix}
\text{id}_{K^n} &
0 &
0
\end{matrix}
\right)
$$
so that $s \circ i = \text{id}_{K^\bullet}$. Finally,
let $h^n : \tilde K^n \to \tilde K^{n - 1}$ be the map
which maps the summand $L^{n - 1}$ of $\tilde K^n$ via the identity morphism
to the summand $L^{n - 1}$ of $\tilde K^{n - 1}$. Then it is a trivial matter
to prove that
$$
\text{id}_{\tilde K^\bullet} - i \circ s
=
d \circ h + h \circ d
$$
which finishes the proof of the lemma.
\end{proof}

\begin{definition}
\label{definition-split-ses}
Let $\mathcal{A}$ be an additive category.
A {\it termwise split exact sequence of complexes of $\mathcal{A}$}
is a complex of complexes
$$
0 \to
A^\bullet \xrightarrow{\alpha}
B^\bullet \xrightarrow{\beta}
C^\bullet \to 0
$$
together with given direct sum decompositions
$B^n = A^n \oplus C^n$
compatible with $\alpha^n$ and $\beta^n$.
We often write $s^n : C^n \to B^n$ and $\pi^n : B^n \to A^n$
for the maps induced by the direct sum decompositions.
According to
Homology, Lemma \ref{homology-lemma-ses-termwise-split-cochain}
we get an associated morphism of complexes
$$
\delta : C^\bullet \longrightarrow A^\bullet[1]
$$
which in degree $n$ is the map $\pi^{n + 1} \circ d_B^n \circ s^n$.
In other words
$(A^\bullet, B^\bullet, C^\bullet, \alpha, \beta, \delta)$
forms a triangle
$$
A^\bullet \to B^\bullet \to C^\bullet \to A^\bullet[1]
$$
This will be the {\it triangle associated to the termwise
split sequence of complexes}.
\end{definition}

\begin{lemma}
\label{lemma-triangle-independent-splittings}
Let $\mathcal{A}$ be an additive category. Let
$0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$
be termwise split exact sequences as in
Definition \ref{definition-split-ses}.
Let $(\pi')^n$, $(s')^n$ be a second collection of splittings.
Denote $\delta' : C^\bullet \longrightarrow A^\bullet[1]$ the
morphism associated to this second set of splittings.
Then
$$
(1, 1, 1) :
(A^\bullet, B^\bullet, C^\bullet, \alpha, \beta, \delta)
\longrightarrow
(A^\bullet, B^\bullet, C^\bullet, \alpha, \beta, \delta')
$$
is an isomorphism of triangles in $K(\mathcal{A})$.
\end{lemma}

\begin{proof}
The statement simply means that $\delta$ and $\delta'$ are
homotopic maps of complexes. This is
Homology, Lemma \ref{homology-lemma-ses-termwise-split-homotopy-cochain}.
\end{proof}

\begin{remark}
\label{remark-make-commute}
Let $\mathcal{A}$ be an additive category.
Let $0 \to A_i^\bullet \to B_i^\bullet \to C_i^\bullet \to 0$, $i = 1, 2$
be termwise split exact sequences. Suppose that
$a : A_1^\bullet \to A_2^\bullet$,
$b : B_1^\bullet \to B_2^\bullet$, and
$c : C_1^\bullet \to C_2^\bullet$ are morphisms of complexes
such that
$$
\xymatrix{
A_1^\bullet \ar[d]_a \ar[r] &
B_1^\bullet \ar[r] \ar[d]_b &
C_1^\bullet \ar[d]_c \\
A_2^\bullet \ar[r] & B_2^\bullet \ar[r] & C_2^\bullet
}
$$
commutes in $K(\mathcal{A})$. In general, there does {\bf not} exist
a morphism $b' : B_1^\bullet \to B_2^\bullet$ which is homotopic to $b$
such that the diagram above commutes in the category of complexes.
Namely, consider
Examples, Equation (\ref{examples-equation-commutes-up-to-homotopy}).
If we could replace the middle map there by a homotopic one such that
the diagram commutes, then we would have additivity of traces which we do not.
\end{remark}

\begin{lemma}
\label{lemma-nilpotent}
Let $\mathcal{A}$ be an additive category.
Let $0 \to A_i^\bullet \to B_i^\bullet \to C_i^\bullet \to 0$, $i = 1, 2, 3$
be termwise split exact sequences of complexes. Let
$b : B_1^\bullet \to B_2^\bullet$ and $b' : B_2^\bullet \to B_3^\bullet$
be morphisms of complexes such that
$$
\vcenter{
\xymatrix{
A_1^\bullet \ar[d]_0 \ar[r] &
B_1^\bullet \ar[r] \ar[d]_b &
C_1^\bullet \ar[d]_0 \\
A_2^\bullet \ar[r] & B_2^\bullet \ar[r] & C_2^\bullet
}
}
\quad\text{and}\quad
\vcenter{
\xymatrix{
A_2^\bullet \ar[d]^0 \ar[r] &
B_2^\bullet \ar[r] \ar[d]^{b'} &
C_2^\bullet \ar[d]^0 \\
A_3^\bullet \ar[r] & B_3^\bullet \ar[r] & C_3^\bullet
}
}
$$
commute in $K(\mathcal{A})$. Then $b' \circ b = 0$ in $K(\mathcal{A})$.
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-make-commute-map} we can replace $b$ and $b'$ by homotopic
maps such that the right square of the left diagram commutes and the
left square of the right diagram commutes. In other words, we have
$\Im(b^n) \subset \Im(A_2^n \to B_2^n)$ and
$\Ker((b')^n) \supset \Im(A_2^n \to B_2^n)$.
Then $b \circ b' = 0$ as a map of complexes.
\end{proof}

\begin{lemma}
\label{lemma-third-isomorphism}
Let $\mathcal{A}$ be an additive category.
Let $f_1 : K_1^\bullet \to L_1^\bullet$ and
$f_2 : K_2^\bullet \to L_2^\bullet$ be morphisms of complexes.
Let
$$
(a, b, c) :
(K_1^\bullet, L_1^\bullet, C(f_1)^\bullet, f_1, i_1, p_1)
\longrightarrow
(K_2^\bullet, L_2^\bullet, C(f_2)^\bullet, f_2, i_2, p_2)
$$
be any morphism of triangles of $K(\mathcal{A})$.
If $a$ and $b$ are homotopy equivalences then so is $c$.
\end{lemma}

\begin{proof}
Let $a^{-1} : K_2^\bullet \to K_1^\bullet$ be a morphism of complexes which
is inverse to $a$ in $K(\mathcal{A})$.
Let $b^{-1} : L_2^\bullet \to L_1^\bullet$ be a morphism of complexes which
is inverse to $b$ in $K(\mathcal{A})$.
Let $c' : C(f_2)^\bullet \to C(f_1)^\bullet$
be the morphism from Lemma \ref{lemma-functorial-cone} applied
to $f_1 \circ a^{-1} = b^{-1} \circ f_2$. If we can show that
$c \circ c'$ and $c' \circ c$ are isomorphisms in $K(\mathcal{A})$
then we win. Hence it suffices to prove the following: Given
a morphism of triangles
$(1, 1, c) : (K^\bullet, L^\bullet, C(f)^\bullet, f, i, p)$
in $K(\mathcal{A})$ the morphism $c$ is an isomorphism in $K(\mathcal{A})$.
By assumption the two squares in the diagram
$$
\xymatrix{
L^\bullet \ar[r] \ar[d]_1 &
C(f)^\bullet \ar[r] \ar[d]_c &
K^\bullet[1] \ar[d]_1 \\
L^\bullet \ar[r] &
C(f)^\bullet \ar[r] &
K^\bullet[1]
}
$$
commute up to homotopy. By construction of $C(f)^\bullet$ the rows
form termwise split sequences of complexes. Thus we see that
$(c - 1)^2 = 0$ in $K(\mathcal{A})$ by Lemma \ref{lemma-nilpotent}.
Hence $c$ is an isomorphism in $K(\mathcal{A})$ with inverse $2 - c$.
\end{proof}

\noindent
Hence if $a$ and $b$ are homotopy equivalences then
the resulting morphism of triangles is an isomorphism of triangles
in $K(\mathcal{A})$.
It turns out that the collection of triangles of $K(\mathcal{A})$
given by cones and the collection of triangles of $K(\mathcal{A})$
given by termwise split sequences of complexes are the same
up to isomorphisms, at least up to sign!

\begin{lemma}
\label{lemma-the-same-up-to-isomorphisms}
Let $\mathcal{A}$ be an additive category.
\begin{enumerate}
\item Given a termwise split sequence of complexes
$(\alpha : A^\bullet \to B^\bullet,
\beta : B^\bullet \to C^\bullet, s^n, \pi^n)$
there exists a homotopy equivalence $C(\alpha)^\bullet \to C^\bullet$
such that the diagram
$$
\xymatrix{
A^\bullet \ar[r] \ar[d] & B^\bullet \ar[d] \ar[r] &
C(\alpha)^\bullet \ar[r]_{-p} \ar[d] & A^\bullet[1] \ar[d] \\
A^\bullet \ar[r] & B^\bullet \ar[r] &
C^\bullet \ar[r]^\delta & A^\bullet[1]
}
$$
defines an isomorphism of triangles in $K(\mathcal{A})$.
\item Given a morphism of complexes $f : K^\bullet \to L^\bullet$
there exists an isomorphism of triangles
$$
\xymatrix{
K^\bullet \ar[r] \ar[d] & \tilde L^\bullet \ar[d] \ar[r] &
M^\bullet \ar[r]_{\delta} \ar[d] & K^\bullet[1] \ar[d] \\
K^\bullet \ar[r] & L^\bullet \ar[r] &
C(f)^\bullet \ar[r]^{-p} & K^\bullet[1]
}
$$
where the upper triangle is the triangle associated to a
termwise split exact sequence $K^\bullet \to \tilde L^\bullet \to M^\bullet$.
\end{enumerate}
\end{lemma}

\begin{proof}
Proof of (1). We have $C(\alpha)^n = B^n \oplus A^{n + 1}$
and we simply define $C(\alpha)^n \to C^n$ via the projection
onto $B^n$ followed by $\beta^n$. This defines
a morphism of complexes because the compositions
$A^{n + 1} \to B^{n + 1} \to C^{n + 1}$ are zero.
To get a homotopy inverse we take
$C^\bullet \to C(\alpha)^\bullet$ given by
$(s^n , -\delta^n)$ in degree $n$. This is a morphism of complexes
because the morphism $\delta^n$ can be characterized as the
unique morphism $C^n \to A^{n + 1}$ such that
$d \circ s^n - s^{n + 1} \circ d = \alpha \circ \delta^n$,
see proof of
Homology, Lemma \ref{homology-lemma-ses-termwise-split-cochain}.
The composition
$C^\bullet \to C(\alpha)^\bullet \to C^\bullet$ is the identity.
The composition $C(\alpha)^\bullet \to C^\bullet \to C(\alpha)^\bullet$
is equal to the morphism
$$
\left(
\begin{matrix}
s^n \circ \beta^n & 0 \\
-\delta^n \circ \beta^n & 0
\end{matrix}
\right)
$$
To see that this is homotopic to the identity map
use the homotopy $h^n : C(\alpha)^n \to C(\alpha)^{n - 1}$
given by the matrix
$$
\left(
\begin{matrix}
0 & 0 \\
\pi^n & 0
\end{matrix}
\right) : C(\alpha)^n = B^n \oplus A^{n + 1} \to
B^{n - 1} \oplus A^n = C(\alpha)^{n - 1}
$$
It is trivial to verify that
$$
\left(
\begin{matrix}
1 & 0 \\
0 & 1
\end{matrix}
\right)
-
\left(
\begin{matrix}
s^n \\
-\delta^n
\end{matrix}
\right)
\left(
\begin{matrix}
\beta^n & 0
\end{matrix}
\right)
=
\left(
\begin{matrix}
d & \alpha^n \\
0 & -d
\end{matrix}
\right)
\left(
\begin{matrix}
0 & 0 \\
\pi^n & 0
\end{matrix}
\right)
+
\left(
\begin{matrix}
0 & 0 \\
\pi^{n + 1} & 0
\end{matrix}
\right)
\left(
\begin{matrix}
d & \alpha^{n + 1} \\
0 & -d
\end{matrix}
\right)
$$
To finish the proof of (1) we have to show that the morphisms
$-p : C(\alpha)^\bullet \to A^\bullet[1]$ (see
Definition \ref{definition-cone})
and  $C(\alpha)^\bullet \to C^\bullet \to A^\bullet[1]$ agree up
to homotopy. This is clear from the above. Namely, we can use the homotopy
inverse $(s, -\delta) : C^\bullet \to C(\alpha)^\bullet$
and check instead that the two maps
$C^\bullet \to A^\bullet[1]$ agree. And note that
$p \circ (s, -\delta) = -\delta$ as desired.

\medskip\noindent
Proof of (2). We let $\tilde f : K^\bullet \to \tilde L^\bullet$,
$s : L^\bullet \to \tilde L^\bullet$
and $\pi : \tilde L^\bullet \to L^\bullet$ be as in
Lemma \ref{lemma-make-injective}. By
Lemmas \ref{lemma-functorial-cone} and \ref{lemma-third-isomorphism}
the triangles $(K^\bullet, L^\bullet, C(f), i, p)$ and
$(K^\bullet, \tilde L^\bullet, C(\tilde f), \tilde i, \tilde p)$
are isomorphic. Note that we can compose isomorphisms of
triangles. Thus we may replace $L^\bullet$ by
$\tilde L^\bullet$ and $f$ by $\tilde f$. In other words
we may assume that $f$ is a termwise split injection.
In this case the result follows from part (1).
\end{proof}


\begin{lemma}
\label{lemma-sequence-maps-split}
Let $\mathcal{A}$ be an additive category.
Let $A_1^\bullet \to A_2^\bullet \to \ldots \to A_n^\bullet$
be a sequence of composable morphisms of complexes.
There exists a commutative diagram
$$
\xymatrix{
A_1^\bullet \ar[r] &
A_2^\bullet \ar[r] &
\ldots \ar[r] &
A_n^\bullet \\
B_1^\bullet \ar[r] \ar[u] &
B_2^\bullet \ar[r] \ar[u] &
\ldots \ar[r] &
B_n^\bullet \ar[u]
}
$$
such that each morphism $B_i^\bullet \to B_{i + 1}^\bullet$
is a split injection and each $B_i^\bullet \to A_i^\bullet$
is a homotopy equivalence. Moreover, if all $A_i^\bullet$ are in
$K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, or $K^b(\mathcal{A})$,
then so are the $B_i^\bullet$.
\end{lemma}

\begin{proof}
The case $n = 1$ is without content.
Lemma \ref{lemma-make-injective} is the case $n = 2$.
Suppose we have constructed the diagram
except for $B_n^\bullet$. Apply Lemma \ref{lemma-make-injective} to
the composition $B_{n - 1}^\bullet \to A_{n - 1}^\bullet \to A_n^\bullet$.
The result is a factorization
$B_{n - 1}^\bullet \to B_n^\bullet \to A_n^\bullet$
as desired.
\end{proof}

\begin{lemma}
\label{lemma-rotate-triangle}
Let $\mathcal{A}$ be an additive category. Let
$(\alpha : A^\bullet \to B^\bullet, \beta : B^\bullet \to C^\bullet, s^n,
\pi^n)$ be a termwise split sequence of complexes.
Let $(A^\bullet, B^\bullet, C^\bullet, \alpha, \beta, \delta)$
be the associated triangle.
Then the triangle
$(C^\bullet[-1], A^\bullet, B^\bullet, \delta[-1], \alpha, \beta)$
is isomorphic to the triangle
$(C^\bullet[-1], A^\bullet, C(\delta[-1])^\bullet, \delta[-1], i, p)$.
\end{lemma}

\begin{proof}
We write $B^n = A^n \oplus C^n$ and we identify $\alpha^n$ and $\beta^n$
with the natural inclusion and projection maps. By construction of $\delta$ we
have
$$
d_B^n =
\left(
\begin{matrix}
d_A^n & \delta^n \\
0 & d_C^n
\end{matrix}
\right)
$$
On the other hand the cone of $\delta[-1] : C^\bullet[-1] \to A^\bullet$
is given as $C(\delta[-1])^n = A^n \oplus C^n$ with differential identical
with the matrix above! Whence the lemma.
\end{proof}

\begin{lemma}
\label{lemma-rotate-cone}
Let $\mathcal{A}$ be an additive category.
Let $f : K^\bullet \to L^\bullet$ be a morphism of complexes.
The triangle $(L^\bullet, C(f)^\bullet, K^\bullet[1], i, p, f[1])$ is
the triangle associated to the termwise split sequence
$$
0 \to L^\bullet \to C(f)^\bullet \to K^\bullet[1] \to 0
$$
coming from the definition of the cone of $f$.
\end{lemma}

\begin{proof}
Immediate from the definitions.
\end{proof}






\section{Distinguished triangles in the homotopy category}
\label{section-homotopy-triangulated}

\noindent
Since we want our boundary maps in long exact sequences of cohomology
to be given by the maps in the snake lemma without signs we define
distinguished triangles in the homotopy category as follows.

\begin{definition}
\label{definition-distinguished-triangle}
Let $\mathcal{A}$ be an additive category.
A triangle $(X, Y, Z, f, g, h)$ of $K(\mathcal{A})$ is
called a {\it distinguished triangle of $K(\mathcal{A})$}
if it is isomorphic to the triangle associated to
a termwise split exact sequence of complexes, see Definition
\ref{definition-split-ses}.
Same definition for $K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, and
$K^b(\mathcal{A})$.
\end{definition}

\noindent
Note that according to Lemma \ref{lemma-the-same-up-to-isomorphisms}
a triangle of the form $(K^\bullet, L^\bullet, C(f)^\bullet, f, i, -p)$
is a distinguished triangle.
This does indeed lead to a triangulated category, see
Proposition \ref{proposition-homotopy-category-triangulated}.
Before we can prove the proposition we need one more lemma
in order to be able to prove TR4.

\begin{lemma}
\label{lemma-two-split-injections}
Let $\mathcal{A}$ be an additive category. Suppose that
$\alpha : A^\bullet \to B^\bullet$ and $\beta : B^\bullet \to C^\bullet$
are split injections of complexes. Then there exist distinguished triangles
$(A^\bullet, B^\bullet, Q_1^\bullet, \alpha, p_1, d_1)$,
$(A^\bullet, C^\bullet, Q_2^\bullet, \beta \circ \alpha, p_2, d_2)$
and
$(B^\bullet, C^\bullet, Q_3^\bullet, \beta, p_3, d_3)$
for which TR4 holds.
\end{lemma}

\begin{proof}
Say $\pi_1^n : B^n \to A^n$, and $\pi_3^n : C^n \to B^n$ are the splittings.
Then also $A^\bullet \to C^\bullet$ is a split injection with splittings
$\pi_2^n = \pi_1^n \circ \pi_3^n$. Let us write $Q_1^\bullet$, $Q_2^\bullet$
and $Q_3^\bullet$ for the ``quotient'' complexes. In other words,
$Q_1^n = \Ker(\pi_1^n)$, $Q_3^n = \Ker(\pi_3^n)$ and
$Q_2^n = \Ker(\pi_2^n)$. Note that the kernels exist. Then
$B^n = A^n \oplus Q_1^n$ and $C_n = B^n \oplus Q_3^n$, where we think of $A^n$
as a subobject of $B^n$ and so on. This implies
$C^n = A^n \oplus Q_1^n \oplus Q_3^n$. Note that
$\pi_2^n = \pi_1^n \circ \pi_3^n$ is zero on both $Q_1^n$ and $Q_3^n$. Hence
$Q_2^n = Q_1^n \oplus Q_3^n$. Consider the commutative diagram
$$
\begin{matrix}
0 & \to & A^\bullet & \to & B^\bullet & \to & Q_1^\bullet & \to & 0 \\
  &     & \downarrow &     & \downarrow &     & \downarrow  & \\
0 & \to & A^\bullet & \to & C^\bullet & \to & Q_2^\bullet & \to & 0 \\
  &     & \downarrow &     & \downarrow &     & \downarrow  & \\
0 & \to & B^\bullet & \to & C^\bullet & \to & Q_3^\bullet & \to & 0
\end{matrix}
$$
The rows of this diagram are termwise split exact sequences, and
hence determine distinguished triangles by
definition. Moreover downward arrows in the diagram above
are compatible with the chosen splittings and hence
define morphisms of triangles
$$
(A^\bullet \to B^\bullet \to Q_1^\bullet \to A^\bullet[1])
\longrightarrow
(A^\bullet \to C^\bullet \to Q_2^\bullet \to A^\bullet[1])
$$
and
$$
(A^\bullet \to C^\bullet \to Q_2^\bullet \to A^\bullet[1])
\longrightarrow
(B^\bullet \to C^\bullet \to Q_3^\bullet \to B^\bullet[1]).
$$
Note that the splittings $Q_3^n \to C^n$
of the bottom split sequence in the diagram provides a splitting
for the split sequence
$0 \to Q_1^\bullet \to Q_2^\bullet \to Q_3^\bullet \to 0$
upon composing with $C^n \to Q_2^n$. It follows easily from this
that the morphism $\delta : Q_3^\bullet \to Q_1^\bullet[1]$
in the corresponding distinguished triangle
$$
(Q_1^\bullet \to Q_2^\bullet \to Q_3^\bullet \to Q_1^\bullet[1])
$$
is equal to the composition $Q_3^\bullet \to B^\bullet[1] \to Q_1^\bullet[1]$.
Hence we get a structure as in the conclusion of axiom TR4.
\end{proof}

\begin{proposition}
\label{proposition-homotopy-category-triangulated}
Let $\mathcal{A}$ be an additive category.
The category $K(\mathcal{A})$ of complexes up to
homotopy with its natural translation functors
and distinguished triangles as defined above
is a triangulated category.
\end{proposition}

\begin{proof}
Proof of TR1. By definition every triangle isomorphic to a distinguished
one is distinguished. Also, any triangle $(A^\bullet, A^\bullet, 0, 1, 0, 0)$
is distinguished since $0 \to A^\bullet \to A^\bullet \to 0 \to 0$ is
a termwise split sequence of complexes. Finally, given any morphism of
complexes $f : K^\bullet \to L^\bullet$ the triangle
$(K, L, C(f), f, i, -p)$ is distinguished by
Lemma \ref{lemma-the-same-up-to-isomorphisms}.

\medskip\noindent
Proof of TR2. Let $(X, Y, Z, f, g, h)$ be a triangle.
Assume $(Y, Z, X[1], g, h, -f[1])$ is distinguished.
Then there exists a termwise split sequence of complexes
$A^\bullet \to B^\bullet \to C^\bullet$ such that the associated
triangle $(A^\bullet, B^\bullet, C^\bullet, \alpha, \beta, \delta)$
is isomorphic to $(Y, Z, X[1], g, h, -f[1])$. Rotating back we see
that $(X, Y, Z, f, g, h)$ is isomorphic to
$(C^\bullet[-1], A^\bullet, B^\bullet, -\delta[-1], \alpha, \beta)$.
It follows from Lemma \ref{lemma-rotate-triangle} that the triangle
$(C^\bullet[-1], A^\bullet, B^\bullet, \delta[-1], \alpha, \beta)$
is isomorphic to
$(C^\bullet[-1], A^\bullet, C(\delta[-1])^\bullet, \delta[-1], i, p)$.
Precomposing the previous isomorphism of triangles with $-1$ on $Y$
it follows that $(X, Y, Z, f, g, h)$ is isomorphic to
$(C^\bullet[-1], A^\bullet, C(\delta[-1])^\bullet, \delta[-1], i, -p)$.
Hence it is distinguished by
Lemma \ref{lemma-the-same-up-to-isomorphisms}.
On the other hand, suppose that $(X, Y, Z, f, g, h)$ is distinguished.
By Lemma \ref{lemma-the-same-up-to-isomorphisms} this means that it is
isomorphic to a triangle of the form
$(K^\bullet, L^\bullet, C(f), f, i, -p)$ for some morphism of
complexes $f$. Then the rotated triangle $(Y, Z, X[1], g, h, -f[1])$ is
isomorphic to $(L^\bullet, C(f), K^\bullet[1], i, -p, -f[1])$ which is
isomorphic to the triangle $(L^\bullet, C(f), K^\bullet[1], i, p, f[1])$.
By Lemma \ref{lemma-rotate-cone} this triangle is distinguished.
Hence $(Y, Z, X[1], g, h, -f[1])$ is distinguished as desired.

\medskip\noindent
Proof of TR3. Let
$(X, Y, Z, f, g, h)$ and $(X', Y', Z', f', g', h')$
be distinguished triangles of $K(\mathcal{A})$
and let $a : X \to X'$ and $b : Y \to Y'$ be morphisms
such that $f' \circ a = b \circ f$. By
Lemma \ref{lemma-the-same-up-to-isomorphisms} we may assume that
$(X, Y, Z, f, g, h) = (X, Y, C(f), f, i, -p)$ and
$(X', Y', Z', f', g', h') = (X', Y', C(f'), f', i', -p')$.
At this point we simply apply Lemma \ref{lemma-functorial-cone}
to the commutative diagram given by $f, f', a, b$.

\medskip\noindent
Proof of TR4. At this point we know that $K(\mathcal{A})$
is a pre-triangulated category. Hence we can use
Lemma \ref{lemma-easier-axiom-four}. Let $A^\bullet \to B^\bullet$
and $B^\bullet \to C^\bullet$ be composable morphisms of
$K(\mathcal{A})$. By Lemma \ref{lemma-sequence-maps-split} we may assume that
$A^\bullet \to B^\bullet$ and $B^\bullet \to C^\bullet$
are split injective morphisms. In this case the result follows
from Lemma \ref{lemma-two-split-injections}.
\end{proof}

\begin{remark}
\label{remark-boundedness-conditions-triangulated}
Let $\mathcal{A}$ be an additive category.
Exactly the same proof as the proof of
Proposition \ref{proposition-homotopy-category-triangulated}
shows that the categories
$K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, and $K^b(\mathcal{A})$
are triangulated categories. Namely, the cone of a morphism between
bounded (above, below) is bounded (above, below).
But we prove below that these are triangulated subcategories
of $K(\mathcal{A})$ which gives another proof.
\end{remark}

\begin{lemma}
\label{lemma-bounded-triangulated-subcategories}
Let $\mathcal{A}$ be an additive category. The categories
$K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, and $K^b(\mathcal{A})$
are full triangulated subcategories of $K(\mathcal{A})$.
\end{lemma}

\begin{proof}
Each of the categories mentioned is a full additive subcategory.
We use the criterion of
Lemma \ref{lemma-triangulated-subcategory}
to show that they are triangulated subcategories.
It is clear that each of the categories
$K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, and $K^b(\mathcal{A})$
is preserved under the shift functors $[1], [-1]$.
Finally, suppose that $f : A^\bullet \to B^\bullet$ is a morphism
in $K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, or $K^b(\mathcal{A})$.
Then $(A^\bullet, B^\bullet, C(f)^\bullet, f, i, -p)$ is a distinguished
triangle of $K(\mathcal{A})$ with $C(f)^\bullet \in K^{+}(\mathcal{A})$,
$K^{-}(\mathcal{A})$, or $K^b(\mathcal{A})$ as is clear from the construction
of the cone. Thus the lemma is proved. (Alternatively,
$K^\bullet \to L^\bullet$ is isomorphic to an termwise split injection
of complexes in $K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, or
$K^b(\mathcal{A})$, see
Lemma \ref{lemma-make-injective}
and then one can directly take the associated
distinguished triangle.)
\end{proof}

\begin{lemma}
\label{lemma-additive-exact-homotopy-category}
Let $\mathcal{A}$, $\mathcal{B}$ be additive categories.
Let $F : \mathcal{A} \to \mathcal{B}$ be an additive functor.
The induced functors
$$
\begin{matrix}
F : K(\mathcal{A}) \longrightarrow K(\mathcal{B}) \\
F : K^{+}(\mathcal{A}) \longrightarrow K^{+}(\mathcal{B}) \\
F : K^{-}(\mathcal{A}) \longrightarrow K^{-}(\mathcal{B}) \\
F : K^b(\mathcal{A}) \longrightarrow K^b(\mathcal{B})
\end{matrix}
$$
are exact functors of triangulated categories.
\end{lemma}

\begin{proof}
Suppose $A^\bullet \to B^\bullet \to C^\bullet$
is a termwise split sequence of complexes of $\mathcal{A}$ with splittings
$(s^n, \pi^n)$ and associated morphism $\delta : C^\bullet \to A^\bullet[1]$,
see Definition \ref{definition-split-ses}. Then
$F(A^\bullet) \to F(B^\bullet) \to F(C^\bullet)$
is a termwise split sequence of complexes with splittings
$(F(s^n), F(\pi^n))$ and associated morphism
$F(\delta) : F(C^\bullet) \to F(A^\bullet)[1]$.
Thus $F$ transforms distinguished triangles into distinguished triangles.
\end{proof}




\section{Derived categories}
\label{section-derived-categories}

\noindent
In this section we construct the derived category of an abelian category
$\mathcal{A}$ by inverting the quasi-isomorphisms in $K(\mathcal{A})$.
Before we do this recall that the functors
$H^i : \text{Comp}(\mathcal{A}) \to \mathcal{A}$
factor through $K(\mathcal{A})$, see
Homology, Lemma \ref{homology-lemma-map-cohomology-homotopy-cochain}.
Moreover, in
Homology, Definition \ref{homology-definition-cohomology-shift}
we have defined identifications $H^i(K^\bullet[n]) = H^{i + n}(K^\bullet)$.
At this point it makes sense to redefine
$$
H^i(K^\bullet) = H^0(K^\bullet[i])
$$
in order to avoid confusion and possible sign errors.

\begin{lemma}
\label{lemma-cohomology-homological}
Let $\mathcal{A}$ be an abelian category. The functor
$$
H^0 : K(\mathcal{A}) \longrightarrow \mathcal{A}
$$
is homological.
\end{lemma}

\begin{proof}
Because $H^0$ is a functor, and by our definition of distinguished triangles
it suffices to prove that given a termwise split short exact sequence
of complexes $0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$
the sequence $H^0(A^\bullet) \to H^0(B^\bullet) \to H^0(C^\bullet)$
is exact. This follows from
Homology, Lemma \ref{homology-lemma-long-exact-sequence-cochain}.
\end{proof}

\noindent
In particular, this lemma implies that a distinguished triangle
$(X, Y, Z, f, g, h)$ in $K(\mathcal{A})$ gives rise to a long exact
cohomology sequence
\begin{equation}
\label{equation-long-exact-cohomology-sequence-D}
\xymatrix{
\ldots \ar[r] &
H^i(X) \ar[r]^{H^i(f)} &
H^i(Y) \ar[r]^{H^i(g)} &
H^i(Z) \ar[r]^{H^i(h)} &
H^{i + 1}(X) \ar[r] & \ldots
}
\end{equation}
see (\ref{equation-long-exact-cohomology-sequence}). Moreover, there is
a compatibility with the long exact sequence of cohomology associated to
a short exact sequence of complexes (insert future reference here). For
example, if $(A^\bullet, B^\bullet, C^\bullet, \alpha, \beta, \delta)$
is the distinguished triangle associated to a termwise split exact
sequence of complexes (see
Definition \ref{definition-split-ses}),
then the cohomology sequence above agrees with the one defined using the
snake lemma, see
Homology, Lemma \ref{homology-lemma-long-exact-sequence-cochain}
and for agreement of sequences, see
Homology, Lemma \ref{homology-lemma-ses-termwise-split-long-cochain}.

\medskip\noindent
Recall that a complex $K^\bullet$ is {\it acyclic} if $H^i(K^\bullet) = 0$
for all $i \in \mathbf{Z}$. Moreover, recall that a morphism of complexes
$f : K^\bullet \to L^\bullet$ is a {\it quasi-isomorphism} if and only if
$H^i(f)$ is an isomorphism for all $i$. See
Homology, Definition \ref{homology-definition-quasi-isomorphism-cochain}.

\begin{lemma}
\label{lemma-acyclic}
Let $\mathcal{A}$ be an abelian category. The full subcategory
$\text{Ac}(\mathcal{A})$ of $K(\mathcal{A})$ consisting of acyclic complexes
is a strictly full saturated triangulated subcategory of $K(\mathcal{A})$.
The corresponding saturated multiplicative system (see
Lemma \ref{lemma-operations})
of $K(\mathcal{A})$ is the set $\text{Qis}(\mathcal{A})$
of quasi-isomorphisms. In particular, the kernel of the localization
functor $Q : K(\mathcal{A}) \to \text{Qis}(\mathcal{A})^{-1}K(\mathcal{A})$
is $\text{Ac}(\mathcal{A})$ and the functor $H^0$ factors through $Q$.
\end{lemma}

\begin{proof}
We know that $H^0$ is a homological functor by
Lemma \ref{lemma-cohomology-homological}.
Thus this lemma is a special case of
Lemma \ref{lemma-acyclic-general}.
\end{proof}

\begin{definition}
\label{definition-unbounded-derived-category}
Let $\mathcal{A}$ be an abelian category.
Let $\text{Ac}(\mathcal{A})$ and $\text{Qis}(\mathcal{A})$
be as in
Lemma \ref{lemma-acyclic}.
The {\it derived category of $\mathcal{A}$} is the triangulated
category
$$
D(\mathcal{A}) =
K(\mathcal{A})/\text{Ac}(\mathcal{A}) =
\text{Qis}(\mathcal{A})^{-1} K(\mathcal{A}).
$$
We denote $H^0 : D(\mathcal{A}) \to \mathcal{A}$ the unique functor
whose composition with the quotient functor gives back the functor
$H^0$ defined above. Using
Lemma \ref{lemma-homological-functor-bounded}
we introduce the strictly full saturated triangulated subcategories
$D^{+}(\mathcal{A}), D^{-}(\mathcal{A}), D^b(\mathcal{A})$
whose sets of objects are
$$
\begin{matrix}
\Ob(D^{+}(\mathcal{A})) =
\{X \in \Ob(D(\mathcal{A})) \mid
H^n(X) = 0\text{ for all }n \ll 0\} \\
\Ob(D^{-}(\mathcal{A})) =
\{X \in \Ob(D(\mathcal{A})) \mid
H^n(X) = 0\text{ for all }n \gg 0\} \\
\Ob(D^b(\mathcal{A})) =
\{X \in \Ob(D(\mathcal{A})) \mid
H^n(X) = 0\text{ for all }|n| \gg 0\}
\end{matrix}
$$
The category $D^b(\mathcal{A})$ is called the {\it bounded derived
category} of $\mathcal{A}$.
\end{definition}

\noindent
If $K^\bullet$ and $L^\bullet$ are complexes of $\mathcal{A}$
then we sometimes say ``$K^\bullet$ is {\it quasi-isomorphic} to
$L^\bullet$'' to indicate that $K^\bullet$ and $L^\bullet$ are
isomorphic objects of $D(\mathcal{A})$.

\begin{remark}
\label{remark-existence-derived}
In this chapter, we consistently work with ``small'' abelian categories
(as is the convention in the Stacks project). For a ``big'' abelian
category $\mathcal{A}$, it isn't clear that the derived category
$D(\mathcal{A})$ exists, because it isn't clear that morphisms in the
derived category are sets. In fact, in general they aren't, see
Examples, Lemma \ref{examples-lemma-big-abelian-category}.
However, if $\mathcal{A}$ is a Grothendieck abelian category, and given
$K^\bullet, L^\bullet$ in $K(\mathcal{A})$, then by
Injectives, Theorem \ref{injectives-theorem-K-injective-embedding-grothendieck}
there exists a quasi-isomorphism $L^\bullet \to I^\bullet$ to a
K-injective complex $I^\bullet$ and Lemma \ref{lemma-K-injective} shows that
$$
\Hom_{D(\mathcal{A})}(K^\bullet, L^\bullet) =
\Hom_{K(\mathcal{A})}(K^\bullet, I^\bullet)
$$
which is a set. Some examples of Grothendieck abelian categories
are the category of modules over a ring, or more generally
the category of sheaves of modules on a ringed site.
\end{remark}

\noindent
Each of the variants $D^{+}(\mathcal{A}), D^{-}(\mathcal{A}), D^b(\mathcal{A})$
can be constructed as a localization of the corresponding homotopy category.
This relies on the following simple lemma.

\begin{lemma}
\label{lemma-complex-cohomology-bounded}
Let $\mathcal{A}$ be an abelian category.
Let $K^\bullet$ be a complex.
\begin{enumerate}
\item If $H^n(K^\bullet) = 0$ for all $n \ll 0$, then there exists
a quasi-isomorphism $K^\bullet \to L^\bullet$ with $L^\bullet$
bounded below.
\item If $H^n(K^\bullet) = 0$ for all $n \gg 0$, then there exists
a quasi-isomorphism $M^\bullet \to K^\bullet$ with $M^\bullet$
bounded above.
\item If $H^n(K^\bullet) = 0$ for all $|n| \gg 0$, then there exists
a commutative diagram of morphisms of complexes
$$
\xymatrix{
K^\bullet \ar[r] & L^\bullet \\
M^\bullet \ar[u] \ar[r] & N^\bullet \ar[u]
}
$$
where all the arrows are quasi-isomorphisms, $L^\bullet$
bounded below, $M^\bullet$ bounded above, and $N^\bullet$ a bounded
complex.
\end{enumerate}
\end{lemma}

\begin{proof}
Pick $a \ll 0 \ll b$ and set $M^\bullet = \tau_{\leq b}K^\bullet$,
$L^\bullet = \tau_{\geq a}K^\bullet$, and
$N^\bullet = \tau_{\leq b}L^\bullet = \tau_{\geq a}M^\bullet$.
See
Homology, Section \ref{homology-section-truncations}
for the truncation functors.
\end{proof}

\noindent
To state the following lemma denote
$\text{Ac}^{+}(\mathcal{A})$, $\text{Ac}^{-}(\mathcal{A})$,
resp.\ $\text{Ac}^b(\mathcal{A})$ the intersection of
$K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, resp.\ $K^b(\mathcal{A})$
with $\text{Ac}(\mathcal{A})$.
Denote $\text{Qis}^{+}(\mathcal{A})$, $\text{Qis}^{-}(\mathcal{A})$,
resp.\ $\text{Qis}^b(\mathcal{A})$ the intersection of
$K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, resp.\ $K^b(\mathcal{A})$
with $\text{Qis}(\mathcal{A})$.

\begin{lemma}
\label{lemma-bounded-derived}
Let $\mathcal{A}$ be an abelian category. The subcategories
$\text{Ac}^{+}(\mathcal{A})$, $\text{Ac}^{-}(\mathcal{A})$,
resp.\ $\text{Ac}^b(\mathcal{A})$
are strictly full saturated triangulated subcategories
of $K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, resp.\ $K^b(\mathcal{A})$.
The corresponding saturated multiplicative systems (see
Lemma \ref{lemma-operations})
are the sets $\text{Qis}^{+}(\mathcal{A})$, $\text{Qis}^{-}(\mathcal{A})$,
resp.\ $\text{Qis}^b(\mathcal{A})$.
\begin{enumerate}
\item The kernel of the functor $K^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$
is $\text{Ac}^{+}(\mathcal{A})$ and this induces an equivalence
of triangulated categories
$$
K^{+}(\mathcal{A})/\text{Ac}^{+}(\mathcal{A}) =
\text{Qis}^{+}(\mathcal{A})^{-1}K^{+}(\mathcal{A})
\longrightarrow
D^{+}(\mathcal{A})
$$
\item The kernel of the functor $K^{-}(\mathcal{A}) \to D^{-}(\mathcal{A})$
is $\text{Ac}^{-}(\mathcal{A})$ and this induces an equivalence
of triangulated categories
$$
K^{-}(\mathcal{A})/\text{Ac}^{-}(\mathcal{A}) =
\text{Qis}^{-}(\mathcal{A})^{-1}K^{-}(\mathcal{A})
\longrightarrow
D^{-}(\mathcal{A})
$$
\item The kernel of the functor $K^b(\mathcal{A}) \to D^b(\mathcal{A})$
is $\text{Ac}^b(\mathcal{A})$ and this induces an equivalence
of triangulated categories
$$
K^b(\mathcal{A})/\text{Ac}^b(\mathcal{A}) =
\text{Qis}^b(\mathcal{A})^{-1}K^b(\mathcal{A})
\longrightarrow
D^b(\mathcal{A})
$$
\end{enumerate}
\end{lemma}

\begin{proof}
The initial statements follow from
Lemma \ref{lemma-acyclic-general}
by considering the restriction of the homological functor $H^0$.
The statement on kernels in (1), (2), (3) is a consequence of the
definitions in each case.
Each of the functors is essentially surjective by
Lemma \ref{lemma-complex-cohomology-bounded}.
To finish the proof we have to show the functors are fully faithful.
We first do this for the bounded below version.

\medskip\noindent
Suppose that $K^\bullet, L^\bullet$ are bounded above complexes.
A morphism between these in $D(\mathcal{A})$ is of the form
$s^{-1}f$ for a pair
$f : K^\bullet \to (L')^\bullet$, $s : L^\bullet \to (L')^\bullet$
where $s$ is a quasi-isomorphism. This implies that $(L')^\bullet$
has cohomology bounded below. Hence by
Lemma \ref{lemma-complex-cohomology-bounded}
we can choose a quasi-isomorphism
$s' : (L')^\bullet \to (L'')^\bullet$
with $(L'')^\bullet$ bounded below. Then the pair $(s' \circ f, s' \circ s)$
defines a morphism in $\text{Qis}^{+}(\mathcal{A})^{-1}K^{+}(\mathcal{A})$.
Hence the functor is ``full''. Finally, suppose that the pair
$f : K^\bullet \to (L')^\bullet$, $s : L^\bullet \to (L')^\bullet$
defines a morphism in $\text{Qis}^{+}(\mathcal{A})^{-1}K^{+}(\mathcal{A})$
which is zero in $D(\mathcal{A})$. This means that there exists a
quasi-isomorphism $s' : (L')^\bullet \to (L'')^\bullet$
such that $s' \circ f = 0$. Using
Lemma \ref{lemma-complex-cohomology-bounded}
once more we obtain a quasi-isomorphism
$s'' : (L'')^\bullet \to (L''')^\bullet$
with $(L''')^\bullet$ bounded below.
Thus we see that $s'' \circ s' \circ f = 0$ which implies that
$s^{-1}f$ is zero in $\text{Qis}^{+}(\mathcal{A})^{-1}K^{+}(\mathcal{A})$.
This finishes the proof that the functor in (1) is an equivalence.

\medskip\noindent
The proof of (2) is dual to the proof of (1).
To prove (3) we may use the result of (2). Hence it suffices to
prove that the functor
$\text{Qis}^b(\mathcal{A})^{-1}K^b(\mathcal{A})
\to \text{Qis}^{-}(\mathcal{A})^{-1}K^{-}(\mathcal{A})$
is fully faithful. The argument given in the previous paragraph
applies directly to show this where we consistently work with complexes
which are already bounded above.
\end{proof}







\section{The canonical delta-functor}
\label{section-canonical-delta-functor}

\noindent
The derived category should be the receptacle for the universal
cohomology functor. In order to state the result we use
the notion of a $\delta$-functor from an abelian category
into a triangulated category, see
Definition \ref{definition-delta-functor}.

\medskip\noindent
Consider the functor
$\text{Comp}(\mathcal{A}) \to K(\mathcal{A})$.
This functor is {\bf not} a $\delta$-functor in general.
The easiest way to see this is to consider a nonsplit
short exact sequence $0 \to A \to B \to C \to 0$
of objects of $\mathcal{A}$. Since
$\Hom_{K(\mathcal{A})}(C[0], A[1]) = 0$
we see that any distinguished triangle arising from
this short exact sequence would look like
$(A[0], B[0], C[0], a, b, 0)$. But the existence of such a
distinguished triangle in $K(\mathcal{A})$ implies
that the extension is split. A contradiction.

\medskip\noindent
It turns out that the functor
$\text{Comp}(\mathcal{A}) \to D(\mathcal{A})$ is a
$\delta$-functor. In order to see this we have to define
the morphisms $\delta$ associated to a short exact sequence
$$
0 \to A^\bullet \xrightarrow{a} B^\bullet \xrightarrow{b} C^\bullet \to 0
$$
of complexes in the abelian category $\mathcal{A}$.
Consider the cone $C(a)^\bullet$ of the morphism $a$.
We have $C(a)^n = B^n \oplus A^{n + 1}$ and we define
$q^n : C(a)^n \to C^n$ via the projection to $B^n$ followed
by $b^n$. Hence a morphism of complexes
$$
q : C(a)^\bullet \longrightarrow C^\bullet.
$$
It is clear that $q \circ i = b$ where $i$ is as in
Definition \ref{definition-cone}.
Note that, as $a^\bullet$ is injective in each degree,
the kernel of $q$ is identified with the cone of
$\text{id}_{A^\bullet}$ which is acyclic. Hence we see that
$q$ is a quasi-isomorphism. According to
Lemma \ref{lemma-the-same-up-to-isomorphisms}
the triangle
$$
(A, B, C(a), a, i, -p)
$$
is a distinguished triangle in $K(\mathcal{A})$.
As the localization functor
$K(\mathcal{A}) \to D(\mathcal{A})$ is
exact we see that $(A, B, C(a), a, i, -p)$ is a distinguished
triangle in $D(\mathcal{A})$. Since $q$ is a quasi-isomorphism
we see that $q$ is an isomorphism in $D(\mathcal{A})$.
Hence we deduce that
$$
(A, B, C, a, b, -p \circ q^{-1})
$$
is a distinguished triangle of $D(\mathcal{A})$.
This suggests the following lemma.

\begin{lemma}
\label{lemma-derived-canonical-delta-functor}
Let $\mathcal{A}$ be an abelian category. The functor
$\text{Comp}(\mathcal{A}) \to D(\mathcal{A})$
defined has the natural structure of a $\delta$-functor,
with
$$
\delta_{A^\bullet \to B^\bullet \to C^\bullet} = - p \circ q^{-1}
$$
with $p$ and $q$ as explained above. The same construction turns the
functors
$\text{Comp}^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$,
$\text{Comp}^{-}(\mathcal{A}) \to D^{-}(\mathcal{A})$, and
$\text{Comp}^b(\mathcal{A}) \to D^b(\mathcal{A})$
into $\delta$-functors.
\end{lemma}

\begin{proof}
We have already seen that this choice leads to a distinguished
triangle whenever given a short exact sequence of complexes.
We have to show that given a commutative diagram
$$
\xymatrix{
0 \ar[r] &
A^\bullet \ar[r]_a \ar[d]_f &
B^\bullet \ar[r]_b \ar[d]_g &
C^\bullet \ar[r] \ar[d]_h &
0 \\
0 \ar[r] &
(A')^\bullet \ar[r]^{a'} &
(B')^\bullet \ar[r]^{b'} &
(C')^\bullet \ar[r] &
0
}
$$
we get the desired commutative diagram of
Definition \ref{definition-delta-functor} (2).
By Lemma \ref{lemma-functorial-cone}
the pair $(f, g)$ induces a canonical morphism
$c : C(a)^\bullet \to C(a')^\bullet$. It is a simple computation
to show that $q' \circ c = h \circ q$ and
$f[1] \circ p = p' \circ c$. From this the result follows directly.
\end{proof}

\begin{lemma}
\label{lemma-derived-compare-triangles-ses}
Let $\mathcal{A}$ be an abelian category.
Let
$$
\xymatrix{
0 \ar[r] &
A^\bullet \ar[r] \ar[d] &
B^\bullet \ar[r] \ar[d] &
C^\bullet \ar[r] \ar[d] &
0 \\
0 \ar[r] &
D^\bullet \ar[r] &
E^\bullet \ar[r] &
F^\bullet \ar[r] &
0
}
$$
be a commutative diagram of morphisms of complexes
such that the rows are short exact sequences of complexes, and
the vertical arrows are quasi-isomorphisms.
The $\delta$-functor of
Lemma \ref{lemma-derived-canonical-delta-functor}
above maps the short exact sequences
$0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$
and
$0 \to D^\bullet \to E^\bullet \to F^\bullet \to 0$
to isomorphic distinguished triangles.
\end{lemma}

\begin{proof}
Trivial from the fact that $K(\mathcal{A}) \to D(\mathcal{A})$
transforms quasi-isomorphisms into isomorphisms and that the
associated distinguished triangles are functorial.
\end{proof}

\begin{lemma}
\label{lemma-derived-compare-triangles-split-case}
Let $\mathcal{A}$ be an abelian category. Let
$$
\xymatrix{
0 \ar[r] &
A^\bullet \ar[r] &
B^\bullet \ar[r] &
C^\bullet \ar[r] &
0
}
$$
be a short exact sequences of complexes.
Assume this short exact sequence is termwise split. Let
$(A^\bullet, B^\bullet, C^\bullet, \alpha, \beta, \delta)$
be the distinguished triangle of $K(\mathcal{A})$
associated to the sequence. The $\delta$-functor of
Lemma \ref{lemma-derived-canonical-delta-functor}
above maps the short exact sequences
$0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$
to a triangle isomorphic to the distinguished triangle
$$
(A^\bullet, B^\bullet, C^\bullet, \alpha, \beta, \delta).
$$
\end{lemma}

\begin{proof}
Follows from
Lemma \ref{lemma-the-same-up-to-isomorphisms}.
\end{proof}

\begin{remark}
\label{remark-truncation-distinguished-triangle}
Let $\mathcal{A}$ be an abelian category. Let $K^\bullet$ be a complex
of $\mathcal{A}$. Let $a \in \mathbf{Z}$. We claim there is a canonical
distinguished triangle
$$
\tau_{\leq a}K^\bullet \to K^\bullet \to \tau_{\geq a + 1}K^\bullet \to
(\tau_{\leq a}K^\bullet)[1]
$$
in $D(\mathcal{A})$. Here we have used the canonical truncation functors $\tau$
from Homology, Section \ref{homology-section-truncations}.
Namely, we first take the distinguished
triangle associated by our $\delta$-functor
(Lemma \ref{lemma-derived-canonical-delta-functor})
to the short exact sequence of complexes
$$
0 \to \tau_{\leq a}K^\bullet \to K^\bullet \to
K^\bullet/\tau_{\leq a}K^\bullet \to 0
$$
Next, we use that the map $K^\bullet \to \tau_{\geq a + 1}K^\bullet$
factors through a quasi-isomorphism
$K^\bullet/\tau_{\leq a}K^\bullet \to \tau_{\geq a + 1}K^\bullet$
by the description of cohomology groups in
Homology, Section \ref{homology-section-truncations}.
In a similar way we obtain canonical distinguished triangles
$$
\tau_{\leq a}K^\bullet \to \tau_{\leq a + 1}K^\bullet \to
H^{a + 1}(K^\bullet)[-a-1] \to (\tau_{\leq a}K^\bullet)[1]
$$
and
$$
H^a(K^\bullet)[-a] \to \tau_{\geq a}K^\bullet \to \tau_{\geq a + 1}K^\bullet
\to H^a(K^\bullet)[-a + 1]
$$
\end{remark}

\begin{lemma}
\label{lemma-trick-vanishing-composition}
Let $\mathcal{A}$ be an abelian category. Let
$$
K_0^\bullet \to K_1^\bullet \to \ldots \to K_n^\bullet
$$
be maps of complexes such that
\begin{enumerate}
\item $H^i(K_0^\bullet) = 0$ for $i > 0$,
\item $H^{-j}(K_j^\bullet) \to H^{-j}(K_{j + 1}^\bullet)$ is zero.
\end{enumerate}
Then the composition $K_0^\bullet \to K_n^\bullet$ factors through
$\tau_{\leq -n}K_n^\bullet \to K_n^\bullet$ in $D(\mathcal{A})$.
Dually, given maps of complexes
$$
K_n^\bullet \to K_{n - 1}^\bullet \to \ldots \to K_0^\bullet
$$
such that
\begin{enumerate}
\item $H^i(K_0^\bullet) = 0$ for $i < 0$,
\item $H^j(K_{j + 1}^\bullet) \to H^j(K_j^\bullet)$ is zero,
\end{enumerate}
then the composition $K_n^\bullet \to K_0^\bullet$ factors through
$K_n^\bullet \to \tau_{\geq n}K_n^\bullet$ in $D(\mathcal{A})$.
\end{lemma}

\begin{proof}
The case $n = 1$. Since $\tau_{\leq 0}K_0^\bullet = K_0^\bullet$
in $D(\mathcal{A})$ we can replace
$K_0^\bullet$ by $\tau_{\leq 0}K_0^\bullet$ and
$K_1^\bullet$ by $\tau_{\leq 0}K_1^\bullet$.
Consider the distinguished triangle
$$
\tau_{\leq -1}K_1^\bullet \to K_1^\bullet \to
H^0(K_1^\bullet)[0] \to (\tau_{\leq -1}K_1^\bullet)[1]
$$
(Remark \ref{remark-truncation-distinguished-triangle}).
The composition $K_0^\bullet \to K_1^\bullet \to H^0(K_1^\bullet)[0]$
is zero as it is equal to $K_0^\bullet \to H^0(K_0^\bullet)[0] \to
H^0(K_1^\bullet)[0]$ which is zero by assumption.
The fact that $\Hom_{D(\mathcal{A})}(K_0^\bullet, -)$
is a homological functor (Lemma \ref{lemma-representable-homological}),
allows us to find the desired factorization.
For $n = 2$ we get a factorization
$K_0^\bullet \to \tau_{\leq -1}K_1^\bullet$ by the case $n = 1$
and we can apply the case $n = 1$ to the map of complexes
$\tau_{\leq -1}K_1^\bullet \to \tau_{\leq -1}K_2^\bullet$
to get a factorization
$\tau_{\leq -1}K_1^\bullet \to \tau_{\leq -2}K_2^\bullet$.
The general case is proved in exactly the same manner.
\end{proof}




\section{Filtered derived categories}
\label{section-filtered-derived-category}

\noindent
A reference for this section is \cite[I, Chapter V]{cotangent}. Let
$\mathcal{A}$ be an abelian category. In this section we will define the
filtered derived category $DF(\mathcal{A})$ of $\mathcal{A}$.
In short, we will define it as the derived category
of the exact category of objects of $\mathcal{A}$ endowed with a finite
filtration. (Thus our construction is a special case of a
more general construction of the derived category of an
exact category, see for example \cite{Buhler}, \cite{Keller}.)
Illusie's filtered derived category is the full subcategory
of ours consisting of those objects whose filtration is finite.
(In our category the filtration is still finite in each degree, but may
not be uniformly bounded.) The rationale for our choice is that it is not
harder and it allows us to apply the discussion to the spectral sequences of
Lemma \ref{lemma-two-ss-complex-functor}, see also
Remark \ref{remark-functorial-ss}.

\medskip\noindent
We will use the notation regarding filtered objects introduced in
Homology, Section \ref{homology-section-filtrations}.
The category of filtered objects of $\mathcal{A}$ is
denoted $\text{Fil}(\mathcal{A})$.
All filtrations will be decreasing by fiat.

\begin{definition}
\label{definition-finite-filtered}
Let $\mathcal{A}$ be an abelian category. The
{\it category of finite filtered objects of $\mathcal{A}$}
is the category of filtered objects
$(A, F)$ of $\mathcal{A}$ whose filtration $F$ is finite.
We denote it $\text{Fil}^f(\mathcal{A})$.
\end{definition}

\noindent
Thus $\text{Fil}^f(\mathcal{A})$ is a full subcategory of
$\text{Fil}(\mathcal{A})$. For each $p \in \mathbf{Z}$ there is
a functor
$\text{gr}^p : \text{Fil}^f(\mathcal{A}) \to \mathcal{A}$.
There is a functor
$$
\text{gr} = \bigoplus\nolimits_{p \in \mathbf{Z}} \text{gr}^p :
\text{Fil}^f(\mathcal{A}) \to \text{Gr}(\mathcal{A})
$$
where $\text{Gr}(\mathcal{A})$ is the category of graded objects of
$\mathcal{A}$, see Homology, Definition \ref{homology-definition-graded}.
Finally, there is a functor
$$
(\text{forget }F) : \text{Fil}^f(\mathcal{A}) \longrightarrow \mathcal{A}
$$
which associates to the filtered object $(A, F)$ the underlying object
of $\mathcal{A}$.
The category $\text{Fil}^f(\mathcal{A})$ is an additive category, but not
abelian in general, see
Homology, Example \ref{homology-example-not-abelian}.

\medskip\noindent
Because the functors $\text{gr}^p$, $\text{gr}$, $(\text{forget }F)$
are additive they induce exact functors of triangulated categories
$$
\text{gr}^p, (\text{forget }F) :
K(\text{Fil}^f(\mathcal{A}))
\to
K(\mathcal{A})
\quad\text{and}\quad
\text{gr} :
K(\text{Fil}^f(\mathcal{A}))
\to
K(\text{Gr}(\mathcal{A}))
$$
by
Lemma \ref{lemma-additive-exact-homotopy-category}.
By analogy with the case of the homotopy category of an abelian category
we make the following definitions.

\begin{definition}
\label{definition-filtered-acyclic}
Let $\mathcal{A}$ be an abelian category.
\begin{enumerate}
\item Let $\alpha : K^\bullet \to L^\bullet$ be a morphism of
$K(\text{Fil}^f(\mathcal{A}))$. We say that
$\alpha$ is a {\it filtered quasi-isomorphism} if
the morphism $\text{gr}(\alpha)$ is a quasi-isomorphism.
\item Let $K^\bullet$ be an object of $K(\text{Fil}^f(\mathcal{A}))$.
We say that $K^\bullet$ is {\it filtered acyclic} if
the complex $\text{gr}(K^\bullet)$ is acyclic.
\end{enumerate}
\end{definition}

\noindent
Note that $\alpha : K^\bullet \to L^\bullet$ is a filtered quasi-isomorphism
if and only if each $\text{gr}^p(\alpha)$ is a quasi-isomorphism. Similarly
a complex $K^\bullet$ is filtered acyclic if and only if each
$\text{gr}^p(K^\bullet)$ is acyclic.

\begin{lemma}
\label{lemma-filtered-cohomology-homological}
Let $\mathcal{A}$ be an abelian category.
\begin{enumerate}
\item The functor
$K(\text{Fil}^f(\mathcal{A})) \longrightarrow \text{Gr}(\mathcal{A})$,
$K^\bullet \longmapsto H^0(\text{gr}(K^\bullet))$
is homological.
\item The functor
$K(\text{Fil}^f(\mathcal{A})) \rightarrow \mathcal{A}$,
$K^\bullet \longmapsto H^0(\text{gr}^p(K^\bullet))$
is homological.
\item The functor
$K(\text{Fil}^f(\mathcal{A})) \longrightarrow \mathcal{A}$,
$K^\bullet \longmapsto H^0((\text{forget }F)K^\bullet)$
is homological.
\end{enumerate}
\end{lemma}

\begin{proof}
This follows from the fact that
$H^0 : K(\mathcal{A}) \to \mathcal{A}$ is homological, see
Lemma \ref{lemma-cohomology-homological}
and the fact that the functors $\text{gr}, \text{gr}^p, (\text{forget }F)$
are exact functors of triangulated categories. See
Lemma \ref{lemma-exact-compose-homological-functor}.
\end{proof}

\begin{lemma}
\label{lemma-filtered-acyclic}
Let $\mathcal{A}$ be an abelian category. The full subcategory
$\text{FAc}(\mathcal{A})$ of $K(\text{Fil}^f(\mathcal{A}))$
consisting of filtered acyclic complexes is a strictly full saturated
triangulated subcategory of $K(\text{Fil}^f(\mathcal{A}))$.
The corresponding saturated multiplicative system (see
Lemma \ref{lemma-operations})
of $K(\text{Fil}^f(\mathcal{A}))$ is the set
$\text{FQis}(\mathcal{A})$ of filtered quasi-isomorphisms.
In particular, the kernel of the localization
functor
$$
Q :
K(\text{Fil}^f(\mathcal{A}))
\longrightarrow
\text{FQis}(\mathcal{A})^{-1}K(\text{Fil}^f(\mathcal{A}))
$$
is $\text{FAc}(\mathcal{A})$ and the functor $H^0 \circ \text{gr}$
factors through $Q$.
\end{lemma}

\begin{proof}
We know that $H^0 \circ \text{gr}$ is a homological functor by
Lemma \ref{lemma-filtered-cohomology-homological}.
Thus this lemma is a special case of
Lemma \ref{lemma-acyclic-general}.
\end{proof}

\begin{definition}
\label{definition-filtered-derived}
Let $\mathcal{A}$ be an abelian category.
Let $\text{FAc}(\mathcal{A})$ and $\text{FQis}(\mathcal{A})$
be as in
Lemma \ref{lemma-filtered-acyclic}.
The {\it filtered derived category of $\mathcal{A}$}
is the triangulated category
$$
DF(\mathcal{A}) =
K(\text{Fil}^f(\mathcal{A}))/\text{FAc}(\mathcal{A}) =
\text{FQis}(\mathcal{A})^{-1} K(\text{Fil}^f(\mathcal{A})).
$$
\end{definition}

\begin{lemma}
\label{lemma-filtered-derived-functors}
The functors $\text{gr}^p, \text{gr}, (\text{forget }F)$ induce
canonical exact functors
$$
\text{gr}^p, \text{gr}, (\text{forget }F):
DF(\mathcal{A})
\longrightarrow
D(\mathcal{A})
$$
which commute with the localization functors.
\end{lemma}

\begin{proof}
This follows from the universal property of localization, see
Lemma \ref{lemma-universal-property-localization},
provided we can show that a filtered quasi-isomorphism is turned
into a quasi-isomorphism by each of the functors
$\text{gr}^p, \text{gr}, (\text{forget }F)$. This is true by definition
for the first two. For the last one the statement we have to do a little
bit of work. Let $f : K^\bullet \to L^\bullet$ be a filtered
quasi-isomorphism in $K(\text{Fil}^f(\mathcal{A}))$.
Choose a distinguished triangle $(K^\bullet, L^\bullet, M^\bullet, f, g, h)$
which contains $f$. Then $M^\bullet$ is filtered acyclic, see
Lemma \ref{lemma-filtered-acyclic}.
Hence by the corresponding lemma for $K(\mathcal{A})$ it suffices
to show that a filtered acyclic complex is an acyclic complex if
we forget the filtration.
This follows from
Homology, Lemma \ref{homology-lemma-filtered-acyclic}.
\end{proof}

\begin{definition}
\label{definition-filtered-derived-bounded}
Let $\mathcal{A}$ be an abelian category.
The {\it bounded filtered derived category} $DF^b(\mathcal{A})$ is
the full subcategory of $DF(\mathcal{A})$ with objects those $X$
such that $\text{gr}(X) \in D^b(\mathcal{A})$.
Similarly for the bounded below filtered derived category
$DF^{+}(\mathcal{A})$ and the bounded above filtered derived category
$DF^{-}(\mathcal{A})$.
\end{definition}

\begin{lemma}
\label{lemma-filtered-complex-cohomology-bounded}
Let $\mathcal{A}$ be an abelian category.
Let $K^\bullet \in K(\text{Fil}^f(\mathcal{A}))$.
\begin{enumerate}
\item If $H^n(\text{gr}(K^\bullet)) = 0$ for all $n < a$, then there exists
a filtered quasi-isomorphism $K^\bullet \to L^\bullet$ with
$L^n = 0$ for all $n < a$.
\item If $H^n(\text{gr}(K^\bullet)) = 0$ for all $n > b$, then there exists
a filtered quasi-isomorphism $M^\bullet \to K^\bullet$ with
$M^n = 0$ for all $n > b$.
\item If $H^n(\text{gr}(K^\bullet)) = 0$ for all $|n| \gg 0$, then there
exists a commutative diagram of morphisms of complexes
$$
\xymatrix{
K^\bullet \ar[r] & L^\bullet \\
M^\bullet \ar[u] \ar[r] & N^\bullet \ar[u]
}
$$
where all the arrows are filtered quasi-isomorphisms, $L^\bullet$
bounded below, $M^\bullet$ bounded above, and $N^\bullet$ a bounded
complex.
\end{enumerate}
\end{lemma}

\begin{proof}
Suppose that $H^n(\text{gr}(K^\bullet)) = 0$ for all $n < a$. By
Homology, Lemma \ref{homology-lemma-filtered-acyclic}
the sequence
$$
K^{a - 1} \xrightarrow{d^{a - 2}} K^{a - 1} \xrightarrow{d^{a - 1}} K^a
$$
is an exact sequence of objects of $\mathcal{A}$ and the morphisms
$d^{a - 2}$ and $d^{a - 1}$ are strict. Hence
$\Coim(d^{a - 1}) = \Im(d^{a - 1})$ in $\text{Fil}^f(\mathcal{A})$
and the map $\text{gr}(\Im(d^{a - 1})) \to \text{gr}(K^a)$
is injective with image equal to the image of
$\text{gr}(K^{a - 1}) \to \text{gr}(K^a)$, see
Homology, Lemma \ref{homology-lemma-characterize-strict}.
This means that the map $K^\bullet \to \tau_{\geq a}K^\bullet$
into the truncation
$$
\tau_{\geq a}K^\bullet =
(\ldots \to 0 \to K^a/\Im(d^{a - 1}) \to K^{a + 1} \to \ldots)
$$
is a filtered quasi-isomorphism. This proves (1). The proof of (2)
is dual to the proof of (1). Part (3) follows formally from (1) and (2).
\end{proof}

\noindent
To state the following lemma denote
$\text{FAc}^{+}(\mathcal{A})$, $\text{FAc}^{-}(\mathcal{A})$,
resp.\ $\text{FAc}^b(\mathcal{A})$ the intersection of
$K^{+}(\text{Fil}^f\mathcal{A})$, $K^{-}(\text{Fil}^f\mathcal{A})$,
resp.\ $K^b(\text{Fil}^f\mathcal{A})$ with $\text{FAc}(\mathcal{A})$.
Denote $\text{FQis}^{+}(\mathcal{A})$, $\text{FQis}^{-}(\mathcal{A})$,
resp.\ $\text{FQis}^b(\mathcal{A})$ the intersection of
$K^{+}(\text{Fil}^f\mathcal{A})$, $K^{-}(\text{Fil}^f\mathcal{A})$,
resp.\ $K^b(\text{Fil}^f\mathcal{A})$ with $\text{FQis}(\mathcal{A})$.

\begin{lemma}
\label{lemma-filtered-bounded-derived}
Let $\mathcal{A}$ be an abelian category. The subcategories
$\text{FAc}^{+}(\mathcal{A})$, $\text{FAc}^{-}(\mathcal{A})$,
resp.\ $\text{FAc}^b(\mathcal{A})$
are strictly full saturated triangulated subcategories
of $K^{+}(\text{Fil}^f\mathcal{A})$, $K^{-}(\text{Fil}^f\mathcal{A})$,
resp.\ $K^b(\text{Fil}^f\mathcal{A})$.
The corresponding saturated multiplicative systems (see
Lemma \ref{lemma-operations})
are the sets $\text{FQis}^{+}(\mathcal{A})$, $\text{FQis}^{-}(\mathcal{A})$,
resp.\ $\text{FQis}^b(\mathcal{A})$.
\begin{enumerate}
\item The kernel of the functor
$K^{+}(\text{Fil}^f\mathcal{A}) \to DF^{+}(\mathcal{A})$
is $\text{FAc}^{+}(\mathcal{A})$ and this induces an equivalence
of triangulated categories
$$
K^{+}(\text{Fil}^f\mathcal{A})/\text{FAc}^{+}(\mathcal{A}) =
\text{FQis}^{+}(\mathcal{A})^{-1}K^{+}(\text{Fil}^f\mathcal{A})
\longrightarrow
DF^{+}(\mathcal{A})
$$
\item The kernel of the functor
$K^{-}(\text{Fil}^f\mathcal{A}) \to DF^{-}(\mathcal{A})$
is $\text{FAc}^{-}(\mathcal{A})$ and this induces an equivalence
of triangulated categories
$$
K^{-}(\text{Fil}^f\mathcal{A})/\text{FAc}^{-}(\mathcal{A}) =
\text{FQis}^{-}(\mathcal{A})^{-1}K^{-}(\text{Fil}^f\mathcal{A})
\longrightarrow
DF^{-}(\mathcal{A})
$$
\item The kernel of the functor
$K^b(\text{Fil}^f\mathcal{A}) \to DF^b(\mathcal{A})$
is $\text{FAc}^b(\mathcal{A})$ and this induces an equivalence
of triangulated categories
$$
K^b(\text{Fil}^f\mathcal{A})/\text{FAc}^b(\mathcal{A}) =
\text{FQis}^b(\mathcal{A})^{-1}K^b(\text{Fil}^f\mathcal{A})
\longrightarrow
DF^b(\mathcal{A})
$$
\end{enumerate}
\end{lemma}

\begin{proof}
This follows from the results above, in particular
Lemma \ref{lemma-filtered-complex-cohomology-bounded},
by exactly the same arguments as used in the proof of
Lemma \ref{lemma-bounded-derived}.
\end{proof}











\section{Derived functors in general}
\label{section-derived-functors}

\noindent
A reference for this section is Deligne's expos\'e XVII in \cite{SGA4}.
A very general notion of right and left derived functors exists where
we have an exact functor between triangulated categories, a multiplicative
system in the source category and we want to find the ``correct'' extension
of the exact functor to the localized category.

\begin{situation}
\label{situation-derived-functor}
Here $F : \mathcal{D} \to \mathcal{D}'$ is an exact functor of triangulated
categories and $S$ is a saturated multiplicative
system in $\mathcal{D}$ compatible with the structure
of triangulated category on $\mathcal{D}$.
\end{situation}

\noindent
Let $X \in \Ob(\mathcal{D})$. Recall from
Categories, Remark \ref{categories-remark-left-localization-morphisms-colimit}
the filtered category $X/S$ of arrows $s : X \to X'$ in $S$ with source $X$.
Dually, in
Categories, Remark \ref{categories-remark-right-localization-morphisms-colimit}
we defined the cofiltered category $S/X$ of arrows $s : X' \to X$ in $S$
with target $X$.

\begin{definition}
\label{definition-right-derived-functor-defined}
Assumptions and notation as in
Situation \ref{situation-derived-functor}.
Let $X \in \Ob(\mathcal{D})$.
\begin{enumerate}
\item we say the {\it right derived functor $RF$ is defined at}
$X$ if the ind-object
$$
(X/S) \longrightarrow \mathcal{D}', \quad
(s : X \to X') \longmapsto F(X')
$$
is essentially constant\footnote{For a discussion of when an ind-object
or pro-object of a category is essentially constant we refer to
Categories, Section \ref{categories-section-essentially-constant}.};
in this case the value
$Y$ in $\mathcal{D}'$ is called the {\it value of $RF$ at $X$}.
\item we say the {\it left derived functor $LF$ is defined at} $X$
if the pro-object
$$
(S/X) \longrightarrow \mathcal{D}', \quad
(s: X' \to X) \longmapsto F(X')
$$
is essentially constant; in this case the value $Y$ in $\mathcal{D}'$
is called the {\it value of $LF$ at $X$}.
\end{enumerate}
By abuse of notation we often denote the values simply
$RF(X)$ or $LF(X)$.
\end{definition}

\noindent
It will turn out that the full subcategory of $\mathcal{D}$ consisting
of objects where $RF$ is defined is a triangulated subcategory, and
$RF$ will define a functor on this subcategory which transforms morphisms
of $S$ into isomorphisms.

\begin{lemma}
\label{lemma-derived-functor}
Assumptions and notation as in
Situation \ref{situation-derived-functor}.
Let $f : X \to Y$ be a morphism of $\mathcal{D}$.
\begin{enumerate}
\item If $RF$ is defined at $X$ and $Y$ then there exists a unique
morphism $RF(f) : RF(X) \to RF(Y)$ between the values such that
for any commutative diagram
$$
\xymatrix{
X \ar[d]_f \ar[r]_s & X' \ar[d]^{f'} \\
Y \ar[r]^{s'} & Y'
}
$$
with $s, s' \in S$ the diagram
$$
\xymatrix{
F(X) \ar[d] \ar[r] & F(X') \ar[d] \ar[r] & RF(X) \ar[d] \\
F(Y) \ar[r] & F(Y') \ar[r] & RF(Y)
}
$$
commutes.
\item If $LF$ is defined at $X$ and $Y$ then there exists a unique
morphism $LF(f) : LF(X) \to LF(Y)$ between the values such that
for any commutative diagram
$$
\xymatrix{
X' \ar[d]_{f'} \ar[r]_s & X \ar[d]^f \\
Y' \ar[r]^{s'} & Y
}
$$
with $s, s'$ in $S$ the diagram
$$
\xymatrix{
LF(X) \ar[d] \ar[r] & F(X') \ar[d] \ar[r] & F(X) \ar[d] \\
LF(Y) \ar[r] & F(Y') \ar[r] & F(Y)
}
$$
commutes.
\end{enumerate}
\end{lemma}

\begin{proof}
Part (1) holds if we only assume that the colimits
$$
RF(X) = \colim_{s : X \to X'} F(X')
\quad\text{and}\quad
RF(Y) = \colim_{s' : Y \to Y'} F(Y')
$$
exist. Namely, to give a morphism $RF(X) \to RF(Y)$ between the colimits
is the same thing as giving for each $s : X \to X'$ in $\Ob(X/S)$
a morphism $F(X') \to RF(Y)$ compatible with morphisms in the category
$X/S$. To get the morphism we choose a commutative diagram
$$
\xymatrix{
X \ar[d]_f \ar[r]_s & X' \ar[d]^{f'} \\
Y \ar[r]^{s'} & Y'
}
$$
with $s, s'$ in $S$ as is possible by MS2 and we set
$F(X') \to RF(Y)$ equal to the composition $F(X') \to F(Y') \to RF(Y)$.
To see that this is independent of the choice of the diagram above use
MS3. Details omitted. The proof of (2) is dual.
\end{proof}

\begin{lemma}
\label{lemma-derived-inverts}
Assumptions and notation as in
Situation \ref{situation-derived-functor}.
Let $s : X \to Y$ be an element of $S$.
\begin{enumerate}
\item $RF$ is defined at $X$ if and only if it is defined at $Y$.
In this case the map $RF(s) : RF(X) \to RF(Y)$ between values
is an isomorphism.
\item $LF$ is defined at $X$ if and only if it is defined at $Y$.
In this case the map $LF(s) : LF(X) \to LF(Y)$ between values
is an isomorphism.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-derived-shift}
\begin{slogan}
Derived functors are compatible with shifts
\end{slogan}
Assumptions and notation as in
Situation \ref{situation-derived-functor}.
Let $X$ be an object of $\mathcal{D}$ and $n \in \mathbf{Z}$.
\begin{enumerate}
\item $RF$ is defined at $X$ if and only if it is defined at $X[n]$.
In this case there is a canonical isomorphism
$RF(X)[n]= RF(X[n])$ between values.
\item $LF$ is defined at $X$ if and only if it is defined at $X[n]$.
In this case there is a canonical isomorphism
$LF(X)[n] \to LF(X[n])$ between values.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-2-out-of-3-defined}
Assumptions and notation as in
Situation \ref{situation-derived-functor}.
Let $(X, Y, Z, f, g, h)$ be a distinguished triangle of $\mathcal{D}$.
If $RF$ is defined at two out of three of $X, Y, Z$, then it is defined
at the third. Moreover, in this case
$$
(RF(X), RF(Y), RF(Z), RF(f), RF(g), RF(h))
$$
is a distinguished triangle in $\mathcal{D}'$. Similarly for $LF$.
\end{lemma}

\begin{proof}
Say $RF$ is defined at $X, Y$ with values $A, B$.
Let $RF(f) : A \to B$ be the induced morphism, see
Lemma \ref{lemma-derived-functor}.
We may choose a distinguished triangle
$(A, B, C, RF(f), b, c)$
in $\mathcal{D}'$. We claim that $C$ is a value of $RF$ at $Z$.

\medskip\noindent
To see this pick $s : X \to X'$ in $S$ such that there exists a morphism
$\alpha : A \to F(X')$ as in
Categories,
Definition \ref{categories-definition-essentially-constant-diagram}.
We may choose a commutative diagram
$$
\xymatrix{
X \ar[d]_f \ar[r]_s & X' \ar[d]^{f'} \\
Y \ar[r]^{s'} & Y'
}
$$
with $s' \in S$ by MS2. Using that $Y/S$ is filtered we can (after replacing
$s'$ by some $s'' : Y \to Y''$ in $S$) assume that there exists
a morphism $\beta : B \to F(Y')$ as in
Categories,
Definition \ref{categories-definition-essentially-constant-diagram}.
Picture
$$
\xymatrix{
A \ar[d]_{RF(f)} \ar[r]_-\alpha &
F(X') \ar[r] \ar[d]^{F(f')} &
A \ar[d]^{RF(f)} \\
B \ar[r]^-\beta & F(Y') \ar[r] & B
}
$$
It may not be true that the left square commutes, but the outer and
right squares commute.
The assumption that the ind-object $\{F(Y')\}_{s' : Y' \to Y}$
is essentially constant means that there exists a $s'' : Y \to Y''$
in $S$ and a morphism $h : Y' \to Y''$ such that $s'' = h \circ s'$ and
such that $F(h)$ equal to $F(Y') \to B \to F(Y') \to F(Y'')$. Hence
after replacing $Y'$ by $Y''$ and $\beta$ by $F(h) \circ \beta$ the
diagram will commute (by direct computation with arrows).

\medskip\noindent
Using MS6 choose a morphism of triangles
$$
(s, s', s'') : (X, Y, Z, f, g, h) \longrightarrow (X', Y', Z', f', g', h')
$$
with $s'' \in S$. By TR3 choose a morphism of triangles
$$
(\alpha, \beta, \gamma) :
(A, B, C, RF(f), b, c)
\longrightarrow
(F(X'), F(Y'), F(Z'), F(f'), F(g'), F(h'))
$$

\medskip\noindent
By
Lemma \ref{lemma-derived-inverts}
it suffices to prove that $RF(Z')$ is defined and has value $C$.
Consider the category $\mathcal{I}$ of
Lemma \ref{lemma-limit-triangles}
of triangles
$$
\mathcal{I} =
\{(t, t', t'') : (X', Y', Z', f', g', h') \to (X'', Y'', Z'', f'', g'', h'')
\mid (t, t', t'') \in S\}
$$
To show that the system $F(Z'')$ is essentially constant over the category
$Z'/S$ is equivalent to showing that the system of $F(Z'')$ is essentially
constant over $\mathcal{I}$ because $\mathcal{I} \to Z'/S$ is cofinal, see
Categories, Lemma \ref{categories-lemma-cofinal-essentially-constant}
(cofinality is proven in Lemma \ref{lemma-limit-triangles}).
For any object $W$ in $\mathcal{D}'$ we
consider the diagram
$$
\xymatrix{
\colim_\mathcal{I} \Mor_{\mathcal{D}'}(W, F(X'')) &
\Mor_{\mathcal{D}'}(W, A) \ar[l] \\
\colim_\mathcal{I} \Mor_{\mathcal{D}'}(W, F(Y'')) \ar[u] &
\Mor_{\mathcal{D}'}(W, B) \ar[u] \ar[l] \\
\colim_\mathcal{I} \Mor_{\mathcal{D}'}(W, F(Z'')) \ar[u] &
\Mor_{\mathcal{D}'}(W, C) \ar[u] \ar[l] \\
\colim_\mathcal{I} \Mor_{\mathcal{D}'}(W, F(X''[1])) \ar[u] &
\Mor_{\mathcal{D}'}(W, A[1]) \ar[u] \ar[l] \\
\colim_\mathcal{I} \Mor_{\mathcal{D}'}(W, F(Y''[1])) \ar[u] &
\Mor_{\mathcal{D}'}(W, B[1]) \ar[u] \ar[l]
}
$$
where the horizontal arrows are given by composing with
$(\alpha, \beta, \gamma)$. Since filtered colimits are exact
(Algebra, Lemma \ref{algebra-lemma-directed-colimit-exact}) the left column
is an exact sequence. Thus the $5$ lemma
(Homology, Lemma \ref{homology-lemma-five-lemma}) tells us the
$$
\colim_\mathcal{I} \Mor_{\mathcal{D}'}(W, F(Z''))
\longrightarrow
\Mor_{\mathcal{D}'}(W, C)
$$
is bijective. Choose an object
$(t, t', t'') : (X', Y', Z') \to (X'', Y'', Z'')$ of $\mathcal{I}$.
Applying what we just showed to $W = F(Z'')$ and the element
$\text{id}_{F(X'')}$ of the colimit we find a unique morphism
$c_{(X'', Y'', Z'')} : F(Z'') \to C$ such that for some
$(X'', Y'', Z'') \to (X''', Y''', Z'')$ in $\mathcal{I}$
$$
F(Z'') \xrightarrow{c_{(X'', Y'', Z'')}} C \xrightarrow{\gamma}
F(Z') \to F(Z'') \to F(Z''')
\quad\text{equals}\quad
F(Z'') \to F(Z''')
$$
The family of morphisms $c_{(X'', Y'', Z'')}$ form an element $c$ of
$\lim_\mathcal{I} \Mor_{\mathcal{D}'}(F(Z''), C)$ by uniqueness
(computation omitted). Finally, we show that
$\colim_\mathcal{I} F(Z'') = C$ via the morphisms $c_{(X'', Y'', Z'')}$
which will finish the proof by 
Categories, Lemma \ref{categories-lemma-characterize-essentially-constant-ind}.
Namely, let $W$ be an object of $\mathcal{D}'$ and let
$d_{(X'', Y'', Z'')} : F(Z'') \to W$ be a family of maps corresponding
to an element of $\lim_\mathcal{I} \Mor_{\mathcal{D}'}(F(Z''), W)$.
If $d_{(X', Y', Z')} \circ \gamma = 0$, then for every object
$(X'', Y'', Z'')$ of $\mathcal{I}$ the morphism $d_{(X'', Y'', Z'')}$
is zero by the existence of $c_{(X'', Y'', Z'')}$ and the
morphism $(X'', Y'', Z'') \to (X''', Y''', Z'')$ in $\mathcal{I}$
satisfying the displayed equality above. Hence the map
$$
\lim_\mathcal{I} \Mor_{\mathcal{D}'}(F(Z''), W)
\longrightarrow
\Mor_{\mathcal{D}'}(C, W)
$$
(coming from precomposing by $\gamma$) is injective. However, it is
also surjective because the element $c$ gives a left inverse. We conclude
that $C$ is the colimit by
Categories, Remark \ref{categories-remark-limit-colim}.
\end{proof}

\begin{lemma}
\label{lemma-direct-sum-defined}
Assumptions and notation as in Situation \ref{situation-derived-functor}.
Let $X, Y$ be objects of $\mathcal{D}$.
\begin{enumerate}
\item If $RF$ is defined at $X$ and $Y$, then $RF$ is defined at $X \oplus Y$.
\item If $\mathcal{D}'$ is Karoubian and $RF$ is defined at $X \oplus Y$,
then $RF$ is defined at both $X$ and $Y$.
\end{enumerate}
In either case we have $RF(X \oplus Y) = RF(X) \oplus RF(Y)$.
Similarly for $LF$.
\end{lemma}

\begin{proof}
If $RF$ is defined at $X$ and $Y$, then the distinguished triangle
$X \to X \oplus Y \to Y \to X[1]$ (Lemma \ref{lemma-split}) and
Lemma \ref{lemma-2-out-of-3-defined}
shows that $RF$ is defined at $X \oplus Y$ and that we
have a distinguished triangle
$RF(X) \to RF(X \oplus Y) \to RF(Y) \to RF(X)[1]$.
Applying Lemma \ref{lemma-split} to this once more we find
that $RF(X \oplus Y) = RF(X) \oplus RF(Y)$.
This proves (1) and the final assertion.

\medskip\noindent
Conversely, assume that $RF$ is defined at $X \oplus Y$ and that $\mathcal{D}'$
is Karoubian. Since $S$ is a saturated system $S$ is the set of arrows which
become invertible under the additive localization functor
$Q : \mathcal{D} \to S^{-1}\mathcal{D}$, see
Categories, Lemma \ref{categories-lemma-what-gets-inverted}.
Thus for any $s : X \to X'$ and $s' : Y \to Y'$ in $S$ the morphism
$s \oplus s' : X \oplus Y \to X' \oplus Y'$ is an element of $S$.
In this way we obtain a functor
$$
X/S \times Y/S \longrightarrow (X \oplus Y)/S
$$
Recall that the categories $X/S, Y/S, (X \oplus Y)/S$ are filtered
(Categories, Remark
\ref{categories-remark-left-localization-morphisms-colimit}).
By Categories, Lemma \ref{categories-lemma-essentially-constant-over-product}
$X/S \times Y/S$ is filtered and
$F|_{X/S} : X/S \to \mathcal{D}'$ (resp.\ $G|_{Y/S} : Y/S \to \mathcal{D}'$)
is essentially constant if and only if
$F|_{X/S} \circ \text{pr}_1 : X/S \times Y/S \to \mathcal{D}'$
(resp.\ $G|_{Y/S} \circ \text{pr}_2 : X/S \times Y/S \to \mathcal{D}'$)
is essentially constant. Below we will show that the displayed functor
is cofinal, hence by
Categories, Lemma \ref{categories-lemma-cofinal-essentially-constant}.
we see that $F|_{(X \oplus Y)/S}$ is essentially constant implies that
$F|_{X/S} \circ \text{pr}_1 \oplus F|_{Y/S} \circ \text{pr}_2 :
X/S \times Y/S \to \mathcal{D}'$
is essentially constant. By Homology, Lemma
\ref{homology-lemma-direct-sum-from-product-essentially-constant}
(and this is where we use that $\mathcal{D}'$ is Karoubian)
we see that 
$F|_{X/S} \circ \text{pr}_1 \oplus F|_{Y/S} \circ \text{pr}_2$
being essentially constant implies
$F|_{X/S} \circ \text{pr}_1$ and
$F|_{Y/S} \circ \text{pr}_2$ are essentially constant proving that $RF$ is
defined at $X$ and $Y$.

\medskip\noindent
Proof that the displayed functor is cofinal.
To do this pick any $t : X \oplus Y \to Z$ in $S$.
Using MS2 we can find morphisms $Z \to X'$, $Z \to Y'$
and $s : X \to X'$, $s' : Y \to Y'$ in $S$ such that
$$
\xymatrix{
X \ar[d]^s & X \oplus Y \ar[d] \ar[l] \ar[r] & Y \ar[d]_{s'} \\
X' & Z \ar[l] \ar[r] & Y'
}
$$
commutes. This proves there is a map $Z \to X' \oplus Y'$ in
$(X \oplus Y)/S$, i.e., we get part (1) of Categories, Definition
\ref{categories-definition-cofinal}. To prove part (2) it suffices
to prove that given $t : X \oplus Y \to Z$ and morphisms
$s_i \oplus s'_i : Z \to X'_i \oplus Y'_i$, $i = 1, 2$ in $(X \oplus Y)/S$
we can find morphisms $a : X'_1 \to X'$, $b : X'_2 \to X'$,
$c : Y'_1 \to Y'$, $d : Y'_2 \to Y'$ in $S$ such that
$a \circ s_1 = b \circ s_2$ and $c \circ s'_1 = d \circ s'_2$.
To do this we first choose any $X'$ and $Y'$ and maps $a, b, c, d$
in $S$; this is possible as $X/S$ and $Y/S$ are filtered. Then the
two maps $a \circ s_1, b \circ s_2 : Z \to X'$ become equal in
$S^{-1}\mathcal{D}$. Hence we can find a morphism
$X' \to X''$ in $S$ equalizing them. Similarly we find $Y' \to Y''$ in $S$
equalizing $c \circ s'_1$ and $d \circ s'_2$. Replacing $X'$ by $X''$ and
$Y'$ by $Y''$ we get $a \circ s_1 = b \circ s_2$ and
$c \circ s'_1 = d \circ s'_2$.

\medskip\noindent
The proof of the corresponding statements for $LF$ are dual.
\end{proof}

\begin{proposition}
\label{proposition-derived-functor}
Assumptions and notation as in Situation \ref{situation-derived-functor}.
\begin{enumerate}
\item The full subcategory $\mathcal{E}$ of $\mathcal{D}$ consisting of
objects at which $RF$ is defined is a strictly full triangulated
subcategory of $\mathcal{D}$.
\item We obtain an exact functor
$RF : \mathcal{E} \longrightarrow \mathcal{D}'$
of triangulated categories.
\item Elements of $S$ with either source or target
in $\mathcal{E}$ are morphisms of $\mathcal{E}$.
\item The functor $S_\mathcal{E}^{-1}\mathcal{E} \to S^{-1}\mathcal{D}$
is a fully faithful exact functor of triangulated categories.
\item Any element of $S_\mathcal{E} = \text{Arrows}(\mathcal{E}) \cap S$
is mapped to an isomorphism by $RF$.
\item We obtain an exact functor
$$
RF : S_\mathcal{E}^{-1}\mathcal{E} \longrightarrow \mathcal{D}'.
$$
\item If $\mathcal{D}'$ is Karoubian, then $\mathcal{E}$ is a saturated
triangulated subcategory of $\mathcal{D}$.
\end{enumerate}
A similar result holds for $LF$.
\end{proposition}

\begin{proof}
Since $S$ is saturated it contains all isomorphisms (see remark
following Categories, Definition
\ref{categories-definition-saturated-multiplicative-system}). Hence
(1) follows from Lemmas \ref{lemma-derived-inverts},
\ref{lemma-2-out-of-3-defined}, and
\ref{lemma-derived-shift}. We get (2) from
Lemmas \ref{lemma-derived-functor}, \ref{lemma-derived-shift}, and
\ref{lemma-2-out-of-3-defined}. We get (3) from
Lemma \ref{lemma-derived-inverts}. The fully faithfulness in (4) follows
from (3) and the definitions. The fact that
$S_\mathcal{E}^{-1}\mathcal{E} \to S^{-1}\mathcal{D}$ is exact
follows from the fact that a triangle in $S_\mathcal{E}^{-1}\mathcal{E}$
is distinguished if and only if it is isomorphic to the image of a
distinguished triangle in $\mathcal{E}$, see proof of
Proposition \ref{proposition-construct-localization}.
Part (5) follows from Lemma \ref{lemma-derived-inverts}.
The factorization of $RF : \mathcal{E} \to \mathcal{D}'$
through an exact functor $S_\mathcal{E}^{-1}\mathcal{E} \to \mathcal{D}'$
follows from Lemma \ref{lemma-universal-property-localization}.
Part (7) follows from Lemma \ref{lemma-direct-sum-defined}.
\end{proof}

\noindent
Proposition \ref{proposition-derived-functor}
tells us that $RF$ lives on a maximal strictly full
triangulated subcategory of $S^{-1}\mathcal{D}$ and is an exact functor
on this triangulated category. Picture:
$$
\xymatrix{
\mathcal{D} \ar[d]_Q \ar[rrr]_F & & & \mathcal{D}' \\
S^{-1}\mathcal{D} & &
S_\mathcal{E}^{-1}\mathcal{E}
\ar[ll]_{\text{fully faithful}}^{\text{exact}} \ar[ur]_{RF}
}
$$

\begin{definition}
\label{definition-everywhere-defined}
In
Situation \ref{situation-derived-functor}.
We say $F$ is {\it right derivable}, or that $RF$ {\it everywhere defined}
if $RF$ is defined at every object of $\mathcal{D}$.
We say $F$ is {\it left derivable}, or that $LF$ {\it everywhere defined}
if $LF$ is defined at every object of $\mathcal{D}$.
\end{definition}

\noindent
In this case we obtain a right (resp.\ left) derived functor
\begin{equation}
\label{equation-everywhere}
RF : S^{-1}\mathcal{D} \longrightarrow \mathcal{D}',
\quad\text{(resp. }
LF : S^{-1}\mathcal{D} \longrightarrow \mathcal{D}'),
\end{equation}
see
Proposition \ref{proposition-derived-functor}.
In most interesting situations it is not the case that $RF \circ Q$ is
equal to $F$. In fact, it might happen that the canonical map
$F(X) \to RF(X)$ is never an isomorphism. In practice this does not happen,
because in practice we only know how to prove $F$ is right derivable by
showing that $RF$ can be computed by evaluating $F$ at judiciously chosen
objects of the triangulated category $\mathcal{D}$. This warrants
a definition.

\begin{definition}
\label{definition-computes}
In
Situation \ref{situation-derived-functor}.
\begin{enumerate}
\item An object $X$ of $\mathcal{D}$ {\it computes} $RF$ if $RF$ is defined
at $X$ and the canonical map $F(X) \to RF(X)$ is an isomorphism.
\item An object $X$ of $\mathcal{D}$ {\it computes} $LF$ if $LF$ is defined
at $X$ and the canonical map $LF(X) \to F(X)$ is an isomorphism.
\end{enumerate}
\end{definition}

\begin{lemma}
\label{lemma-computes-shift}
Assumptions and notation as in
Situation \ref{situation-derived-functor}.
Let $X$ be an object of $\mathcal{D}$ and $n \in \mathbf{Z}$.
\begin{enumerate}
\item $X$ computes $RF$ if and only if $X[n]$ computes $RF$.
\item $X$ computes $LF$ if and only if $X[n]$ computes $LF$.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-2-out-of-3-computes}
Assumptions and notation as in
Situation \ref{situation-derived-functor}.
Let $(X, Y, Z, f, g, h)$ be a distinguished triangle of $\mathcal{D}$.
If $X, Y$ compute $RF$ then so does $Z$. Similar for $LF$.
\end{lemma}

\begin{proof}
By
Lemma \ref{lemma-2-out-of-3-defined}
we know that $RF$ is defined at $Z$ and that $RF$ applied to the
triangle produces a distinguished triangle.
Consider the morphism of distinguished triangles
$$
\xymatrix{
(F(X), F(Y), F(Z), F(f), F(g), F(h)) \ar[d] \\
(RF(X), RF(Y), RF(Z), RF(f), RF(g), RF(h))
}
$$
Two out of three maps are isomorphisms, hence so is the third.
\end{proof}

\begin{lemma}
\label{lemma-direct-sum-computes}
Assumptions and notation as in Situation \ref{situation-derived-functor}.
Let $X, Y$ be objects of $\mathcal{D}$. If $X \oplus Y$ computes $RF$, then
$X$ and $Y$ compute $RF$. Similarly for $LF$.
\end{lemma}

\begin{proof}
If $X \oplus Y$ computes $RF$, then $RF(X \oplus Y) = F(X) \oplus F(Y)$.
In the proof of Lemma \ref{lemma-direct-sum-defined} we have seen that
the functor $X/S \times Y/S \to (X \oplus Y)/S$, $(s, s') \mapsto s \oplus s'$
is cofinal. We will use this without further mention. Let $s : X \to X'$ be
an element of $S$. Then $F(X) \to F(X')$ has a section, namely,
$$
F(X') \to F(X' \oplus Y) \to RF(X' \oplus Y) =
RF(X \oplus Y) = F(X) \oplus F(Y) \to F(X).
$$
where we have used Lemma \ref{lemma-derived-inverts}.
Hence $F(X') = F(X) \oplus E$ for some object $E$ of $\mathcal{D}'$
such that $E \to F(X' \oplus Y) \to RF(X'\oplus Y) = RF(X \oplus Y)$
is zero (Lemma \ref{lemma-when-split}).
Because $RF$ is defined at $X' \oplus Y$ with value
$F(X) \oplus F(Y)$ we can find a morphism $t : X' \oplus Y \to Z$
of $S$ such that $F(t)$ annihilates $E$. We may assume
$Z = X'' \oplus Y''$ and $t = t' \oplus t''$ with $t', t'' \in S$.
Then $F(t')$ annihilates $E$. It follows that $F$ is essentially constant
on $X/S$ with value $F(X)$ as desired.
\end{proof}

\begin{lemma}
\label{lemma-existence-computes}
Assumptions and notation as in
Situation \ref{situation-derived-functor}.
\begin{enumerate}
\item If for every object $X \in \Ob(\mathcal{D})$
there exists an arrow $s : X \to X'$ in $S$ such that $X'$ computes
$RF$, then $RF$ is everywhere defined.
\item If for every object $X \in \Ob(\mathcal{D})$
there exists an arrow $s : X' \to X$ in $S$ such that $X'$ computes
$LF$, then $LF$ is everywhere defined.
\end{enumerate}
\end{lemma}

\begin{proof}
This is clear from the definitions.
\end{proof}

\begin{lemma}
\label{lemma-find-existence-computes}
Assumptions and notation as in
Situation \ref{situation-derived-functor}.
If there exists a subset $\mathcal{I} \subset \Ob(\mathcal{D})$
such that
\begin{enumerate}
\item for all $X \in \Ob(\mathcal{D})$
there exists $s : X \to X'$ in $S$ with $X' \in \mathcal{I}$,
and
\item for every arrow $s : X \to X'$ in $S$ with $X, X' \in \mathcal{I}$
the map $F(s) : F(X) \to F(X')$ is an isomorphism,
\end{enumerate}
then $RF$ is everywhere defined and every $X \in \mathcal{I}$
computes $RF$. Dually, if there exists a subset
$\mathcal{P} \subset \Ob(\mathcal{D})$
such that
\begin{enumerate}
\item for all $X \in \Ob(\mathcal{D})$
there exists $s : X' \to X$ in $S$ with $X' \in \mathcal{P}$,
and
\item for every arrow $s : X \to X'$ in $S$ with $X, X' \in \mathcal{P}$
the map $F(s) : F(X) \to F(X')$ is an isomorphism,
\end{enumerate}
then $LF$ is everywhere defined and every $X \in \mathcal{P}$
computes $LF$.
\end{lemma}

\begin{proof}
Let $X$ be an object of $\mathcal{D}$.
Assumption (1) implies that the arrows $s : X \to X'$ in $S$ with
$X' \in \mathcal{I}$ are cofinal in the category $X/S$. Assumption
(2) implies that $F$ is constant on this cofinal subcategory.
Clearly this implies that $F : (X/S) \to \mathcal{D}'$ is essentially
constant with value $F(X')$ for any $s : X \to X'$ in $S$
with $X' \in \mathcal{I}$.
\end{proof}

\begin{lemma}
\label{lemma-compose-derived-functors-general}
Let $\mathcal{A}, \mathcal{B}, \mathcal{C}$ be triangulated categories.
Let $S$, resp.\ $S'$ be a saturated multiplicative system in
$\mathcal{A}$, resp.\ $\mathcal{B}$ compatible with the triangulated structure.
Let $F : \mathcal{A} \to \mathcal{B}$ and $G : \mathcal{B} \to \mathcal{C}$
be exact functors. Denote $F' : \mathcal{A} \to (S')^{-1}\mathcal{B}$ the
composition of $F$ with the localization functor.
\begin{enumerate}
\item If $RF'$, $RG$, $R(G \circ F)$ are everywhere defined, then there
is a canonical transformation of functors
$t : R(G \circ F) \longrightarrow RG \circ RF'$.
\item If $LF'$, $LG$, $L(G \circ F)$ are everywhere defined, then there
is a canonical transformation of functors
$t : LG \circ LF' \to L(G \circ F)$.
\end{enumerate}
\end{lemma}

\begin{proof}
In this proof we try to be careful. Hence let us think of
the derived functors as the functors
$$
RF' : S^{-1}\mathcal{A} \to (S')^{-1}\mathcal{B}, \quad
R(G \circ F) : S^{-1}\mathcal{A} \to \mathcal{C}, \quad
RG : (S')^{-1}\mathcal{B} \to \mathcal{C}.
$$
Let us denote
$Q_A : \mathcal{A} \to S^{-1}\mathcal{A}$ and
$Q_B : \mathcal{B} \to (S')^{-1}\mathcal{B}$
the localization functors. Then $F' = Q_B \circ F$. Note that for
every object $Y$ of $\mathcal{B}$ there is a canonical map
$$
G(Y) \longrightarrow RG(Q_B(Y))
$$
in other words, there is a transformation of functors
$t' : G \to RG \circ Q_B$. Let $X$ be an object of $\mathcal{A}$.
We have
\begin{align*}
R(G \circ F)(Q_A(X))
& = \colim_{s : X \to X' \in S} G(F(X')) \\
& \xrightarrow{t'} \colim_{s : X \to X' \in S} RG(Q_B(F(X'))) \\
& = \colim_{s : X \to X' \in S} RG(F'(X')) \\
& = RG(\colim_{s : X \to X' \in S} F'(X')) \\
& = RG(RF'(X)).
\end{align*}
The system $F'(X')$ is essentially constant in the category
$(S')^{-1}\mathcal{B}$. Hence we may pull the colimit inside the
functor $RG$ in the third equality of the diagram above, see
Categories, Lemma \ref{categories-lemma-image-essentially-constant}
and its proof. We omit the proof this defines a transformation
of functors. The case of left derived functors is similar.
\end{proof}




\section{Derived functors on derived categories}
\label{section-derived-functors-classical}

\noindent
In practice derived functors come about most often when given an
additive functor between abelian categories.

\begin{situation}
\label{situation-classical}
Here $F : \mathcal{A} \to \mathcal{B}$ is an additive functor between
abelian categories. This induces exact functors
$$
F : K(\mathcal{A}) \to K(\mathcal{B}), \quad
K^{+}(\mathcal{A}) \to K^{+}(\mathcal{B}), \quad
K^{-}(\mathcal{A}) \to K^{-}(\mathcal{B}).
$$
We also denote $F$ the composition $K(\mathcal{A}) \to D(\mathcal{B})$,
$K^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$, and
$K^{-}(\mathcal{A}) \to D^-(\mathcal{B})$ of $F$ with the localization
functor $K(\mathcal{B}) \to D(\mathcal{B})$, etc. This situation leads
to four derived functors we will consider in the following.
\begin{enumerate}
\item The right derived functor of
$F : K(\mathcal{A}) \to D(\mathcal{B})$
relative to the multiplicative system $\text{Qis}(\mathcal{A})$.
\item The right derived functor of
$F : K^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$
relative to the multiplicative system $\text{Qis}^{+}(\mathcal{A})$.
\item The left derived functor of
$F : K(\mathcal{A}) \to D(\mathcal{B})$
relative to the multiplicative system $\text{Qis}(\mathcal{A})$.
\item The left derived functor of
$F : K^{-}(\mathcal{A}) \to D^{-}(\mathcal{B})$
relative to the multiplicative system $\text{Qis}^-(\mathcal{A})$.
\end{enumerate}
Each of these cases is an example of
Situation \ref{situation-derived-functor}.
\end{situation}

\noindent
Some of the ambiguity that may arise is alleviated by the following.

\begin{lemma}
\label{lemma-irrelevant}
In
Situation \ref{situation-classical}.
\begin{enumerate}
\item Let $X$ be an object of $K^{+}(\mathcal{A})$.
The right derived functor of $K(\mathcal{A}) \to D(\mathcal{B})$
is defined at $X$ if and only if the right derived functor of
$K^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$ is defined at $X$.
Moreover, the values are canonically isomorphic.
\item Let $X$ be an object of $K^{+}(\mathcal{A})$.
Then $X$ computes the right derived functor of
$K(\mathcal{A}) \to D(\mathcal{B})$
if and only if $X$ computes the right derived functor of
$K^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$.
\item Let $X$ be an object of $K^{-}(\mathcal{A})$.
The left derived functor of $K(\mathcal{A}) \to D(\mathcal{B})$
is defined at $X$ if and only if the left derived functor of
$K^{-}(\mathcal{A}) \to D^{-}(\mathcal{B})$ is defined at $X$.
Moreover, the values are canonically isomorphic.
\item Let $X$ be an object of $K^{-}(\mathcal{A})$.
Then $X$ computes the left derived functor of
$K(\mathcal{A}) \to D(\mathcal{B})$ if and only if $X$ computes
the left derived functor of $K^{-}(\mathcal{A}) \to D^{-}(\mathcal{B})$.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $X$ be an object of $K^{+}(\mathcal{A})$.
Consider a quasi-isomorphism $s : X \to X'$ in $K(\mathcal{A})$.
By
Lemma \ref{lemma-complex-cohomology-bounded}
there exists quasi-isomorphism $X' \to X''$ with $X''$ bounded below.
Hence we see that $X/\text{Qis}^+(\mathcal{A})$ is cofinal
in $X/\text{Qis}(\mathcal{A})$. Thus it is clear that (1) holds.
Part (2) follows directly from part (1).
Parts (3) and (4) are dual to parts (1) and (2).
\end{proof}

\noindent
Given an object $A$ of an abelian category $\mathcal{A}$ we get a complex
$$
A[0] = ( \ldots \to 0 \to A \to 0 \to \ldots )
$$
where $A$ is placed in degree zero. Hence a functor
$\mathcal{A} \to K(\mathcal{A})$, $A \mapsto A[0]$.
Let us temporarily say that a partial functor is one that is
defined on a subcategory.

\begin{definition}
\label{definition-derived-functor}
In
Situation \ref{situation-classical}.
\begin{enumerate}
\item The {\it right derived functors of $F$} are the partial functors
$RF$ associated to cases (1) and (2) of
Situation \ref{situation-classical}.
\item The {\it left derived functors of $F$} are the partial functors
$LF$ associated to cases (3) and (4) of
Situation \ref{situation-classical}.
\item An object $A$ of $\mathcal{A}$ is said to be
{\it right acyclic for $F$}, or {\it acyclic for $RF$}
if $A[0]$ computes $RF$.
\item An object $A$ of $\mathcal{A}$ is said to be
{\it left acyclic for $F$}, or {\it acyclic for $LF$}
if $A[0]$ computes $LF$.
\end{enumerate}
\end{definition}

\noindent
The following few lemmas give some criteria for the existence of
enough acyclics.

\begin{lemma}
\label{lemma-subcategory-left-resolution}
Let $\mathcal{A}$ be an abelian category. Let
$\mathcal{P} \subset \Ob(\mathcal{A})$ be a subset containing $0$
such that every object of $\mathcal{A}$ is a quotient of an element of
$\mathcal{P}$. Let $a \in \mathbf{Z}$.
\begin{enumerate}
\item Given $K^\bullet$ with $K^n = 0$ for $n > a$
there exists a quasi-isomorphism $P^\bullet \to K^\bullet$
with $P^n \in \mathcal{P}$ and $P^n \to K^n$ surjective
for all $n$ and $P^n = 0$ for $n > a$.
\item Given $K^\bullet$ with $H^n(K^\bullet) = 0$ for $n > a$
there exists a quasi-isomorphism $P^\bullet \to K^\bullet$
with $P^n \in \mathcal{P}$ for all $n$ and $P^n = 0$ for $n > a$.
\end{enumerate}
\end{lemma}

\begin{proof}
Proof of part (1). Consider the following induction hypothesis $IH_n$:
There are $P^j \in \mathcal{P}$, $j \geq n$, with $P^j = 0$ for $j > a$,
maps $d^j : P^j \to P^{j + 1}$ for $j \geq n$, and surjective maps
$\alpha^j : P^j \to K^j$ for $j \geq n$ such that the diagram
$$
\xymatrix{
& &
P^n \ar[d]^\alpha \ar[r] &
P^{n + 1} \ar[d]^\alpha \ar[r] &
P^{n + 2} \ar[d]^\alpha \ar[r] &
\ldots \\
\ldots \ar[r] &
K^{n - 1} \ar[r] &
K^n \ar[r] &
K^{n + 1} \ar[r] &
K^{n + 2} \ar[r] &
\ldots
}
$$
is commutative, such that $d^{j + 1} \circ d^j = 0$ for $j \geq n$,
such that $\alpha$ induces isomorphisms
$H^j(K^\bullet) \to \Ker(d^j)/\Im(d^{j - 1})$
for $j > n$, and such that $\alpha : \Ker(d^n) \to \Ker(d_K^n)$
is surjective. Then we choose a surjection
$$
P^{n - 1}
\longrightarrow
K^{n - 1} \times_{K^n} \Ker(d^n) =
K^{n - 1} \times_{\Ker(d_K^n)} \Ker(d^n)
$$
with $P^{n - 1}$ in $\mathcal{P}$. This allows us to extend the diagram
above to
$$
\xymatrix{
& P^{n - 1} \ar[d]^\alpha \ar[r] &
P^n \ar[d]^\alpha \ar[r] &
P^{n + 1} \ar[d]^\alpha \ar[r] &
P^{n + 2} \ar[d]^\alpha \ar[r] &
\ldots \\
\ldots \ar[r] &
K^{n - 1} \ar[r] &
K^n \ar[r] &
K^{n + 1} \ar[r] &
K^{n + 2} \ar[r] &
\ldots
}
$$
The reader easily checks that $IH_{n - 1}$ holds with this choice.

\medskip\noindent
We finish the proof of (1) as follows.
First we note that $IH_n$ is true for $n = a + 1$ since
we can just take $P^j = 0$ for $j > a$. Hence we see that
proceeding by descending induction we produce a complex $P^\bullet$
with $P^n = 0$ for $n > a$
consisting of objects from $\mathcal{P}$, and a termwise
surjective quasi-isomorphism $\alpha : P^\bullet \to K^\bullet$ as desired.

\medskip\noindent
Proof of part (2). The assumption implies that the morphism
$\tau_{\leq a}K^\bullet \to K^\bullet$
(Homology, Section \ref{homology-section-truncations})
is a quasi-isomorphism.
Apply part (1) to find $P^\bullet \to \tau_{\leq a}K^\bullet$.
The composition $P^\bullet \to K^\bullet$ is the desired quasi-isomorphism.
\end{proof}

\begin{lemma}
\label{lemma-subcategory-right-resolution}
Let $\mathcal{A}$ be an abelian category. Let
$\mathcal{I} \subset \Ob(\mathcal{A})$ be a subset containing $0$
such that every object of $\mathcal{A}$ is a subobject of an element of
$\mathcal{I}$. Let $a \in \mathbf{Z}$.
\begin{enumerate}
\item Given $K^\bullet$ with $K^n = 0$ for $n < a$
there exists a quasi-isomorphism $K^\bullet \to I^\bullet$
with $K^n \to I^n$ injective and $I^n \in \mathcal{I}$ for all $n$
and $I^n = 0$ for $n < a$,
\item Given $K^\bullet$ with $H^n(K^\bullet) = 0$
for $n < a$ there exists a quasi-isomorphism $K^\bullet \to I^\bullet$
with $I^n \in \mathcal{I}$ and $I^n = 0$ for $n < a$.
\end{enumerate}
\end{lemma}

\begin{proof}
This lemma is dual to Lemma \ref{lemma-subcategory-left-resolution}.
\end{proof}

\begin{lemma}
\label{lemma-subcategory-right-acyclics}
In
Situation \ref{situation-classical}.
Let $\mathcal{I} \subset \Ob(\mathcal{A})$ be a subset with the
following properties:
\begin{enumerate}
\item every object of $\mathcal{A}$ is a subobject of an element of
$\mathcal{I}$,
\item for any short exact sequence $0 \to P \to Q \to R \to 0$ of
$\mathcal{A}$ with $P, Q \in \mathcal{I}$, then $R \in \mathcal{I}$,
and $0 \to F(P) \to F(Q) \to F(R) \to 0$ is exact.
\end{enumerate}
Then every object of $\mathcal{I}$ is acyclic for $RF$.
\end{lemma}

\begin{proof}
We may add $0$ to $\mathcal{I}$ if necessary. Pick $A \in \mathcal{I}$.
Let $A[0] \to K^\bullet$ be a quasi-isomorphism with $K^\bullet$
bounded below. Then we can find a quasi-isomorphism
$K^\bullet \to I^\bullet$ with $I^\bullet$ bounded below and
each $I^n \in \mathcal{I}$, see
Lemma \ref{lemma-subcategory-right-resolution}.
Hence we see that these resolutions are cofinal in the category
$A[0]/\text{Qis}^{+}(\mathcal{A})$. To finish the proof it therefore
suffices to show that for any quasi-isomorphism
$A[0] \to I^\bullet$ with $I^\bullet$ bounded above and $I^n \in \mathcal{I}$
we have $F(A)[0] \to F(I^\bullet)$ is a quasi-isomorphism.
To see this suppose that $I^n = 0$ for $n < n_0$. Of course we may assume
that $n_0 < 0$. Starting with $n = n_0$ we prove inductively that
$\Im(d^{n - 1}) = \Ker(d^n)$ and $\Im(d^{-1})$
are elements of $\mathcal{I}$ using property (2) and the exact sequences
$$
0 \to \Ker(d^n) \to I^n \to \Im(d^n) \to 0.
$$
Moreover, property (2) also guarantees that the complex
$$
0 \to F(I^{n_0}) \to F(I^{n_0 + 1}) \to \ldots \to F(I^{-1}) \to
F(\Im(d^{-1})) \to 0
$$
is exact. The exact sequence
$0 \to \Im(d^{-1}) \to I^0 \to I^0/\Im(d^{-1}) \to 0$
implies that $I^0/\Im(d^{-1})$ is an element of $\mathcal{I}$.
The exact sequence $0 \to A \to I^0/\Im(d^{-1}) \to \Im(d^0) \to 0$
then implies that $\Im(d^0) = \Ker(d^1)$ is an elements of
$\mathcal{I}$ and from then on one continues as before to show that
$\Im(d^{n - 1}) = \Ker(d^n)$ is an element of $\mathcal{I}$
for all $n > 0$. Applying $F$ to each of the short exact sequences
mentioned above and using (2) we observe that $F(A)[0] \to F(I^\bullet)$
is an isomorphism as desired.
\end{proof}

\begin{lemma}
\label{lemma-subcategory-left-acyclics}
In
Situation \ref{situation-classical}.
Let $\mathcal{P} \subset \Ob(\mathcal{A})$ be a subset with the
following properties:
\begin{enumerate}
\item every object of $\mathcal{A}$ is a quotient of an element of
$\mathcal{P}$,
\item for any short exact sequence $0 \to P \to Q \to R \to 0$ of
$\mathcal{A}$ with $Q, R \in \mathcal{P}$, then $P \in \mathcal{P}$,
and $0 \to F(P) \to F(Q) \to F(R) \to 0$ is exact.
\end{enumerate}
Then every object of $\mathcal{P}$ is acyclic for $LF$.
\end{lemma}

\begin{proof}
Dual to the proof of
Lemma \ref{lemma-subcategory-right-acyclics}.
\end{proof}







\section{Higher derived functors}
\label{section-higher-derived}

\noindent
The following simple lemma shows that right derived functors
``move to the right''.

\begin{lemma}
\label{lemma-negative-vanishing}
Let $F : \mathcal{A} \to \mathcal{B}$ be an additive functor
between abelian categories. Let $K^\bullet \in K^{+}(\mathcal{A})$
and $a \in \mathbf{Z}$.
\begin{enumerate}
\item If $H^i(K^\bullet) = 0$ for all $i < a$ and $RF$ is defined at
$K^\bullet$, then $H^i(RF(K^\bullet)) = 0$ for all $i < a$.
\item If $RF$ is defined at $K^\bullet$ and $\tau_{\leq a}K^\bullet$,
then $H^i(RF(\tau_{\leq a}K^\bullet)) = H^i(RF(K^\bullet))$
for all $i \leq a$.
\end{enumerate}
\end{lemma}

\begin{proof}
Assume $K^\bullet$ satisfies the assumptions of (1).
Let $K^\bullet \to L^\bullet$ be any quasi-isomorphism.
Then it is also true that $K^\bullet \to \tau_{\geq a}L^\bullet$
is a quasi-isomorphism by our assumption on $K^\bullet$.
Hence in the category $K^\bullet/\text{Qis}^{+}(\mathcal{A})$ the
quasi-isomorphisms $s : K^\bullet \to L^\bullet$ with $L^n = 0$ for $n < a$
are cofinal. Thus $RF$ is the value of the essentially constant
ind-object $F(L^\bullet)$ for these $s$ it follows that
$H^i(RF(K^\bullet)) = 0$ for $i < 0$.

\medskip\noindent
To prove (2) we use the distinguished triangle
$$
\tau_{\leq a}K^\bullet \to K^\bullet \to \tau_{\geq a + 1}K^\bullet
\to (\tau_{\leq a}K^\bullet)[1]
$$
of Remark \ref{remark-truncation-distinguished-triangle} to conclude
via Lemma \ref{lemma-2-out-of-3-defined} that
$RF$ is defined at $\tau_{\geq a + 1}K^\bullet$ as well and that we have
a distinguished triangle
$$
RF(\tau_{\leq a}K^\bullet) \to RF(K^\bullet) \to RF(\tau_{\geq a + 1}K^\bullet)
\to RF(\tau_{\leq a}K^\bullet)[1]
$$
in $D(\mathcal{B})$. By part (1) we see that $RF(\tau_{\geq a + 1}K^\bullet)$
has vanishing cohomology in degrees $< a + 1$. The long exact cohomology
sequence of this distinguished triangle then shows what we want.
\end{proof}

\begin{definition}
\label{definition-higher-derived-functors}
Let $F : \mathcal{A} \to \mathcal{B}$ be an additive functor
between abelian categories. Assume
$RF : D^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$ is everywhere
defined. Let $i \in \mathbf{Z}$.
The {\it $i$th right derived functor $R^iF$ of $F$} is the functor
$$
R^iF = H^i \circ RF :
\mathcal{A}
\longrightarrow
\mathcal{B}
$$
\end{definition}

\noindent
The following lemma shows that it really does not make a lot
of sense to take the right derived functor unless the functor
is left exact.

\begin{lemma}
\label{lemma-left-exact-higher-derived}
Let $F : \mathcal{A} \to \mathcal{B}$ be an additive functor
between abelian categories and assume
$RF : D^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$ is everywhere
defined.
\begin{enumerate}
\item We have $R^iF = 0$ for $i < 0$,
\item $R^0F$ is left exact,
\item the map $F \to R^0F$ is an isomorphism if and
only if $F$ is left exact.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $A$ be an object of $\mathcal{A}$. Let $A[0] \to K^\bullet$
be any quasi-isomorphism. Then it is also true that
$A[0] \to \tau_{\geq 0}K^\bullet$ is a quasi-isomorphism.
Hence in the category $A[0]/\text{Qis}^{+}(\mathcal{A})$ the
quasi-isomorphisms $s : A[0] \to K^\bullet$ with $K^n = 0$ for $n < 0$
are cofinal. Thus it is clear that $H^i(RF(A[0])) = 0$ for $i < 0$.
Moreover, for such an $s$ the sequence
$$
0 \to A \to K^0 \to K^1
$$
is exact. Hence if $F$ is left exact, then $0 \to F(A) \to F(K^0) \to F(K^1)$
is exact as well, and we see that $F(A) \to H^0(F(K^\bullet))$ is an
isomorphism for every $s : A[0] \to K^\bullet$ as above which implies
that $H^0(RF(A[0])) = F(A)$.

\medskip\noindent
Let $0 \to A \to B \to C \to 0$ be a short exact sequence of $\mathcal{A}$.
By
Lemma \ref{lemma-derived-canonical-delta-functor}
we obtain a distinguished triangle
$(A[0], B[0], C[0], a, b, c)$ in $K^{+}(\mathcal{A})$.
From the long exact cohomology sequence (and the vanishing for $i < 0$
proved above) we deduce that $0 \to R^0F(A) \to R^0F(B) \to R^0F(C)$
is exact. Hence $R^0F$ is left exact. Of course this also proves that if
$F \to R^0F$ is an isomorphism, then $F$ is left exact.
\end{proof}

\begin{lemma}
\label{lemma-F-acyclic}
Let $F : \mathcal{A} \to \mathcal{B}$ be an additive functor
between abelian categories and assume
$RF : D^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$ is everywhere
defined. Let $A$ be an object of $\mathcal{A}$.
\begin{enumerate}
\item $A$ is right acyclic for $F$ if and only if
$F(A) \to R^0F(A)$ is an isomorphism and $R^iF(A) = 0$ for all $i > 0$,
\item if $F$ is left exact, then $A$ is right acyclic for $F$
if and only if $R^iF(A) = 0$ for all $i > 0$.
\end{enumerate}
\end{lemma}

\begin{proof}
If $A$ is right acyclic for $F$, then $RF(A[0]) = F(A)[0]$ and in
particular $F(A) \to R^0F(A)$ is an isomorphism and
$R^iF(A) = 0$ for $i \not = 0$. Conversely, if $F(A) \to R^0F(A)$
is an isomorphism and $R^iF(A) = 0$ for all $i > 0$ then
$F(A[0]) \to RF(A[0])$ is a quasi-isomorphism by
Lemma \ref{lemma-left-exact-higher-derived} part (1)
and hence $A$ is acyclic. If $F$ is left exact then $F = R^0F$, see
Lemma \ref{lemma-left-exact-higher-derived}.
\end{proof}

\begin{lemma}
\label{lemma-F-acyclic-ses}
Let $F : \mathcal{A} \to \mathcal{B}$ be a left exact functor
between abelian categories and assume
$RF : D^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$ is everywhere
defined. Let $0 \to A \to B \to C \to 0$ be a short exact sequence
of $\mathcal{A}$.
\begin{enumerate}
\item If $A$ and $C$ are right acyclic for $F$ then so is $B$.
\item If $A$ and $B$ are right acyclic for $F$ then so is $C$.
\item If $B$ and $C$ are right acyclic for $F$ and $F(B) \to F(C)$ is
surjective then $A$ is right acyclic for $F$.
\end{enumerate}
In each of the three cases
$$
0 \to F(A) \to F(B) \to F(C) \to 0
$$
is a short exact sequence of $\mathcal{B}$.
\end{lemma}

\begin{proof}
By
Lemma \ref{lemma-derived-canonical-delta-functor}
we obtain a distinguished triangle
$(A[0], B[0], C[0], a, b, c)$ in $K^{+}(\mathcal{A})$.
As $RF$ is an exact functor and since
$R^iF = 0$ for $i < 0$ and $R^0F = F$
(Lemma \ref{lemma-left-exact-higher-derived})
we obtain an exact cohomology sequence
$$
0 \to F(A) \to F(B) \to F(C) \to R^1F(A) \to \ldots
$$
in the abelian category $\mathcal{B}$. Thus the lemma follows from
the characterization of acyclic objects in
Lemma \ref{lemma-F-acyclic}.
\end{proof}

\begin{lemma}
\label{lemma-right-derived-delta-functor}
Let $F : \mathcal{A} \to \mathcal{B}$ be an additive functor
between abelian categories and assume
$RF : D^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$ is everywhere defined.
\begin{enumerate}
\item The functors $R^iF$, $i \geq 0$ come equipped with a canonical
structure of a $\delta$-functor from $\mathcal{A} \to \mathcal{B}$, see
Homology, Definition \ref{homology-definition-cohomological-delta-functor}.
\item If every object of $\mathcal{A}$ is a subobject of a right
acyclic object for $F$, then $\{R^iF, \delta\}_{i \geq 0}$ is a
universal $\delta$-functor, see
Homology, Definition \ref{homology-definition-universal-delta-functor}.
\end{enumerate}
\end{lemma}

\begin{proof}
The functor $\mathcal{A} \to \text{Comp}^{+}(\mathcal{A})$,
$A \mapsto A[0]$ is exact. The functor
$\text{Comp}^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$
is a $\delta$-functor, see
Lemma \ref{lemma-derived-canonical-delta-functor}.
The functor $RF : D^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$ is exact.
Finally, the functor $H^0 : D^{+}(\mathcal{B}) \to \mathcal{B}$
is a homological functor, see
Definition \ref{definition-unbounded-derived-category}.
Hence we get the structure of a $\delta$-functor from
Lemma \ref{lemma-compose-delta-functor-homological}
and
Lemma \ref{lemma-exact-compose-delta-functor}.
Part (2) follows from
Homology, Lemma \ref{homology-lemma-efface-implies-universal}
and the description of acyclics in
Lemma \ref{lemma-F-acyclic}.
\end{proof}

\begin{lemma}[Leray's acyclicity lemma]
\label{lemma-leray-acyclicity}
Let $F : \mathcal{A} \to \mathcal{B}$ be an additive functor
between abelian categories and assume
$RF : D^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$ is everywhere defined.
Let $A^\bullet$ be a bounded below complex of $F$-acyclic objects.
The canonical map
$$
F(A^\bullet) \longrightarrow RF(A^\bullet)
$$
is an isomorphism in $D^{+}(\mathcal{B})$, i.e., $A^\bullet$ computes
$RF$.
\end{lemma}

\begin{proof}
First we claim the lemma holds for a bounded complex of acyclic objects.
Namely, it holds for complexes with at most one nonzero object by definition.
Suppose that $A^\bullet$ is a complex with $A^n = 0$ for
$n \not \in [a, b]$. Using the ``stupid'' truncations we obtain
a termwise split short exact sequence of complexes
$$
0 \to \sigma_{\geq a + 1} A^\bullet \to A^\bullet \to
\sigma_{\leq a} A^\bullet \to 0
$$
see
Homology, Section \ref{homology-section-truncations}.
Thus a distinguished triangle
$(\sigma_{\geq a + 1} A^\bullet, A^\bullet, \sigma_{\leq a} A^\bullet)$.
By induction hypothesis the two outer complexes compute $RF$.
Then the middle one does too by
Lemma \ref{lemma-2-out-of-3-computes}.

\medskip\noindent
Suppose that $A^\bullet$ is a bounded below complex of acyclic objects.
To show that $F(A) \to RF(A)$ is an isomorphism in $D^{+}(\mathcal{B})$
it suffices to show that $H^i(F(A)) \to H^i(RF(A))$ is an isomorphism for
all $i$. Pick $i$. Consider the termwise split short exact sequence of
complexes
$$
0 \to \sigma_{\geq i + 2} A^\bullet \to A^\bullet \to
\sigma_{\leq i + 1} A^\bullet \to 0.
$$
Note that this induces a termwise split short exact sequence
$$
0 \to \sigma_{\geq i + 2} F(A^\bullet) \to F(A^\bullet) \to
\sigma_{\leq i + 1} F(A^\bullet) \to 0.
$$
Hence we get distinguished triangles
$$
\begin{matrix}
(\sigma_{\geq i + 2} A^\bullet, A^\bullet,
\sigma_{\leq i + 1} A^\bullet) \\
(\sigma_{\geq i + 2} F(A^\bullet), F(A^\bullet),
\sigma_{\leq i + 1} F(A^\bullet)) \\
(RF(\sigma_{\geq i + 2} A^\bullet), RF(A^\bullet),
RF(\sigma_{\leq i + 1} A^\bullet))
\end{matrix}
$$
Using the last two we obtain a map of exact sequences
$$
\xymatrix{
H^i(\sigma_{\geq i + 2} F(A^\bullet)) \ar[r] \ar[d] &
H^i(F(A^\bullet)) \ar[r] \ar[d]^\alpha &
H^i(\sigma_{\leq i + 1} F(A^\bullet)) \ar[r] \ar[d]^\beta &
H^{i + 1}(\sigma_{\geq i + 2} F(A^\bullet)) \ar[d] \\
R^iF(\sigma_{\geq i + 2} A^\bullet) \ar[r] &
R^iF(A^\bullet) \ar[r] &
R^iF(\sigma_{\leq i + 1} A^\bullet) \ar[r] &
R^{i + 1}F(\sigma_{\geq i + 2} A^\bullet)
}
$$
By the results of the first paragraph the map $\beta$ is an isomorphism.
By inspection the objects on the upper left and the upper right
are zero. Hence to finish the proof it suffices to show that
$R^iF(\sigma_{\geq i + 2} A^\bullet) = 0$ and
$R^{i + 1}F(\sigma_{\geq i + 2} A^\bullet) = 0$.
This follows immediately from
Lemma \ref{lemma-negative-vanishing}.
\end{proof}

\begin{proposition}
\label{proposition-enough-acyclics}
\begin{slogan}
A functor on an Abelian categories is extended to the (bounded below or above)
derived category by resolving with a complex that is acyclic for that functor.
\end{slogan}
Let $F : \mathcal{A} \to \mathcal{B}$ be an additive functor of
abelian categories.
\begin{enumerate}
\item If every object of $\mathcal{A}$ injects into an object acyclic
for $RF$, then $RF$ is defined on all of $K^{+}(\mathcal{A})$
and we obtain an exact functor
$$
RF : D^{+}(\mathcal{A}) \longrightarrow D^{+}(\mathcal{B})
$$
see (\ref{equation-everywhere}). Moreover, any bounded below complex
$A^\bullet$ whose terms are acyclic for $RF$ computes $RF$.
\item If every object of $\mathcal{A}$ is quotient of
an object acyclic for $LF$, then $LF$ is defined on all of
$K^{-}(\mathcal{A})$ and we obtain an exact functor
$$
LF : D^{-}(\mathcal{A}) \longrightarrow D^{-}(\mathcal{B})
$$
see (\ref{equation-everywhere}). Moreover, any bounded above complex
$A^\bullet$ whose terms are acyclic for $LF$ computes $LF$.
\end{enumerate}
\end{proposition}

\begin{proof}
Assume every object of $\mathcal{A}$ injects into an object acyclic
for $RF$. Let $\mathcal{I}$ be the set of objects acyclic for $RF$.
Let $K^\bullet$ be a bounded below complex in $\mathcal{A}$. By
Lemma \ref{lemma-subcategory-right-resolution}
there exists a quasi-isomorphism $\alpha : K^\bullet \to I^\bullet$ with
$I^\bullet$ bounded below and $I^n \in \mathcal{I}$. Hence in order to
prove (1) it suffices to show that
$F(I^\bullet) \to F((I')^\bullet)$ is a quasi-isomorphism when
$s : I^\bullet \to (I')^\bullet$ is a quasi-isomorphism of bounded
below complexes of objects from $\mathcal{I}$, see
Lemma \ref{lemma-find-existence-computes}.
Note that the cone $C(s)^\bullet$ is an acyclic bounded below complex
all of whose terms are in $\mathcal{I}$.
Hence it suffices to show: given an acyclic bounded below complex
$I^\bullet$ all of whose terms are in $\mathcal{I}$ the complex
$F(I^\bullet)$ is acyclic.

\medskip\noindent
Say $I^n = 0$ for $n < n_0$. Setting $J^n = \Im(d^n)$ we break
$I^\bullet$ into short exact sequences
$0 \to J^n \to I^{n + 1} \to J^{n + 1} \to 0$
for $n \geq n_0$. These sequences induce distinguished triangles
$(J^n, I^{n + 1}, J^{n + 1})$ in $D^+(\mathcal{A})$ by
Lemma \ref{lemma-derived-canonical-delta-functor}.
For each $k \in \mathbf{Z}$ denote $H_k$ the assertion:
For all $n \leq k$ the right derived functor
$RF$ is defined at $J^n$ and $R^iF(J^n) = 0$ for $i \not = 0$.
Then $H_k$ holds trivially for $k \leq n_0$. If $H_n$ holds,
then, using Proposition \ref{proposition-derived-functor},
we see that $RF$ is defined at $J^{n + 1}$ and
$(RF(J^n), RF(I^{n + 1}), RF(J^{n + 1}))$ is a distinguished
triangle of $D^+(\mathcal{B})$. Thus the long exact cohomology sequence
(\ref{equation-long-exact-cohomology-sequence-D})
associated to this triangle gives an exact sequence
$$
0 \to R^{-1}F(J^{n + 1}) \to R^0F(J^n) \to
F(I^{n + 1}) \to R^0F(J^{n + 1}) \to 0
$$
and gives that $R^iF(J^{n + 1}) = 0$ for $i \not \in \{-1, 0\}$.
By Lemma \ref{lemma-negative-vanishing} we see that $R^{-1}F(J^{n + 1}) = 0$.
This proves that $H_{n + 1}$ is true hence $H_k$ holds for all $k$.
We also conclude that
$$
0 \to R^0F(J^n) \to F(I^{n + 1}) \to R^0F(J^{n + 1}) \to 0
$$
is short exact for all $n$. This in turn proves that $F(I^\bullet)$ is exact.

\medskip\noindent
The proof in the case of $LF$ is dual.
\end{proof}

\begin{lemma}
\label{lemma-right-derived-exact-functor}
Let $F : \mathcal{A} \to \mathcal{B}$ be an exact functor of
abelian categories. Then
\begin{enumerate}
\item every object of $\mathcal{A}$ is right acyclic for $F$,
\item $RF : D^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$ is everywhere defined,
\item $RF : D(\mathcal{A}) \to D(\mathcal{B})$ is everywhere defined,
\item every complex computes $RF$, in other words, the canonical
map $F(K^\bullet) \to RF(K^\bullet)$ is an isomorphism for all complexes, and
\item $R^iF = 0$ for $i \not = 0$.
\end{enumerate}
\end{lemma}

\begin{proof}
This is true because $F$ transforms acyclic complexes into acyclic complexes
and quasi-isomorphisms into quasi-isomorphisms. Details omitted.
\end{proof}









\section{Triangulated subcategories of the derived category}
\label{section-triangulated-sub}

\noindent
Let $\mathcal{A}$ be an abelian category. In this section we look at
certain strictly full saturated triangulated subcategories
$\mathcal{D}' \subset D(\mathcal{A})$.

\medskip\noindent
Let $\mathcal{B} \subset \mathcal{A}$ be a weak Serre subcategory, see
Homology, Definition \ref{homology-definition-serre-subcategory} and
Lemma \ref{homology-lemma-characterize-weak-serre-subcategory}.
We let $D_\mathcal{B}(\mathcal{A})$ the full subcategory of
$D(\mathcal{A})$ whose objects are
$$
\Ob(D_\mathcal{B}(\mathcal{A}))
=
\{X \in \Ob(D(\mathcal{A})) \mid
H^n(X) \text{ is an object of }\mathcal{B}\text{ for all }n\}
$$
We also define
$D^{+}_\mathcal{B}(\mathcal{A}) =
D^{+}(\mathcal{A}) \cap D_\mathcal{B}(\mathcal{A})$
and similarly for the other bounded versions.

\begin{lemma}
\label{lemma-cohomology-in-serre-subcategory}
Let $\mathcal{A}$ be an abelian category.
Let $\mathcal{B} \subset \mathcal{A}$ be a weak Serre subcategory.
The category $D_\mathcal{B}(\mathcal{A})$ is a strictly full
saturated triangulated subcategory of $D(\mathcal{A})$.
Similarly for the bounded versions.
\end{lemma}

\begin{proof}
It is clear that $D_\mathcal{B}(\mathcal{A})$ is an additive subcategory
preserved under the translation functors.
If $X \oplus Y$ is in $D_\mathcal{B}(\mathcal{A})$, then
both $H^n(X)$ and $H^n(Y)$ are kernels of maps between maps of objects
of $\mathcal{B}$ as $H^n(X \oplus Y) = H^n(X) \oplus H^n(Y)$.
Hence both $X$ and $Y$ are in $D_\mathcal{B}(\mathcal{A})$. By
Lemma \ref{lemma-triangulated-subcategory}
it therefore suffices to show that given a distinguished triangle
$(X, Y, Z, f, g, h)$ such that $X$ and $Y$ are in $D_\mathcal{B}(\mathcal{A})$
then $Z$ is an object of $D_\mathcal{B}(\mathcal{A})$. The long exact
cohomology sequence (\ref{equation-long-exact-cohomology-sequence-D})
and the definition of a weak Serre subcategory (see
Homology, Definition \ref{homology-definition-serre-subcategory})
show that $H^n(Z)$ is an object of $\mathcal{B}$ for all $n$.
Thus $Z$ is an object of $D_\mathcal{B}(\mathcal{A})$.
\end{proof}

\noindent
We continue to assume that $\mathcal{B}$ is a weak Serre subcategory
of the abelian category $\mathcal{A}$. Then $\mathcal{B}$ is an abelian
category and the inclusion functor $\mathcal{B} \to \mathcal{A}$ is exact.
Hence we obtain a derived functor $D(\mathcal{B}) \to D(\mathcal{A})$, see
Lemma \ref{lemma-right-derived-exact-functor}. Clearly the
functor $D(\mathcal{B}) \to D(\mathcal{A})$ factors through a canonical
exact functor
\begin{equation}
\label{equation-compare}
D(\mathcal{B}) \longrightarrow D_\mathcal{B}(\mathcal{A})
\end{equation}
After all a complex made from objects of $\mathcal{B}$ certainly
gives rise to an object of $D_\mathcal{B}(\mathcal{A})$ and as
distinguished triangles in $D_\mathcal{B}(\mathcal{A})$ are exactly the
distinguished triangles of $D(\mathcal{A})$ whose vertices are in
$D_\mathcal{B}(\mathcal{A})$ we see that the functor is exact since
$D(\mathcal{B}) \to D(\mathcal{A})$ is exact. Similarly we obtain functors
$D^+(\mathcal{B}) \to D^+_\mathcal{B}(\mathcal{A})$,
$D^-(\mathcal{B}) \to D^-_\mathcal{B}(\mathcal{A})$, and
$D^b(\mathcal{B}) \to D^b_\mathcal{B}(\mathcal{A})$
for the bounded versions. A key question in many cases is whether the
displayed functor is an equivalence.

\medskip\noindent
Now, suppose that $\mathcal{B}$ is a Serre subcategory of $\mathcal{A}$.
In this case we have the quotient functor
$\mathcal{A} \to \mathcal{A}/\mathcal{B}$, see
Homology, Lemma \ref{homology-lemma-serre-subcategory-is-kernel}.
In this case $D_\mathcal{B}(\mathcal{A})$ is the kernel of the functor
$D(\mathcal{A}) \to D(\mathcal{A}/\mathcal{B})$.
Thus we obtain a canonical functor
$$
D(\mathcal{A})/D_\mathcal{B}(\mathcal{A})
\longrightarrow
D(\mathcal{A}/\mathcal{B})
$$
by
Lemma \ref{lemma-universal-property-quotient}.
Similarly for the bounded versions.

\begin{lemma}
\label{lemma-derived-of-quotient}
Let $\mathcal{A}$ be an abelian category.
Let $\mathcal{B} \subset \mathcal{A}$ be a Serre subcategory.
Then $D(\mathcal{A}) \to D(\mathcal{A}/\mathcal{B})$
is essentially surjective.
\end{lemma}

\begin{proof}
We will use the description of the category $\mathcal{A}/\mathcal{B}$
in the proof of
Homology, Lemma \ref{homology-lemma-serre-subcategory-is-kernel}.
Let $(X^\bullet, d^\bullet)$ be a complex of $\mathcal{A}/\mathcal{B}$.
This means that $X^i$ is an object of $\mathcal{A}$ and
$d^i : X^i \to X^{i + 1}$ is a morphism in $\mathcal{A}/\mathcal{B}$
such that $d^i \circ d^{i - 1} = 0$ in $\mathcal{A}/\mathcal{B}$.

\medskip\noindent
For $i \geq 0$ we may write $d^i = (s^i, f^i)$ where $s^i : Y^i \to X^i$
is a morphism of $\mathcal{A}$ whose kernel and cokernel are in $\mathcal{B}$
(equivalently $s^i$ becomes an isomorphism in the quotient category)
and $f^i : Y^i \to X^{i + 1}$ is a morphism of $\mathcal{A}$.
By induction we will construct a commutative diagram
$$
\xymatrix{
& (X')^1 \ar@{..>}[r] & (X')^2 \ar@{..>}[r] & \ldots \\
X^0 \ar@{..>}[ru] &
X^1 \ar@{..>}[u] &
X^2 \ar@{..>}[u] &
\ldots \\
Y^0 \ar[u]_{s^0} \ar[ru]_{f^0} &
Y^1 \ar[u]_{s^1} \ar[ru]_{f^1} &
Y^2 \ar[u]_{s^2} \ar[ru]_{f^2} &
\ldots
}
$$
where the vertical arrows $X^i \to (X')^i$ become isomorphisms
in the quotient category. Namely, we first let
$(X')^1 = \Coker(Y^0 \to X^0 \oplus X^1)$ (or rather the
pushout of the diagram with arrows $s^0$ and $f^0$) which gives the
first commutative diagram. Next, we take
$(X')^2 = \Coker(Y^1 \to (X')^1 \oplus X^2)$. And so on.
Setting additionally $(X')^n = X^n$ for $n \leq 0$ we see that the map
$(X^\bullet, d^\bullet) \to ((X')^\bullet, (d')^\bullet)$
is an isomorphism of complexes in $\mathcal{A}/\mathcal{B}$.
Hence we may assume $d^n : X^n \to X^{n + 1}$ is given
by a map $X^n \to X^{n + 1}$ in $\mathcal{A}$ for $n \geq 0$.

\medskip\noindent
Dually, for $i < 0$ we may write $d^i = (g^i, t^{i + 1})$ where
$t^{i + 1} : X^{i + 1} \to Z^{i + 1}$ is an isomorphism in the
quotient category and $g^i : X^i \to Z^{i + 1}$ is a morphism.
By induction we will construct a commutative diagram
$$
\xymatrix{
\ldots &
Z^{-2} &
Z^{-1} &
Z^0 \\
\ldots &
X^{-2} \ar[u]_{t_{-2}} \ar[ru]_{g_{-2}} &
X^{-1} \ar[u]_{t_{-1}} \ar[ru]_{g_{-1}} &
X^0 \ar[u]_{t^0} \\
\ldots &
(X')^{-2} \ar@{..>}[u] \ar@{..>}[r] &
(X')^{-1} \ar@{..>}[u] \ar@{..>}[ru]
}
$$
where the vertical arrows $(X')^i \to X^i$ become isomorphisms
in the quotient category. Namely, we take
$(X')^{-1} = X^{-1} \times_{Z^0} X^0$. Then we take
$(X')^{-2} = X^{-2} \times_{Z^{-1}} (X')^{-1}$. And so on.
Setting additionally $(X')^n = X^n$ for $n \geq 0$ we see that the map
$((X')^\bullet, (d')^\bullet) \to (X^\bullet, d^\bullet)$
is an isomorphism of complexes in $\mathcal{A}/\mathcal{B}$.
Hence we may assume $d^n : X^n \to X^{n + 1}$ is given
by a map $d^n : X^n \to X^{n + 1}$ in $\mathcal{A}$
for all $n \in \mathbf{Z}$.

\medskip\noindent
In this case we know the compositions $d^n \circ d^{n - 1}$
are zero in $\mathcal{A}/\mathcal{B}$. If for $n > 0$ we replace
$X^n$ by
$$
(X')^n = X^n/\sum\nolimits_{0 < k \leq n} \Im(\Im(X^{k - 2} \to X^k) \to X^n)
$$
then the compositions $d^n \circ d^{n - 1}$ are zero for $n \geq 0$.
(Similarly to the second paragraph above we obtain an isomorphism of
complexes
$(X^\bullet, d^\bullet) \to ((X')^\bullet, (d')^\bullet)$.)
Finally, for $n < 0$ we replace $X^n$ by
$$
(X')^n = \bigcap\nolimits_{n \leq k < 0}
(X^n \to X^k)^{-1}\Ker(X^k \to X^{k + 2})
$$
and we argue in the same manner to get a complex in $\mathcal{A}$
whose image in $\mathcal{A}/\mathcal{B}$ is isomorphic to the given one.
\end{proof}

\begin{lemma}
\label{lemma-quotient-by-serre-easy}
Let $\mathcal{A}$ be an abelian category.
Let $\mathcal{B} \subset \mathcal{A}$ be a Serre subcategory.
Suppose that the functor $v : \mathcal{A} \to \mathcal{A}/\mathcal{B}$
has a left adjoint $u : \mathcal{A}/\mathcal{B} \to \mathcal{A}$
such that $vu \cong \text{id}$. Then
$$
D(\mathcal{A})/D_\mathcal{B}(\mathcal{A}) = D(\mathcal{A}/\mathcal{B})
$$
and similarly for the bounded versions.
\end{lemma}

\begin{proof}
The functor $D(v) : D(\mathcal{A}) \to D(\mathcal{A}/\mathcal{B})$
is essentially surjective by
Lemma \ref{lemma-derived-of-quotient}.
For an object $X$ of $D(\mathcal{A})$ the adjunction mapping
$c_X : uvX \to X$ maps to an isomorphism in $D(\mathcal{A}/\mathcal{B})$
because $vuv \cong v$ by the assumption that $vu \cong \text{id}$.
Thus in a distinguished triangle $(uvX, X, Z, c_X, g, h)$ the object
$Z$ is an object of $D_\mathcal{B}(\mathcal{A})$ as we see by looking
at the long exact cohomology sequence.
Hence $c_X$ is an element of the multiplicative system used to define
the quotient category $D(\mathcal{A})/D_\mathcal{B}(\mathcal{A})$.
Thus $uvX \cong X$ in $D(\mathcal{A})/D_\mathcal{B}(\mathcal{A})$.
For $X, Y \in \Ob(\mathcal{A}))$ the map
$$
\Hom_{D(\mathcal{A})/D_\mathcal{B}(\mathcal{A})}(X, Y)
\longrightarrow
\Hom_{D(\mathcal{A}/\mathcal{B})}(vX, vY)
$$
is bijective because $u$ gives an inverse (by the remarks above).
\end{proof}

\noindent
For certain Serre subcategories $\mathcal{B} \subset \mathcal{A}$
we can prove that the functor
$D(\mathcal{B}) \to D_\mathcal{B}(\mathcal{A})$
is fully faithful.

\begin{lemma}
\label{lemma-fully-faithful-embedding}
Let $\mathcal{A}$ be an abelian category. Let $\mathcal{B} \subset \mathcal{A}$
be a Serre subcategory. Assume that for every surjection $X \to Y$
with $X \in \Ob(\mathcal{A})$ and $Y \in \Ob(\mathcal{B})$ there exists
$X' \subset X$, $X' \in \Ob(\mathcal{B})$ which surjects onto $Y$.
Then the functor $D^-(\mathcal{B}) \to D^-_\mathcal{B}(\mathcal{A})$ of
(\ref{equation-compare}) is an equivalence.
\end{lemma}

\begin{proof}
Let $X^\bullet$ be a bounded above complex of $\mathcal{A}$ such that
$H^i(X^\bullet) \in \Ob(\mathcal{B})$ for all $i \in \mathbf{Z}$.
Moreover, suppose we are given $B^i \subset X^i$, $B^i \in \Ob(\mathcal{B})$
for all $i \in \mathbf{Z}$. Claim: there exists a subcomplex
$Y^\bullet \subset X^\bullet$ such that
\begin{enumerate}
\item $Y^\bullet \to X^\bullet$ is a quasi-isomorphism,
\item $Y^i \in \Ob(\mathcal{B})$ for all $i \in \mathbf{Z}$, and
\item $B^i \subset Y^i$ for all $i \in \mathbf{Z}$.
\end{enumerate}
To prove the claim, using the assumption of the lemma we first choose
$C^i \subset \Ker(d^i : X^i \to X^{i + 1})$, $C^i \in \Ob(\mathcal{B})$
surjecting onto $H^i(X^\bullet)$. Setting
$D^i = C^i + d^{i - 1}(B^{i - 1}) + B^i$ we find a subcomplex
$D^\bullet$ satisfying (2) and (3) such that
$H^i(D^\bullet) \to H^i(X^\bullet)$ is surjective for all $i \in \mathbf{Z}$.
For any choice of $E^i \subset X^i$ with $E^i \in \Ob(\mathcal{B})$ and
$d^i(E^i) \subset D^{i + 1} + E^{i + 1}$ we see that setting
$Y^i = D^i + E^i$ gives a subcomplex whose terms are in $\mathcal{B}$ and
whose cohomology surjects onto the cohomology of $X^\bullet$. Clearly, if
$d^i(E^i) = (D^{i + 1} + E^{i + 1}) \cap \text{Im}(d^i)$ then we see that
the map on cohomology is also injective. For $n \gg 0$ we can
take $E^n$ equal to $0$. By descending induction
we can choose $E^i$ for all $i$ with the desired property.
Namely, given $E^{i + 1}, E^{i + 2}, \ldots$ we choose $E^i \subset X^i$
such that $d^i(E^i) = (D^{i + 1} + E^{i + 1}) \cap \text{Im}(d^i)$.
This is possible by our assumption in the lemma combined with
the fact that $(D^{i + 1} + E^{i + 1}) \cap \text{Im}(d^i)$ is
in $\mathcal{B}$ as $\mathcal{B}$ is a Serre subcategory of $\mathcal{A}$.

\medskip\noindent
The claim above implies the lemma. Essential surjectivity is immediate
from the claim. Let us prove faithfulness. Namely, suppose we have
a morphism $f : U^\bullet \to V^\bullet$ of bounded above complexes
of $\mathcal{B}$ whose image in $D(\mathcal{A})$ is zero. Then
there exists a quasi-isomorphism $s : V^\bullet \to X^\bullet$
into a bounded above complex of $\mathcal{A}$ such that
$s \circ f$ is homotopic to zero. Choose a homotopy
$h^i : U^i \to X^{i - 1}$ between $0$ and $s \circ f$.
Apply the claim with $B^i = h^{i + 1}(U^{i + 1}) + s^i(V^i)$.
The resulting map $s' : V^\bullet \to Y^\bullet$
is a quasi-isomorphism as well and $s' \circ f$ is homotopic
to zero as is clear from the fact that $h^i$ factors through $Y^{i - 1}$.
This proves faithfulness. Fully faithfulness is proved in the
exact same manner.
\end{proof}





\section{Injective resolutions}
\label{section-injective-resolutions}

\noindent
In this section we prove some lemmas regarding the existence
of injective resolutions in abelian categories having enough injectives.

\begin{definition}
\label{definition-injective-resolution}
Let $\mathcal{A}$ be an abelian category.
Let $A \in \Ob(\mathcal{A})$.
An {\it injective resolution of $A$} is a complex
$I^\bullet$ together with a map $A \to I^0$ such
that:
\begin{enumerate}
\item We have $I^n = 0$ for $n < 0$.
\item Each $I^n$ is an injective object of $\mathcal{A}$.
\item The map $A \to I^0$ is an isomorphism onto $\Ker(d^0)$.
\item We have $H^i(I^\bullet) = 0$ for $i > 0$.
\end{enumerate}
Hence $A[0] \to I^\bullet$ is a quasi-isomorphism.
In other words the complex
$$
\ldots \to 0 \to A \to I^0 \to I^1 \to \ldots
$$
is acyclic.
Let $K^\bullet$ be a complex in $\mathcal{A}$.
An {\it injective resolution of $K^\bullet$} is a complex
$I^\bullet$ together with a map $\alpha : K^\bullet \to I^\bullet$
of complexes such that
\begin{enumerate}
\item We have $I^n = 0$ for $n \ll 0$, i.e., $I^\bullet$ is bounded below.
\item Each $I^n$ is an injective object of $\mathcal{A}$.
\item The map $\alpha : K^\bullet \to I^\bullet$ is a
quasi-isomorphism.
\end{enumerate}
\end{definition}

\noindent
In other words an injective resolution $K^\bullet \to I^\bullet$
gives rise to a diagram
$$
\xymatrix{
\ldots \ar[r] & K^{n - 1} \ar[d] \ar[r] & K^n \ar[d] \ar[r] &
K^{n + 1} \ar[d] \ar[r] & \ldots \\
\ldots \ar[r] & I^{n - 1} \ar[r] & I^n \ar[r] & I^{n + 1} \ar[r] & \ldots
}
$$
which induces an isomorphism on cohomology objects in each degree.
An injective resolution of an object $A$ of $\mathcal{A}$
is almost the same thing as an injective resolution of
the complex $A[0]$.

\begin{lemma}
\label{lemma-cohomology-bounded-below}
Let $\mathcal{A}$ be an abelian category.
Let $K^\bullet$ be a complex of $\mathcal{A}$.
\begin{enumerate}
\item If $K^\bullet$ has an injective resolution then
$H^n(K^\bullet) = 0$ for $n \ll 0$.
\item If $H^n(K^\bullet) = 0$ for all $n \ll 0$ then there
exists a quasi-isomorphism $K^\bullet \to L^\bullet$
with $L^\bullet$ bounded below.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted. For the second statement use
$L^\bullet = \tau_{\geq n}K^\bullet$ for
some $n \ll 0$. See
Homology, Section \ref{homology-section-truncations}
for the definition of the truncation $\tau_{\geq n}$.
\end{proof}

\begin{lemma}
\label{lemma-injective-resolutions-exist}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has enough injectives.
\begin{enumerate}
\item Any object of $\mathcal{A}$ has an injective resolution.
\item If $H^n(K^\bullet) = 0$ for all $n \ll 0$ then
$K^\bullet$ has an injective resolution.
\item If $K^\bullet$ is a complex with $K^n = 0$ for $n < a$, then
there exists an injective resolution $\alpha : K^\bullet \to I^\bullet$
with $I^n = 0$ for $n < a$ such that each $\alpha^n : K^n \to I^n$ is
injective.
\end{enumerate}
\end{lemma}

\begin{proof}
Proof of (1). First choose an injection $A \to I^0$ of $A$ into an
injective object of $\mathcal{A}$. Next, choose an injection
$I_0/A \to I^1$ into an injective object of $\mathcal{A}$.
Denote $d^0$ the induced map $I^0 \to I^1$.
Next, choose an injection $I^1/\Im(d^0) \to I^2$ into
an injective object of $\mathcal{A}$. Denote $d^1$ the induced
map $I^1 \to I^2$. And so on.
By Lemma \ref{lemma-cohomology-bounded-below} part (2) follows from part (3).
Part (3) is a special case of
Lemma \ref{lemma-subcategory-right-resolution}.
\end{proof}

\begin{lemma}
\label{lemma-acyclic-is-zero}
Let $\mathcal{A}$ be an abelian category.
Let $K^\bullet$ be an acyclic complex.
Let $I^\bullet$ be bounded below and consisting of injective objects.
Any morphism $K^\bullet \to I^\bullet$ is homotopic to zero.
\end{lemma}

\begin{proof}
Let $\alpha : K^\bullet \to I^\bullet$ be a morphism of
complexes. Assume that $\alpha^j = 0$ for $j < n$.
We will show that there exists a morphism $h : K^{n + 1} \to I^n$
such that $\alpha^n = h \circ d$. Thus $\alpha$ will be homotopic
to the morphism of complexes $\beta$ defined by
$$
\beta^j =
\left\{
\begin{matrix}
0 & \text{if} & j \leq n \\
\alpha^{n + 1} - d \circ h & \text{if} & j = n + 1 \\
\alpha^j & \text{if} & j > n + 1
\end{matrix}
\right.
$$
This will clearly prove the lemma (by induction).
To prove the existence of $h$ note that
$\alpha^n|_{d^{n - 1}(K^{n - 1})} = 0$ since
$\alpha^{n - 1} = 0$. Since $K^\bullet$ is acyclic we
have $d^{n - 1}(K^{n - 1}) = \Ker(K^n \to K^{n + 1})$.
Hence we can think of $\alpha^n$ as a map into $I^n$ defined
on the subobject $\Im(K^n \to K^{n + 1})$ of $K^{n + 1}$.
By injectivity of the object $I^n$ we can extend this to
a map $h : K^{n + 1} \to I^n$ as desired.
\end{proof}

\begin{remark}
\label{remark-easier-proofs}
Let $\mathcal{A}$ be an abelian category.
Using the fact that $K(\mathcal{A})$ is a triangulated category we
may use
Lemma \ref{lemma-acyclic-is-zero}
to obtain proofs of some of the lemmas below which are usually proved by
chasing through diagrams.
Namely, suppose that $\alpha : K^\bullet \to L^\bullet$ is a quasi-isomorphism
of complexes. Then
$$
(K^\bullet, L^\bullet, C(\alpha)^\bullet, \alpha, i, -p)
$$
is a distinguished triangle in $K(\mathcal{A})$
(Lemma \ref{lemma-the-same-up-to-isomorphisms})
and $C(\alpha)^\bullet$ is an acyclic complex
(Lemma \ref{lemma-acyclic}).
Next, let $I^\bullet$ be a bounded below complex of injective objects. Then
$$
\xymatrix{
\Hom_{K(\mathcal{A})}(C(\alpha)^\bullet, I^\bullet) \ar[r] &
\Hom_{K(\mathcal{A})}(L^\bullet, I^\bullet) \ar[r] &
\Hom_{K(\mathcal{A})}(K^\bullet, I^\bullet) \ar[lld] \\
\Hom_{K(\mathcal{A})}(C(\alpha)^\bullet[-1], I^\bullet)
}
$$
is an exact sequence of abelian groups, see
Lemma \ref{lemma-representable-homological}.
At this point
Lemma \ref{lemma-acyclic-is-zero}
guarantees that the outer two groups are zero and hence
$\Hom_{K(\mathcal{A})}(L^\bullet, I^\bullet) =
\Hom_{K(\mathcal{A})}(K^\bullet, I^\bullet)$.
\end{remark}

\begin{lemma}
\label{lemma-morphisms-lift}
Let $\mathcal{A}$ be an abelian category.
Consider a solid diagram
$$
\xymatrix{
K^\bullet \ar[r]_\alpha \ar[d]_\gamma & L^\bullet \ar@{-->}[dl]^\beta \\
I^\bullet
}
$$
where $I^\bullet$ is bounded below and consists of injective
objects, and $\alpha$ is a quasi-isomorphism.
\begin{enumerate}
\item There exists a map of complexes $\beta$ making the diagram
commute up to homotopy.
\item If $\alpha$ is injective in every degree
then we can find a $\beta$ which makes the diagram commute.
\end{enumerate}
\end{lemma}

\begin{proof}
The ``correct'' proof of part (1) is explained in
Remark \ref{remark-easier-proofs}.
We also give a direct proof here.

\medskip\noindent
We first show that (2) implies (1). Namely, let
$\tilde \alpha : K \to \tilde L^\bullet$, $\pi$, $s$ be as in
Lemma \ref{lemma-make-injective}. Since $\tilde \alpha$ is injective
by (2) there exists a morphism $\tilde \beta : \tilde L^\bullet \to I^\bullet$
such that $\gamma = \tilde \beta \circ \tilde \alpha$. Set
$\beta = \tilde \beta \circ s$. Then we have
$$
\beta \circ \alpha
=
\tilde \beta \circ s \circ \pi \circ \tilde \alpha
\sim
\tilde \beta \circ \tilde \alpha
=
\gamma
$$
as desired.

\medskip\noindent
Assume that $\alpha : K^\bullet \to L^\bullet$ is injective.
Suppose we have already defined $\beta$ in all degrees
$\leq n - 1$ compatible with differentials and such that
$\gamma^j = \beta^j \circ \alpha^j$ for all $j \leq n - 1$.
Consider the commutative solid diagram
$$
\xymatrix{
K^{n - 1} \ar[r] \ar@/_2pc/[dd]_\gamma \ar[d]^\alpha &
K^n \ar@/^2pc/[dd]^\gamma \ar[d]^\alpha \\
L^{n - 1} \ar[r] \ar[d]^\beta &
L^n \ar@{-->}[d] \\
I^{n - 1} \ar[r] &
I^n
}
$$
Thus we see that the dotted arrow is prescribed on the subobjects
$\alpha(K^n)$ and $d^{n - 1}(L^{n - 1})$. Moreover, these two arrows
agree on $\alpha(d^{n - 1}(K^{n - 1}))$. Hence if
\begin{equation}
\label{equation-qis}
\alpha(d^{n - 1}(K^{n - 1}))
=
\alpha(K^n) \cap d^{n - 1}(L^{n - 1})
\end{equation}
then these morphisms glue to a morphism
$\alpha(K^n) + d^{n - 1}(L^{n - 1}) \to I^n$ and, using the injectivity
of $I^n$, we can extend this to a morphism from all of $L^n$ into $I^n$.
After this by induction we get the morphism $\beta$ for all $n$ simultaneously
(note that we can set $\beta^n = 0$ for all $n \ll 0$ since $I^\bullet$
is bounded below -- in this way starting the induction).

\medskip\noindent
It remains to prove the equality (\ref{equation-qis}).
The reader is encouraged to argue this for themselves with a suitable
diagram chase. Nonetheless here is our argument.
Note that the inclusion
$\alpha(d^{n - 1}(K^{n - 1})) \subset \alpha(K^n) \cap d^{n - 1}(L^{n - 1})$
is obvious. Take an object $T$ of $\mathcal{A}$ and a morphism
$x : T \to L^n$ whose image is contained in the subobject
$\alpha(K^n) \cap d^{n - 1}(L^{n - 1})$.
Since $\alpha$ is injective we see that $x = \alpha \circ x'$ for
some $x' : T \to K^n$. Moreover, since $x$ lies in $d^{n - 1}(L^{n - 1})$
we see that $d^n \circ x = 0$. Hence using injectivity of $\alpha$ again
we see that $d^n \circ x' = 0$. Thus $x'$ gives a morphism
$[x'] : T \to H^n(K^\bullet)$. On the other hand the corresponding
map $[x] : T \to H^n(L^\bullet)$ induced by $x$ is zero by assumption.
Since $\alpha$ is a quasi-isomorphism we conclude that $[x'] = 0$.
This of course means exactly that the image of $x'$ is
contained in $d^{n - 1}(K^{n - 1})$ and we win.
\end{proof}

\begin{lemma}
\label{lemma-morphisms-equal-up-to-homotopy}
Let $\mathcal{A}$ be an abelian category.
Consider a solid diagram
$$
\xymatrix{
K^\bullet \ar[r]_\alpha \ar[d]_\gamma & L^\bullet \ar@{-->}[dl]^{\beta_i} \\
I^\bullet
}
$$
where $I^\bullet$ is bounded below and consists of injective
objects, and $\alpha$ is a quasi-isomorphism.
Any two morphisms $\beta_1, \beta_2$ making the diagram commute
up to homotopy are homotopic.
\end{lemma}

\begin{proof}
This follows from
Remark \ref{remark-easier-proofs}.
We also give a direct argument here.

\medskip\noindent
Let $\tilde \alpha : K \to \tilde L^\bullet$, $\pi$, $s$ be as in
Lemma \ref{lemma-make-injective}. If we can show that $\beta_1 \circ\pi$
is homotopic to $\beta_2 \circ \pi$, then we deduce that
$\beta_1 \sim \beta_2$ because $\pi \circ s$ is the identity.
Hence we may assume $\alpha^n : K^n \to L^n$ is the
inclusion of a direct summand for all $n$. Thus we get a
short exact sequence of complexes
$$
0 \to K^\bullet \to L^\bullet \to M^\bullet \to 0
$$
which is termwise split and such that $M^\bullet$ is acyclic.
We choose splittings $L^n = K^n \oplus M^n$, so we have
$\beta_i^n : K^n \oplus M^n \to I^n$ and $\gamma^n : K^n \to I^n$.
In this case the condition on $\beta_i$ is that there are morphisms
$h_i^n : K^n \to I^{n - 1}$ such that
$$
\gamma^n - \beta_i^n|_{K^n} = d \circ h_i^n + h_i^{n + 1} \circ d
$$
Thus we see that
$$
\beta_1^n|_{K^n} - \beta_2^n|_{K^n}
=
d \circ (h_1^n - h_2^n) + (h_1^{n + 1} - h_2^{n + 1}) \circ d
$$
Consider the map $h^n : K^n \oplus M^n \to I^{n - 1}$ which
equals $h_1^n - h_2^n$ on the first summand and zero on the second.
Then we see that
$$
\beta_1^n - \beta_2^n
-
(d \circ h^n + h^{n + 1}) \circ d)
$$
is a morphism of complexes $L^\bullet \to I^\bullet$
which is identically zero on the subcomplex $K^\bullet$.
Hence it factors as $L^\bullet \to M^\bullet \to I^\bullet$.
Thus the result of the lemma follows from Lemma \ref{lemma-acyclic-is-zero}.
\end{proof}

\begin{lemma}
\label{lemma-morphisms-into-injective-complex}
Let $\mathcal{A}$ be an abelian category.
Let $I^\bullet$ be bounded below complex consisting of injective
objects. Let $L^\bullet \in K(\mathcal{A})$. Then
$$
\Mor_{K(\mathcal{A})}(L^\bullet, I^\bullet)
=
\Mor_{D(\mathcal{A})}(L^\bullet, I^\bullet).
$$
\end{lemma}

\begin{proof}
Let $a$ be an element of the right hand side.
We may represent $a = \gamma\alpha^{-1}$ where
$\alpha : K^\bullet \to L^\bullet$
is a quasi-isomorphism and $\gamma : K^\bullet \to I^\bullet$ is a map
of complexes. By
Lemma \ref{lemma-morphisms-lift}
we can find a morphism $\beta : L^\bullet \to I^\bullet$ such that
$\beta \circ \alpha$ is homotopic to $\gamma$. This proves that the
map is surjective. Let $b$ be an element of the left hand side
which maps to zero in the right hand side. Then $b$ is the homotopy class
of a morphism $\beta : L^\bullet \to I^\bullet$ such that there exists a
quasi-isomorphism $\alpha : K^\bullet \to L^\bullet$ with
$\beta  \circ \alpha$ homotopic to zero. Then
Lemma \ref{lemma-morphisms-equal-up-to-homotopy}
shows that $\beta$ is homotopic to zero also, i.e., $b = 0$.
\end{proof}

\begin{lemma}
\label{lemma-injective-resolution-ses}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has enough injectives.
For any short exact sequence
$0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$
of $\text{Comp}^{+}(\mathcal{A})$ there exists a
commutative diagram in $\text{Comp}^{+}(\mathcal{A})$
$$
\xymatrix{
0 \ar[r] &
A^\bullet \ar[r] \ar[d] &
B^\bullet \ar[r] \ar[d] &
C^\bullet \ar[r] \ar[d] &
0 \\
0 \ar[r] &
I_1^\bullet \ar[r] &
I_2^\bullet \ar[r] &
I_3^\bullet \ar[r] &
0
}
$$
where the vertical arrows are injective resolutions and
the rows are short exact sequences of complexes.
In fact, given any injective resolution $A^\bullet \to I^\bullet$
we may assume $I_1^\bullet = I^\bullet$.
\end{lemma}

\begin{proof}
Step 1. Choose an injective resolution $A^\bullet \to I^\bullet$ (see
Lemma \ref{lemma-injective-resolutions-exist}) or use the given one.
Recall that $\text{Comp}^{+}(\mathcal{A})$ is an
abelian category, see
Homology, Lemma \ref{homology-lemma-cat-cochain-abelian}.
Hence we may form the pushout along
the injective map $A^\bullet \to I^\bullet$ to get
$$
\xymatrix{
0 \ar[r] &
A^\bullet \ar[r] \ar[d] &
B^\bullet \ar[r] \ar[d] &
C^\bullet \ar[r] \ar[d] &
0 \\
0 \ar[r] &
I^\bullet \ar[r] &
E^\bullet \ar[r] &
C^\bullet \ar[r] &
0
}
$$
Note that the lower short exact sequence is termwise split, see
Homology, Lemma \ref{homology-lemma-characterize-injectives}.
Hence it suffices to prove the lemma when
$0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$ is
termwise split.

\medskip\noindent
Step 2. Choose splittings. In other words, write
$B^n = A^n \oplus C^n$. Denote $\delta : C^\bullet \to A^\bullet[1]$
the morphism as in
Homology, Lemma \ref{homology-lemma-ses-termwise-split-cochain}.
Choose injective resolutions $f_1 : A^\bullet \to I_1^\bullet$
and $f_3 : C^\bullet \to I_3^\bullet$. (If $A^\bullet$ is a complex of
injectives, then use $I_1^\bullet = A^\bullet$.)
We may assume $f_3$ is injective in
every degree. By Lemma \ref{lemma-morphisms-lift} we may find
a morphism $\delta' : I_3^\bullet \to I_1^\bullet[1]$ such
that $\delta' \circ f_3 = f_1[1] \circ \delta$ (equality of
morphisms of complexes). Set $I_2^n = I_1^n \oplus I_3^n$.
Define
$$
d_{I_2}^n =
\left(
\begin{matrix}
d_{I_1}^n & (\delta')^n \\
0 & d_{I_3}^n
\end{matrix}
\right)
$$
and define the maps $B^n \to I_2^n$ to be given as the
sum of the maps $A^n \to I_1^n$ and $C^n \to I_3^n$.
Everything is clear.
\end{proof}








\section{Projective resolutions}
\label{section-projective-resolutions}

\noindent
This section is dual to
Section \ref{section-injective-resolutions}.
We give definitions and state results, but we do not reprove the lemmas.

\begin{definition}
\label{definition-projective-resolution}
Let $\mathcal{A}$ be an abelian category.
Let $A \in \Ob(\mathcal{A})$.
An {\it projective resolution of $A$} is a complex
$P^\bullet$ together with a map $P^0 \to A$ such
that:
\begin{enumerate}
\item We have $P^n = 0$ for $n > 0$.
\item Each $P^n$ is an projective object of $\mathcal{A}$.
\item The map $P^0 \to A$ induces an isomorphism $\Coker(d^{-1}) \to A$.
\item We have $H^i(P^\bullet) = 0$ for $i < 0$.
\end{enumerate}
Hence $P^\bullet \to A[0]$ is a quasi-isomorphism.
In other words the complex
$$
\ldots \to P^{-1} \to P^0 \to A \to 0 \to \ldots
$$
is acyclic. Let $K^\bullet$ be a complex in $\mathcal{A}$.
An {\it projective resolution of $K^\bullet$} is a complex
$P^\bullet$ together with a map $\alpha : P^\bullet \to K^\bullet$
of complexes such that
\begin{enumerate}
\item We have $P^n = 0$ for $n \gg 0$, i.e., $P^\bullet$ is bounded above.
\item Each $P^n$ is an projective object of $\mathcal{A}$.
\item The map $\alpha : P^\bullet \to K^\bullet$ is a
quasi-isomorphism.
\end{enumerate}
\end{definition}

\begin{lemma}
\label{lemma-cohomology-bounded-above}
Let $\mathcal{A}$ be an abelian category.
Let $K^\bullet$ be a complex of $\mathcal{A}$.
\begin{enumerate}
\item If $K^\bullet$ has a projective resolution then
$H^n(K^\bullet) = 0$ for $n \gg 0$.
\item If $H^n(K^\bullet) = 0$ for $n \gg 0$ then there
exists a quasi-isomorphism $L^\bullet \to K^\bullet$
with $L^\bullet$ bounded above.
\end{enumerate}
\end{lemma}

\begin{proof}
Dual to
Lemma \ref{lemma-cohomology-bounded-below}.
\end{proof}

\begin{lemma}
\label{lemma-projective-resolutions-exist}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has enough projectives.
\begin{enumerate}
\item Any object of $\mathcal{A}$ has a projective resolution.
\item If $H^n(K^\bullet) = 0$ for all $n \gg 0$ then
$K^\bullet$ has a projective resolution.
\item If $K^\bullet$ is a complex with $K^n = 0$ for $n > a$, then
there exists a projective resolution $\alpha : P^\bullet \to K^\bullet$
with $P^n = 0$ for $n > a$ such that each $\alpha^n : P^n \to K^n$ is
surjective.
\end{enumerate}
\end{lemma}

\begin{proof}
Dual to
Lemma \ref{lemma-injective-resolutions-exist}.
\end{proof}

\begin{lemma}
\label{lemma-projective-into-acyclic-is-zero}
Let $\mathcal{A}$ be an abelian category.
Let $K^\bullet$ be an acyclic complex.
Let $P^\bullet$ be bounded above and consisting of projective objects.
Any morphism $P^\bullet \to K^\bullet$ is homotopic to zero.
\end{lemma}

\begin{proof}
Dual to
Lemma \ref{lemma-acyclic-is-zero}.
\end{proof}

\begin{remark}
\label{remark-easier-projective}
Let $\mathcal{A}$ be an abelian category.
Suppose that $\alpha : K^\bullet \to L^\bullet$ is a quasi-isomorphism
of complexes. Let $P^\bullet$ be a bounded above complex of projectives.
Then
$$
\Hom_{K(\mathcal{A})}(P^\bullet, K^\bullet)
\longrightarrow
\Hom_{K(\mathcal{A})}(P^\bullet, L^\bullet)
$$
is an isomorphism. This is dual to
Remark \ref{remark-easier-proofs}.
\end{remark}

\begin{lemma}
\label{lemma-morphisms-lift-projective}
Let $\mathcal{A}$ be an abelian category.
Consider a solid diagram
$$
\xymatrix{
K^\bullet & L^\bullet \ar[l]^\alpha \\
P^\bullet \ar[u] \ar@{-->}[ru]_\beta
}
$$
where $P^\bullet$ is bounded above and consists of projective
objects, and $\alpha$ is a quasi-isomorphism.
\begin{enumerate}
\item There exists a map of complexes $\beta$ making the diagram
commute up to homotopy.
\item If $\alpha$ is surjective in every degree
then we can find a $\beta$ which makes the diagram commute.
\end{enumerate}
\end{lemma}

\begin{proof}
Dual to
Lemma \ref{lemma-morphisms-lift}.
\end{proof}

\begin{lemma}
\label{lemma-morphisms-equal-up-to-homotopy-projective}
Let $\mathcal{A}$ be an abelian category. Consider a solid diagram
$$
\xymatrix{
K^\bullet & L^\bullet \ar[l]^\alpha \\
P^\bullet \ar[u] \ar@{-->}[ru]_{\beta_i}
}
$$
where $P^\bullet$ is bounded above and consists of projective
objects, and $\alpha$ is a quasi-isomorphism.
Any two morphisms $\beta_1, \beta_2$ making the diagram commute
up to homotopy are homotopic.
\end{lemma}

\begin{proof}
Dual to
Lemma \ref{lemma-morphisms-equal-up-to-homotopy}.
\end{proof}

\begin{lemma}
\label{lemma-morphisms-from-projective-complex}
Let $\mathcal{A}$ be an abelian category.
Let $P^\bullet$ be bounded above complex consisting of projective
objects. Let $L^\bullet \in K(\mathcal{A})$. Then
$$
\Mor_{K(\mathcal{A})}(P^\bullet, L^\bullet)
=
\Mor_{D(\mathcal{A})}(P^\bullet, L^\bullet).
$$
\end{lemma}

\begin{proof}
Dual to
Lemma \ref{lemma-morphisms-into-injective-complex}.
\end{proof}

\begin{lemma}
\label{lemma-projective-resolution-ses}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has enough projectives.
For any short exact sequence
$0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$
of $\text{Comp}^{+}(\mathcal{A})$ there exists a
commutative diagram in $\text{Comp}^{+}(\mathcal{A})$
$$
\xymatrix{
0 \ar[r] &
P_1^\bullet \ar[r] \ar[d] &
P_2^\bullet \ar[r] \ar[d] &
P_3^\bullet \ar[r] \ar[d] &
0 \\
0 \ar[r] &
A^\bullet \ar[r] &
B^\bullet \ar[r] &
C^\bullet \ar[r] &
0
}
$$
where the vertical arrows are projective resolutions and
the rows are short exact sequences of complexes.
In fact, given any projective resolution $P^\bullet \to C^\bullet$
we may assume $P_3^\bullet = P^\bullet$.
\end{lemma}

\begin{proof}
Dual to
Lemma \ref{lemma-injective-resolution-ses}.
\end{proof}

\begin{lemma}
\label{lemma-precise-vanishing}
Let $\mathcal{A}$ be an abelian category.
Let $P^\bullet$, $K^\bullet$ be complexes.
Let $n \in \mathbf{Z}$. Assume that
\begin{enumerate}
\item $P^\bullet$ is a bounded complex consisting of projective
objects,
\item $P^i = 0$ for $i < n$, and
\item $H^i(K^\bullet) = 0$ for $i \geq n$.
\end{enumerate}
Then
$\Hom_{K(\mathcal{A})}(P^\bullet, K^\bullet) =
\Hom_{D(\mathcal{A})}(P^\bullet, K^\bullet) = 0$.
\end{lemma}

\begin{proof}
The first equality follows from
Lemma \ref{lemma-morphisms-from-projective-complex}.
Note that there is a distinguished triangle
$$
(\tau_{\leq n - 1}K^\bullet, K^\bullet, \tau_{\geq n}K^\bullet, f, g, h)
$$
by Remark \ref{remark-truncation-distinguished-triangle}. Hence, by
Lemma \ref{lemma-representable-homological}
it suffices to prove
$\Hom_{K(\mathcal{A})}(P^\bullet, \tau_{\leq n - 1}K^\bullet) = 0$ and
$\Hom_{K(\mathcal{A})}(P^\bullet, \tau_{\geq n} K^\bullet) = 0$.
The first vanishing is trivial and the second is
Lemma \ref{lemma-projective-into-acyclic-is-zero}.
\end{proof}

\begin{lemma}
\label{lemma-lift-map}
Let $\mathcal{A}$ be an abelian category.
Let $\beta : P^\bullet \to L^\bullet$ and
$\alpha : E^\bullet \to L^\bullet$ be
maps of complexes. Let $n \in \mathbf{Z}$. Assume
\begin{enumerate}
\item $P^\bullet$ is a bounded complex of projectives and
$P^i = 0$ for $i < n$,
\item $H^i(\alpha)$ is an isomorphism for $i > n$ and surjective
for $i = n$.
\end{enumerate}
Then there exists a map of complexes $\gamma : P^\bullet \to E^\bullet$
such that $\alpha \circ \gamma$ and $\beta$ are homotopic.
\end{lemma}

\begin{proof}
Consider the cone $C^\bullet = C(\alpha)^\bullet$ with map
$i : L^\bullet \to C^\bullet$.
Note that $i \circ \beta$ is zero by
Lemma \ref{lemma-precise-vanishing}.
Hence we can lift $\beta$ to $E^\bullet$ by
Lemma \ref{lemma-representable-homological}.
\end{proof}












\section{Right derived functors and injective resolutions}
\label{section-right-derived-functor}

\noindent
At this point we can use the material above to define the right derived
functors of an additive functor between an abelian category having
enough injectives and a general abelian category.

\begin{lemma}
\label{lemma-injective-acyclic}
Let $\mathcal{A}$ be an abelian category.
Let $I \in \Ob(\mathcal{A})$ be an injective object.
Let $I^\bullet$ be a bounded below complex of injectives in $\mathcal{A}$.
\begin{enumerate}
\item $I^\bullet$ computes $RF$ relative to $\text{Qis}^{+}(\mathcal{A})$
for any exact functor $F : K^{+}(\mathcal{A}) \to \mathcal{D}$
into any triangulated category $\mathcal{D}$.
\item $I$ is right acyclic for any additive functor
$F : \mathcal{A} \to \mathcal{B}$ into any abelian category $\mathcal{B}$.
\end{enumerate}
\end{lemma}

\begin{proof}
Part (2) is a direct consequences of part (1) and
Definition \ref{definition-derived-functor}.
To prove (1) let $\alpha : I^\bullet \to K^\bullet$ be a quasi-isomorphism
into a complex. By
Lemma \ref{lemma-morphisms-lift}
we see that $\alpha$ has a left inverse. Hence the category
$I^\bullet/\text{Qis}^{+}(\mathcal{A})$ is essentially constant with value
$\text{id} : I^\bullet \to I^\bullet$. Thus also the ind-object
$$
I^\bullet/\text{Qis}^{+}(\mathcal{A}) \longrightarrow \mathcal{D}, \quad
(I^\bullet \to K^\bullet) \longmapsto F(K^\bullet)
$$
is essentially constant with value $F(I^\bullet)$. This proves (1), see
Definitions \ref{definition-right-derived-functor-defined} and
\ref{definition-computes}.
\end{proof}

\begin{lemma}
\label{lemma-enough-injectives-right-derived}
Let $\mathcal{A}$ be an abelian category with enough injectives.
\begin{enumerate}
\item For any exact functor $F : K^{+}(\mathcal{A}) \to \mathcal{D}$
into a triangulated category $\mathcal{D}$ the right derived
functor
$$
RF : D^{+}(\mathcal{A}) \longrightarrow \mathcal{D}
$$
is everywhere defined.
\item For any additive functor $F : \mathcal{A} \to \mathcal{B}$ into an
abelian category $\mathcal{B}$ the right derived functor
$$
RF : D^{+}(\mathcal{A}) \longrightarrow D^{+}(\mathcal{B})
$$
is everywhere defined.
\end{enumerate}
\end{lemma}

\begin{proof}
Combine
Lemma \ref{lemma-injective-acyclic}
and
Proposition \ref{proposition-enough-acyclics}
for the second assertion. To see the first assertion combine
Lemma \ref{lemma-injective-resolutions-exist},
Lemma \ref{lemma-injective-acyclic},
Lemma \ref{lemma-existence-computes},
and Equation (\ref{equation-everywhere}).
\end{proof}

\begin{lemma}
\label{lemma-right-derived-properties}
Let $\mathcal{A}$ be an abelian category with enough injectives.
Let $F : \mathcal{A} \to \mathcal{B}$ be an additive functor.
\begin{enumerate}
\item The functor $RF$ is an exact functor
$D^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$.
\item The functor $RF$ induces an exact functor
$K^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$.
\item The functor $RF$ induces a $\delta$-functor
$\text{Comp}^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$.
\item The functor $RF$ induces a $\delta$-functor
$\mathcal{A} \to D^{+}(\mathcal{B})$.
\end{enumerate}
\end{lemma}

\begin{proof}
This lemma simply reviews some of the results obtained so far.
Note that by
Lemma \ref{lemma-enough-injectives-right-derived}
$RF$ is everywhere defined. Here are some references:
\begin{enumerate}
\item The derived functor is exact: This boils down to
Lemma \ref{lemma-2-out-of-3-defined}.
\item This is true because $K^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$
is exact and compositions of exact functors are exact.
\item This is true because
$\text{Comp}^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$ is
a $\delta$-functor, see
Lemma \ref{lemma-derived-canonical-delta-functor}.
\item This is true because $\mathcal{A} \to \text{Comp}^{+}(\mathcal{A})$
is exact and precomposing a $\delta$-functor by an exact functor gives
a $\delta$-functor.
\end{enumerate}
\end{proof}

\begin{lemma}
\label{lemma-higher-derived-functors}
Let $\mathcal{A}$ be an abelian category with enough injectives.
Let $F : \mathcal{A} \to \mathcal{B}$ be a left exact functor.
\begin{enumerate}
\item For any short exact sequence
$0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$
of complexes in $\text{Comp}^{+}(\mathcal{A})$ there
is an associated long exact sequence
$$
\ldots \to
H^i(RF(A^\bullet)) \to
H^i(RF(B^\bullet)) \to
H^i(RF(C^\bullet)) \to
H^{i + 1}(RF(A^\bullet)) \to \ldots
$$
\item The functors $R^iF : \mathcal{A} \to \mathcal{B}$
are zero for $i < 0$. Also $R^0F = F : \mathcal{A} \to \mathcal{B}$.
\item We have $R^iF(I) = 0$ for $i > 0$ and $I$ injective.
\item The sequence $(R^iF, \delta)$ forms a universal $\delta$-functor (see
Homology, Definition \ref{homology-definition-universal-delta-functor})
from $\mathcal{A}$ to $\mathcal{B}$.
\end{enumerate}
\end{lemma}

\begin{proof}
This lemma simply reviews some of the results obtained so far.
Note that by
Lemma \ref{lemma-enough-injectives-right-derived}
$RF$ is everywhere defined. Here are some references:
\begin{enumerate}
\item This follows from
Lemma \ref{lemma-right-derived-properties} part (3)
combined with the long exact cohomology sequence
(\ref{equation-long-exact-cohomology-sequence-D}) for
$D^{+}(\mathcal{B})$.
\item This is
Lemma \ref{lemma-left-exact-higher-derived}.
\item This is the fact that injective objects are acyclic.
\item This is
Lemma \ref{lemma-right-derived-delta-functor}.
\end{enumerate}
\end{proof}






\section{Cartan-Eilenberg resolutions}
\label{section-cartan-eilenberg}

\noindent
This section can be expanded. The material can be generalized and applied in
more cases. Resolutions need not use injectives and the method also
works in the unbounded case in some situations.

\begin{definition}
\label{definition-cartan-eilenberg}
Let $\mathcal{A}$ be an abelian category.
Let $K^\bullet$ be a bounded below complex.
A {\it Cartan-Eilenberg resolution} of $K^\bullet$
is given by a double complex $I^{\bullet, \bullet}$
and a morphism of complexes $\epsilon : K^\bullet \to I^{\bullet, 0}$
with the following properties:
\begin{enumerate}
\item There exists a $i \ll 0$ such that $I^{p, q} = 0$ for all $p < i$
and all $q$.
\item We have $I^{p, q} = 0$ if $q < 0$.
\item The complex $I^{p, \bullet}$ is an injective resolution of $K^p$.
\item The complex $\Ker(d_1^{p, \bullet})$ is an injective resolution
of $\Ker(d_K^p)$.
\item The complex $\Im(d_1^{p, \bullet})$ is an injective resolution
of $\Im(d_K^p)$.
\item The complex $H^p_I(I^{\bullet, \bullet})$ is an injective resolution
of $H^p(K^\bullet)$.
\end{enumerate}
\end{definition}

\begin{lemma}
\label{lemma-cartan-eilenberg}
Let $\mathcal{A}$ be an abelian category with enough injectives.
Let $K^\bullet$ be a bounded below complex.
There exists a Cartan-Eilenberg resolution of $K^\bullet$.
\end{lemma}

\begin{proof}
Suppose that $K^p = 0$ for $p < n$. Decompose $K^\bullet$ into
short exact sequences as follows: Set $Z^p = \Ker(d^p)$,
$B^p = \Im(d^{p - 1})$, $H^p = Z^p/B^p$, and consider
$$
\begin{matrix}
0 \to Z^n \to K^n \to B^{n + 1} \to 0 \\
0 \to B^{n + 1} \to Z^{n + 1} \to H^{n + 1} \to 0 \\
0 \to Z^{n + 1} \to K^{n + 1} \to B^{n + 2} \to 0 \\
0 \to B^{n + 2} \to Z^{n + 2} \to H^{n + 2} \to 0 \\
\ldots
\end{matrix}
$$
Set $I^{p, q} = 0$ for $p < n$. Inductively we choose
injective resolutions as follows:
\begin{enumerate}
\item Choose an injective resolution $Z^n \to J_Z^{n, \bullet}$.
\item Using Lemma \ref{lemma-injective-resolution-ses} choose injective
resolutions $K^n \to I^{n, \bullet}$, $B^{n + 1} \to J_B^{n + 1, \bullet}$,
and an exact sequence of complexes
$0 \to J_Z^{n, \bullet} \to I^{n, \bullet} \to J_B^{n + 1, \bullet} \to 0$
compatible with the short exact sequence
$0 \to Z^n \to K^n \to B^{n + 1} \to 0$.
\item Using Lemma \ref{lemma-injective-resolution-ses} choose injective
resolutions $Z^{n + 1} \to J_Z^{n + 1, \bullet}$,
$H^{n + 1} \to J_H^{n + 1, \bullet}$,
and an exact sequence of complexes
$0 \to J_B^{n + 1, \bullet} \to J_Z^{n + 1, \bullet}
\to J_H^{n + 1, \bullet} \to 0$
compatible with the short exact sequence
$0 \to B^{n + 1} \to Z^{n + 1} \to H^{n + 1} \to 0$.
\item Etc.
\end{enumerate}
Taking as maps $d_1^\bullet : I^{p, \bullet} \to I^{p + 1, \bullet}$
the compositions
$I^{p, \bullet} \to J_B^{p + 1, \bullet} \to
J_Z^{p + 1, \bullet} \to I^{p + 1, \bullet}$ everything is clear.
\end{proof}

\begin{lemma}
\label{lemma-two-ss-complex-functor}
Let $F : \mathcal{A} \to \mathcal{B}$ be a left exact functor of
abelian categories.
Let $K^\bullet$ be a bounded below complex of $\mathcal{A}$.
Let $I^{\bullet, \bullet}$ be a Cartan-Eilenberg resolution
for $K^\bullet$. The spectral sequences
$({}'E_r, {}'d_r)_{r \geq 0}$ and $({}''E_r, {}''d_r)_{r \geq 0}$
associated to the double complex $F(I^{\bullet, \bullet})$
satisfy the relations
$$
{}'E_1^{p, q} = R^qF(K^p)
\quad
\text{and}
\quad
{}''E_2^{p, q} = R^pF(H^q(K^\bullet))
$$
Moreover, these spectral sequences are bounded, converge to
$H^*(RF(K^\bullet))$, and the associated induced filtrations on
$H^n(RF(K^\bullet))$ are finite.
\end{lemma}

\begin{proof}
We will use the following remarks without further mention:
\begin{enumerate}
\item As $I^{p, \bullet}$ is an injective resolution of
$K^p$ we see that $RF$ is defined at $K^p[0]$
with value $F(I^{p, \bullet})$.
\item As $H^p_I(I^{\bullet, \bullet})$ is an injective resolution of
$H^p(K^\bullet)$ the derived functor $RF$ is defined at $H^p(K^\bullet)[0]$
with value $F(H^p_I(I^{\bullet, \bullet}))$.
\item By
Homology, Lemma \ref{homology-lemma-double-complex-gives-resolution}
the total complex $sI^\bullet$ is an injective resolution of
$K^\bullet$. Hence $RF$ is defined at $K^\bullet$ with value
$F(sI^\bullet)$.
\end{enumerate}
Consider the two spectral sequences associated to the double complex
$L^{\bullet, \bullet} = F(I^{\bullet, \bullet})$, see
Homology, Lemma \ref{homology-lemma-ss-double-complex}.
These are both bounded, converge to $H^*(sL^\bullet)$, and induce
finite filtrations on $H^n(sL^\bullet)$, see
Homology, Lemma \ref{homology-lemma-first-quadrant-ss}.
Since
$sL^\bullet = s(F(I^{\bullet, \bullet})) = F(sI^\bullet)$ computes
$H^n(RF(K^\bullet))$ we find the final assertion of the lemma holds true.

\medskip\noindent
Computation of the first spectral sequence. We have
${}'E_1^{p, q} = H^q(L^{p, \bullet})$ in other words
$$
{}'E_1^{p, q} = H^q(F(I^{p, \bullet})) = R^qF(K^p)
$$
as desired. Observe for later use that the maps
${}'d_1^{p, q} : {}'E_1^{p, q} \to {}'E_1^{p + 1, q}$ are the maps
$R^qF(K^p) \to R^qF(K^{p + 1})$ induced by $K^p \to K^{p + 1}$
and the fact that $R^qF$ is a functor.

\medskip\noindent
Computation of the second spectral sequence. We have
${}''E_1^{p, q} = H^q(L^{\bullet, p}) = H^q(F(I^{\bullet, p}))$.
Note that the complex $I^{\bullet, p}$ is bounded below,
consists of injectives, and moreover each kernel, image, and
cohomology group of the differentials is an injective object
of $\mathcal{A}$. Hence we can split the differentials, i.e.,
each differential is a split surjection onto a direct summand.
It follows that the same is true after applying $F$. Hence
${}''E_1^{p, q} = F(H^q(I^{\bullet, p})) = F(H^q_I(I^{\bullet, p}))$.
The differentials on this are $(-1)^q$ times $F$ applied to
the differential of the complex $H^p_I(I^{\bullet, \bullet})$
which is an injective resolution of $H^p(K^\bullet)$. Hence the
description of the $E_2$ terms.
\end{proof}

\begin{remark}
\label{remark-functorial-ss}
The spectral sequences of Lemma \ref{lemma-two-ss-complex-functor}
are functorial in the complex $K^\bullet$. This follows from functoriality
properties of Cartan-Eilenberg resolutions. On the other hand, they are
both examples of a more general spectral sequence which may be associated
to a filtered complex of $\mathcal{A}$. The functoriality will follow from
its construction. We will return to this in the section on the filtered
derived category, see Remark \ref{remark-final-functorial}.
\end{remark}










\section{Composition of right derived functors}
\label{section-composition-right-derived-functors}

\noindent
Sometimes we can compute the right derived functor of a composition.
Suppose that $\mathcal{A}, \mathcal{B}, \mathcal{C}$ be abelian categories.
Let $F : \mathcal{A} \to \mathcal{B}$ and $G : \mathcal{B} \to \mathcal{C}$
be left exact functors. Assume that the right derived functors
$RF : D^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$,
$RG : D^{+}(\mathcal{B}) \to D^{+}(\mathcal{C})$, and
$R(G \circ F) : D^{+}(\mathcal{A}) \to D^{+}(\mathcal{C})$
are everywhere defined. Then there exists a canonical transformation
$$
t : R(G \circ F) \longrightarrow RG \circ RF
$$
of functors from $D^{+}(\mathcal{A})$ to $D^{+}(\mathcal{C})$, see
Lemma \ref{lemma-compose-derived-functors-general}.
This transformation need not always be an isomorphism.

\begin{lemma}
\label{lemma-compose-derived-functors}
Let $\mathcal{A}, \mathcal{B}, \mathcal{C}$ be abelian categories.
Let $F : \mathcal{A} \to \mathcal{B}$ and $G : \mathcal{B} \to \mathcal{C}$
be left exact functors. Assume $\mathcal{A}$, $\mathcal{B}$ have
enough injectives. The following are equivalent
\begin{enumerate}
\item $F(I)$ is right acyclic for $G$ for each injective object $I$
of $\mathcal{A}$, and
\item the canonical map
$$
t : R(G \circ F) \longrightarrow RG \circ RF.
$$
is isomorphism of functors of functors from
$D^{+}(\mathcal{A})$ to $D^{+}(\mathcal{C})$.
\end{enumerate}
\end{lemma}

\begin{proof}
If (2) holds, then (1) follows by evaluating the isomorphism
$t$ on $RF(I) = F(I)$. Conversely, assume (1) holds.
Let $A^\bullet$ be a bounded below complex of $\mathcal{A}$.
Choose an injective resolution $A^\bullet \to I^\bullet$.
The map $t$ is given (see proof of
Lemma \ref{lemma-compose-derived-functors-general})
by the maps
$$
R(G \circ F)(A^\bullet) =
(G \circ F)(I^\bullet) =
G(F(I^\bullet))) \to
RG(F(I^\bullet)) =
RG(RF(A^\bullet))
$$
where the arrow is an isomorphism by
Lemma \ref{lemma-leray-acyclicity}.
\end{proof}

\begin{lemma}[Grothendieck spectral sequence]
\label{lemma-grothendieck-spectral-sequence}
With assumptions as in Lemma \ref{lemma-compose-derived-functors}
and assuming the equivalent conditions (1) and (2) hold.
Let $X$ be an object of $D^{+}(\mathcal{A})$.
There exists a spectral sequence $(E_r, d_r)_{r \geq 0}$
consisting of bigraded objects $E_r$ of $\mathcal{C}$ with
$d_r$ of bidegree $(r, - r + 1)$ and with
$$
E_2^{p, q} = R^pG(R^qF(X))
$$
Moreover, this spectral sequence is bounded, converges to
$R^*(G \circ F)(X)$, and induces a finite filtration
on each $R^n(G \circ F)(X)$.
\end{lemma}

\begin{proof}
We may represent $X$ by a bounded below complex $A^\bullet$.
Choose an injective resolution $A^\bullet \to I^\bullet$.
Choose a Cartan-Eilenberg resolution
$F(I^\bullet) \to I^{\bullet, \bullet}$ using
Lemma \ref{lemma-cartan-eilenberg}.
Apply the second spectral sequence of
Lemma \ref{lemma-two-ss-complex-functor}.
\end{proof}






\section{Resolution functors}
\label{section-derived-category}

\noindent
Let $\mathcal{A}$ be an abelian category with enough injectives.
Denote $\mathcal{I}$ the full additive subcategory of $\mathcal{A}$ whose
objects are the injective objects of $\mathcal{A}$.
It turns out that $K^{+}(\mathcal{I})$ and $D^{+}(\mathcal{A})$
are equivalent in this case (see
Proposition \ref{proposition-derived-category}).
For many purposes it therefore makes sense to think of
$D^{+}(\mathcal{A})$ as the (easier to grok) category $K^{+}(\mathcal{I})$
in this case.

\begin{proposition}
\label{proposition-derived-category}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has enough injectives.
Denote $\mathcal{I} \subset \mathcal{A}$ the strictly full
additive subcategory whose objects are the injective objects of
$\mathcal{A}$.
The functor
$$
K^{+}(\mathcal{I}) \longrightarrow D^{+}(\mathcal{A})
$$
is exact, fully faithful and essentially surjective, i.e.,
an equivalence of triangulated categories.
\end{proposition}

\begin{proof}
It is clear that the functor is exact.
It is essentially surjective by
Lemma \ref{lemma-injective-resolutions-exist}.
Fully faithfulness is a consequence of
Lemma \ref{lemma-morphisms-into-injective-complex}.
\end{proof}

\noindent
Proposition \ref{proposition-derived-category}
implies that we can find resolution functors.
It turns out that we can prove resolution functors exist
even in some cases where the abelian category $\mathcal{A}$ is
a ``big'' category, i.e., has a class of objects.

\begin{definition}
\label{definition-localization-functor}
Let $\mathcal{A}$ be an abelian category with enough injectives.
A {\it resolution functor}\footnote{This is likely nonstandard terminology.}
for $\mathcal{A}$ is given by the following data:
\begin{enumerate}
\item for all $K^\bullet \in \Ob(K^{+}(\mathcal{A}))$ a
bounded below complex of injectives $j(K^\bullet)$, and
\item for all $K^\bullet \in \Ob(K^{+}(\mathcal{A}))$ a
quasi-isomorphism $i_{K^\bullet} : K^\bullet \to j(K^\bullet)$.
\end{enumerate}
\end{definition}

\begin{lemma}
\label{lemma-resolution-functor}
Let $\mathcal{A}$ be an abelian category with enough injectives.
Given a resolution functor $(j, i)$ there is a unique way to
turn $j$ into a functor and $i$ into a $2$-isomorphism
producing a $2$-commutative diagram
$$
\xymatrix{
K^{+}(\mathcal{A}) \ar[rd] \ar[rr]_j & & K^{+}(\mathcal{I}) \ar[ld] \\
& D^{+}(\mathcal{A})
}
$$
where $\mathcal{I}$ is the full additive subcategory of $\mathcal{A}$
consisting of injective objects.
\end{lemma}

\begin{proof}
For every morphism $\alpha : K^\bullet \to L^\bullet$ of $K^{+}(\mathcal{A})$
there is a unique morphism
$j(\alpha) : j(K^\bullet) \to j(L^\bullet)$ in $K^{+}(\mathcal{I})$
such that
$$
\xymatrix{
K^\bullet \ar[r]_\alpha \ar[d]_{i_{K^\bullet}} &
L^\bullet \ar[d]^{i_{L^\bullet}} \\
j(K^\bullet) \ar[r]^{j(\alpha)} & j(L^\bullet)
}
$$
is commutative in $K^{+}(\mathcal{A})$. To see this either use
Lemmas \ref{lemma-morphisms-lift} and
\ref{lemma-morphisms-equal-up-to-homotopy}
or the equivalent
Lemma \ref{lemma-morphisms-into-injective-complex}.
The uniqueness implies that $j$ is a functor, and the commutativity of
the diagram implies that $i$ gives a $2$-morphism which witnesses the
$2$-commutativity of the diagram of categories in the statement of
the lemma.
\end{proof}

\begin{lemma}
\label{lemma-into-derived-category}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has enough injectives.
Then a resolution functor $j$ exists and is
unique up to unique isomorphism of functors.
\end{lemma}

\begin{proof}
Consider the set of all objects $K^\bullet$ of $K^{+}(\mathcal{A})$.
(Recall that by our conventions any category has a set of
objects unless mentioned otherwise.)
By Lemma \ref{lemma-injective-resolutions-exist} every object
has an injective resolution.
By the axiom of choice we can choose for each $K^\bullet$
an injective resolution $i_{K^\bullet} : K^\bullet \to j(K^\bullet)$.
\end{proof}

\begin{lemma}
\label{lemma-j-is-exact}
Let $\mathcal{A}$ be an abelian category with enough injectives.
Any resolution functor
$j : K^{+}(\mathcal{A}) \to K^{+}(\mathcal{I})$
is exact.
\end{lemma}

\begin{proof}
Denote $i_{K^\bullet} : K^\bullet \to j(K^\bullet)$ the
canonical maps of Definition \ref{definition-localization-functor}.
First we discuss the existence of the functorial isomorphism
$j(K^\bullet[1]) \to j(K^\bullet)[1]$.
Consider the diagram
$$
\xymatrix{
K^\bullet[1] \ar[d]^{i_{K^\bullet[1]}} \ar@{=}[rr] & &
K^\bullet[1] \ar[d]^{i_{K^\bullet}[1]} \\
j(K^\bullet[1]) \ar@{..>}[rr]^{\xi_{K^\bullet}} & & j(K^\bullet)[1]
}
$$
By Lemmas \ref{lemma-morphisms-lift}
and \ref{lemma-morphisms-equal-up-to-homotopy}
there exists a unique dotted arrow $\xi_{K^\bullet}$ in $K^{+}(\mathcal{I})$
making the diagram commute in $K^{+}(\mathcal{A})$.
We omit the verification that this gives a functorial isomorphism.
(Hint: use Lemma \ref{lemma-morphisms-equal-up-to-homotopy} again.)

\medskip\noindent
Let $(K^\bullet, L^\bullet, M^\bullet, f, g, h)$
be a distinguished triangle of $K^{+}(\mathcal{A})$.
We have to show that
$(j(K^\bullet), j(L^\bullet), j(M^\bullet), j(f), j(g),
\xi_{K^\bullet} \circ j(h))$ is
a distinguished triangle of $K^{+}(\mathcal{I})$.
Note that we have a commutative diagram
$$
\xymatrix{
K^\bullet \ar[r]_f \ar[d] &
L^\bullet \ar[r]_g \ar[d] &
M^\bullet \ar[rr]_h \ar[d] & &
K^\bullet[1] \ar[d] \\
j(K^\bullet) \ar[r]^{j(f)} &
j(L^\bullet) \ar[r]^{j(g)} &
j(M^\bullet) \ar[rr]^{\xi_{K^\bullet} \circ j(h)} & &
j(K^\bullet)[1]
}
$$
in $K^{+}(\mathcal{A})$ whose vertical arrows are the quasi-isomorphisms
$i_K, i_L, i_M$. Hence we see that the image of
$(j(K^\bullet), j(L^\bullet), j(M^\bullet), j(f), j(g),
\xi_{K^\bullet} \circ j(h))$
in $D^{+}(\mathcal{A})$ is isomorphic to a distinguished triangle
and hence a distinguished triangle by TR1. Thus we see from
Lemma \ref{lemma-exact-equivalence}
that $(j(K^\bullet), j(L^\bullet), j(M^\bullet), j(f), j(g),
\xi_{K^\bullet} \circ j(h))$ is a distinguished triangle in
$K^{+}(\mathcal{I})$.
\end{proof}

\begin{lemma}
\label{lemma-resolution-functor-quasi-inverse}
Let $\mathcal{A}$ be an abelian category which has enough injectives.
Let $j$ be a resolution functor. Write
$Q : K^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$ for the natural functor.
Then $j = j' \circ Q$ for a unique
functor $j' : D^{+}(\mathcal{A}) \to K^{+}(\mathcal{I})$ which
is quasi-inverse to the canonical functor
$K^{+}(\mathcal{I}) \to D^{+}(\mathcal{A})$.
\end{lemma}

\begin{proof}
By
Lemma \ref{lemma-bounded-derived}
$Q$ is a localization functor.
To prove the existence of $j'$ it suffices to show that any element of
$\text{Qis}^{+}(\mathcal{A})$ is mapped to an isomorphism under
the functor $j$, see
Lemma \ref{lemma-universal-property-localization}.
This is true by the remarks following
Definition \ref{definition-localization-functor}.
\end{proof}

\begin{remark}
\label{remark-big-localization}
Suppose that $\mathcal{A}$ is a ``big'' abelian category with enough injectives
such as the category of abelian groups. In this case we have to be slightly
more careful in constructing our resolution functor since we cannot use
the axiom of choice with a quantifier ranging over a class. But note that
the proof of the lemma does show that any two localization functors are
canonically isomorphic. Namely, given quasi-isomorphisms
$i : K^\bullet \to I^\bullet$ and $i' : K^\bullet \to J^\bullet$ of
a bounded below complex $K^\bullet$ into bounded below complexes of injectives
there exists a unique(!) morphism $a : I^\bullet \to J^\bullet$
in $K^{+}(\mathcal{I})$ such that $i' = i \circ a$ as morphisms in
$K^{+}(\mathcal{I})$. Hence the only issue is existence, and we will see how
to deal with this in the next section.
\end{remark}










\section{Functorial injective embeddings and resolution functors}
\label{section-functorial-injective-resolutions}

\noindent
In this section we redo the construction of a resolution functor
$K^{+}(\mathcal{A}) \to K^{+}(\mathcal{I})$ in case the
category $\mathcal{A}$ has functorial injective embeddings.
There are two reasons for this: (1) the proof is easier and (2)
the construction also works if $\mathcal{A}$ is a ``big'' abelian
category. See
Remark \ref{remark-big-abelian-category}
below.

\medskip\noindent
Let $\mathcal{A}$ be an abelian category. As before denote $\mathcal{I}$
the additive full subcategory of $\mathcal{A}$ consisting of injective
objects. Consider the category $\text{InjRes}(\mathcal{A})$
of arrows $\alpha : K^\bullet \to I^\bullet$
where $K^\bullet$ is a bounded below complex of $\mathcal{A}$,
$I^\bullet$ is a bounded below complex of injectives of $\mathcal{A}$
and $\alpha$ is a quasi-isomorphism. In other words, $\alpha$ is
an injective resolution and $K^\bullet$ is bounded below.
There is an obvious functor
$$
s : \text{InjRes}(\mathcal{A}) \longrightarrow \text{Comp}^{+}(\mathcal{A})
$$
defined by $(\alpha : K^\bullet \to I^\bullet) \mapsto K^\bullet$.
There is also a functor
$$
t : \text{InjRes}(\mathcal{A}) \longrightarrow K^{+}(\mathcal{I})
$$
defined by $(\alpha : K^\bullet \to I^\bullet) \mapsto I^\bullet$.

\begin{lemma}
\label{lemma-functorial-injective-resolutions}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has functorial injective embeddings, see
Homology, Definition \ref{homology-definition-functorial-injective-embedding}.
\begin{enumerate}
\item There exists a functor
$inj : \text{Comp}^{+}(\mathcal{A}) \to \text{InjRes}(\mathcal{A})$
such that $s \circ inj = \text{id}$.
\item For any functor
$inj : \text{Comp}^{+}(\mathcal{A}) \to \text{InjRes}(\mathcal{A})$
such that $s \circ inj = \text{id}$ we obtain a resolution functor, see
Definition \ref{definition-localization-functor}.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $A \mapsto (A \to J(A))$ be a functorial injective embedding, see
Homology, Definition \ref{homology-definition-functorial-injective-embedding}.
We first note that we may assume $J(0) = 0$. Namely, if not then
for any object $A$ we have $0 \to A \to 0$ which gives
a direct sum decomposition $J(A) = J(0) \oplus \Ker(J(A) \to J(0))$.
Note that the functorial morphism $A \to J(A)$ has to map
into the second summand. Hence we can replace our functor
by $J'(A) = \Ker(J(A) \to J(0))$ if needed.

\medskip\noindent
Let $K^\bullet$ be a bounded below complex of $\mathcal{A}$.
Say $K^p = 0$ if $p < B$.
We are going to construct a double complex $I^{\bullet, \bullet}$
of injectives, together with a map $\alpha : K^\bullet \to I^{\bullet, 0}$
such that $\alpha$ induces a quasi-isomorphism of $K^\bullet$
with the associated total complex of $I^{\bullet, \bullet}$.
First we set $I^{p, q} = 0$ whenever $q < 0$.
Next, we set $I^{p, 0} = J(K^p)$ and $\alpha^p : K^p \to I^{p, 0}$
the functorial embedding. Since $J$ is a functor we see that
$I^{\bullet, 0}$ is a complex and that $\alpha$ is a
morphism of complexes. Each $\alpha^p$ is injective. And
$I^{p, 0} = 0$ for $p < B$ because $J(0) = 0$. Next, we set
$I^{p, 1} = J(\Coker(K^p \to I^{p, 0}))$. Again by functoriality
we see that $I^{\bullet, 1}$ is a complex. And again we get
that $I^{p, 1} = 0$ for $p < B$. It is also clear that
$K^p$ maps isomorphically onto $\Ker(I^{p, 0} \to I^{p, 1})$.
As our third step we take $I^{p, 2} = J(\Coker(I^{p, 0} \to I^{p, 1}))$.
And so on and so forth.

\medskip\noindent
At this point we can apply
Homology, Lemma \ref{homology-lemma-double-complex-gives-resolution}
to get that the map
$$
\alpha : K^\bullet \to sI^\bullet
$$
is a quasi-isomorphism. To prove we get a functor $inj$ it
rests to show that the construction above
is functorial. This verification is omitted.

\medskip\noindent
Suppose we have a functor $inj$ such that $s \circ inj = \text{id}$.
For every object $K^\bullet$ of $\text{Comp}^{+}(\mathcal{A})$
we can write
$$
inj(K^\bullet) = (i_{K^\bullet} : K^\bullet \to j(K^\bullet))
$$
This provides us with a resolution functor as in
Definition \ref{definition-localization-functor}.
\end{proof}

\begin{remark}
\label{remark-match}
Suppose $inj$ is a functor such that $s \circ inj = \text{id}$
as in part (2) of
Lemma \ref{lemma-functorial-injective-resolutions}.
Write $inj(K^\bullet) = (i_{K^\bullet} : K^\bullet \to j(K^\bullet))$
as in the proof of that lemma.
Suppose $\alpha : K^\bullet \to L^\bullet$ is a map
of bounded below complexes. Consider the map
$inj(\alpha)$ in the category $\text{InjRes}(\mathcal{A})$.
It induces a commutative diagram
$$
\xymatrix{
K^\bullet
\ar[rr]^-{\alpha}
\ar[d]_{i_K} & &
L^\bullet \ar[d]^{i_L} \\
j(K)^\bullet
\ar[rr]^-{inj(\alpha)}
& &
j(L)^\bullet
}
$$
of morphisms of complexes.
Hence, looking at the proof of
Lemma \ref{lemma-resolution-functor}
we see that the functor $j : K^{+}(\mathcal{A}) \to K^{+}(\mathcal{I})$
is given by the rule
$$
j(\alpha\text{ up to homotopy}) = inj(\alpha)\text{ up to homotopy}\in
\Hom_{K^{+}(\mathcal{I})}(j(K^\bullet), j(L^\bullet))
$$
Hence we see that $j$ matches $t \circ inj$ in this case, i.e., the
diagram
$$
\xymatrix{
\text{Comp}^{+}(\mathcal{A}) \ar[rr]_{t \circ inj} \ar[rd] & &
K^{+}(\mathcal{I}) \\
& K^{+}(\mathcal{A}) \ar[ru]_j
}
$$
is commutative.
\end{remark}

\begin{remark}
\label{remark-big-abelian-category}
Let $\textit{Mod}(\mathcal{O}_X)$ be the category of $\mathcal{O}_X$-modules
on a ringed space $(X, \mathcal{O}_X)$ (or more generally on a
ringed site). We will see later that $\textit{Mod}(\mathcal{O}_X)$ has enough
injectives and in fact functorial injective embeddings, see
Injectives, Theorem \ref{injectives-theorem-sheaves-modules-injectives}.
Note that the proof of Lemma \ref{lemma-into-derived-category} does
not apply to $\textit{Mod}(\mathcal{O}_X)$. But the proof of
Lemma \ref{lemma-functorial-injective-resolutions} does apply
to $\textit{Mod}(\mathcal{O}_X)$. Thus we obtain
$$
j : K^{+}(\textit{Mod}(\mathcal{O}_X))
\longrightarrow
K^{+}(\mathcal{I})
$$
which is a resolution functor where $\mathcal{I}$ is the additive
category of injective $\mathcal{O}_X$-modules. This argument also
works in the following cases:
\begin{enumerate}
\item The category $\text{Mod}_R$ of $R$-modules over a ring $R$.
\item The category $\textit{PMod}(\mathcal{O})$ of presheaves of
$\mathcal{O}$-modules on a site endowed with a presheaf of rings.
\item The category $\textit{Mod}(\mathcal{O})$ of sheaves of
$\mathcal{O}$-modules on a ringed site.
\item Add more here as needed.
\end{enumerate}
\end{remark}









\section{Right derived functors via resolution functors}
\label{section-right-derived-functor-via-resolutions}

\noindent
The content of the following lemma is that we can simply define
$RF(K^\bullet) = F(j(K^\bullet))$ if we are given a resolution functor $j$.

\begin{lemma}
\label{lemma-right-derived-functor}
Let $\mathcal{A}$ be an abelian category with enough injectives
Let $F : \mathcal{A} \to \mathcal{B}$ be an additive functor into
an abelian category. Let $(i, j)$ be a resolution functor, see
Definition \ref{definition-localization-functor}.
The right derived functor $RF$ of $F$ fits into the following
$2$-commutative diagram
$$
\xymatrix{
D^{+}(\mathcal{A}) \ar[rd]_{RF} \ar[rr]^{j'} & &
K^{+}(\mathcal{I}) \ar[ld]^F \\
& D^{+}(\mathcal{B})
}
$$
where $j'$ is the functor from
Lemma \ref{lemma-resolution-functor-quasi-inverse}.
\end{lemma}

\begin{proof}
By
Lemma \ref{lemma-injective-acyclic}
we have $RF(K^\bullet) = F(j(K^\bullet))$.
\end{proof}

\begin{remark}
\label{remark-right-derived-functor}
In the situation of
Lemma \ref{lemma-right-derived-functor}
we see that we have actually lifted the right derived
functor to an exact functor
$F \circ j' : D^{+}(\mathcal{A}) \to K^{+}(\mathcal{B})$.
It is occasionally useful to use such a factorization.
\end{remark}








\section{Filtered derived category and injective resolutions}
\label{section-filtered-derived}

\noindent
Let $\mathcal{A}$ be an abelian category. In this section we will show
that if $\mathcal{A}$ has enough injectives, then so does
the category $\text{Fil}^f(\mathcal{A})$ in some sense. One
can use this observation to compute in the filtered derived category
of $\mathcal{A}$.

\medskip\noindent
The category $\text{Fil}^f(\mathcal{A})$ is an example of an
exact category, see
Injectives, Remark \ref{injectives-remark-embed-exact-category}.
A special role is played by the strict morphisms, see
Homology, Definition \ref{homology-definition-strict},
i.e., the morphisms $f$ such that $\Coim(f) = \Im(f)$.
We will say that a complex $A \to B \to C$ in $\text{Fil}^f(\mathcal{A})$ is
{\it exact} if the sequence $\text{gr}(A) \to \text{gr}(B) \to \text{gr}(C)$
is exact in $\mathcal{A}$. This implies that $A \to B$ and $B \to C$
are strict morphisms, see
Homology, Lemma \ref{homology-lemma-filtered-acyclic}.

\begin{definition}
\label{definition-filtered-complexes-notation}
Let $\mathcal{A}$ be an abelian category.
We say an object $I$ of $\text{Fil}^f(\mathcal{A})$
is {\it filtered injective} if each $\text{gr}^p(I)$ is
an injective object of $\mathcal{A}$.
\end{definition}

\begin{lemma}
\label{lemma-filtered-injective}
Let $\mathcal{A}$ be an abelian category.
An object $I$ of $\text{Fil}^f(\mathcal{A})$ is filtered injective
if and only if
there exist $a \leq b$, injective objects $I_n$, $a \leq n \leq b$
of $\mathcal{A}$ and an isomorphism $I \cong \bigoplus_{a \leq n \leq b} I_n$
such that $F^pI = \bigoplus_{n \geq p} I_n$.
\end{lemma}

\begin{proof}
Follows from the fact that any injection $J \to M$ of $\mathcal{A}$
is split if $J$ is an injective object. Details omitted.
\end{proof}

\begin{lemma}
\label{lemma-split-strict-monomorphism}
Let $\mathcal{A}$ be an abelian category.
Any strict monomorphism $u : I \to A$ of $\text{Fil}^f(\mathcal{A})$
where $I$ is a filtered injective object is a split injection.
\end{lemma}

\begin{proof}
Let $p$ be the largest integer such that $F^pI \not = 0$.
In particular $\text{gr}^p(I) = F^pI$.
Let $I'$ be the object of $\text{Fil}^f(\mathcal{A})$ whose
underlying object of $\mathcal{A}$ is $F^pI$ and with filtration
given by $F^nI' = 0$ for $n > p$ and $F^nI' = I' = F^pI$ for
$n \leq p$. Note that $I' \to I$ is a strict monomorphism too.
The fact that $u$ is a strict monomorphism implies that
$F^pI \to A/F^{p + 1}(A)$ is injective, see
Homology, Lemma \ref{homology-lemma-characterize-strict}.
Choose a splitting $s : A/F^{p + 1}A \to F^pI$ in $\mathcal{A}$.
The induced morphism $s' : A \to I'$ is a strict morphism of
filtered objects splitting the composition $I' \to I \to A$.
Hence we can write $A = I' \oplus \Ker(s')$ and
$I = I' \oplus \Ker(s'|_I)$. Note that
$\Ker(s'|_I) \to \Ker(s')$ is a strict monomorphism
and that $\Ker(s'|_I)$ is a filtered injective object.
By induction on the length of the filtration on $I$ the map
$\Ker(s'|_I) \to \Ker(s')$ is a split injection.
Thus we win.
\end{proof}

\begin{lemma}
\label{lemma-injective-property-filtered-injective}
Let $\mathcal{A}$ be an abelian category.
Let $u : A \to B$ be a strict monomorphism
of $\text{Fil}^f(\mathcal{A})$
and $f : A \to I$ a morphism from $A$ into a filtered injective object
in $\text{Fil}^f(\mathcal{A})$.
Then there exists a morphism $g : B \to I$ such that $f = g \circ u$.
\end{lemma}

\begin{proof}
The pushout $f' : I \to I \amalg_A B$ of $f$ by $u$ is a strict
monomorphism, see
Homology, Lemma \ref{homology-lemma-pushout-filtered}.
Hence the result follows formally from
Lemma \ref{lemma-split-strict-monomorphism}.
\end{proof}

\begin{lemma}
\label{lemma-strict-monomorphism-into-filtered-injective}
Let $\mathcal{A}$ be an abelian category with enough injectives.
For any object $A$ of $\text{Fil}^f(\mathcal{A})$ there exists
a strict monomorphism $A \to I$
where $I$ is a filtered injective object.
\end{lemma}

\begin{proof}
Pick $a \leq b$ such that $\text{gr}^p(A) = 0$ unless
$p \in \{a, a + 1, \ldots, b\}$. For each
$n \in \{a, a + 1, \ldots, b\}$ choose an injection
$u_n : A/F^{n + 1}A \to I_n$ with $I_n$ an injective object.
Set $I = \bigoplus_{a \leq n \leq b} I_n$ with filtration
$F^pI = \bigoplus_{n \geq p} I_n$ and set $u : A \to I$ equal to
the direct sum of the maps $u_n$.
\end{proof}

\begin{lemma}
\label{lemma-filtered-injective-right-resolution-single-object}
Let $\mathcal{A}$ be an abelian category with enough injectives.
For any object $A$ of $\text{Fil}^f(\mathcal{A})$ there exists
a filtered quasi-isomorphism $A[0] \to I^\bullet$
where $I^\bullet$ is a complex of filtered injective objects
with $I^n = 0$ for $n < 0$.
\end{lemma}

\begin{proof}
First choose a strict monomorphism $u_0 : A \to I^0$ of $A$ into a filtered
injective object, see
Lemma \ref{lemma-strict-monomorphism-into-filtered-injective}.
Next, choose a strict monomorphism
$u_1 : \Coker(u_0) \to I^1$ into a filtered injective object of
$\mathcal{A}$. Denote $d^0$ the induced map $I^0 \to I^1$.
Next, choose a strict monomorphism $u_2 : \Coker(u_1) \to I^2$ into
a filtered injective object of $\mathcal{A}$. Denote $d^1$ the induced
map $I^1 \to I^2$. And so on. This works because each
of the sequences
$$
0 \to \Coker(u_n) \to I^{n + 1} \to \Coker(u_{n + 1}) \to 0
$$
is short exact, i.e., induces a short exact sequence on applying
$\text{gr}$. To see this use
Homology, Lemma \ref{homology-lemma-characterize-strict}.
\end{proof}

\begin{lemma}
\label{lemma-filtered-injective-right-resolution-map}
Let $\mathcal{A}$ be an abelian category with enough injectives.
Let $f : A \to B$ be a morphism of $\text{Fil}^f(\mathcal{A})$.
Given filtered quasi-isomorphisms $A[0] \to I^\bullet$ and
$B[0] \to J^\bullet$ where $I^\bullet, J^\bullet$ are complexes of
filtered injective objects with $I^n = J^n = 0$ for $n < 0$, then
there exists a commutative diagram
$$
\xymatrix{
A[0] \ar[r] \ar[d] &
B[0] \ar[d] \\
I^\bullet \ar[r] &
J^\bullet
}
$$
\end{lemma}

\begin{proof}
As $A[0] \to I^\bullet$ and $C[0] \to J^\bullet$ are filtered
quasi-isomorphisms we conclude that $a : A \to I^0$, $b : B \to J^0$
and all the morphisms $d_I^n$, $d_J^n$ are strict, see
Homology, Lemma \ref{homology-lemma-filtered-acyclic}.
We will inductively construct the maps $f^n$ in the following
commutative diagram
$$
\xymatrix{
A \ar[r]_a \ar[d]_f &
I^0 \ar[r] \ar[d]^{f^0} &
I^1 \ar[r] \ar[d]^{f^1} &
I^2 \ar[r] \ar[d]^{f^2} &
\ldots \\
B \ar[r]^b &
J^0 \ar[r] &
J^1 \ar[r] &
J^2 \ar[r] &
\ldots
}
$$
Because $A \to I^0$ is a strict monomorphism and because
$J^0$ is filtered injective, we can find a morphism $f^0 : I^0 \to J^0$
such that $f^0 \circ a = b \circ f$, see
Lemma \ref{lemma-injective-property-filtered-injective}.
The composition $d_J^0 \circ b \circ f$ is zero, hence
$d_J^0 \circ f^0 \circ a = 0$, hence $d_J^0 \circ f^0$ factors
through a unique morphism
$$
\Coker(a) = \Coim(d_I^0) = \Im(d_I^0) \longrightarrow J^1.
$$
As $\Im(d_I^0) \to I^1$ is a strict monomorphism we can extend the
displayed arrow to a morphism $f^1 : I^1 \to J^1$ by
Lemma \ref{lemma-injective-property-filtered-injective}
again. And so on.
\end{proof}

\begin{lemma}
\label{lemma-filtered-injective-right-resolution-ses}
Let $\mathcal{A}$ be an abelian category with enough injectives.
Let $0 \to A \to B \to C \to 0$ be a short exact sequence in
$\text{Fil}^f(\mathcal{A})$.
Given filtered quasi-isomorphisms $A[0] \to I^\bullet$ and
$C[0] \to J^\bullet$ where $I^\bullet, J^\bullet$ are complexes of
filtered injective objects with $I^n = J^n = 0$ for $n < 0$, then
there exists a commutative diagram
$$
\xymatrix{
0 \ar[r] &
A[0] \ar[r] \ar[d] &
B[0] \ar[r] \ar[d] &
C[0] \ar[r] \ar[d] &
0 \\
0 \ar[r] &
I^\bullet \ar[r] &
M^\bullet \ar[r] &
J^\bullet \ar[r] &
0
}
$$
where the lower row is a termwise split sequence of complexes.
\end{lemma}

\begin{proof}
As $A[0] \to I^\bullet$ and $C[0] \to J^\bullet$ are filtered
quasi-isomorphisms we conclude that $a : A \to I^0$, $c : C \to J^0$
and all the morphisms $d_I^n$, $d_J^n$ are strict, see
Homology, Lemma \ref{lemma-filtered-acyclic}.
We are going to step by step construct the south-east and the south
arrows in the following commutative diagram
$$
\xymatrix{
B \ar[r]_\beta \ar[rd]^b &
C \ar[r]_c \ar[rd]^{\overline{b}} &
J^0 \ar[d]^{\delta^0} \ar[r] &
J^1 \ar[d]^{\delta^1} \ar[r] & \ldots \\
A \ar[u]^\alpha \ar[r]^a &
I^0 \ar[r] &
I^1 \ar[r] &
I^2 \ar[r] & \ldots
}
$$
As $A \to B$ is a strict monomorphism, we can find a morphism
$b : B \to I^0$ such that $b \circ \alpha = a$, see
Lemma \ref{lemma-injective-property-filtered-injective}.
As $A$ is the kernel of the strict morphism $I^0 \to I^1$
and $\beta = \Coker(\alpha)$ we obtain a unique morphism
$\overline{b} : C \to I^1$ fitting into the diagram.
As $c$ is a strict monomorphism and $I^1$ is filtered injective
we can find $\delta^0 : J^0 \to I^1$, see
Lemma \ref{lemma-injective-property-filtered-injective}.
Because $B \to C$ is a strict epimorphism and because
$B \to I^0 \to I^1 \to I^2$ is zero, we see that
$C \to I^1 \to I^2$ is zero. Hence $d_I^1 \circ \delta^0$
is zero on $C \cong \Im(c)$.
Hence $d_I^1 \circ \delta^0$ factors through a unique morphism
$$
\Coker(c) = \Coim(d_J^0) = \Im(d_J^0) \longrightarrow I^2.
$$
As $I^2$ is filtered injective and $\Im(d_J^0) \to J^1$ is a
strict monomorphism we can extend the displayed morphism to a morphism
$\delta^1 : J^1 \to I^2$, see
Lemma \ref{lemma-injective-property-filtered-injective}.
And so on. We set $M^\bullet = I^\bullet \oplus J^\bullet$
with differential
$$
d_M^n =
\left(
\begin{matrix}
d_I^n & (-1)^{n + 1}\delta^n \\
0 & d_J^n
\end{matrix}
\right)
$$
Finally, the map $B[0] \to M^\bullet$ is given by
$b \oplus c \circ \beta : M \to I^0 \oplus J^0$.
\end{proof}

\begin{lemma}
\label{lemma-right-resolution-by-filtered-injectives}
Let $\mathcal{A}$ be an abelian category with enough injectives.
For every $K^\bullet \in K^{+}(\text{Fil}^f(\mathcal{A}))$
there exists a filtered quasi-isomorphism $K^\bullet \to I^\bullet$
with $I^\bullet$ bounded below,
each $I^n$ a filtered injective object, and
each $K^n \to I^n$ a strict monomorphism.
\end{lemma}

\begin{proof}
After replacing $K^\bullet$ by a shift (which is harmless for the proof)
we may assume that $K^n = 0$ for $n < 0$. Consider the
short exact sequences
$$
\begin{matrix}
0 \to \Ker(d_K^0) \to K^0 \to \Coim(d_K^0) \to 0 \\
0 \to \Ker(d_K^1) \to K^1 \to \Coim(d_K^1) \to 0 \\
0 \to \Ker(d_K^2) \to K^2 \to \Coim(d_K^2) \to 0 \\
\ldots
\end{matrix}
$$
of the exact category $\text{Fil}^f(\mathcal{A})$
and the maps $u_i : \Coim(d_K^i) \to \Ker(d_K^{i + 1})$.
For each $i \geq 0$ we may choose filtered quasi-isomorphisms
$$
\begin{matrix}
\Ker(d_K^i)[0] \to I_{ker, i}^\bullet \\
\Coim(d_K^i)[0] \to I_{coim, i}^\bullet
\end{matrix}
$$
with $I_{ker, i}^n, I_{coim, i}^n$ filtered injective and zero for $n < 0$, see
Lemma \ref{lemma-filtered-injective-right-resolution-single-object}.
By
Lemma \ref{lemma-filtered-injective-right-resolution-map}
we may lift $u_i$ to a morphism of complexes
$u_i^\bullet : I_{coim, i}^\bullet \to I_{ker, i + 1}^\bullet$.
Finally, for each $i \geq 0$ we may complete the diagrams
$$
\xymatrix{
0 \ar[r] &
\Ker(d_K^i)[0] \ar[r] \ar[d] &
K^i[0] \ar[r] \ar[d] &
\Coim(d_K^i)[0] \ar[r] \ar[d] &
0 \\
0 \ar[r] &
I_{ker, i}^\bullet \ar[r]^{\alpha_i} &
I_i^\bullet \ar[r]^{\beta_i} &
I_{coim, i}^\bullet \ar[r] &
0
}
$$
with the lower sequence a termwise split exact sequence, see
Lemma \ref{lemma-filtered-injective-right-resolution-ses}.
For $i \geq 0$ set $d_i : I_i^\bullet \to I_{i + 1}^\bullet$
equal to $d_i =  \alpha_{i + 1} \circ u_i^\bullet \circ \beta_i$.
Note that $d_i \circ d_{i - 1} = 0$ because
$\beta_i \circ \alpha_i = 0$. Hence we have constructed
a commutative diagram
$$
\xymatrix{
I_0^\bullet \ar[r] &
I_1^\bullet \ar[r] &
I_2^\bullet \ar[r] & \ldots \\
K^0[0] \ar[r] \ar[u] &
K^1[0] \ar[r] \ar[u] &
K^2[0] \ar[r] \ar[u] &
\ldots
}
$$
Here the vertical arrows are filtered quasi-isomorphisms.
The upper row is a complex of complexes and each complex consists of
filtered injective objects with no nonzero objects in degree $< 0$.
Thus we obtain a double complex by setting $I^{a, b} = I_a^b$ and using
$$
d_1^{a, b} : I^{a, b} = I_a^b \to I_{a + 1}^b = I^{a + 1, b}
$$
the map $d_a^b$ and using for
$$
d_2^{a, b} : I^{a, b} = I_a^b \to I_a^{b + 1} = I^{a, b + 1}
$$
the map $d_{I_a}^b$. Denote $\text{Tot}(I^{\bullet, \bullet})$
the total complex associated to this double complex, see
Homology, Definition \ref{homology-definition-associated-simple-complex}.
Observe that the maps $K^n[0] \to I_n^\bullet$ come from maps
$K^n \to I^{n, 0}$ which give rise to a map of complexes
$$
K^\bullet \longrightarrow \text{Tot}(I^{\bullet, \bullet})
$$
We claim this is a filtered quasi-isomorphism.
As $\text{gr}(-)$ is an additive functor, we see that
$\text{gr}(\text{Tot}(I^{\bullet, \bullet})) =
\text{Tot}(\text{gr}(I^{\bullet, \bullet}))$.
Thus we can use
Homology,
Lemma \ref{homology-lemma-double-complex-gives-resolution}
to conclude that
$\text{gr}(K^\bullet) \to \text{gr}(\text{Tot}(I^{\bullet, \bullet}))$
is a quasi-isomorphism as desired.
\end{proof}

\begin{lemma}
\label{lemma-filtered-acyclic-is-zero}
Let $\mathcal{A}$ be an abelian category.
Let $K^\bullet, I^\bullet \in K(\text{Fil}^f(\mathcal{A}))$.
Assume $K^\bullet$ is filtered acyclic and
$I^\bullet$ bounded below and consisting of filtered injective objects.
Any morphism $K^\bullet \to I^\bullet$ is homotopic to zero:
$\Hom_{K(\text{Fil}^f(\mathcal{A}))}(K^\bullet, I^\bullet) = 0$.
\end{lemma}

\begin{proof}
Let $\alpha : K^\bullet \to I^\bullet$ be a morphism of
complexes. Assume that $\alpha^j = 0$ for $j < n$.
We will show that there exists a morphism $h : K^{n + 1} \to I^n$
such that $\alpha^n = h \circ d$. Thus $\alpha$ will be homotopic
to the morphism of complexes $\beta$ defined by
$$
\beta^j =
\left\{
\begin{matrix}
0 & \text{if} & j \leq n \\
\alpha^{n + 1} - d \circ h & \text{if} & j = n + 1 \\
\alpha^j & \text{if} & j > n + 1
\end{matrix}
\right.
$$
This will clearly prove the lemma (by induction).
To prove the existence of $h$ note that
$\alpha^n \circ d_K^{n - 1} = 0$ since
$\alpha^{n - 1} = 0$. Since $K^\bullet$ is filtered acyclic
we see that $d_K^{n - 1}$ and $d_K^n$ are strict and that
$$
0 \to \Im(d_K^{n - 1}) \to K^n \to \Im(d_K^n) \to 0
$$
is an exact sequence of the exact category $\text{Fil}^f(\mathcal{A})$, see
Homology, Lemma \ref{homology-lemma-filtered-acyclic}.
Hence we can think of $\alpha^n$ as a map into $I^n$ defined
on $\Im(d_K^n)$.
Using that $\Im(d_K^n) \to K^{n + 1}$ is a strict monomorphism
and that $I^n$ is filtered injective we may lift this map to a map
$h : K^{n + 1} \to I^n$ as desired, see
Lemma \ref{lemma-injective-property-filtered-injective}.
\end{proof}

\begin{lemma}
\label{lemma-morphisms-into-filtered-injective-complex}
Let $\mathcal{A}$ be an abelian category.
Let $I^\bullet \in K(\text{Fil}^f(\mathcal{A}))$
be a bounded below complex consisting of
filtered injective objects.
\begin{enumerate}
\item Let $\alpha : K^\bullet \to L^\bullet$ in $K(\text{Fil}^f(\mathcal{A}))$
be a filtered quasi-isomorphism.
Then the map
$$
\Hom_{K(\text{Fil}^f(\mathcal{A}))}(L^\bullet, I^\bullet)
\to
\Hom_{K(\text{Fil}^f(\mathcal{A}))}(K^\bullet, I^\bullet)
$$
is bijective.
\item Let $L^\bullet \in K(\text{Fil}^f(\mathcal{A}))$. Then
$$
\Hom_{K(\text{Fil}^f(\mathcal{A}))}(L^\bullet, I^\bullet)
=
\Hom_{DF(\mathcal{A})}(L^\bullet, I^\bullet).
$$
\end{enumerate}
\end{lemma}

\begin{proof}
Proof of (1). Note that
$$
(K^\bullet, L^\bullet, C(\alpha)^\bullet, \alpha, i, -p)
$$
is a distinguished triangle in $K(\text{Fil}^f(\mathcal{A}))$
(Lemma \ref{lemma-the-same-up-to-isomorphisms})
and $C(\alpha)^\bullet$ is a filtered acyclic complex
(Lemma \ref{lemma-filtered-acyclic}).
Then
$$
\xymatrix{
\Hom_{K(\text{Fil}^f(\mathcal{A}))}(C(\alpha)^\bullet, I^\bullet) \ar[r] &
\Hom_{K(\text{Fil}^f(\mathcal{A}))}(L^\bullet, I^\bullet) \ar[r] &
\Hom_{K(\text{Fil}^f(\mathcal{A}))}(K^\bullet, I^\bullet) \ar[lld] \\
\Hom_{K(\text{Fil}^f(\mathcal{A}))}(C(\alpha)^\bullet[-1], I^\bullet)
}
$$
is an exact sequence of abelian groups, see
Lemma \ref{lemma-representable-homological}.
At this point
Lemma \ref{lemma-filtered-acyclic-is-zero}
guarantees that the outer two groups are zero and hence
$\Hom_{K(\mathcal{A})}(L^\bullet, I^\bullet) =
\Hom_{K(\mathcal{A})}(K^\bullet, I^\bullet)$.

\medskip\noindent
Proof of (2).
Let $a$ be an element of the right hand side.
We may represent $a = \gamma\alpha^{-1}$ where
$\alpha : K^\bullet \to L^\bullet$
is a filtered quasi-isomorphism and $\gamma : K^\bullet \to I^\bullet$
is a map of complexes. By part (1)
we can find a morphism $\beta : L^\bullet \to I^\bullet$ such that
$\beta \circ \alpha$ is homotopic to $\gamma$. This proves that the
map is surjective. Let $b$ be an element of the left hand side
which maps to zero in the right hand side. Then $b$ is the homotopy class
of a morphism $\beta : L^\bullet \to I^\bullet$ such that there exists a
filtered quasi-isomorphism $\alpha : K^\bullet \to L^\bullet$ with
$\beta  \circ \alpha$ homotopic to zero. Then part (1)
shows that $\beta$ is homotopic to zero also, i.e., $b = 0$.
\end{proof}

\begin{lemma}
\label{lemma-filtered-localization-functor}
Let $\mathcal{A}$ be an abelian category with enough injectives.
Let $\mathcal{I}^f \subset \text{Fil}^f(\mathcal{A})$
denote the strictly full additive subcategory whose objects are
the filtered injective objects. The canonical functor
$$
K^{+}(\mathcal{I}^f)
\longrightarrow
DF^{+}(\mathcal{A})
$$
is exact, fully faithful and essentially surjective, i.e., an
equivalence of triangulated categories. Furthermore the diagrams
$$
\xymatrix{
K^{+}(\mathcal{I}^f) \ar[d]_{\text{gr}^p} \ar[r] &
DF^{+}(\mathcal{A}) \ar[d]_{\text{gr}^p} \\
K^{+}(\mathcal{I}) \ar[r] &
D^{+}(\mathcal{A})
}
\quad
\xymatrix{
K^{+}(\mathcal{I}^f) \ar[d]^{\text{forget }F} \ar[r] &
DF^{+}(\mathcal{A}) \ar[d]^{\text{forget }F} \\
K^{+}(\mathcal{I}) \ar[r] &
D^{+}(\mathcal{A})
}
$$
are commutative, where $\mathcal{I} \subset \mathcal{A}$ is the
strictly full additive subcategory whose objects are
the injective objects.
\end{lemma}

\begin{proof}
The functor $K^{+}(\mathcal{I}^f) \to DF^{+}(\mathcal{A})$
is essentially surjective by
Lemma \ref{lemma-right-resolution-by-filtered-injectives}.
It is fully faithful by
Lemma \ref{lemma-morphisms-into-filtered-injective-complex}.
It is an exact functor by our definitions regarding distinguished
triangles.
The commutativity of the squares is immediate.
\end{proof}

\begin{remark}
\label{remark-filtered-localization-big}
We can invert the arrow of the lemma
only if $\mathcal{A}$ is a category in our sense,
namely if it has a set of objects. However, suppose given a big abelian
category $\mathcal{A}$ with enough injectives, such as
$\textit{Mod}(\mathcal{O}_X)$ for example. Then for any given set of objects
$\{A_i\}_{i\in I}$ there is an abelian subcategory
$\mathcal{A}' \subset \mathcal{A}$ containing all of them
and having enough injectives, see
Sets, Lemma \ref{sets-lemma-abelian-injectives}.
Thus we may use the lemma above for $\mathcal{A}'$.
This essentially means that if we use a set worth of diagrams, etc
then we will never run into trouble using the lemma.
\end{remark}

\noindent
Let $\mathcal{A}, \mathcal{B}$ be abelian categories.
Let $T : \mathcal{A} \to \mathcal{B}$ be a left exact functor.
(We cannot use the letter $F$ for the functor since this would
conflict too much with our use of the letter $F$ to indicate
filtrations.) Note that $T$ induces an additive functor
$$
T : \text{Fil}^f(\mathcal{A}) \to \text{Fil}^f(\mathcal{B})
$$
by the rule $T(A, F) = (T(A), F)$ where $F^pT(A) = T(F^pA)$ which makes
sense as $T$ is left exact. (Warning: It may not be the case that
$\text{gr}(T(A)) = T(\text{gr}(A))$.)
This induces functors of triangulated categories
\begin{equation}
\label{equation-induced-T-filtered}
T :
K^{+}(\text{Fil}^f(\mathcal{A}))
\longrightarrow
K^{+}(\text{Fil}^f(\mathcal{B}))
\end{equation}
The filtered right derived functor of $T$ is the right derived functor of
Definition \ref{definition-right-derived-functor-defined}
for this exact functor composed with the exact functor
$K^{+}(\text{Fil}^f(\mathcal{B})) \to DF^{+}(\mathcal{B})$ and the
multiplicative set $\text{FQis}^{+}(\mathcal{A})$.
Assume $\mathcal{A}$ has enough injectives. At this point we can redo the
discussion of
Section \ref{section-right-derived-functor}
to define the
{\it filtered right derived functors}
\begin{equation}
\label{equation-filtered-derived-functor}
RT : DF^{+}(\mathcal{A}) \longrightarrow DF^{+}(\mathcal{B})
\end{equation}
of our functor $T$.

\medskip\noindent
However, instead we will proceed as in
Section \ref{section-right-derived-functor-via-resolutions},
and it will turn out that we can define $RT$ even if $T$ is just additive.
Namely, we first choose a quasi-inverse
$j' : DF^{+}(\mathcal{A}) \to K^{+}(\mathcal{I}^f)$ of the
equivalence of
Lemma \ref{lemma-filtered-localization-functor}.
By
Lemma \ref{lemma-exact-equivalence}
we see that $j'$ is an exact functor of triangulated categories.
Next, we note that for a filtered injective object $I$ we have
a (noncanonical) decomposition
\begin{equation}
\label{equation-decompose}
I \cong \bigoplus\nolimits_{p \in \mathbf{Z}} I_p,
\quad\text{with}\quad
F^pI = \bigoplus\nolimits_{q \geq p} I_q
\end{equation}
by
Lemma \ref{lemma-filtered-injective}.
Hence if $T$ is any additive functor $T : \mathcal{A} \to \mathcal{B}$
then we get an additive functor
\begin{equation}
\label{equation-extend-T}
T_{ext} : \mathcal{I}^f \to \text{Fil}^f(\mathcal{B})
\end{equation}
by setting $T_{ext}(I) = \bigoplus T(I_p)$ with
$F^pT_{ext}(I) = \bigoplus_{q \geq p} T(I_q)$. Note that we have the
property $\text{gr}(T_{ext}(I)) = T(\text{gr}(I))$ by construction.
Hence we obtain a functor
\begin{equation}
\label{equation-extend-T-complexes}
T_{ext} : K^{+}(\mathcal{I}^f) \to K^{+}(\text{Fil}^f(\mathcal{B}))
\end{equation}
which commutes with $\text{gr}$. Then we define
(\ref{equation-filtered-derived-functor}) by the composition
\begin{equation}
\label{equation-definition-filtered-derived-functor}
RT = T_{ext} \circ j'.
\end{equation}
Since $RT : D^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$ is computed
by injective resolutions as well, see
Lemmas \ref{lemma-injective-acyclic},
the commutation of $T$ with $\text{gr}$, and the commutative diagrams of
Lemma \ref{lemma-filtered-localization-functor}
imply that
\begin{equation}
\label{equation-commute-gr}
\text{gr}^p \circ RT \cong RT \circ \text{gr}^p
\end{equation}
and
\begin{equation}
\label{equation-commute-forget}
(\text{forget }F) \circ RT \cong RT \circ (\text{forget }F)
\end{equation}
as functors $DF^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$.

\medskip\noindent
The filtered derived functor $RT$ (\ref{equation-filtered-derived-functor})
induces functors
$$
\begin{matrix}
RT : \text{Fil}^f(\mathcal{A}) \to DF^{+}(\mathcal{B}), \\
RT : \text{Comp}^{+}(\text{Fil}^f(\mathcal{A})) \to DF^{+}(\mathcal{B}), \\
RT : KF^{+}(\mathcal{A}) \to DF^{+}(\mathcal{B}).
\end{matrix}
$$
Note that since $\text{Fil}^f(\mathcal{A})$, and
$\text{Comp}^{+}(\text{Fil}^f(\mathcal{A}))$ are no longer
abelian it does not make sense to say that $RT$ restricts to
a $\delta$-functor on them. (This can be
repaired by thinking of these categories as exact categories and
formulating the notion of a $\delta$-functor from an exact category
into a triangulated category.)
But it does make sense, and it is true
by construction, that $RT$ is an exact functor on the triangulated
category $KF^{+}(\mathcal{A})$.

\begin{lemma}
\label{lemma-ss-filtered-derived}
Let $\mathcal{A}, \mathcal{B}$ be abelian categories. Let
$T : \mathcal{A} \to \mathcal{B}$ be a left exact functor.
Assume $\mathcal{A}$ has enough injectives.
Let $(K^\bullet, F)$ be an object of
$\text{Comp}^{+}(\text{Fil}^f(\mathcal{A}))$.
There exists a spectral sequence $(E_r, d_r)_{r\geq 0}$
consisting of bigraded objects $E_r$ of $\mathcal{B}$
and $d_r$ of bidegree $(r, - r + 1)$ and with
$$
E_1^{p, q} = R^{p + q}T(\text{gr}^p(K^\bullet))
$$
Moreover, this spectral sequence is bounded, converges
to $R^*T(K^\bullet)$, and induces a finite
filtration on each $R^nT(K^\bullet)$. The construction
of this spectral sequence is functorial in the object
$K^\bullet$ of $\text{Comp}^{+}(\text{Fil}^f(\mathcal{A}))$
and the terms $(E_r, d_r)$ for $r \geq 1$ do not depend
on any choices.
\end{lemma}

\begin{proof}
Choose a filtered quasi-isomorphism $K^\bullet \to I^\bullet$
with $I^\bullet$ a bounded below complex of filtered injective objects, see
Lemma \ref{lemma-right-resolution-by-filtered-injectives}.
Consider the complex $RT(K^\bullet) = T_{ext}(I^\bullet)$, see
(\ref{equation-definition-filtered-derived-functor}).
Thus we can consider the spectral sequence
$(E_r, d_r)_{r \geq 0}$ associated to
this as a filtered complex in $\mathcal{B}$, see
Homology, Section \ref{homology-section-filtered-complex}.
By
Homology, Lemma \ref{homology-lemma-spectral-sequence-filtered-complex}
we have $E_1^{p, q} = H^{p + q}(\text{gr}^p(T(I^\bullet)))$.
By Equation (\ref{equation-decompose}) we have
$E_1^{p, q} = H^{p + q}(T(\text{gr}^p(I^\bullet)))$, and
by definition of a filtered injective resolution the
map $\text{gr}^p(K^\bullet) \to \text{gr}^p(I^\bullet)$
is an injective resolution. Hence
$E_1^{p, q} = R^{p + q}T(\text{gr}^p(K^\bullet))$.

\medskip\noindent
On the other hand, each $I^n$ has a finite filtration and hence
each $T(I^n)$ has a finite filtration. Thus we may apply
Homology, Lemma \ref{homology-lemma-biregular-ss-converges}
to conclude that the spectral sequence is bounded, converges to
$H^n(T(I^\bullet)) = R^nT(K^\bullet)$
moreover inducing finite filtrations on each of the terms.

\medskip\noindent
Suppose that $K^\bullet \to L^\bullet$ is a morphism of
$\text{Comp}^{+}(\text{Fil}^f(\mathcal{A}))$.
Choose a filtered quasi-isomorphism $L^\bullet \to J^\bullet$
with $J^\bullet$ a bounded below complex of filtered injective
objects, see
Lemma \ref{lemma-right-resolution-by-filtered-injectives}.
By our results above,
for example
Lemma \ref{lemma-morphisms-into-filtered-injective-complex},
there exists a diagram
$$
\xymatrix{
K^\bullet \ar[r] \ar[d] & L^\bullet \ar[d] \\
I^\bullet \ar[r] & J^\bullet
}
$$
which commutes up to homotopy. Hence we get a morphism of filtered
complexes $T(I^\bullet) \to T(J^\bullet)$ which gives rise to the
morphism of spectral sequences, see
Homology,
Lemma \ref{homology-lemma-spectral-sequence-filtered-complex-functorial}.
The last statement follows from this.
\end{proof}

\begin{remark}
\label{remark-final-functorial}
As promised in Remark \ref{remark-functorial-ss} we discuss the connection
of the lemma above with the constructions using Cartan-Eilenberg resolutions.
Namely, let $T : \mathcal{A} \to \mathcal{B}$ be a left exact functor
of abelian categories, assume $\mathcal{A}$
has enough injectives, and let $K^\bullet$ be a bounded below complex
of $\mathcal{A}$. We give an alternative construction of the
spectral sequences ${}'E$ and ${}''E$ of
Lemma \ref{lemma-two-ss-complex-functor}.

\medskip\noindent
First spectral sequence. Consider the ``stupid'' filtration on $K^\bullet$
obtained by setting $F^p(K^\bullet) = \sigma_{\geq p}(K^\bullet)$, see
Homology, Section \ref{homology-section-truncations}.
Note that this stupid in the sense that
$d(F^p(K^\bullet)) \subset F^{p + 1}(K^\bullet)$, compare
Homology, Lemma \ref{homology-lemma-spectral-sequence-filtered-complex-d1}.
Note that $\text{gr}^p(K^\bullet) = K^p[-p]$ with this filtration.
According to Lemma \ref{lemma-ss-filtered-derived} there is a spectral sequence
with $E_1$ term
$$
E_1^{p, q} = R^{p + q}T(K^p[-p]) = R^qT(K^p)
$$
as in the spectral sequence ${}'E_r$. Observe moreover that the differentials
$E_1^{p, q} \to E_1^{p + 1, q}$ agree with the differentials in $'{}E_1$, see
Homology, Lemma
\ref{homology-lemma-spectral-sequence-filtered-complex-d1} part (2)
and the description of ${}'d_1$ in the proof of
Lemma \ref{lemma-two-ss-complex-functor}.

\medskip\noindent
Second spectral sequence. Consider the filtration on the complex $K^\bullet$
obtained by setting $F^p(K^\bullet) = \tau_{\leq -p}(K^\bullet)$, see
Homology, Section \ref{homology-section-truncations}.
The minus sign is necessary
to get a decreasing filtration. Note that
$\text{gr}^p(K^\bullet)$ is quasi-isomorphic to $H^{-p}(K^\bullet)[p]$
with this filtration. According to Lemma \ref{lemma-ss-filtered-derived}
there is a spectral sequence with $E_1$ term
$$
E_1^{p, q} = R^{p + q}T(H^{-p}(K^\bullet)[p])
= R^{2p + q}T(H^{-p}(K^\bullet)) = {}''E_2^{i, j}
$$
with $i = 2p + q$ and $j = -p$. (This looks unnatural, but note that we
could just have well developed the whole theory of filtered complexes
using increasing filtrations, with the end result that this then looks
natural, but the other one doesn't.) We leave it to the reader to see
that the differentials match up.

\medskip\noindent
Actually, given a Cartan-Eilenberg resolution
$K^\bullet \to I^{\bullet, \bullet}$ the induced morphism
$K^\bullet \to sI^\bullet$ into the associated simple complex
will be a filtered injective resolution for either filtration
using suitable filtrations on $sI^\bullet$. This can be used
to match up the spectral sequences exactly.
\end{remark}






\section{Ext groups}
\label{section-ext}

\noindent
In this section we start describing the Ext groups of objects
of an abelian category. First we have the following very general
definition.

\begin{definition}
\label{definition-ext}
Let $\mathcal{A}$ be an abelian category. Let $i \in \mathbf{Z}$. Let
$X, Y$ be objects of $D(\mathcal{A})$. The {\it $i$th extension group}
of $X$ by $Y$ is the group
$$
\Ext^i_\mathcal{A}(X, Y) =
\Hom_{D(\mathcal{A})}(X, Y[i]) =
\Hom_{D(\mathcal{A})}(X[-i], Y).
$$
If $A, B \in \Ob(\mathcal{A})$ we set
$\Ext^i_\mathcal{A}(A, B) = \text{Ext}^i_\mathcal{A}(A[0], B[0])$.
\end{definition}

\noindent
Since $\Hom_{D(\mathcal{A})}(X, -)$,
resp.\ $\Hom_{D(\mathcal{A})}(-, Y)$ is a homological,
resp.\ cohomological functor, see
Lemma \ref{lemma-representable-homological},
we see that a distinguished triangle $(Y, Y', Y'')$,
resp.\ $(X, X', X'')$ leads to a long exact sequence
$$
\ldots \to
\Ext^i_\mathcal{A}(X, Y) \to
\Ext^i_\mathcal{A}(X, Y') \to
\Ext^i_\mathcal{A}(X, Y'') \to
\Ext^{i + 1}_\mathcal{A}(X, Y) \to \ldots
$$
respectively
$$
\ldots \to
\Ext^i_\mathcal{A}(X'', Y) \to
\Ext^i_\mathcal{A}(X', Y) \to
\Ext^i_\mathcal{A}(X, Y) \to
\Ext^{i + 1}_\mathcal{A}(X'', Y) \to \ldots
$$
Note that since $D^+(\mathcal{A})$, $D^-(\mathcal{A})$, $D^b(\mathcal{A})$
are full subcategories we may compute the Ext groups by Hom groups
in these categories provided $X$, $Y$ are contained in them.

\medskip\noindent
In case the category $\mathcal{A}$ has enough injectives or enough
projectives we can compute the Ext groups using injective or
projective resolutions. To avoid confusion, recall that having an
injective (resp.\ projective) resolution implies vanishing of homology
in all low (resp.\ high) degrees, see
Lemmas \ref{lemma-cohomology-bounded-below} and
\ref{lemma-cohomology-bounded-above}.

\begin{lemma}
\label{lemma-compute-ext-resolutions}
Let $\mathcal{A}$ be an abelian category.
Let $X^\bullet, Y^\bullet \in \Ob(K(\mathcal{A}))$.
\begin{enumerate}
\item Let $Y^\bullet \to I^\bullet$ be an injective resolution
(Definition \ref{definition-injective-resolution}). Then
$$
\Ext^i_\mathcal{A}(X^\bullet, Y^\bullet) =
\Hom_{K(\mathcal{A})}(X^\bullet, I^\bullet[i]).
$$
\item Let $P^\bullet \to X^\bullet$ be a projective resolution
(Definition \ref{definition-projective-resolution}). Then
$$
\Ext^i_\mathcal{A}(X^\bullet, Y^\bullet) =
\Hom_{K(\mathcal{A})}(P^\bullet[-i], Y^\bullet).
$$
\end{enumerate}
\end{lemma}

\begin{proof}
Follows immediately from
Lemma \ref{lemma-morphisms-into-injective-complex}
and
Lemma \ref{lemma-morphisms-from-projective-complex}.
\end{proof}

\noindent
In the rest of this section we discuss extensions of objects of the
abelian category itself. First we observe the following.

\begin{lemma}
\label{lemma-negative-exts}
Let $\mathcal{A}$ be an abelian category.
\begin{enumerate}
\item Let $X$, $Y$ be objects of $D(\mathcal{A})$. Given $a, b \in \mathbf{Z}$
such that $H^i(X) = 0$ for $i > a$ and $H^j(Y) = 0$
for $j < b$, we have $\Ext^n_\mathcal{A}(X, Y) = 0$ for
$n < b - a$ and
$$
\Ext^{b - a}_\mathcal{A}(X, Y) = \Hom_\mathcal{A}(H^a(X), H^b(Y))
$$
\item Let $A, B \in \Ob(\mathcal{A})$.
For $i < 0$ we have $\Ext^i_\mathcal{A}(B, A) = 0$.
We have $\Ext^0_\mathcal{A}(B, A) = \Hom_\mathcal{A}(B, A)$.
\end{enumerate}
\end{lemma}

\begin{proof}
Choose complexes $X^\bullet$ and $Y^\bullet$ representing $X$ and $Y$.
Since $Y^\bullet \to \tau_{\geq b}Y^\bullet$ is a quasi-isomorphism,
we may assume that $Y^j = 0$ for $j < b$.
Let $L^\bullet \to X^\bullet$ be any quasi-isomorphism.
Then $\tau_{\leq a}L^\bullet \to X^\bullet$
is a quasi-isomorphism. Hence a morphism $X \to Y[n]$
in $D(\mathcal{A})$ can be represented as $fs^{-1}$ where
$s : L^\bullet \to X^\bullet$ is a quasi-isomorphism,
$f : L^\bullet \to Y^\bullet[n]$ a morphism, and
$L^i = 0$ for $i < a$. Note that $f$ maps $L^i$ to $Y^{i + n}$.
Thus $f = 0$ if $n < b - a$ because always either $L^i$ or $Y^{i + n}$ is
zero. If $n = b - a$, then $f$ corresponds exactly to a morphism
$H^a(X) \to H^b(Y)$. Part (2) is a special case of (1).
\end{proof}

\noindent
Let $\mathcal{A}$ be an abelian category.
Suppose that $0 \to A \to A' \to A'' \to 0$ is a short exact
sequence of objects of $\mathcal{A}$. Then
$0 \to A[0] \to A'[0] \to A''[0] \to 0$ leads to a distinguished
triangle in $D(\mathcal{A})$ (see
Lemma \ref{lemma-derived-canonical-delta-functor})
hence a long exact sequence of Ext groups
$$
0 \to \Ext^0_\mathcal{A}(B, A) \to
\Ext^0_\mathcal{A}(B, A') \to
\Ext^0_\mathcal{A}(B, A'') \to
\Ext^1_\mathcal{A}(B, A) \to \ldots
$$
Similarly, given a short exact sequence $0 \to B \to B' \to B'' \to 0$
we obtain a long exact sequence of Ext groups
$$
0 \to \Ext^0_\mathcal{A}(B'', A) \to
\Ext^0_\mathcal{A}(B', A) \to
\Ext^0_\mathcal{A}(B, A) \to
\Ext^1_\mathcal{A}(B'', A) \to \ldots
$$
We may view these Ext groups as an application of the construction of the
derived category. It shows one can define Ext groups and construct
the long exact sequence of Ext groups without needing the existence of enough
injectives or projectives. There is an alternative construction of the Ext
groups due to Yoneda which avoids the use of the derived category, see
\cite{Yoneda}.

\begin{definition}
\label{definition-yoneda-extension}
Let $\mathcal{A}$ be an abelian category.
Let $A, B \in \Ob(\mathcal{A})$.
A degree $i$ {\it Yoneda extension} of $B$ by $A$ is an exact sequence
$$
E : 0 \to A \to Z_{i - 1} \to Z_{i - 2} \to \ldots \to Z_0 \to B \to 0
$$
in $\mathcal{A}$. We say two Yoneda extensions $E$ and $E'$ of the same degree
are {\it equivalent} if there exists a commutative diagram
$$
\xymatrix{
0 \ar[r] & A \ar[r] & Z_{i - 1} \ar[r] & \ldots \ar[r] &
Z_0 \ar[r] & B \ar[r] & 0 \\
0 \ar[r] &
A \ar[r] \ar[u]^{\text{id}} \ar[d]_{\text{id}} &
Z''_{i - 1} \ar[r] \ar[u] \ar[d] &
\ldots \ar[r] &
Z''_0 \ar[r] \ar[u] \ar[d] &
B \ar[r] \ar[u]_{\text{id}} \ar[d]^{\text{id}} & 0 \\
0 \ar[r] & A \ar[r] & Z'_{i - 1} \ar[r] & \ldots \ar[r] &
Z'_0 \ar[r] & B \ar[r] & 0
}
$$
where the middle row is a Yoneda extension as well.
\end{definition}

\noindent
It is not immediately clear that the equivalence of the definition is
an equivalence relation. Although it is instructive to prove this directly
this will also follow from
Lemma \ref{lemma-yoneda-extension}
below.

\medskip\noindent
Let $\mathcal{A}$ be an abelian category with objects $A$, $B$.
Given a Yoneda extension
$E : 0 \to A \to Z_{i - 1} \to Z_{i - 2} \to \ldots \to Z_0 \to B \to 0$
we define an associated element $\delta(E) \in \Ext^i(B, A)$
as the morphism $\delta(E) = fs^{-1} : B[0] \to A[i]$ where
$s$ is the quasi-isomorphism
$$
(\ldots \to 0 \to A \to Z_{i - 1} \to \ldots \to Z_0 \to 0 \to \ldots)
\longrightarrow
B[0]
$$
and $f$ is the morphism of complexes
$$
(\ldots \to 0 \to A \to Z_{i - 1} \to \ldots \to Z_0 \to 0 \to \ldots)
\longrightarrow
A[i]
$$
We call $\delta(E) = fs^{-1}$ the {\it class} of the Yoneda extension.
It turns out that this class characterizes the equivalence class
of the Yoneda extension.

\begin{lemma}
\label{lemma-yoneda-extension}
Let $\mathcal{A}$ be an abelian category with objects $A$, $B$.
Any element in $\Ext^i_\mathcal{A}(B, A)$ is $\delta(E)$
for some degree $i$ Yoneda extension of $B$ by $A$.
Given two Yoneda extensions $E$, $E'$ of the same degree
then $E$ is equivalent to $E'$ if and only if $\delta(E) = \delta(E')$.
\end{lemma}

\begin{proof}
Let $\xi : B[0] \to A[i]$ be an element of $\Ext^i_\mathcal{A}(B, A)$.
We may write $\xi = f s^{-1}$ for some quasi-isomorphism
$s : L^\bullet \to B[0]$ and map $f : L^\bullet \to A[i]$.
After replacing $L^\bullet$ by $\tau_{\leq 0}L^\bullet$ we may assume
that $L^i = 0$ for $i > 0$. Picture
$$
\xymatrix{
L^{- i - 1} \ar[r] & L^{-i} \ar[r] \ar[d] & \ldots \ar[r] &
L^0 \ar[r] & B \ar[r] & 0 \\
& A
}
$$
Then setting $Z_{i - 1} = (L^{- i + 1} \oplus A)/L^{-i}$ and
$Z_j = L^{-j}$ for $j = i - 2, \ldots, 0$ we see that we obtain a
degree $i$ extension $E$ of $B$ by $A$ whose class $\delta(E)$ equals
$\xi$.

\medskip\noindent
It is immediate from the definitions that equivalent Yoneda extensions
have the same class. Suppose that
$E : 0 \to A \to Z_{i - 1} \to Z_{i - 2} \to \ldots \to Z_0 \to B \to 0$ and
$E' : 0 \to A \to Z'_{i - 1} \to Z'_{i - 2} \to \ldots \to Z'_0 \to B \to 0$
are Yoneda extensions with the same class.
By construction of $D(\mathcal{A})$ as the localization
of $K(\mathcal{A})$ at the set of quasi-isomorphisms, this means there
exists a complex $L^\bullet$ and quasi-isomorphisms
$$
t : L^\bullet \to
(\ldots \to 0 \to A \to Z_{i - 1} \to \ldots \to Z_0 \to 0 \to \ldots)
$$
and
$$
t' : L^\bullet \to
(\ldots \to 0 \to A \to Z'_{i - 1} \to \ldots \to Z'_0 \to 0 \to \ldots)
$$
such that $s \circ t = s' \circ t'$ and $f \circ t = f' \circ t'$, see
Categories, Section \ref{categories-section-localization}.
Let $E''$ be the degree $i$ extension of $B$ by $A$ constructed from
the pair $L^\bullet \to B[0]$ and $L^\bullet \to A[i]$ in the first
paragraph of the proof. Then the reader sees readily that there exists
``morphisms'' of degree $i$ Yoneda extensions $E'' \to E$ and $E'' \to E'$
as in the definition of equivalent Yoneda extensions (details omitted).
This finishes the proof.
\end{proof}

\begin{lemma}
\label{lemma-ext-1}
Let $\mathcal{A}$ be an abelian category. Let $A$, $B$ be objects
of $\mathcal{A}$. Then $\Ext^1_\mathcal{A}(B, A)$ is
the group $\Ext_\mathcal{A}(B, A)$ constructed in
Homology, Definition \ref{homology-definition-ext-group}.
\end{lemma}

\begin{proof}
This is the case $i = 1$ of
Lemma \ref{lemma-yoneda-extension}.
\end{proof}

\begin{lemma}
\label{lemma-higher-ext-zero}
Let $\mathcal{A}$ be an abelian category and let $p \geq 0$.
If $\Ext^p_\mathcal{A}(B, A) = 0$ for any pair of objects $A$, $B$
of $\mathcal{A}$, then $\Ext^i_\mathcal{A}(B, A) = 0$ for
$i \geq p$ and any pair of objects $A$, $B$ of $\mathcal{A}$.
\end{lemma}

\begin{proof}
For $i > p$ write any class $\xi$ as $\delta(E)$
where $E$ is a Yoneda extension
$$
E : 0 \to A \to Z_{i - 1} \to Z_{i - 2} \to \ldots \to Z_0 \to B \to 0
$$
This is possible by Lemma \ref{lemma-yoneda-extension}.
Set $C = \Ker(Z_{p - 1} \to Z_p) = \Im(Z_p \to Z_{p - 1})$.
Then $\delta(E)$ is the composition of $\delta(E')$ and $\delta(E'')$
where
$$
E' : 0 \to C \to Z_{p - 1} \to \ldots \to Z_0 \to B \to 0
$$
and
$$
E'' : 0 \to A \to Z_{i - 1} \to Z_{i - 2} \to \ldots \to Z_p \to C \to 0
$$
Since $\delta(E') \in \Ext^p_\mathcal{A}(B, C) = 0$
we conclude.
\end{proof}

\begin{lemma}
\label{lemma-ext-2-zero}
Let $\mathcal{A}$ be an abelian category. Assume $\Ext^2_\mathcal{A}(B, A) = 0$
for any pair of objects $A$, $B$ of $\mathcal{A}$.
Then any object $K$ of $D^b(\mathcal{A})$ is isomorphic to the direct
sum of its cohomologies: $K \cong \bigoplus H^i(K)[-i]$.
\end{lemma}

\begin{proof}
Choose $a, b$ such that $H^i(K) = 0$ for $i \not \in [a, b]$.
We will prove the lemma by induction on $b - a$. If $b - a \leq 0$,
then the result is clear. If $b - a > 0$, then we look at the
distinguished triangle of truncations
$$
\tau_{\leq b - 1}K \to K \to H^b(K)[-b] \to (\tau_{\leq b - 1}K)[1]
$$
see Remark \ref{remark-truncation-distinguished-triangle}.
By Lemma \ref{lemma-split} if the last arrow is zero, then
$K \cong \tau_{\leq b - 1}K \oplus H^b(K)[-b]$ and we win
by induction. Again using induction we see that
$$
\Hom_{D(\mathcal{A})}(H^b(K)[-b], (\tau_{\leq b - 1}K)[1]) =
\bigoplus\nolimits_{i < b} \Ext_\mathcal{A}^{b - i + 1}(H^b(K), H^i(K))
$$
Since $\Ext^i_\mathcal{A}(B, A) = 0$ for $i \geq 2$
and any pair of objects $A, B$ of $\mathcal{A}$ by
our assumption and Lemma \ref{lemma-higher-ext-zero} we are done.
\end{proof}






\section{K-groups}
\label{section-K-groups}

\noindent
A tiny bit about $K_0$ of a triangulated category.

\begin{definition}
\label{definition-K-zero}
Let $\mathcal{D}$ be a triangulated category. We denote $K_0(\mathcal{D})$ the
{\it zeroth $K$-group of $\mathcal{D}$}. It is the abelian group constructed
as follows. Take the free abelian group on the objects on $\mathcal{D}$
and for every distinguished triangle $X \to Y \to Z$
impose the relation $[Y] - [X] - [Z] = 0$.
\end{definition}

\noindent
Observe that this implies that $[X[n]] = (-1)^n[X]$ because we have
the distinguished triangle $(X, 0, X[1], 0, 0, -\text{id}[1])$.

\begin{lemma}
\label{lemma-K-bounded-derived}
Let $\mathcal{A}$ be an abelian category. Then there is a canonical
identification $K_0(D^b(\mathcal{A})) = K_0(\mathcal{A})$
of zeroth $K$-groups.
\end{lemma}

\begin{proof}
Given an object $A$ of $\mathcal{A}$ denote $A[0]$ the object $A$
viewed as a complex sitting in degree $0$.
If $0 \to A \to A' \to A'' \to 0$ is a short
exact sequence, then we get a distinguished triangle
$A[0] \to A'[0] \to A''[0] \to A[1]$, see
Section \ref{section-canonical-delta-functor}.
This shows that we obtain a map $K_0(\mathcal{A}) \to K_0(D^b(\mathcal{A}))$
by sending $[A]$ to $[A[0]]$ with apologies for the horrendous notation.

\medskip\noindent
On the other hand, given an object $X$ of $D^b(\mathcal{A})$ we can
consider the element
$$
c(X) = \sum (-1)^i[H^i(X)] \in K_0(\mathcal{A})
$$
Given a distinguished triangle $X \to Y \to Z$ the long exact sequence
of cohomology (\ref{equation-long-exact-cohomology-sequence-D})
and the relations in $K_0(\mathcal{A})$ show that
$c(Y) = c(X) + c(Z)$. Thus $c$ factors through a map
$c : K_0(D^b(\mathcal{A})) \to K_0(\mathcal{A})$.

\medskip\noindent
We want to show that the two maps above are mutually inverse.
It is clear that the composition $K_0(\mathcal{A}) \to
K_0(D^b(\mathcal{A})) \to K_0(\mathcal{A})$ is the identity.
Suppose that $X^\bullet$ is a bounded complex of $\mathcal{A}$.
The existence of the distinguished triangles of ``stupid truncations'' (see
Homology, Section \ref{homology-section-truncations})
$$
\sigma_{\geq n}X^\bullet \to \sigma_{\geq n - 1}X^\bullet \to
X^{n - 1}[-n + 1] \to (\sigma_{\geq n}X^\bullet)[1]
$$
and induction show that
$$
[X^\bullet] = \sum (-1)^i[X^i[0]]
$$
in $K_0(D^b(\mathcal{A}))$ (with again apologies for the notation).
It follows that the composition
$K_0(\mathcal{A}) \to K_0(D^b(\mathcal{A}))$ is surjective
which finishes the proof.
\end{proof}

\begin{lemma}
\label{lemma-map-K}
Let $F : \mathcal{D} \to \mathcal{D}'$ be an exact functor of triangulated
categories. Then $F$ induces a group homomorphism
$K_0(\mathcal{D}) \to K_0(\mathcal{D}')$.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-homological-map-K}
Let $H : \mathcal{D} \to \mathcal{A}$ be a homological functor
from a triangulated category to an abelian category. Assume that
for any $X$ in $\mathcal{D}$ only a finite number of the objects
$H(X[i])$ are nonzero in $\mathcal{A}$. Then $H$ induces a group homomorphism
$K_0(\mathcal{D}) \to K_0(\mathcal{A})$ sending $[X]$ to
$\sum (-1)^i[H(X[i])]$.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-DBA-map-K}
Let $\mathcal{B}$ be a weak Serre subcategory of the abelian category
$\mathcal{A}$. Then there are canonical maps
$$
K_0(\mathcal{B}) \longrightarrow
K_0(D^b_\mathcal{B}(\mathcal{A})) \longrightarrow
K_0(\mathcal{B})
$$
whose composition is zero. The second arrow
sends the class $[X]$ of the object $X$ to the element
$\sum (-1)^i[H^i(X)]$ of $K_0(\mathcal{B})$.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-bilinear-map-K}
Let $\mathcal{D}$, $\mathcal{D}'$, $\mathcal{D}''$ be triangulated categories.
Let
$$
\otimes : \mathcal{D} \times \mathcal{D}' \longrightarrow \mathcal{D}''
$$
be a functor such that for fixed $X$ in $\mathcal{D}$ the functor
$X \otimes - : \mathcal{D}' \to \mathcal{D}''$ is an exact functor and
for fixed $X'$ in $\mathcal{D}'$ the functor
$- \otimes X' : \mathcal{D} \to \mathcal{D}''$ is an exact functor. Then
$\otimes$ induces a bilinear map
$K_0(\mathcal{D}) \times K_0(\mathcal{D}') \to K_0(\mathcal{D}'')$
which sends $([X], [X'])$ to $[X \otimes X']$.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}









\section{Unbounded complexes}
\label{section-unbounded}

\noindent
A reference for the material in this section is \cite{Spaltenstein}.
The following lemma is useful to find ``good'' left resolutions of
unbounded complexes.

\begin{lemma}
\label{lemma-special-direct-system}
Let $\mathcal{A}$ be an abelian category. Let
$\mathcal{P} \subset \Ob(\mathcal{A})$ be a subset.
Assume $\mathcal{P}$ contains $0$, is closed under (finite) direct sums,
and every object of $\mathcal{A}$ is a quotient of an
element of $\mathcal{P}$. Let $K^\bullet$ be a complex.
There exists a commutative diagram
$$
\xymatrix{
P_1^\bullet \ar[d] \ar[r] & P_2^\bullet \ar[d] \ar[r] & \ldots \\
\tau_{\leq 1}K^\bullet \ar[r] & \tau_{\leq 2}K^\bullet \ar[r] & \ldots
}
$$
in the category of complexes such that
\begin{enumerate}
\item the vertical arrows are quasi-isomorphisms,
\item $P_n^\bullet$ is a bounded above complex with terms in
$\mathcal{P}$,
\item the arrows $P_n^\bullet \to P_{n + 1}^\bullet$
are termwise split injections and each cokernel
$P^i_{n + 1}/P^i_n$ is an element of $\mathcal{P}$.
\end{enumerate}
\end{lemma}

\begin{proof}
By
Lemma \ref{lemma-subcategory-left-resolution}
any bounded above complex has a resolution by a bounded above complex
whose terms are in $\mathcal{P}$. Thus we obtain the first complex
$P_1^\bullet$. By induction it suffices, given
$P_1^\bullet, \ldots, P_n^\bullet$ to construct
$P_{n + 1}^\bullet$ and the maps
$P_n^\bullet \to P_{n + 1}^\bullet$ and
$P_{n + 1}^\bullet \to \tau_{\leq n + 1}K^\bullet$.
Consider the cone $C_1^\bullet$ of the composition
$P_n^\bullet \to \tau_{\leq n}K^\bullet \to \tau_{\leq n + 1}K^\bullet$.
This fits into the distinguished triangle
$$
P_n^\bullet \to \tau_{\leq n + 1}K^\bullet \to C_1^\bullet \to P_n^\bullet[1]
$$
Note that $C_1^\bullet$ is bounded above, hence we can choose a
quasi-isomorphism $Q^\bullet \to C_1^\bullet$ where $Q^\bullet$ is a
bounded above complex whose terms are elements of $\mathcal{P}$.
Take the cone $C_2^\bullet$ of the map of complexes
$Q^\bullet \to P_n^\bullet[1]$ to get the
distinguished triangle
$$
Q^\bullet \to P_n^\bullet[1] \to C_2^\bullet \to Q^\bullet[1]
$$
By the axioms of triangulated categories we obtain a map
of distinguished triangles
$$
\xymatrix{
P_n^\bullet \ar[r] \ar[d] &
C_2^\bullet[-1] \ar[r] \ar[d] &
Q^\bullet \ar[r] \ar[d] &
P_n^\bullet[1] \ar[d] \\
P_n^\bullet \ar[r] &
\tau_{\leq n + 1}K^\bullet \ar[r] &
C_1^\bullet \ar[r] &
P_n^\bullet[1]
}
$$
in the triangulated category $K(\mathcal{A})$.
Set $P_{n + 1}^\bullet = C_2^\bullet[-1]$.
Then (2) holds because $\mathcal{P}$ is closed
under direct sums. Note that (3) holds by construction.
Choose an actual morphism of complexes
$f : P_{n + 1}^\bullet \to \tau_{\leq n + 1}K^\bullet$.
The left square of the diagram above commutes up to homotopy, but as
$P_n^\bullet \to P_{n + 1}^\bullet$ is a termwise split injection
we can lift the homotopy and modify our choice of $f$ to make it commute.
Finally, $f$ is a quasi-isomorphism, because both $P_n^\bullet \to P_n^\bullet$
and $Q^\bullet \to C_1^\bullet$ are.
\end{proof}

\noindent
In some cases we can use the lemma above to show that a left derived
functor is everywhere defined.

\begin{proposition}
\label{proposition-left-derived-exists}
Let $F : \mathcal{A} \to \mathcal{B}$ be a right exact functor
of abelian categories. Let $\mathcal{P} \subset \Ob(\mathcal{A})$ be a
subset. Assume
\begin{enumerate}
\item $\mathcal{P}$ contains $0$, is closed under (finite) direct sums,
and every object of $\mathcal{A}$ is a quotient of an
element of $\mathcal{P}$,
\item for any bounded above acyclic complex $P^\bullet$ of
$\mathcal{A}$ with $P^n \in \mathcal{P}$ for all $n$ the
complex $F(P^\bullet)$ is exact,
\item $\mathcal{A}$ and $\mathcal{B}$ have colimits
of systems over $\mathbf{N}$,
\item colimits over $\mathbf{N}$ are exact in both
$\mathcal{A}$ and $\mathcal{B}$, and
\item $F$ commutes with colimits over $\mathbf{N}$.
\end{enumerate}
Then $LF$ is defined on all of $D(\mathcal{A})$.
\end{proposition}

\begin{proof}
By (1) and Lemma \ref{lemma-subcategory-left-resolution} for any bounded
above complex $K^\bullet$ there exists a quasi-isomorphism
$P^\bullet \to K^\bullet$ with $P^\bullet$ bounded above and
$P^n \in \mathcal{P}$ for all $n$. Suppose that
$s : P^\bullet \to (P')^\bullet$ is a quasi-isomorphism of bounded
above complexes consisting of objects of $\mathcal{P}$. Then
$F(P^\bullet) \to F((P')^\bullet)$ is a quasi-isomorphism because
$F(C(s)^\bullet)$ is acyclic by assumption (2). This already shows that
$LF$ is defined on $D^{-}(\mathcal{A})$ and that a bounded above
complex consisting of objects of $\mathcal{P}$ computes $LF$, see
Lemma \ref{lemma-find-existence-computes}.

\medskip\noindent
Next, let $K^\bullet$ be an arbitrary complex of $\mathcal{A}$.
Choose a diagram
$$
\xymatrix{
P_1^\bullet \ar[d] \ar[r] & P_2^\bullet \ar[d] \ar[r] & \ldots \\
\tau_{\leq 1}K^\bullet \ar[r] & \tau_{\leq 2}K^\bullet \ar[r] & \ldots
}
$$
as in Lemma \ref{lemma-special-direct-system}. Note that
the map $\colim P_n^\bullet \to K^\bullet$ is a quasi-isomorphism
because colimits over $\mathbf{N}$ in $\mathcal{A}$ are exact
and $H^i(P_n^\bullet) = H^i(K^\bullet)$ for $n > i$. We claim that
$$
F(\colim P_n^\bullet) = \colim F(P_n^\bullet)
$$
(termwise colimits) is $LF(K^\bullet)$, i.e., that $\colim P_n^\bullet$
computes $LF$. To see this, by Lemma \ref{lemma-find-existence-computes},
it suffices to prove the following claim. Suppose that
$$
\colim Q_n^\bullet = Q^\bullet
\xrightarrow{\ \alpha\ }
P^\bullet = \colim P_n^\bullet
$$
is a quasi-isomorphism of complexes, such that each
$P_n^\bullet$, $Q_n^\bullet$ is a bounded above complex whose terms are
in $\mathcal{P}$ and the maps $P_n^\bullet \to \tau_{\leq n}P^\bullet$ and
$Q_n^\bullet \to \tau_{\leq n}Q^\bullet$ are quasi-isomorphisms.
Claim: $F(\alpha)$ is a quasi-isomorphism.

\medskip\noindent
The problem is that we do not assume that $\alpha$ is given as a colimit
of maps between the complexes $P_n^\bullet$ and $Q_n^\bullet$. However,
for each $n$ we know that the solid arrows in the diagram
$$
\xymatrix{
& R^\bullet \ar@{..>}[d] \\
P_n^\bullet \ar[d] &
L^\bullet \ar@{..>}[l] \ar@{..>}[r] &
Q_n^\bullet \ar[d] \\
\tau_{\leq n}P^\bullet \ar[rr]^{\tau_{\leq n}\alpha} & &
\tau_{\leq n}Q^\bullet
}
$$
are quasi-isomorphisms. Because quasi-isomorphisms form a multiplicative
system in $K(\mathcal{A})$ (see Lemma \ref{lemma-acyclic})
we can find a quasi-isomorphism
$L^\bullet \to P_n^\bullet$ and map of complexes $L^\bullet \to Q_n^\bullet$
such that the diagram above commutes up to homotopy. Then
$\tau_{\leq n}L^\bullet \to L^\bullet$ is a quasi-isomorphism.
Hence (by the first part of the proof) we can find a bounded above
complex $R^\bullet$ whose terms are in $\mathcal{P}$ and a quasi-isomorphism
$R^\bullet \to L^\bullet$ (as indicated in the diagram). Using the result
of the first paragraph of the proof we see that
$F(R^\bullet) \to F(P_n^\bullet)$ and $F(R^\bullet) \to F(Q_n^\bullet)$
are quasi-isomorphisms. Thus we obtain a isomorphisms
$H^i(F(P_n^\bullet)) \to H^i(F(Q_n^\bullet))$ fitting into the commutative
diagram
$$
\xymatrix{
H^i(F(P_n^\bullet)) \ar[r] \ar[d] &
H^i(F(Q_n^\bullet)) \ar[d] \\
H^i(F(P^\bullet)) \ar[r] &
H^i(F(Q^\bullet))
}
$$
The exact same argument shows that these maps are also compatible
as $n$ varies. Since by (4) and (5) we have
$$
H^i(F(P^\bullet)) =
H^i(F(\colim P_n^\bullet)) =
H^i(\colim F(P_n^\bullet)) = \colim H^i(F(P_n^\bullet))
$$
and similarly for $Q^\bullet$ we conclude that
$H^i(\alpha) : H^i(F(P^\bullet) \to H^i(F(Q^\bullet)$ is an isomorphism
and the claim follows.
\end{proof}

\begin{lemma}
\label{lemma-special-inverse-system}
Let $\mathcal{A}$ be an abelian category. Let
$\mathcal{I} \subset \Ob(\mathcal{A})$ be a subset.
Assume $\mathcal{I}$ contains $0$, is closed under (finite) products,
and every object of $\mathcal{A}$ is a subobject of an
element of $\mathcal{I}$. Let $K^\bullet$ be a complex.
There exists a commutative diagram
$$
\xymatrix{
\ldots \ar[r] &
\tau_{\geq -2}K^\bullet \ar[r] \ar[d] &
\tau_{\geq -1}K^\bullet \ar[d] \\
\ldots \ar[r] & I_2^\bullet \ar[r] & I_1^\bullet
}
$$
in the category of complexes such that
\begin{enumerate}
\item the vertical arrows are quasi-isomorphisms,
\item $I_n^\bullet$ is a bounded below complex with terms in $\mathcal{I}$,
\item the arrows $I_{n + 1}^\bullet \to I_n^\bullet$ are termwise split
surjections and $\Ker(I^i_{n + 1} \to I^i_n)$ is an element of $\mathcal{I}$.
\end{enumerate}
\end{lemma}

\begin{proof}
This lemma is dual to
Lemma \ref{lemma-special-direct-system}.
\end{proof}







\section{Deriving adjoints}
\label{section-deriving-adjoints}

\noindent
Let $F : \mathcal{D} \to \mathcal{D}'$ and $G : \mathcal{D}' \to \mathcal{D}$
be exact functors of triangulated categories.
Let $S$, resp.\ $S'$ be a multiplicative system for
$\mathcal{D}$, resp.\ $\mathcal{D}'$ compatible with the
triangulated structure.
Denote $Q : \mathcal{D} \to S^{-1}\mathcal{D}$
and $Q' : \mathcal{D}' \to (S')^{-1}\mathcal{D}'$
the localization functors. In this situation, by abuse of notation,
one often denotes $RF$ the partially defined right derived functor
corresponding to $Q' \circ F : \mathcal{D} \to (S')^{-1}\mathcal{D}'$
and the multiplicative system $S$. Similarly one denotes
$LG$ the partially defined left derived functor
corresponding to $Q \circ G : \mathcal{D}' \to S^{-1}\mathcal{D}$
and the multiplicative system $S'$. Picture
$$
\vcenter{
\xymatrix{
\mathcal{D} \ar[r]_F \ar[d]_Q & \mathcal{D}' \ar[d]^{Q'} \\
S^{-1}\mathcal{D} \ar@{..>}[r]^{RF} &
(S')^{-1}\mathcal{D}'
}
}
\quad\text{and}\quad
\vcenter{
\xymatrix{
\mathcal{D}' \ar[r]_G \ar[d]_{Q'} & \mathcal{D} \ar[d]^Q \\
(S')^{-1}\mathcal{D}' \ar@{..>}[r]^{LG} &
S^{-1}\mathcal{D}
}
}
$$

\begin{lemma}
\label{lemma-pre-derived-adjoint-functors-general}
In the situation above assume $F$ is right adjoint
to $G$. Let $K \in \Ob(\mathcal{D})$ and
$M \in \Ob(\mathcal{D}')$. If $RF$ is defined at $K$
and $LG$ is defined at $M$, then there is a canonical isomorphism
$$
\Hom_{(S')^{-1}\mathcal{D}'}(M, RF(K)) =
\Hom_{S^{-1}\mathcal{D}}(LG(M), K)
$$
This isomorphism is functorial in both variables on the triangulated
subcategories of $S^{-1}\mathcal{D}$ and $(S')^{-1}\mathcal{D}'$
where $RF$ and $LG$ are defined.
\end{lemma}

\begin{proof}
Since $RF$ is defined at $K$, we see that the rule which assigns to a
$s : K \to I$ in $S$ the object $F(I)$ is essentially
constant as an ind-object of $(S')^{-1}\mathcal{D}'$ with value $RF(K)$.
Similarly, the rule which assigns to a $t : P \to M$ in $S'$
the object $G(P)$ is essentially constant as a pro-object of
$S^{-1}\mathcal{D}$ with value $LG(M)$. Thus we have
\begin{align*}
\Hom_{(S')^{-1}\mathcal{D}'}(M, RF(K))
& =
\colim_{s : K \to I} \Hom_{(S')^{-1}\mathcal{D}'}(M, F(I)) \\
& =
\colim_{s : K \to I} \colim_{t : P \to M} \Hom_{\mathcal{D}'}(P, F(I)) \\
& =
\colim_{t : P \to M} \colim_{s : K \to I} \Hom_{\mathcal{D}'}(P, F(I)) \\
& =
\colim_{t : P \to M} \colim_{s : K \to I} \Hom_{\mathcal{D}}(G(P), I) \\
& =
\colim_{t : P \to M} \Hom_{S^{-1}\mathcal{D}}(G(P), K) \\
& =
\Hom_{S^{-1}\mathcal{D}}(LG(M), K)
\end{align*}
The first equality holds by
Categories, Lemma \ref{categories-lemma-characterize-essentially-constant-ind}.
The second equality holds by the definition of morphisms in
$D(\mathcal{B})$, see Categories, Remark
\ref{categories-remark-right-localization-morphisms-colimit}.
The third equality holds by
Categories, Lemma \ref{categories-lemma-colimits-commute}.
The fourth equality holds because $F$ and $G$ are adjoint.
The fifth equality holds by definition of morphism
in $D(\mathcal{A})$, see Categories, Remark
\ref{categories-remark-left-localization-morphisms-colimit}.
The sixth equality holds by
Categories, Lemma \ref{categories-lemma-characterize-essentially-constant-pro}.
We omit the proof of functoriality.
\end{proof}

\begin{lemma}
\label{lemma-pre-derived-adjoint-functors}
Let $F : \mathcal{A} \to \mathcal{B}$ and $G : \mathcal{B} \to \mathcal{A}$
be functors of abelian categories such that $F$ is a right adjoint to $G$.
Let $K^\bullet$ be a complex of $\mathcal{A}$ and let $M^\bullet$ be
a complex of $\mathcal{B}$. If $RF$ is defined at $K^\bullet$
and $LG$ is defined at $M^\bullet$, then there is a canonical isomorphism
$$
\Hom_{D(\mathcal{B})}(M^\bullet, RF(K^\bullet)) =
\Hom_{D(\mathcal{A})}(LG(M^\bullet), K^\bullet)
$$
This isomorphism is functorial in both variables on the triangulated
subcategories of $D(\mathcal{A})$ and $D(\mathcal{B})$
where $RF$ and $LG$ are defined.
\end{lemma}

\begin{proof}
This is a special case of the very general
Lemma \ref{lemma-pre-derived-adjoint-functors-general}.
\end{proof}

\noindent
The following lemma is an example of why it is easier to work
with unbounded derived categories. Namely, without having the
unbounded derived functors, the lemma could not even be stated.

\begin{lemma}
\label{lemma-derived-adjoint-functors}
Let $F : \mathcal{A} \to \mathcal{B}$ and $G : \mathcal{B} \to \mathcal{A}$
be functors of abelian categories such that $F$ is a right adjoint to $G$.
If the derived functors $RF : D(\mathcal{A}) \to D(\mathcal{B})$ and
$LG : D(\mathcal{B}) \to D(\mathcal{A})$ exist, then
$RF$ is a right adjoint to $LG$.
\end{lemma}

\begin{proof}
Immediate from Lemma \ref{lemma-pre-derived-adjoint-functors}.
\end{proof}





\section{K-injective complexes}
\label{section-K-injective}

\noindent
The following types of complexes can be used to compute right derived
functors on the unbounded derived category.

\begin{definition}
\label{definition-K-injective}
Let $\mathcal{A}$ be an abelian category. A complex $I^\bullet$
is {\it K-injective} if for every acyclic complex $M^\bullet$ we
have $\Hom_{K(\mathcal{A})}(M^\bullet, I^\bullet) = 0$.
\end{definition}

\noindent
In the situation of the definition we have in fact
$\Hom_{K(\mathcal{A})}(M^\bullet[i], I^\bullet) = 0$ for all $i$
as the translate of an acyclic complex is acyclic.

\begin{lemma}
\label{lemma-K-injective}
Let $\mathcal{A}$ be an abelian category.
Let $I^\bullet$ be a complex. The following are equivalent
\begin{enumerate}
\item $I^\bullet$ is K-injective,
\item for every quasi-isomorphism $M^\bullet \to N^\bullet$ the map
$$
\Hom_{K(\mathcal{A})}(N^\bullet, I^\bullet)
\to \Hom_{K(\mathcal{A})}(M^\bullet, I^\bullet)
$$
is bijective, and
\item for every complex $N^\bullet$ the map
$$
\Hom_{K(\mathcal{A})}(N^\bullet, I^\bullet)
\to \Hom_{D(\mathcal{A})}(N^\bullet, I^\bullet)
$$
is an isomorphism.
\end{enumerate}
\end{lemma}

\begin{proof}
Assume (1). Then (2) holds because the functor
$\Hom_{K(\mathcal{A})}( - , I^\bullet)$ is cohomological
and the cone on a quasi-isomorphism is acyclic.

\medskip\noindent
Assume (2). A morphism $N^\bullet \to I^\bullet$ in $D(\mathcal{A})$
is of the form $fs^{-1} : N^\bullet \to I^\bullet$ where
$s : M^\bullet \to N^\bullet$ is a quasi-isomorphism and
$f : M^\bullet \to I^\bullet$ is a map. By (2) this corresponds to
a unique morphism $N^\bullet \to I^\bullet$ in $K(\mathcal{A})$, i.e.,
(3) holds.

\medskip\noindent
Assume (3). If $M^\bullet$ is acyclic then $M^\bullet$ is isomorphic
to the zero complex in $D(\mathcal{A})$ hence
$\Hom_{D(\mathcal{A})}(M^\bullet, I^\bullet) = 0$, whence
$\Hom_{K(\mathcal{A})}(M^\bullet, I^\bullet) = 0$ by (3),
i.e., (1) holds.
\end{proof}

\begin{lemma}
\label{lemma-triangle-K-injective}
Let $\mathcal{A}$ be an abelian category. Let $(K, L, M, f, g, h)$
be a distinguished triangle of $K(\mathcal{A})$. If two out of
$K$, $L$, $M$ are K-injective complexes, then the third is too.
\end{lemma}

\begin{proof}
Follows from the definition,
Lemma \ref{lemma-representable-homological}, and
the fact that $K(\mathcal{A})$ is a triangulated category
(Proposition \ref{proposition-homotopy-category-triangulated}).
\end{proof}

\begin{lemma}
\label{lemma-bounded-below-injectives-K-injective}
Let $\mathcal{A}$ be an abelian category. A bounded below complex of
injectives is K-injective.
\end{lemma}

\begin{proof}
Follows from
Lemmas \ref{lemma-K-injective} and
\ref{lemma-morphisms-into-injective-complex}.
\end{proof}

\begin{lemma}
\label{lemma-product-K-injective}
Let $\mathcal{A}$ be an abelian category. Let $T$ be a set and for
each $t \in T$ let $I_t^\bullet$ be a K-injective complex. If
$I^n = \prod_t I_t^n$ exists for all $n$, then $I^\bullet$ is
a K-injective complex. Moreover, $I^\bullet$ represents the
product of the objects $I_t^\bullet$ in $D(\mathcal{A})$.
\end{lemma}

\begin{proof}
Let $K^\bullet$ be an complex. Observe that the complex
$$
C :
\prod\nolimits_b \Hom(K^{-b}, I^{b - 1}) \to
\prod\nolimits_b \Hom(K^{-b}, I^b) \to
\prod\nolimits_b \Hom(K^{-b}, I^{b + 1})
$$
has cohomology $\Hom_{K(\mathcal{A})}(K^\bullet, I^\bullet)$
in the middle. Similarly, the complex
$$
C_t :
\prod\nolimits_b \Hom(K^{-b}, I_t^{b - 1}) \to
\prod\nolimits_b \Hom(K^{-b}, I_t^b) \to
\prod\nolimits_b \Hom(K^{-b}, I_t^{b + 1})
$$
computes $\Hom_{K(\mathcal{A})}(K^\bullet, I_t^\bullet)$.
Next, observe that we have
$$
C = \prod\nolimits_{t \in T} C_t
$$
as complexes of abelian groups by our choice of $I$.
Taking products is an exact functor on the
category of abelian groups. Hence if $K^\bullet$ is acyclic, then
$\Hom_{K(\mathcal{A})}(K^\bullet, I_t^\bullet) = 0$, hence
$C_t$ is acyclic, hence $C$ is acyclic, hence we get
$\Hom_{K(\mathcal{A})}(K^\bullet, I^\bullet) = 0$.
Thus we find that $I^\bullet$ is K-injective.
Having said this, we can use Lemma \ref{lemma-K-injective}
to conclude that
$$
\Hom_{D(\mathcal{A})}(K^\bullet, I^\bullet)
=
\prod\nolimits_{t \in T} \Hom_{D(\mathcal{A})}(K^\bullet, I_t^\bullet)
$$
and indeed $I^\bullet$ represents the product in the derived category.
\end{proof}

\begin{lemma}
\label{lemma-K-injective-defined}
Let $\mathcal{A}$ be an abelian category.
Let $F : K(\mathcal{A}) \to \mathcal{D}'$ be an exact functor
of triangulated categories. Then $RF$ is defined at every complex
in $K(\mathcal{A})$ which is quasi-isomorphic to a
K-injective complex. In fact, every K-injective complex computes $RF$.
\end{lemma}

\begin{proof}
By
Lemma \ref{lemma-derived-inverts}
it suffices to show that $RF$ is defined at a K-injective complex,
i.e., it suffices to show a K-injective complex $I^\bullet$ computes $RF$.
Any quasi-isomorphism $I^\bullet \to N^\bullet$ is a homotopy equivalence
as it has an inverse by
Lemma \ref{lemma-K-injective}.
Thus $I^\bullet \to I^\bullet$ is a final object of
$I^\bullet/\text{Qis}(\mathcal{A})$ and we win.
\end{proof}

\begin{lemma}
\label{lemma-enough-K-injectives-implies}
Let $\mathcal{A}$ be an abelian category.
Assume every complex has a quasi-isomorphism towards a K-injective complex.
Then any exact functor $F : K(\mathcal{A}) \to \mathcal{D}'$ of triangulated
categories has a right derived functor
$$
RF : D(\mathcal{A}) \longrightarrow \mathcal{D}'
$$
and $RF(I^\bullet) = F(I^\bullet)$ for K-injective complexes $I^\bullet$.
\end{lemma}

\begin{proof}
To see this we apply
Lemma \ref{lemma-find-existence-computes}
with $\mathcal{I}$ the collection of K-injective complexes. Since (1)
holds by assumption, it suffices to prove that if $I^\bullet \to J^\bullet$
is a quasi-isomorphism of K-injective complexes, then
$F(I^\bullet) \to F(J^\bullet)$ is an isomorphism. This is clear because
$I^\bullet \to J^\bullet$ is a homotopy equivalence, i.e., an
isomorphism in $K(\mathcal{A})$, by
Lemma \ref{lemma-K-injective}.
\end{proof}

\noindent
The following lemma can be generalized to limits over bigger ordinals.

\begin{lemma}
\label{lemma-limit-K-injectives}
\begin{slogan}
The limit of a ``split'' tower of K-injective complexes is K-injective.
\end{slogan}
Let $\mathcal{A}$ be an abelian category. Let
$$
\ldots \to I_3^\bullet \to I_2^\bullet \to I_1^\bullet
$$
be an inverse system of complexes. Assume
\begin{enumerate}
\item each $I_n^\bullet$ is $K$-injective,
\item each map $I_{n + 1}^m \to I_n^m$ is a split surjection,
\item the limits $I^m = \lim I_n^m$ exist.
\end{enumerate}
Then the complex $I^\bullet$ is K-injective.
\end{lemma}

\begin{proof}
We urge the reader to skip the proof of this lemma.
Let $M^\bullet$ be an acyclic complex. Let us abbreviate
$H_n(a, b) = \Hom_\mathcal{A}(M^a, I_n^b)$. With this notation
$\Hom_{K(\mathcal{A})}(M^\bullet, I^\bullet)$ is the cohomology
of the complex
$$
\prod_m \lim\limits_n H_n(m, m - 2)
\to
\prod_m \lim\limits_n H_n(m, m - 1)
\to
\prod_m \lim\limits_n H_n(m, m)
\to
\prod_m \lim\limits_n H_n(m, m + 1)
$$
in the third spot from the left.
We may exchange the order of $\prod$ and $\lim$ and each of the complexes
$$
\prod_m H_n(m, m - 2)
\to
\prod_m H_n(m, m - 1)
\to
\prod_m H_n(m, m)
\to
\prod_m H_n(m, m + 1)
$$
is exact by assumption (1). By assumption (2) the maps in the systems
$$
\ldots \to
\prod_m H_3(m, m - 2) \to
\prod_m H_2(m, m - 2) \to
\prod_m H_1(m, m - 2)
$$
are surjective. Thus the lemma follows from
Homology, Lemma \ref{homology-lemma-apply-Mittag-Leffler}.
\end{proof}

\noindent
It appears that a combination of Lemmas \ref{lemma-special-inverse-system},
\ref{lemma-bounded-below-injectives-K-injective}, and
\ref{lemma-limit-K-injectives} produces ``enough K-injectives'' for any
abelian category with enough injectives and countable products.
Actually, this may not work! See Lemma \ref{lemma-difficulty-K-injectives}
for an explanation.

\begin{lemma}
\label{lemma-adjoint-preserve-K-injectives}
Let $\mathcal{A}$ and $\mathcal{B}$ be abelian categories.
Let $u : \mathcal{A} \to \mathcal{B}$ and
$v : \mathcal{B} \to \mathcal{A}$ be additive functors. Assume
\begin{enumerate}
\item $u$ is right adjoint to $v$, and
\item $v$ is exact.
\end{enumerate}
Then $u$ transforms K-injective complexes into K-injective complexes.
\end{lemma}

\begin{proof}
Let $I^\bullet$ be a K-injective complex of $\mathcal{A}$.
Let $M^\bullet$ be a acyclic complex of $\mathcal{B}$.
As $v$ is exact we see that $v(M^\bullet)$ is an acyclic complex.
By adjointness we get
$$
0 = \Hom_{K(\mathcal{A})}(v(M^\bullet), I^\bullet) =
\Hom_{K(\mathcal{B})}(M^\bullet, u(I^\bullet))
$$
hence the lemma follows.
\end{proof}





\section{Bounded cohomological dimension}
\label{section-bounded}

\noindent
There is another case where the unbounded derived functor exists.
Namely, when the functor has bounded cohomological dimension.

\begin{lemma}
\label{lemma-replace-resolution}
Let $\mathcal{A}$ be an abelian category. Let
$d : \Ob(\mathcal{A}) \to \{0, 1, 2, \ldots, \infty\}$ be a function.
Assume that
\begin{enumerate}
\item every object of $\mathcal{A}$ is a subobject of an
object $A$ with $d(A) = 0$,
\item $d(A \oplus B) \leq \max \{d(A), d(B)\}$ for $A, B \in \mathcal{A}$, and
\item if $0 \to A \to B \to C \to 0$ is short exact, then
$d(C) \leq \max\{d(A) - 1, d(B)\}$.
\end{enumerate}
Let $K^\bullet$ be a complex such that $n + d(K^n)$ tends to $-\infty$
as $n \to -\infty$. Then there exists a quasi-isomorphism
$K^\bullet \to L^\bullet$ with $d(L^n) = 0$ for all $n \in \mathbf{Z}$.
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-subcategory-right-resolution} we can find a
quasi-isomorphism $\sigma_{\geq 0}K^\bullet \to M^\bullet$ with
$M^n = 0$ for $n < 0$ and $d(M^n) = 0$ for $n \geq 0$. Then $K^\bullet$
is quasi-isomorphic to the complex
$$
\ldots \to K^{-2} \to K^{-1} \to M^0 \to M^1 \to \ldots
$$
Hence we may assume that $d(K^n) = 0$ for $n \gg 0$. Note that
the condition $n + d(K^n) \to -\infty$ as $n \to -\infty$ is not
violated by this replacement.

\medskip\noindent
We are going to improve $K^\bullet$ by an (infinite) sequence of
elementary replacements. An {\it elementary replacement} is the following.
Choose an index $n$ such that $d(K^n) > 0$. Choose an injection
$K^n \to M$ where $d(M) = 0$. Set
$M' = \Coker(K^n \to M \oplus K^{n + 1})$. Consider the map of complexes
$$
\xymatrix{
K^\bullet : \ar[d] &
K^{n - 1} \ar[d] \ar[r] &
K^n \ar[d] \ar[r] &
K^{n + 1} \ar[d] \ar[r] &
K^{n + 2} \ar[d] \\
(K')^\bullet : &
K^{n - 1} \ar[r] &
M \ar[r] &
M' \ar[r] &
K^{n + 2}
}
$$
It is clear that $K^\bullet \to (K')^\bullet$ is a quasi-isomorphism.
Moreover, it is clear that $d((K')^n) = 0$ and
$$
d((K')^{n + 1}) \leq \max\{d(K^n) - 1, d(M \oplus K^{n + 1})\} \leq
\max\{d(K^n) - 1, d(K^{n + 1})\}
$$
and the other values are unchanged.

\medskip\noindent
To finish the proof we carefuly choose the order in which to do
the elementary replacements so that for every integer $m$ the complex
$\sigma_{\geq m}K^\bullet$ is changed only a finite number of times.
To do this set
$$
\xi(K^\bullet) = \max \{n + d(K^n) \mid d(K^n) > 0\}
$$
and
$$
I = \{n \in \mathbf{Z} \mid \xi(K^\bullet) = n + d(K^n)
\text{ and }
 d(K^n) > 0\}
$$
Our assumption that $n + d(K^n)$ tends to $-\infty$ as $n \to -\infty$
and the fact that $d(K^n) = 0$ for $n >> 0$
implies $\xi(K^\bullet) < +\infty$ and that $I$ is a finite set.
It is clear that $\xi((K')^\bullet) \leq \xi(K^\bullet)$ for an
elementary transformation as above. An elementary transformation
changes the complex in degrees $\leq \xi(K^\bullet) + 1$. Hence if we can
find finite sequence of elementary transformations which
decrease $\xi(K^\bullet)$, then we win. However, note that if we
do an elementary transformation starting with the smallest element
$n \in I$, then we either decrease the size of $I$, or we increase
$\min I$. Since every element of $I$ is $\leq \xi(K^\bullet)$ we see
that we win after a finite number of steps.
\end{proof}

\begin{lemma}
\label{lemma-unbounded-right-derived}
Let $F : \mathcal{A} \to \mathcal{B}$ be a left exact functor of
abelian categories. If
\begin{enumerate}
\item every object of $\mathcal{A}$ is a subobject of an object
which is right acyclic for $F$,
\item there exists an integer $n$ such that $R^nF = 0$,
\end{enumerate}
then $RF : D(\mathcal{A}) \to D(\mathcal{B})$ exists. Any
complex consisting of right acyclic objects for $F$ computes
$RF$ and any complex is the source of a quasi-isomorphism
into such a complex.
\end{lemma}

\begin{proof}
Note that the first condition implies that
$RF : D^+(\mathcal{A}) \to D^+(\mathcal{B})$ exists, see
Proposition \ref{proposition-enough-acyclics}.
Let $A$ be an object of $\mathcal{A}$. Choose an injection $A \to A'$
with $A'$ acyclic. Then we see that $R^{n + 1}F(A) = R^nF(A'/A) = 0$ by
the long exact cohomology sequence. Hence we conclude that $R^{n + 1}F = 0$.
Continuing like this using induction we find that $R^mF = 0$ for all
$m \geq n$.

\medskip\noindent
We are going to use Lemma \ref{lemma-replace-resolution} with the function
$d : \Ob(\mathcal{A}) \to \{0, 1, 2, \ldots \}$ given by
$d(A) = \max \{0\} \cup \{i \mid R^iF(A) \not = 0\}$.
The first assumption of Lemma \ref{lemma-replace-resolution}
is our assumption (1). The second assumption of
Lemma \ref{lemma-replace-resolution} follows from the fact
that $RF(A \oplus B) = RF(A) \oplus RF(B)$. The third assumption of
Lemma \ref{lemma-replace-resolution} follows from the long exact
cohomology sequence. Hence for every complex $K^\bullet$ there exists a
quasi-isomorphism $K^\bullet \to L^\bullet$ with $L^n$ right acyclic for $F$.
We claim that if $L^\bullet \to M^\bullet$ is a quasi-isomorphism of
complexes of right acyclic objects for $F$, then
$F(L^\bullet) \to F(M^\bullet)$
is a quasi-isomorphism. If we prove this claim then we are done by
Lemma \ref{lemma-find-existence-computes}.
To prove the claim pick an integer $i \in \mathbf{Z}$.
Consider the distinguished triangle
$$
\sigma_{\geq i - n - 1}L^\bullet \to
\sigma_{\geq i - n - 1}M^\bullet \to Q^\bullet,
$$
i.e., let $Q^\bullet$ be the cone of the first map.
Note that $Q^\bullet$ is bounded below and that
$H^j(Q^\bullet)$ is zero except possibly for $j = i - n - 1$
or $j = i - n - 2$. We may apply $RF$ to $Q^\bullet$.
Using the second spectral sequence of
Lemma \ref{lemma-two-ss-complex-functor}
and the assumed vanishing of cohomology (2) we conclude
that $R^jF(Q^\bullet)$ is zero except possibly for
$j \in \{i - n - 2, \ldots, i - 1\}$. Hence we see that
$RF(\sigma_{\geq i - n - 1}L^\bullet) \to RF(\sigma_{\geq i - n - 1}M^\bullet)$
induces an isomorphism of cohomology objects in degrees $\geq i$.
By Proposition \ref{proposition-enough-acyclics} we know that
$RF(\sigma_{\geq i - n - 1}L^\bullet) = \sigma_{\geq i - n - 1}F(L^\bullet)$
and
$RF(\sigma_{\geq i - n - 1}M^\bullet) = \sigma_{\geq i - n - 1}F(M^\bullet)$.
We conclude that $F(L^\bullet) \to F(M^\bullet)$
is an isomorphism in degree $i$ as desired.
\end{proof}

\begin{lemma}
\label{lemma-unbounded-left-derived}
Let $F : \mathcal{A} \to \mathcal{B}$ be a right exact functor of
abelian categories. If
\begin{enumerate}
\item every object of $\mathcal{A}$ is a quotient of an object
which is left acyclic for $F$,
\item there exists an integer $n$ such that $L^nF = 0$,
\end{enumerate}
then $LF : D(\mathcal{A}) \to D(\mathcal{B})$ exists. Any
complex consisting of left acyclic objects for $F$ computes
$LF$ and any complex is the target of a quasi-isomorphism
into such a complex.
\end{lemma}

\begin{proof}
This is dual to Lemma \ref{lemma-unbounded-right-derived}.
\end{proof}






\section{Derived colimits}
\label{section-derived-colimit}

\noindent
In a triangulated category there is a notion of derived colimit.

\begin{definition}
\label{definition-derived-colimit}
Let $\mathcal{D}$ be a triangulated category.
Let $(K_n, f_n)$ be a system of objects of $\mathcal{D}$.
We say an object $K$ is a {\it derived colimit}, or a
{\it homotopy colimit} of the system $(K_n)$ if
the direct sum $\bigoplus K_n$ exists and there is a distinguished triangle
$$
\bigoplus K_n \to \bigoplus K_n \to K \to \bigoplus K_n[1]
$$
where the map $\bigoplus K_n \to \bigoplus K_n$ is given
by $1 - f_n$ in degree $n$. If this is the
case, then we sometimes indicate this by the notation
$K = \text{hocolim} K_n$.
\end{definition}

\noindent
By TR3 a derived colimit, if it exists, is unique up to (non-unique)
isomorphism. Moreover, by TR1 a derived colimit of $K_n$ exists
as soon as $\bigoplus K_n$ exists. The derived category $D(\textit{Ab})$
of the category of abelian groups is an example of a triangulated
category where all homotopy colimits exist.

\medskip\noindent
The nonuniqueness makes it hard to pin down the derived colimit. In
More on Algebra, Lemma \ref{more-algebra-lemma-map-from-hocolim}
the reader finds an exact sequence
$$
0 \to R^1\lim \Hom(K_n, L[-1]) \to \Hom(\text{hocolim} K_n, L)
\to \lim \Hom(K_n, L) \to 0
$$
describing the $\Hom$s out of a homotopy colimit in terms of the
usual $\Hom$s.

\begin{remark}
\label{remark-uniqueness-derived-colimit}
Let $\mathcal{D}$ be a triangulated category.
Let $(K_n, f_n)$ be a system of objects of $\mathcal{D}$.
We may think of a derived colimit as an object $K$
of $\mathcal{D}$ endowed with morphisms $i_n : K_n \to K$
such that $i_{n + 1} \circ f_n = i_n$ and such that there
exists a morphism $c : K \to \bigoplus K_n$ with the property that
$$
\bigoplus K_n \xrightarrow{1 - f_n} \bigoplus K_n \xrightarrow{i_n}
K \xrightarrow{c} \bigoplus K_n[1]
$$
is a distinguished triangle. If $(K', i'_n, c')$ is a second
derived colimit, then there exists an isomorphism
$\varphi : K \to K'$ such that $\varphi \circ i_n = i'_n$ and
$c' \circ \varphi = c$. The existence of $\varphi$ is
TR3 and the fact that $\varphi$ is an isomorphism is
Lemma \ref{lemma-third-isomorphism-triangle}.
\end{remark}

\begin{remark}
\label{remark-functoriality-derived-colimit}
Let $\mathcal{D}$ be a triangulated category.
Let $(a_n) : (K_n, f_n) \to (L_n, g_n)$ be a morphism of systems
of objects of $\mathcal{D}$. Let $(K, i_n, c)$ be a derived
colimit of the first system and let $(L, j_n, d)$ be a derived
colimit of the second system with notation as in
Remark \ref{remark-uniqueness-derived-colimit}.
Then there exists a morphism $a : K \to L$
such that $a \circ i_n = j_n$ and $d \circ a = (a_n[1]) \circ c$.
This follows from TR3 applied to the defining distinguished
triangles.
\end{remark}

\begin{lemma}
\label{lemma-hocolim-subsequence}
Let $\mathcal{D}$ be a triangulated category.
Let $(K_n, f_n)$ be a system of objects of $\mathcal{D}$.
Let $n_1 < n_2 < n_3 < \ldots$ be a sequence of integers.
Assume $\bigoplus K_n$ and $\bigoplus K_{n_i}$ exist.
Then there exists an isomorphism
$\text{hocolim} K_{n_i} \to \text{hocolim} K_n$
such that
$$
\xymatrix{
K_{n_i} \ar[r] \ar[d]_{\text{id}} & \text{hocolim} K_{n_i} \ar[d] \\
K_{n_i} \ar[r] & \text{hocolim} K_n
}
$$
commutes for all $i$.
\end{lemma}

\begin{proof}
Let $g_i : K_{n_i} \to K_{n_{i + 1}}$ be the composition
$f_{n_{i + 1} - 1} \circ \ldots \circ f_{n_i}$.
We construct commutative diagrams
$$
\vcenter{
\xymatrix{
\bigoplus\nolimits_i K_{n_i} \ar[r]_{1 - g_i} \ar[d]_b &
\bigoplus\nolimits_i K_{n_i} \ar[d]^a \\
\bigoplus\nolimits_n K_n \ar[r]^{1 - f_n} &
\bigoplus\nolimits_n K_n
}
}
\quad\text{and}\quad
\vcenter{
\xymatrix{
\bigoplus\nolimits_n K_n \ar[r]_{1 - f_n} \ar[d]_d &
\bigoplus\nolimits_n K_n \ar[d]^c \\
\bigoplus\nolimits_i K_{n_i} \ar[r]^{1 - g_i} &
\bigoplus\nolimits_i K_{n_i}
}
}
$$
as follows. Let $a_i = a|_{K_{n_i}}$ be the inclusion of $K_{n_i}$
into the direct sum. In other words, $a$ is the natural inclusion.
Let $b_i = b|_{K_{n_i}}$ be the map
$$
K_{n_i}
\xrightarrow{1,\ f_{n_i},\ f_{n_i + 1} \circ f_{n_i},
\ \ldots,\ f_{n_{i + 1} - 2} \circ \ldots \circ f_{n_i}}
K_{n_i} \oplus K_{n_i + 1} \oplus \ldots \oplus K_{n_{i + 1} - 1}
$$
If $n_{i - 1} < j \leq n_i$, then we let $c_j = c|_{K_j}$
be the map
$$
K_j \xrightarrow{f_{n_i - 1} \circ \ldots \circ f_j} K_{n_i}
$$
We let $d_j = d|_{K_j}$ be zero if $j \not = n_i$ for any $i$
and we let $d_{n_i}$ be the natural inclusion of $K_{n_i}$
into the direct sum. In other words, $d$ is the natural projection.
By TR3 these diagrams define morphisms
$$
\varphi : \text{hocolim} K_{n_i} \to \text{hocolim} K_n
\quad\text{and}\quad
\psi : \text{hocolim} K_n \to \text{hocolim} K_{n_i}
$$
Since $c \circ a$ and $d \circ b$ are the identity maps we see that
$\varphi \circ \psi$ is an isomorphism by
Lemma \ref{lemma-third-isomorphism-triangle}.
The other way around we get the morphisms $a \circ c$ and $b \circ d$.
Consider the morphism
$h = (h_j) : \bigoplus K_n \to \bigoplus K_n$ given by
the rule: for $n_{i - 1} < j < n_i$ we set
$$
h_j : K_j
\xrightarrow{1,\ f_j,\ f_{j + 1} \circ f_j,
\ \ldots,\ f_{n_i - 1} \circ \ldots \circ f_j}
K_j \oplus \ldots \oplus K_{n_i}
$$
Then the reader verifies that $(1 - f) \circ h = \text{id} - a \circ c$
and $h \circ (1 - f) = \text{id} - b \circ d$. This means that
$\text{id} - \psi \circ \varphi$ has square zero by
Lemma \ref{lemma-third-map-square-zero} (small argument omitted).
In other words, $\psi \circ \varphi$ differs from the identity
by a nilpotent endomorphism, hence is an isomorphism. Thus
$\varphi$ and $\psi$ are isomorphisms as desired.
\end{proof}

\begin{lemma}
\label{lemma-direct-sums}
Let $\mathcal{A}$ be an abelian category.
If $\mathcal{A}$ has exact countable direct sums, then
$D(\mathcal{A})$ has countable direct sums. In fact given
a collection of complexes $K_i^\bullet$ indexed by a countable
index set $I$ the termwise direct sum $\bigoplus K_i^\bullet$
is the direct sum of $K_i^\bullet$ in $D(\mathcal{A})$.
\end{lemma}

\begin{proof}
Let $L^\bullet$ be a complex. Suppose given maps
$\alpha_i : K_i^\bullet \to L^\bullet$ in $D(\mathcal{A})$.
This means there exist quasi-isomorphisms
$s_i : M_i^\bullet \to K_i^\bullet$
of complexes and maps of complexes $f_i : M_i^\bullet \to L^\bullet$
such that $\alpha_i = f_is_i^{-1}$. By assumption the map of complexes
$$
s : \bigoplus M_i^\bullet \longrightarrow \bigoplus K_i^\bullet
$$
is a quasi-isomorphism. Hence setting $f = \bigoplus f_i$ we see that
$\alpha = fs^{-1}$ is a map in $D(\mathcal{A})$ whose composition
with the coprojection $K_i^\bullet \to \bigoplus K_i^\bullet$ is $\alpha_i$.
We omit the verification that $\alpha$ is unique.
\end{proof}

\begin{lemma}
\label{lemma-compute-colimit}
Let $\mathcal{A}$ be an abelian category. Assume colimits over $\mathbf{N}$
exist and are exact. Then countable direct sums exists and are exact.
Moreover, if $(A_n, f_n)$ is a system over $\mathbf{N}$, then there is
a short exact sequence
$$
0 \to \bigoplus A_n \to \bigoplus A_n \to \colim A_n \to 0
$$
where the first map in degree $n$ is given by $1 - f_n$.
\end{lemma}

\begin{proof}
The first statement follows from
$\bigoplus A_n = \colim (A_1 \oplus \ldots \oplus A_n)$.
For the second, note that for each $n$ we have the short exact sequence
$$
0 \to
A_1 \oplus \ldots \oplus A_{n - 1} \to
A_1 \oplus \ldots \oplus A_n \to A_n \to 0
$$
where the first map is given by the maps $1 - f_i$ and the
second map is the sum of the transition maps.
Take the colimit to get the sequence of the lemma.
\end{proof}

\begin{lemma}
\label{lemma-colim-hocolim}
Let $\mathcal{A}$ be an abelian category. Let $L_n^\bullet$
be a system of complexes of $\mathcal{A}$. Assume
colimits over $\mathbf{N}$ exist and are exact in $\mathcal{A}$.
Then the termwise
colimit $L^\bullet = \colim L_n^\bullet$ is a homotopy colimit of the
system in $D(\mathcal{A})$.
\end{lemma}

\begin{proof}
We have an exact sequence of complexes
$$
0 \to \bigoplus L_n^\bullet \to \bigoplus L_n^\bullet \to L^\bullet \to 0
$$
by Lemma \ref{lemma-compute-colimit}.
The direct sums are direct sums in $D(\mathcal{A})$ by
Lemma \ref{lemma-direct-sums}.
Thus the result follows from the definition
of derived colimits in
Definition \ref{definition-derived-colimit}
and the fact that a short exact sequence of complexes
gives a distinguished triangle
(Lemma \ref{lemma-derived-canonical-delta-functor}).
\end{proof}

\begin{lemma}
\label{lemma-cohomology-of-hocolim}
Let $\mathcal{D}$ be a triangulated category having countable
direct sums. Let $\mathcal{A}$ be an abelian category with exact
colimits over $\mathbf{N}$.
Let $H : \mathcal{D} \to \mathcal{A}$ be a homological functor
commuting with countable direct sums.
Then $H(\text{hocolim} K_n) = \colim H(K_n)$
for any system of objects of $\mathcal{D}$.
\end{lemma}

\begin{proof}
Write $K = \text{hocolim} K_n$. Apply $H$ to the defining
distinguished triangle to get
$$
\bigoplus H(K_n) \to \bigoplus H(K_n)
\to H(K) \to
\bigoplus H(K_n[1]) \to \bigoplus H(K_n[1])
$$
where the first map is given by $1 - H(f_n)$ and the last map
is given by $1 - H(f_n[1])$.
Apply Lemma \ref{lemma-compute-colimit} to see that this proves the lemma.
\end{proof}

\noindent
The following lemma tells us that taking maps out of a compact
object (to be defined later) commutes with derived colimits.

\begin{lemma}
\label{lemma-commutes-with-countable-sums}
Let $\mathcal{D}$ be a triangulated category with countable direct sums.
Let $K \in \mathcal{D}$ be an object such that for every
countable set of objects $E_n \in \mathcal{D}$ the canonical map
$$
\bigoplus \Hom_\mathcal{D}(K, E_n)
\longrightarrow
\Hom_\mathcal{D}(K, \bigoplus E_n)
$$
is a bijection. Then, given any system $L_n$ of $\mathcal{D}$ over
$\mathbf{N}$ whose derived colimit $L = \text{hocolim} L_n$
exists we have that
$$
\colim \Hom_\mathcal{D}(K, L_n) \longrightarrow \Hom_\mathcal{D}(K, L)
$$
is a bijection.
\end{lemma}

\begin{proof}
Consider the defining distinguished triangle
$$
\bigoplus L_n \to \bigoplus L_n \to L \to \bigoplus L_n[1]
$$
Apply the cohomological functor $\Hom_\mathcal{D}(K, -)$
(see Lemma \ref{lemma-representable-homological}).
By elementary considerations concerning colimits of abelian groups
we get the result.
\end{proof}






\section{Derived limits}
\label{section-derived-limit}

\noindent
In a triangulated category there is a notion of derived limit.

\begin{definition}
\label{definition-derived-limit}
Let $\mathcal{D}$ be a triangulated category.
Let $(K_n, f_n)$ be an inverse system of objects of $\mathcal{D}$.
We say an object $K$ is a {\it derived limit}, or a
{\it homotopy limit} of the system $(K_n)$ if
the product $\prod K_n$ exists and there is a distinguished triangle
$$
K \to \prod K_n \to \prod K_n \to K[1]
$$
where the map $\prod K_n \to \prod K_n$ is given
by $(k_n) \mapsto (k_n - f_{n+1}(k_{n + 1}))$. If this is the
case, then we sometimes indicate this by the notation $K = R\lim K_n$.
\end{definition}

\noindent
By TR3 a derived limit, if it exists, is unique up to (non-unique)
isomorphism. Moreover, by TR1 a derived limit $R\lim K_n$ exists
as soon as $\prod K_n$ exists. The derived category $D(\textit{Ab})$
of the category of abelian groups is an example of a triangulated category
where all derived limits exist.

\medskip\noindent
The nonuniqueness makes it hard to pin down the derived limit. In
More on Algebra, Lemma \ref{more-algebra-lemma-map-into-Rlim}
the reader finds an exact sequence
$$
0 \to R^1\lim \Hom(L, K_n[-1]) \to \Hom(L, R\lim K_n)
\to \lim \Hom(L, K_n) \to 0
$$
describing the $\Hom$s into a derived limit in terms of the
usual $\Hom$s.

\begin{lemma}
\label{lemma-products}
Let $\mathcal{A}$ be an abelian category with exact
countable products. Then
\begin{enumerate}
\item $D(\mathcal{A})$ has countable products,
\item countable products $\prod K_i$ in $D(\mathcal{A})$ are obtained by
taking termwise products of any complexes representing the $K_i$, and
\item $H^p(\prod K_i) = \prod H^p(K_i)$.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $K_i^\bullet$ be a complex representing $K_i$ in $D(\mathcal{A})$.
Let $L^\bullet$ be a complex. Suppose given maps
$\alpha_i : L^\bullet \to K_i^\bullet$ in $D(\mathcal{A})$.
This means there exist quasi-isomorphisms $s_i : K_i^\bullet \to M_i^\bullet$
of complexes and maps of complexes $f_i : L^\bullet \to M_i^\bullet$
such that $\alpha_i = s_i^{-1}f_i$. By assumption the map of complexes
$$
s : \prod K_i^\bullet \longrightarrow \prod M_i^\bullet
$$
is a quasi-isomorphism. Hence setting $f = \prod f_i$ we see that
$\alpha = s^{-1}f$ is a map in $D(\mathcal{A})$ whose composition
with the projection $\prod K_i^\bullet \to K_i^\bullet$ is $\alpha_i$.
We omit the verification that $\alpha$ is unique.
\end{proof}

\noindent
The duals of Lemmas \ref{lemma-compute-colimit},
\ref{lemma-colim-hocolim}, and
\ref{lemma-commutes-with-countable-sums}
should be stated here and proved. However, we do not know any applications
of these lemmas for now.

\begin{lemma}
\label{lemma-inverse-limit-bounded-below}
Let $\mathcal{A}$ be an abelian category with countable products and
enough injectives. Let $(K_n)$ be an inverse system of $D^+(\mathcal{A})$.
Then $R\lim K_n$ exists.
\end{lemma}

\begin{proof}
It suffices to show that $\prod K_n$ exists in $D(\mathcal{A})$.
For every $n$ we can represent $K_n$ by a bounded below complex
$I_n^\bullet$ of injectives (Lemma \ref{lemma-injective-resolutions-exist}).
Then $\prod K_n$ is represented by $\prod I_n^\bullet$, see
Lemma \ref{lemma-product-K-injective}.
\end{proof}

\begin{lemma}
\label{lemma-difficulty-K-injectives}
Let $\mathcal{A}$ be an abelian category with countable products and
enough injectives. Let $K^\bullet$ be a complex. Let $I_n^\bullet$ be
the inverse system of bounded below complexes of injectives produced by
Lemma \ref{lemma-special-inverse-system}. Then
$I^\bullet = \lim I_n^\bullet$ exists, is K-injective, and
the following are equivalent
\begin{enumerate}
\item the map $K^\bullet \to I^\bullet$ is a quasi-isomorphism,
\item the canonical map $K^\bullet \to R\lim \tau_{\geq -n}K^\bullet$
is an isomorphism in $D(\mathcal{A})$.
\end{enumerate}
\end{lemma}

\begin{proof}
The statement of the lemma makes sense as $R\lim \tau_{\geq -n}K^\bullet$
exists by Lemma \ref{lemma-inverse-limit-bounded-below}.
Each complex $I_n^\bullet$ is K-injective by
Lemma \ref{lemma-bounded-below-injectives-K-injective}.
Choose direct sum decompositions $I_{n + 1}^p = C_{n + 1}^p \oplus I_n^p$
for all $n \geq 1$. Set $C_1^p = I_1^p$. The complex
$I^\bullet = \lim I_n^\bullet$ exists because we can take
$I^p = \prod_{n \geq 1} C_n^p$. Fix $p \in \mathbf{Z}$.
We claim there is a split short exact sequence
$$
0 \to I^p \to \prod I_n^p \to \prod I_n^p \to 0
$$
of objects of $\mathcal{A}$. Here the first map is given by
the projection maps $I^p \to I_n^p$ and the second map
by $(x_n) \mapsto (x_n - f^p_{n + 1}(x_{n + 1}))$ where
$f^p_n : I_n^p \to I_{n - 1}^p$ are the transition maps.
The splitting comes from the map $\prod I_n^p \to \prod C_n^p = I^p$.
We obtain a termwise split short exact sequence of complexes
$$
0 \to I^\bullet \to \prod I_n^\bullet \to \prod I_n^\bullet \to 0
$$
Hence a corresponding distinguished triangle in $K(\mathcal{A})$
and $D(\mathcal{A})$. By Lemma \ref{lemma-product-K-injective}
the products are K-injective and represent the corresponding
products in $D(\mathcal{A})$.
It follows that $I^\bullet$ represents $R\lim I_n^\bullet$
(Definition \ref{definition-derived-limit}).
Moreover, it follows that $I^\bullet$ is K-injective by
Lemma \ref{lemma-triangle-K-injective}.
By the commutative diagram of Lemma \ref{lemma-special-inverse-system}
we obtain a corresponding commutative diagram
$$
\xymatrix{
K^\bullet \ar[r] \ar[d] & R\lim \tau_{\geq -n} K^\bullet \ar[d] \\
I^\bullet \ar[r] & R\lim I_n^\bullet
}
$$
in $D(\mathcal{A})$. Since the right vertical arrow is an isomorphism
(as derived limits are defined on the level of the derived category
and since $\tau_{\geq -n}K^\bullet \to I_n^\bullet$ is a quasi-isomorphism),
the lemma follows.
\end{proof}

\begin{lemma}
\label{lemma-enough-K-injectives-Ab4-star}
Let $\mathcal{A}$ be an abelian category having enough injectives
and exact countable products. Then for every complex
there is a quasi-isomorphism to a K-injective complex.
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-difficulty-K-injectives} it suffices to show that
$K \to R\lim\tau_{\geq -n}K$ is an isomorphism for all $K$ in $D(\mathcal{A})$.
Consider the defining distinguished triangle
$$
R\lim\tau_{\geq -n}K \to
\prod \tau_{\geq -n}K \to
\prod \tau_{\geq -n}K \to
(R\lim\tau_{\geq -n}K)[1]
$$
By Lemma \ref{lemma-products} we have
$$
H^p(\prod \tau_{\geq -n}K) = \prod\nolimits_{p \geq -n} H^p(K)
$$
It follows in a straightforward manner from the long exact cohomology
sequence of the displayed distinguished triangle
that $H^p(R\lim \tau_{\geq -n}K) = H^p(K)$.
\end{proof}




\section{Operations on full subcategories}
\label{section-operate-on-full}

\noindent
Let $\mathcal{T}$ be a triangulated category. We will identify full
subcategories of $\mathcal{T}$ with subsets of $\Ob(\mathcal{T})$.
Given full subcategories $\mathcal{A}, \mathcal{B}, \ldots$ we let
\begin{enumerate}
\item $\mathcal{A}[a, b]$ for $-\infty \leq a \leq b \leq \infty$
be the full subcategory of $\mathcal{T}$ consisting of all objects
$A[-i]$ with $i \in [a, b] \cap \mathbf{Z}$
with $A \in \Ob(\mathcal{A})$ (note the minus sign!),
\item $smd(\mathcal{A})$ be the full subcategory of $\mathcal{T}$
consisting of all objects which are isomorphic to direct summands of objects
of $\mathcal{A}$,
\item $add(\mathcal{A})$ be the full subcategory of $\mathcal{T}$
consisting of all objects which are isomorphic to finite direct sums of objects
of $\mathcal{A}$,
\item $\mathcal{A} \star \mathcal{B}$ be the full subcategory of $\mathcal{T}$
consisting of all objects $X$ of $\mathcal{T}$ which fit into a distinguished
triangle $A \to X \to B$ with $A \in \Ob(\mathcal{A})$ and
$B \in \Ob(\mathcal{B})$,
\item $\mathcal{A}^{\star n} = \mathcal{A} \star \ldots \star \mathcal{A}$
with $n \geq 1$ factors (we will see $\star$ is associative below),
\item $smd(add(\mathcal{A})^{\star n}) =
smd(add(\mathcal{A}) \star \ldots \star add(\mathcal{A}))$
with $n \geq 1$ factors.
\end{enumerate}
If $E$ is an object of $\mathcal{T}$, then we think of $E$ sometimes
also as the full subcategory of $\mathcal{T}$ whose single object is $E$.
Then we can consider things like $add(E[-1, 2])$ and so on and so forth.
We warn the reader that this notation is not universally accepted.

\begin{lemma}
\label{lemma-associativity-star}
Let $\mathcal{T}$ be a triangulated category.
Given full subcategories $\mathcal{A}$, $\mathcal{B}$, $\mathcal{C}$
we have $(\mathcal{A} \star \mathcal{B}) \star \mathcal{C} =
\mathcal{A} \star (\mathcal{B} \star \mathcal{C})$.
\end{lemma}

\begin{proof}
If we have distinguished triangles $A \to X \to B$ and $X \to Y \to C$
then by Axiom TR4 we have distinguished triangles
$A \to Y \to Z$ and $B \to Z \to C$.
\end{proof}

\begin{lemma}
\label{lemma-smd-star}
Let $\mathcal{T}$ be a triangulated category.
Given full subcategories $\mathcal{A}$, $\mathcal{B}$
we have
$smd(\mathcal{A}) \star smd(\mathcal{B}) \subset
smd(\mathcal{A} \star \mathcal{B})$ and
$smd(smd(\mathcal{A}) \star smd(\mathcal{B})) =
smd(\mathcal{A} \star \mathcal{B})$.
\end{lemma}

\begin{proof}
Suppose we have a distinguished triangle $A_1 \to X \to B_1$ where
$A_1 \oplus A_2 \in \Ob(\mathcal{A})$ and $B_1 \oplus B_2 \in \Ob(\mathcal{B})$.
Then we obtain a distinguished triangle
$A_1 \oplus A_2 \to A_2 \oplus X \oplus B_2 \to B_1 \oplus B_2$
which proves that $X$ is in $smd(\mathcal{A} \star \mathcal{B})$.
This proves the inclusion. The equality follows trivially from this.
\end{proof}

\begin{lemma}
\label{lemma-add-star}
Let $\mathcal{T}$ be a triangulated category. Given full subcategories
$\mathcal{A}$, $\mathcal{B}$ the full subcategories
$add(\mathcal{A}) \star add(\mathcal{B})$ and
$smd(add(\mathcal{A}))$ are closed under direct sums.
\end{lemma}

\begin{proof}
Namely, if $A \to X \to B$ and $A' \to X' \to B'$ are distinguished triangles
and $A, A' \in add(\mathcal{A})$ and $B, B' \in add(\mathcal{B})$ then
$A \oplus A' \to X \oplus X' \to B \oplus B'$ is a distinguished triangle
with $A \oplus A' \in add(\mathcal{A})$ and $B \oplus B' \in add(\mathcal{B})$.
The result for $smd(add(\mathcal{A}))$ is trivial.
\end{proof}

\begin{lemma}
\label{lemma-cone-n}
Let $\mathcal{T}$ be a triangulated category. Given a full subcategory
$\mathcal{A}$ for $n \geq 1$ the subcategory
$$
\mathcal{C}_n = smd(add(\mathcal{A})^{\star n}) =
smd(add(\mathcal{A}) \star \ldots \star add(\mathcal{A}))
$$
defined above is a strictly full subcategory of $\mathcal{T}$
closed under direct sums and direct summands and
$\mathcal{C}_{n + m} = smd(\mathcal{C}_n \star \mathcal{C}_m)$
for all $n, m \geq 1$.
\end{lemma}

\begin{proof}
Immediate from Lemmas \ref{lemma-associativity-star}, \ref{lemma-smd-star}, and
\ref{lemma-add-star}.
\end{proof}

\begin{remark}
\label{remark-operations-functor}
Let $F : \mathcal{T} \to \mathcal{T}'$ be an exact functor of triangulated
categories. Given a full subcategory $\mathcal{A}$ of $\mathcal{T}$ we denote
$F(\mathcal{A})$ the full subcategory of $\mathcal{T}'$ whose objects
consists of all objects $F(A)$ with $A \in \Ob(\mathcal{A})$. We have
$$
F(\mathcal{A}[a, b]) = F(\mathcal{A})[a, b]
$$
$$
F(smd(\mathcal{A})) \subset smd(F(\mathcal{A})),
$$
$$
F(add(\mathcal{A})) \subset add(F(\mathcal{A})),
$$
$$
F(\mathcal{A} \star \mathcal{B}) \subset F(\mathcal{A}) \star F(\mathcal{B}),
$$
$$
F(\mathcal{A}^{\star n}) \subset F(\mathcal{A})^{\star n}.
$$
We omit the trivial verifications.
\end{remark}

\begin{remark}
\label{remark-operations-unions}
Let $\mathcal{T}$ be a triangulated category. Given full subcategories
$\mathcal{A}_1 \subset \mathcal{A}_2 \subset \mathcal{A}_3 \subset \ldots$
and $\mathcal{B}$ of $\mathcal{T}$ we have
$$
\left(\bigcup \mathcal{A}_i\right)[a, b] = \bigcup \mathcal{A}_i[a, b]
$$
$$
smd\left(\bigcup \mathcal{A}_i\right) = \bigcup smd(\mathcal{A}_i),
$$
$$
add\left(\bigcup \mathcal{A}_i\right) = \bigcup add(\mathcal{A}_i),
$$
$$
\left(\bigcup \mathcal{A}_i\right) \star \mathcal{B} =
\bigcup \mathcal{A}_i \star \mathcal{B},
$$
$$
\mathcal{B} \star \left(\bigcup \mathcal{A}_i\right) =
\bigcup \mathcal{B} \star \mathcal{A}_i,
$$
$$
\left(\bigcup \mathcal{A}_i\right)^{\star n} =
\bigcup \mathcal{A}_i^{\star n}.
$$
We omit the trivial verifications.
\end{remark}

\begin{lemma}
\label{lemma-in-cone-n}
Let $\mathcal{A}$ be an abelian category. Let $\mathcal{D} = D(\mathcal{A})$.
Let $\mathcal{E} \subset \Ob(\mathcal{A})$ be a subset which we view as
a subset of $\Ob(\mathcal{D})$ also. Let $K$ be an object of $\mathcal{D}$.
\begin{enumerate}
\item Let $b \geq a$ and assume $H^i(K)$ is zero for $i \not \in [a, b]$
and $H^i(K) \in \mathcal{E}$ if $i \in [a, b]$. Then $K$ is in
$smd(add(\mathcal{E}[a, b])^{\star (b - a + 1)})$.
\item Let $b \geq a$ and assume $H^i(K)$ is zero for $i \not \in [a, b]$
and $H^i(K) \in smd(add(\mathcal{E}))$ if $i \in [a, b]$. Then $K$ is in
$smd(add(\mathcal{E}[a, b])^{\star (b - a + 1)})$.
\item Let $b \geq a$ and assume $K$ can be represented by a complex $K^\bullet$
with $K^i = 0$ for $i \not \in [a, b]$ and $K^i \in \mathcal{E}$ for
$i \in [a, b]$. Then $K$ is in
$smd(add(\mathcal{E}[a, b])^{\star (b - a + 1)})$.
\item Let $b \geq a$ and assume $K$ can be represented by a complex $K^\bullet$
with $K^i = 0$ for $i \not \in [a, b]$ and $K^i \in smd(add(\mathcal{E}))$ for
$i \in [a, b]$. Then $K$ is in
$smd(add(\mathcal{E}[a, b])^{\star (b - a + 1)})$.
\end{enumerate}
\end{lemma}

\begin{proof}
We will use Lemma \ref{lemma-cone-n} without further mention.
We will prove (2) which trivially implies (1). We use induction
on $b - a$. If $b - a = 0$, then $K$ is isomorphic to $H^i(K)[-a]$
in $\mathcal{D}$ and the result is immediate. If $b - a > 0$, then
we consider the distinguished triangle
$$
\tau_{\leq b - 1}K^\bullet \to K^\bullet \to K^b[-b]
$$
and we conclude by induction on $b - a$. We omit the proof of (3) and (4).
\end{proof}

\begin{lemma}
\label{lemma-forward-cone-n}
Let $\mathcal{T}$ be a triangulated category. Let
$H : \mathcal{T} \to \mathcal{A}$ be a homological functor
to an abelian category $\mathcal{A}$.
Let $a \leq b$ and $\mathcal{E} \subset \Ob(\mathcal{T})$
be a subset such that $H^i(E) = 0$ for $E \in \mathcal{E}$
and $i \not \in [a, b]$.
Then for $X \in smd(add(\mathcal{E}[-m, m])^{\star n})$
we have $H^i(X) = 0$ for $i \not \in [-m + na, m + nb]$.
\end{lemma}

\begin{proof}
Omitted. Pleasant exercise in the definitions.
\end{proof}





\section{Generators of triangulated categories}
\label{section-generators}

\noindent
In this section we briefly introduce a few of the different notions
of a generator for a triangulated category. Our terminology is
taken from \cite{BvdB} (except that we use ``saturated'' for what
they call ``\'epaisse'', see Definition \ref{definition-saturated}, and
our definition of $add(\mathcal{A})$ is different).

\medskip\noindent
Let $\mathcal{D}$ be a triangulated category. Let $E$ be an object
of $\mathcal{D}$. Denote $\langle E \rangle_1$ the strictly full subcategory
of $\mathcal{D}$ consisting of objects in $\mathcal{D}$ isomorphic to
direct summands of finite direct sums
$$
\bigoplus\nolimits_{i = 1, \ldots, r} E[n_i]
$$
of shifts of $E$. It is clear that in the notation of
Section \ref{section-operate-on-full} we have
$$
\langle E \rangle_1 = smd(add(E[-\infty, \infty]))
$$
For $n > 1$ let $\langle E \rangle_n$ denote the full
subcategory of $\mathcal{D}$ consisting of objects of $\mathcal{D}$
isomorphic to direct summands of objects $X$ which fit into a distinguished
triangle
$$
A \to X \to B \to A[1]
$$
where $A$ is an object of $\langle E \rangle_1$ and $B$ an object of
$\langle E \rangle_{n - 1}$. In the notation of
Section \ref{section-operate-on-full} we have
$$
\langle E \rangle_n = smd(\langle E \rangle_1 \star \langle E \rangle_{n - 1})
$$
Each of the categories $\langle E \rangle_n$ is a strictly full additive
(by Lemma \ref{lemma-add-star}) subcategory of $\mathcal{D}$ preserved
under shifts and under taking summands. But, $\langle E \rangle_n$ is not
necessarily closed under ``taking cones'' or ``extensions'', hence not
necessarily a triangulated subcategory. This will be true for the
subcategory
$$
\langle E \rangle = \bigcup\nolimits_n \langle E \rangle_n
$$
as will be shown in the lemmas below.

\begin{lemma}
\label{lemma-generated-by-E-explicit}
Let $\mathcal{T}$ be a triangulated category. Let $E$ be an object
of $\mathcal{T}$. For $n \geq 1$ we have
$$
\langle E \rangle_n =
smd(\langle E \rangle_1 \star \ldots \star \langle E \rangle_1) =
smd({\langle E \rangle_1}^{\star n}) =
\bigcup\nolimits_{m \geq 1} smd(add(E[-m, m])^{\star n})
$$
For $n, n' \geq 1$ we have $\langle E \rangle_{n + n'} =
smd(\langle E \rangle_n \star \langle E \rangle_{n'})$.
\end{lemma}

\begin{proof}
The left equality in the displayed formula follows from
Lemmas \ref{lemma-associativity-star} and \ref{lemma-smd-star}
and induction. The middle equality is a matter of notation.
Since $\langle E \rangle_1 = smd(add(E[-\infty, \infty])])$
and since $E[-\infty, \infty] = \bigcup_{m \geq 1} E[-m, m]$
we see from Remark \ref{remark-operations-unions} and
Lemma \ref{lemma-smd-star} that we get the equality on the right.
Then the final statement follows from the remark and the
corresponding statement of Lemma \ref{lemma-cone-n}.
\end{proof}

\begin{lemma}
\label{lemma-find-smallest-containing-E}
Let $\mathcal{D}$ be a triangulated category. Let $E$ be an object
of $\mathcal{D}$. The subcategory
$$
\langle E \rangle = \bigcup\nolimits_n \langle E \rangle_n
= \bigcup\nolimits_{n, m \geq 1} smd(add(E[-m, m])^{\star n})
$$
is a strictly full, saturated, triangulated subcategory of $\mathcal{D}$
and it is the smallest such subcategory of $\mathcal{D}$ containing
the object $E$.
\end{lemma}

\begin{proof}
The equality on the right follows from
Lemma \ref{lemma-generated-by-E-explicit}.
It is clear that $\langle E \rangle = \bigcup \langle E \rangle_n$
contains $E$, is preserved under shifts, direct sums, direct summands.
If $A \in \langle E \rangle_a$ and $B \in \langle E \rangle_b$
and if $A \to X \to B \to A[1]$ is a distinguished triangle, then
$X \in \langle E \rangle_{a + b}$ by Lemma \ref{lemma-generated-by-E-explicit}.
Hence $\bigcup \langle E \rangle_n$ is also preserved under extensions
and it follows that it is a triangulated subcategory. 

\medskip\noindent
Finally, let $\mathcal{D}' \subset \mathcal{D}$ be a 
strictly full, saturated, triangulated subcategory of $\mathcal{D}$
containing $E$. Then
$\mathcal{D}'[-\infty, \infty] \subset \mathcal{D}'$,
$add(\mathcal{D}) \subset \mathcal{D}'$,
$smd(\mathcal{D}') \subset \mathcal{D}'$, and
$\mathcal{D}' \star \mathcal{D}' \subset \mathcal{D}'$.
In other words, all the operations we used to construct
$\langle E \rangle$ out of $E$ preserve $\mathcal{D}'$.
Hence $\langle E \rangle \subset \mathcal{D}'$ and this
finishes the proof.
\end{proof}

\begin{definition}
\label{definition-generators}
Let $\mathcal{D}$ be a triangulated category. Let $E$ be an object
of $\mathcal{D}$.
\begin{enumerate}
\item We say $E$ is a {\it classical generator} of $\mathcal{D}$
if the smallest strictly full, saturated, triangulated subcategory
of $\mathcal{D}$ containing $E$ is equal to $\mathcal{D}$, in
other words, if $\langle E \rangle = \mathcal{D}$.
\item We say $E$ is a {\it strong generator} of $\mathcal{D}$
if $\langle E \rangle_n = \mathcal{D}$ for some $n \geq 1$.
\item We say $E$ is a {\it weak generator} or a {\it generator}
of $\mathcal{D}$
if for any nonzero object $K$ of $\mathcal{D}$ there exists
an integer $n$ and a nonzero map $E \to K[n]$.
\end{enumerate}
\end{definition}

\noindent
This definition can be generalized to the case of a family of objects.

\begin{lemma}
\label{lemma-right-orthogonal}
Let $\mathcal{D}$ be a triangulated category. Let $E, K$ be objects
of $\mathcal{D}$. The following are equivalent
\begin{enumerate}
\item $\Hom(E, K[i]) = 0$ for all $i \in \mathbf{Z}$,
\item $\Hom(E', K) = 0$ for all $E' \in \langle E \rangle$.
\end{enumerate}
\end{lemma}

\begin{proof}
The implication (2) $\Rightarrow$ (1) is immediate. Conversely,
assume (1). Then $\Hom(X, K) = 0$ for all $X$ in $\langle E \rangle_1$.
Arguing by induction on $n$ and using
Lemma \ref{lemma-representable-homological}
we see that $\Hom(X, K) = 0$ for all $X$
in $\langle E \rangle_n$.
\end{proof}

\begin{lemma}
\label{lemma-classical-generator-generator}
Let $\mathcal{D}$ be a triangulated category. Let $E$ be an object
of $\mathcal{D}$. If $E$ is a classical generator of $\mathcal{D}$,
then $E$ is a generator.
\end{lemma}

\begin{proof}
Assume $E$ is a classical generator. Let $K$ be an object of $\mathcal{D}$
such that $\Hom(E, K[i]) = 0$ for all $i \in \mathbf{Z}$. By
Lemma \ref{lemma-right-orthogonal}
$\Hom(E', K) = 0$ for all $E'$ in $\langle E \rangle$. However, since
$\mathcal{D} = \langle E \rangle$ we conclude that $\text{id}_K = 0$,
i.e., $K = 0$.
\end{proof}

\begin{lemma}
\label{lemma-classical-generator-strong-generator}
Let $\mathcal{D}$ be a triangulated category which has a strong generator.
Let $E$ be an object of $\mathcal{D}$. If $E$ is a classical generator of
$\mathcal{D}$, then $E$ is a strong generator.
\end{lemma}

\begin{proof}
Let $E'$ be an object of $\mathcal{D}$ such that
$\mathcal{D} = \langle E' \rangle_n$. Since
$\mathcal{D} = \langle E \rangle$ we see that $E' \in \langle E \rangle_m$
for some $m \geq 1$ by Lemma \ref{lemma-find-smallest-containing-E}.
Then $\langle E' \rangle_1 \subset \langle E \rangle_m$ hence
$$
\mathcal{D} =
\langle E' \rangle_n = smd(
\langle E' \rangle_1 \star \ldots \star \langle E' \rangle_1)
\subset
smd(
\langle E \rangle_m \star \ldots \star \langle E \rangle_m)
=
\langle E \rangle_{nm}
$$
as desired. Here we used Lemma \ref{lemma-generated-by-E-explicit}.
\end{proof}

\begin{remark}
\label{remark-check-on-generator}
Let $\mathcal{D}$ be a triangulated category. Let $E$ be an object
of $\mathcal{D}$. Let $T$ be a property of objects of $\mathcal{D}$.
Suppose that
\begin{enumerate}
\item if $K_i \in D(A)$, $i = 1, \ldots, r$ with
$T(K_i)$ for $i = 1, \ldots, r$, then $T(\bigoplus K_i)$,
\item if $K \to L \to M \to K[1]$ is a distinguished triangle and
$T$ holds for two, then $T$ holds for the third object,
\item if $T(K \oplus L)$ then $T(K)$ and $T(L)$, and
\item $T(E[n])$ holds for all $n$.
\end{enumerate}
Then $T$ holds for all objects of $\langle E \rangle$.
\end{remark}












\section{Compact objects}
\label{section-compact}

\noindent
Here is the definition.

\begin{definition}
\label{definition-compact-object}
Let $\mathcal{D}$ be an additive category with arbitrary direct
sums. A {\it compact object} of $\mathcal{D}$ is an object $K$
such that the map
$$
\bigoplus\nolimits_{i \in I} \Hom_{\mathcal{D}}(K, E_i)
\longrightarrow
\Hom_{\mathcal{D}}(K, \bigoplus\nolimits_{i \in I} E_i)
$$
is bijective for any set $I$ and objects
$E_i \in \Ob(\mathcal{D})$ parametrized by $i \in I$.
\end{definition}

\noindent
This notion turns out to be very useful in algebraic geometry.
It is an intrinsic condition on objects that forces the objects
to be, well, compact.

\begin{lemma}
\label{lemma-compact-objects-subcategory}
Let $\mathcal{D}$ be a (pre-)triangulated category with direct sums.
Then the compact objects of $\mathcal{D}$ form the objects of a
Karoubian, saturated, strictly full, (pre-)triangulated subcategory
$\mathcal{D}_c$ of $\mathcal{D}$.
\end{lemma}

\begin{proof}
Let $(X, Y, Z, f, g, h)$ be a distinguished triangle of $\mathcal{D}$
with $X$ and $Y$ compact. Then it follows from
Lemma \ref{lemma-representable-homological}
and the five lemma
(Homology, Lemma \ref{homology-lemma-five-lemma})
that $Z$ is a compact object too. It is clear that if $X \oplus Y$
is compact, then $X$, $Y$ are compact objects too. Hence
$\mathcal{D}_c$ is a saturated triangulated subcategory.
Since $\mathcal{D}$ is Karoubian by
Lemma \ref{lemma-projectors-have-images-triangulated}
we conclude that the same is true for $\mathcal{D}_c$.
\end{proof}

\begin{lemma}
\label{lemma-write-as-colimit}
Let $\mathcal{D}$ be a triangulated category with direct sums.
Let $E_i$, $i \in I$ be a family of compact objects of $\mathcal{D}$
such that $\bigoplus E_i$ generates $\mathcal{D}$.
Then every object $X$ of $\mathcal{D}$ can be written as
$$
X = \text{hocolim} X_n
$$
where $X_1$ is a direct sum of shifts of the $E_i$ and each transition
morphism fits into a distinguished triangle
$Y_n \to X_n \to X_{n + 1} \to Y_n[1]$
where $Y_n$ is a direct sum of shifts of the $E_i$.
\end{lemma}

\begin{proof}
Set $X_1 = \bigoplus_{(i, m, \varphi)} E_i[m]$ where the direct sum is over
all triples $(i, m, \varphi)$ such that $i \in I$, $m \in \mathbf{Z}$
and $\varphi : E_i[m] \to X$. Then $X_1$ comes equipped with a canonical
morphism $X_1 \to X$. Given $X_n \to X$ we set
$Y_n = \bigoplus_{(i, m, \varphi)} E_i[m]$ where the direct sum is over
all triples $(i, m, \varphi)$ such that $i \in I$, $m \in \mathbf{Z}$, and
$\varphi : E_i[m] \to X_n$ is a morphism such that $E_i[m] \to X_n \to X$
is zero. Choose a distinguished triangle
$Y_n \to X_n \to X_{n + 1} \to Y_n[1]$
and let $X_{n + 1} \to X$ be any morphism such that $X_n \to X_{n + 1} \to X$
is the given one; such a morphism exists by our choice of $Y_n$.
We obtain a morphism $\text{hocolim} X_n \to X$ by the construction
of our maps $X_n \to X$. Choose a distinguished triangle
$$
C \to \text{hocolim} X_n \to X \to C[1]
$$
Let $E_i[m] \to C$ be a morphism. Since $E_i$ is compact, the
composition $E_i[m] \to C \to \text{hocolim} X_n$ factors through
$X_n$ for some $n$, say by $E_i[m] \to X_n$. Then the
construction of $Y_n$ shows that the composition
$E_i[m] \to X_n \to X_{n + 1}$ is zero. In other words, the composition
$E_i[m] \to C \to \text{hocolim} X_n$ is zero. This means that our
morphism $E_i[m] \to C$ comes from a morphism $E_i[m] \to X[-1]$.
The construction of $X_1$ then shows that such morphism lifts to
$\text{hocolim} X_n$ and we conclude that our morphism $E_i[m] \to C$
is zero. The assumption that $\bigoplus E_i$ generates $\mathcal{D}$
implies that $C$ is zero and the proof is done.
\end{proof}

\begin{lemma}
\label{lemma-factor-through}
With assumptions and notation as in Lemma \ref{lemma-write-as-colimit}.
If $C$ is a compact object and $C \to X_n$ is a morphism, then
there is a factorization $C \to E \to X_n$ where
$E$ is an object of $\langle E_{i_1} \oplus \ldots \oplus E_{i_t} \rangle$
for some $i_1, \ldots, i_t \in I$.
\end{lemma}

\begin{proof}
We prove this by induction on $n$. The base case $n = 1$ is clear.
If $n > 1$ consider the composition $C \to X_n \to Y_{n - 1}[1]$.
This can be factored through some $E'[1] \to Y_{n - 1}[1]$ where
$E'$ is a finite direct sum of shifts of the $E_i$. Let $I' \subset I$
be the finite set of indices that occur in this direct sum. Thus we obtain
$$
\xymatrix{
E' \ar[r] \ar[d] &
C' \ar[r] \ar[d] &
C \ar[r] \ar[d] &
E'[1] \ar[d] \\
Y_{n - 1} \ar[r] &
X_{n - 1} \ar[r] &
X_n \ar[r] &
Y_{n - 1}[1]
}
$$
By induction the morphism $C' \to X_{n - 1}$ factors through
$E'' \to X_{n - 1}$ with $E''$ an object of
$\langle \bigoplus_{i \in I''} E_i \rangle$
for some finite subset $I'' \subset I$. Choose a distinguished
triangle
$$
E' \to E'' \to E \to E'[1]
$$
then $E$ is an object of $\langle \bigoplus_{i \in I' \cup I''} E_i \rangle$.
By construction and the axioms of a triangulated category we can choose
morphisms $C \to E$ and a morphism $E \to X_n$ fitting into morphisms
of triangles $(E', C', C) \to (E', E'', E)$ and
$(E', E'', E) \to (Y_{n - 1}, X_{n - 1}, X_n)$. The composition
$C \to E \to X_n$ may not equal the given morphism $C \to X_n$, but
the compositions into $Y_{n - 1}$ are equal. Let $C \to X_{n - 1}$
be a morphism that lifts the difference. By induction assumption we
can factor this through a morphism $E''' \to X_{n - 1}$ with
$E''$ an object of $\langle \bigoplus_{i \in I'''} E_i \rangle$
for some finite subset $I' \subset I$. Thus we see that we get
a solution on considering $E \oplus E''' \to X_n$ because
$E \oplus E'''$ is an object of
$\langle \bigoplus_{i \in I' \cup I'' \cup I'''} E_i \rangle$.
\end{proof}

\begin{definition}
\label{definition-compactly-generated}
Let $\mathcal{D}$ be a triangulated category with arbitrary direct
sums. We say $\mathcal{D}$ is {\it compactly generated} if
there exists a set $E_i$, $i \in I$ of compact objects such that
$\bigoplus E_i$ generates $\mathcal{D}$.
\end{definition}

\noindent
The following proposition clarifies the relationship between
classical generators and weak generators.

\begin{proposition}
\label{proposition-generator-versus-classical-generator}
Let $\mathcal{D}$ be a triangulated category with direct sums.
Let $E$ be a compact object of $\mathcal{D}$.
The following are equivalent
\begin{enumerate}
\item $E$ is a classical generator for $\mathcal{D}_c$ and
$\mathcal{D}$ is compactly generated, and
\item $E$ is a generator for $\mathcal{D}$.
\end{enumerate}
\end{proposition}

\begin{proof}
If $E$ is a classical generator for $\mathcal{D}_c$, then
$\mathcal{D}_c = \langle E \rangle$. It follows formally
from the assumption that $\mathcal{D}$ is compactly generated
and Lemma \ref{lemma-right-orthogonal} that $E$ is a generator
for $\mathcal{D}$.

\medskip\noindent
The converse is more interesting. Assume that $E$ is a generator
for $\mathcal{D}$. Let $X$ be a compact object of $\mathcal{D}$.
Apply Lemma \ref{lemma-write-as-colimit} with $I = \{1\}$ and
$E_1 = E$ to write
$$
X = \text{hocolim} X_n
$$
as in the lemma. Since $X$ is compact we
find that $X \to \text{hocolim} X_n$ factors through $X_n$ for
some $n$ (Lemma \ref{lemma-commutes-with-countable-sums}).
Thus $X$ is a direct summand of $X_n$.
By Lemma \ref{lemma-factor-through} we see that $X$ is an
object of $\langle E \rangle$ and the lemma is proven.
\end{proof}











\section{Brown representability}
\label{section-brown}

\noindent
A reference for the material in this section is \cite{Neeman-Grothendieck}.

\begin{lemma}
\label{lemma-brown}
\begin{reference}
\cite[Theorem 3.1]{Neeman-Grothendieck}.
\end{reference}
Let $\mathcal{D}$ be a triangulated category with direct sums which is
compactly generated. Let $H : \mathcal{D} \to \textit{Ab}$ be a contravariant
cohomological functor which transforms direct sums into products.
Then $H$ is representable.
\end{lemma}

\begin{proof}
Let $E_i$, $i \in I$ be a set of compact objects such that
$\bigoplus_{i \in I} E_i$ generates $\mathcal{D}$. We may and do assume
that the set of objects $\{E_i\}$ is preserved under shifts. Consider pairs
$(i, a)$ where $i \in I$ and $a \in H(E_i)$ and set
$$
X_1 = \bigoplus\nolimits_{(i, a)} E_i
$$
Since $H(X_1) = \prod_{(i, a)} H(E_i)$ we see that $(a)_{(i, a)}$
defines an element $a_1 \in H(X_1)$. Set $H_1 = \Hom_\mathcal{D}(- , X_1)$.
By Yoneda's lemma (Categories, Lemma \ref{categories-lemma-yoneda})
the element $a_1$ defines a natural transformation $H_1 \to H$.

\medskip\noindent
We are going to inductively construct $X_n$ and transformations
$a_n : H_n \to H$ where $H_n = \Hom_\mathcal{D}(-, X_n)$.
Namely, we apply the procedure
above to the functor $\Ker(H_n \to H)$ to get an object
$$
K_{n + 1} = \bigoplus\nolimits_{(i, k),\ k \in \Ker(H_n(E_i) \to H(E_i))} E_i
$$
and a transformation $\Hom_\mathcal{D}(-, K_{n + 1}) \to \Ker(H_n \to H)$.
By Yoneda's lemma the composition $\Hom_\mathcal{D}(-, K_{n + 1}) \to H_n$
gives a morphism $K_{n + 1} \to X_n$. We choose
a distinguished triangle
$$
K_{n + 1} \to X_n \to X_{n + 1} \to K_{n + 1}[1]
$$
in $\mathcal{D}$. The element $a_n \in H(X_n)$ maps to zero
in $H(K_{n + 1})$ by construction. Since $H$ is cohomological
we can lift it to an element $a_{n + 1} \in H(X_{n + 1})$.

\medskip\noindent
We claim that $X = \text{hocolim} X_n$ represents $H$. Applying $H$
to the defining distinguished triangle
$$
\bigoplus X_n \to
\bigoplus X_n \to X \to
\bigoplus X_n[1]
$$
we obtain an exact sequence
$$
\prod H(X_n) \leftarrow 
\prod H(X_n) \leftarrow 
H(X)
$$
Thus there exists an element $a \in H(X)$ mapping to $(a_n)$
in $\prod H(X_n)$. Hence a natural transformation
$\Hom_\mathcal{D}(- , X) \to H$ such that
$$
\Hom_\mathcal{D}(-, X_1) \to
\Hom_\mathcal{D}(-, X_2) \to
\Hom_\mathcal{D}(-, X_3) \to \ldots \to
\Hom_\mathcal{D}(-, X) \to H
$$
commutes. For each $i$ the map $\Hom_\mathcal{D}(E_i, X) \to H(E_i)$
is surjective, by construction of $X_1$. On the other hand, by construction
of $X_n \to X_{n + 1}$ the kernel of $\Hom_\mathcal{D}(E_i, X_n) \to H(E_i)$
is killed by the map
$\Hom_\mathcal{D}(E_i, X_n) \to \Hom_\mathcal{D}(E_i, X_{n + 1})$.
Since
$$
\Hom_\mathcal{D}(E_i, X) = \colim \Hom_\mathcal{D}(E_i, X_n)
$$
by Lemma \ref{lemma-commutes-with-countable-sums}
we see that $\Hom_\mathcal{D}(E_i, X) \to H(E_i)$ is injective.

\medskip\noindent
To finish the proof, consider the subcategory
$$
\mathcal{D}' =
\{Y \in \Ob(\mathcal{D}) \mid \Hom_\mathcal{D}(Y[n], X) \to H(Y[n])
\text{ is an isomorphism for all }n\}
$$
As $\Hom_\mathcal{D}(-, X) \to H$ is a transformation between
cohomological functors,
the subcategory $\mathcal{D}'$ is a strictly full, saturated, triangulated
subcategory of $\mathcal{D}$ (details omitted; see proof of
Lemma \ref{lemma-homological-functor-kernel}). Moreover, as both
$H$ and $\Hom_\mathcal{D}(-, X)$ transform direct sums into products,
we see that direct sums of objects of $\mathcal{D}'$ are in $\mathcal{D}'$.
Thus derived colimits of objects of $\mathcal{D}'$ are in $\mathcal{D}'$.
Since $\{E_i\}$ is preserved under shifts, we see that $E_i$
is an object of $\mathcal{D}'$ for all $i$. It follows from
Lemma \ref{lemma-write-as-colimit} that $\mathcal{D}' = \mathcal{D}$
and the proof is complete.
\end{proof}

\begin{proposition}
\label{proposition-brown}
\begin{reference}
\cite[Theorem 4.1]{Neeman-Grothendieck}.
\end{reference}
Let $\mathcal{D}$ be a triangulated category with direct sums which is
compactly generated. Let $F : \mathcal{D} \to \mathcal{D}'$ be an
exact functor of triangulated categories which transforms direct sums
into direct sums. Then $F$ has an exact right adjoint.
\end{proposition}

\begin{proof}
For an object $Y$ of $\mathcal{D}'$ consider the contravariant functor
$$
\mathcal{D} \to \textit{Ab},\quad W \mapsto \Hom_{\mathcal{D}'}(F(W), Y)
$$
This is a cohomological functor as $F$ is exact and transforms direct sums
into products as $F$ transforms direct sums into direct sums. Thus by
Lemma \ref{lemma-brown} we find an object $X$ of $\mathcal{D}$ such that
$\Hom_\mathcal{D}(W, X) = \Hom_{\mathcal{D}'}(F(W), Y)$.
The existence of the adjoint follows from
Categories, Lemma \ref{categories-lemma-adjoint-exists}.
Exactness follows from Lemma \ref{lemma-adjoint-is-exact}.
\end{proof}







\section{Admissible subcategories}
\label{section-admissible}

\noindent
A reference for this section is \cite[Section 1]{Bondal-Kapranov}.

\begin{definition}
\label{definition-orthogonal}
Let $\mathcal{D}$ be an additive category. Let $\mathcal{A} \subset \mathcal{D}$
be a full subcategory. The {\it right orthogonal} $\mathcal{A}^\perp$ of
$\mathcal{A}$ is the full subcategory consisting of the objects $X$ of
$\mathcal{D}$ such that $\Hom(A, X) = 0$ for all $A \in \Ob(\mathcal{A})$.
The {\it left orthogonal} ${}^\perp\mathcal{A}$ of
$\mathcal{A}$ is the full subcategory consisting of the objects $X$ of
$\mathcal{D}$ such that $\Hom(X, A) = 0$ for all $A \in \Ob(\mathcal{A})$.
\end{definition}

\begin{lemma}
\label{lemma-pre-prepare-adjoint}
Let $\mathcal{D}$ be a triangulated category.
Let $\mathcal{A} \subset \mathcal{D}$
be a full subcategory invariant under all shifts.
Consider a distinguished triangle
$$
X \to Y \to Z \to X[1]
$$
of $\mathcal{D}$. The following are equivalent
\begin{enumerate}
\item $Z$ is in $\mathcal{A}^\perp$, and
\item $\Hom(A, X) = \Hom(A, Y)$ for all $A \in \Ob(\mathcal{A})$.
\end{enumerate}
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-representable-homological} the functor
$\Hom(A, -)$ is homological and hence we get a long exact sequence
as in (\ref{equation-long-exact-cohomology-sequence}).
Assume (1) and let $A \in \Ob(\mathcal{A})$.
Then we consider the exact sequence
$$
\Hom(A[1], Z) \to \Hom(A, X) \to \Hom(A, Y) \to \Hom(A, Z)
$$
Since $A[1] \in \Ob(\mathcal{A})$
we see that the first and last groups are zero.
Thus we get (2). Assume (2) and let $A \in \Ob(\mathcal{A})$.
Then we consider the exact sequence
$$
\Hom(A, X) \to \Hom(A, Y) \to \Hom(A, Z) \to \Hom(A[-1], X) \to \Hom(A[-1], Y)
$$
and we conclude that $\Hom(A, Z) = 0$ as desired.
\end{proof}

\begin{lemma}
\label{lemma-orthogonal-triangulated}
Let $\mathcal{D}$ be a triangulated category. Let
$\mathcal{A} \subset \mathcal{D}$ be a full subcategory invariant
under all shifts. Then both the right orthogonal $\mathcal{A}^\perp$ and
the left orthogonal ${}^\perp\mathcal{A}$ of $\mathcal{A}$
are strictly full, saturated\footnote{Definition \ref{definition-saturated}.},
triangulated subcagories of $\mathcal{D}$.
\end{lemma}

\begin{proof}
It is immediate from the definitions that the orthogonals are preserved
under taking shifts, direct sums, and direct summands.
Consider a distinguished triangle
$$
X \to Y \to Z \to X[1]
$$
of $\mathcal{D}$. By Lemma \ref{lemma-triangulated-subcategory} it
suffices to show that if $X$ and $Y$ are in $\mathcal{A}^\perp$, then
$Z$ is in $\mathcal{A}^\perp$. This is immediate from
Lemma \ref{lemma-pre-prepare-adjoint}.
\end{proof}

\begin{lemma}
\label{lemma-prepare-adjoint}
Let $\mathcal{D}$ be a triangulated category. Let $\mathcal{A}$
be a full triangulated subcategory of $\mathcal{D}$. For an object $X$
of $\mathcal{D}$ consider the property $P(X)$: there exists a
distinguished triangle $A \to X \to B \to A[1]$
in $\mathcal{D}$ with $A$ in $\mathcal{A}$ and $B$ in $\mathcal{A}^\perp$.
\begin{enumerate}
\item If $X_1 \to X_2 \to X_3 \to X_1[1]$ is a distinguished triangle
and $P$ holds for two out of three, then it holds for the third.
\item If $P$ holds for $X_1$ and $X_2$, then it holds for $X_1 \oplus X_2$.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $X_1 \to X_2 \to X_3 \to X_1[1]$ be a distinguished triangle
and assume $P$ holds for $X_1$ and $X_2$. Choose distinguished triangles
$$
A_1 \to X_1 \to B_1 \to A_1[1]
\quad\text{and}\quad
A_2 \to X_2 \to B_2 \to A_2[1]
$$
as in condition $P$. Since
$\Hom(A_1, A_2) = \Hom(A_1, X_2)$ by Lemma \ref{lemma-pre-prepare-adjoint}
there is a unique morphism $A_1 \to A_2$ such that the diagram
$$
\xymatrix{
A_1 \ar[d] \ar[r] & X_1 \ar[d] \\
A_2 \ar[r] & X_2
}
$$
commutes. Choose an extension of this to a diagram
$$
\xymatrix{
A_1 \ar[r] \ar[d] & X_1 \ar[r] \ar[d] & Q_1 \ar[r] \ar[d] & A_1[1] \ar[d] \\
A_2 \ar[r] \ar[d] & X_2 \ar[r] \ar[d] & Q_2 \ar[r] \ar[d] & A_2[1] \ar[d] \\
A_3 \ar[r] \ar[d] & X_3 \ar[r] \ar[d] & Q_3 \ar[r] \ar[d] & A_3[1] \ar[d] \\
A_1[1] \ar[r] & X_1[1] \ar[r] & Q_1[1] \ar[r] & A_1[2]
}
$$
as in Proposition \ref{proposition-9}. By TR3 we see that
$Q_1 \cong B_1$ and $Q_2 \cong B_2$ and hence
$Q_1, Q_2 \in \Ob(\mathcal{A}^\perp)$.
As $Q_1 \to Q_2 \to Q_3 \to Q_1[1]$
is a distinguished triangle we see that $Q_3 \in \Ob(\mathcal{A}^\perp)$
by Lemma \ref{lemma-orthogonal-triangulated}.
Since $\mathcal{A}$ is a full triangulated subcategory, we see that
$A_3$ is isomorphic to an object of $\mathcal{A}$.
Thus $X_3$ satisfies $P$. The other cases of (1) follow from this
case by translation. Part (2) is a special case of (1)
via Lemma \ref{lemma-split}.
\end{proof}

\begin{lemma}
\label{lemma-right-adjoint}
Let $\mathcal{D}$ be a triangulated category. Let
$\mathcal{A} \subset \mathcal{D}$ be a full triangulated subcategory.
The following are equivalent
\begin{enumerate}
\item the inclusion functor $\mathcal{A} \to \mathcal{D}$
has a right adjoint, and
\item for every $X$ in $\mathcal{D}$ there exists a distinguished
triangle
$$
A \to X \to B \to X'[1]
$$
in $\mathcal{D}$ with $A \in \Ob(\mathcal{A})$ and
$B \in \Ob(\mathcal{A}^\perp)$.
\end{enumerate}
If this holds, then $\mathcal{A}$ is saturated
(Definition \ref{definition-saturated}) and if $\mathcal{A}$
is strictly full in $\mathcal{D}$, then
$\mathcal{A} = {}^\perp(\mathcal{A}^\perp)$.
\end{lemma}

\begin{proof}
Assume (1) and denote $v : \mathcal{D} \to \mathcal{A}$ the right adjoint.
Let $X \in \Ob(\mathcal{D})$. Set $A = v(X)$. We may extend the
adjunction mapping $A \to X$ to a distinguished triangle
$A \to X \to B \to A[1]$. Since
$$
\Hom_\mathcal{A}(A', A) =
\Hom_\mathcal{A}(A', v(X)) =
\Hom_\mathcal{D}(A', X)
$$
for $A' \in \Ob(\mathcal{A})$, we conclude that $B \in \Ob(\mathcal{A}^\perp)$
by Lemma \ref{lemma-pre-prepare-adjoint}.

\medskip\noindent
Assume (2). We will contruct the adjoint $v$ explictly.
Let $X \in \Ob(\mathcal{D})$. Choose $A \to X \to B \to A[1]$ as in (2).
Set $v(X) = A$. Let $f : X \to Y$ be a morphism in $\mathcal{D}$.
Choose $A' \to Y \to B' \to A'[1]$ as in (2). Since
$\Hom(A, A') = \Hom(A, Y)$ by Lemma \ref{lemma-pre-prepare-adjoint}
there is a unique morphism $f' : A \to A'$ such that the diagram
$$
\xymatrix{
A \ar[d]_{f'} \ar[r] & X \ar[d]^f \\
A' \ar[r] & Y
}
$$
commutes. Hence we can set $v(f) = f'$ to get a functor.
To see that $v$ is adjoint to the inclusion morphism use
Lemma \ref{lemma-pre-prepare-adjoint} again.

\medskip\noindent
Proof of the final statement. In other to prove that $\mathcal{A}$
is saturated we may replace $\mathcal{A}$ by the strictly full
subcategory having the same isomorphism classes as $\mathcal{A}$;
details omitted. Assume $\mathcal{A}$ is strictly full. If we show that
$\mathcal{A} = {}^\perp(\mathcal{A}^\perp)$, then
$\mathcal{A}$ will be saturated by Lemma \ref{lemma-orthogonal-triangulated}.
Since the incusion $\mathcal{A} \subset {}^\perp(\mathcal{A}^\perp)$
is clear it suffices to prove the other inclusion.
Let $X$ be an object of ${}^\perp(\mathcal{A}^\perp)$.
Choose a distinguished triangle $A \to X \to B \to A[1]$
as in (2). As $\Hom(X, B) = 0$ by assumption we see that
$A \cong X \oplus B[-1]$ by Lemma \ref{lemma-split}.
Since $\Hom(A, B[-1]) = 0$ as $B \in \mathcal{A}^\perp$
this implies $B[-1] = 0$ and $A \cong X$ as desired.
\end{proof}

\begin{lemma}
\label{lemma-left-adjoint}
Let $\mathcal{D}$ be a triangulated category. Let
$\mathcal{A} \subset \mathcal{D}$ be a full triangulated subcategory.
The following are equivalent
\begin{enumerate}
\item the inclusion functor $\mathcal{A} \to \mathcal{D}$
has a left adjoint, and
\item for every $X$ in $\mathcal{D}$ there exists a distinguished
triangle
$$
B \to X \to A \to K[1]
$$
in $\mathcal{D}$ with $A \in \Ob(\mathcal{A})$ and
$B \in \Ob({}^\perp\mathcal{A})$.
\end{enumerate}
If this holds, then $\mathcal{A}$ is saturated
(Definition \ref{definition-saturated}) and if $\mathcal{A}$
is strictly full in $\mathcal{D}$, then
$\mathcal{A} = ({}^\perp\mathcal{A})^\perp$.
\end{lemma}

\begin{proof}
Omitted. Dual to Lemma \ref{lemma-right-adjoint}.
\end{proof}

\begin{definition}
\label{definition-admissible}
Let $\mathcal{D}$ be a triangulated category. A {\it right admissible}
subcategory of $\mathcal{D}$ is a strictly full triangulated subcategory
satisfying the equivalent conditions of Lemma \ref{lemma-right-adjoint}.
A {\it left admissible}
subcategory of $\mathcal{D}$ is a strictly full triangulated subcategory
satisfying the equivalent conditions of Lemma \ref{lemma-left-adjoint}.
A {\it two-sided admissible} subcategory is one which is both
right and left admissible.
\end{definition}






\section{Postnikov systems}
\label{section-postnikov}

\noindent
A reference for this section is \cite{Orlov-K3}. Let $\mathcal{D}$
be a triangulated category. Let
$$
X_n \to X_{n - 1} \to \ldots \to X_0
$$
be a complex in $\mathcal{D}$. In this section we consider the problem
of constructing a ``totalization'' of this complex.

\begin{definition}
\label{definition-postnikov-system}
Let $\mathcal{D}$ be a triangulated category. Let
$$
X_n \to X_{n - 1} \to \ldots \to X_0
$$
be a complex in $\mathcal{D}$. A {\it Postnikov system} is defined
inductively as follows.
\begin{enumerate}
\item If $n = 0$, then it is an isomorphism $Y_0 \to X_0$.
\item If $n = 1$, then it is a choice of a distinguished triangle
$$
Y_1 \to X_1 \to Y_0 \to Y_1[1]
$$
where $X_1 \to Y_0$ composed with $Y_0 \to X_0$ is the given morphism
$X_1 \to X_0$.
\item If $n > 1$, then it is a choice of a Postnikov system
for $X_{n - 1} \to \ldots \to X_0$ and a choice of a distinguished
triangle
$$
Y_n \to X_n \to Y_{n - 1} \to Y_n[1]
$$
where the morphism $X_n \to Y_{n - 1}$ composed with
$Y_{n - 1} \to X_{n - 1}$ is the given morphism $X_n \to X_{n - 1}$.
\end{enumerate}
Given a morphism
\begin{equation}
\label{equation-map-complexes}
\vcenter{
\xymatrix{
X_n \ar[r] \ar[d] &
X_{n - 1} \ar[r] \ar[d] &
\ldots \ar[r] &
X_0 \ar[d] \\
X'_n \ar[r] &
X'_{n - 1} \ar[r] &
\ldots \ar[r] &
X'_0
}
}
\end{equation}
between complexes of the same length in $\mathcal{D}$
there is an obvious notion of a {\it morphism of Postnikov systems}.
\end{definition}

\noindent
Here is a key example.

\begin{example}
\label{example-key-postnikov}
Let $\mathcal{A}$ be an abelian category. Let $\ldots \to A_2 \to A_1 \to A_0$
be a chain complex in $\mathcal{A}$.
Then we can consider the objects
$$
X_n = A_n
\quad\text{and}\quad
Y_n = (A_n \to A_{n - 1} \to \ldots \to A_0)[-n]
$$
of $D(\mathcal{A})$. With the evident canonical maps $Y_n \to X_n$ and
$Y_0 \to Y_1[1] \to Y_2[2] \to \ldots$ the distinguished triangles
$Y_n \to X_n \to Y_{n - 1} \to Y_n[1]$ define a Postnikov system as in
Definition \ref{definition-postnikov-system} for
$\ldots \to X_2 \to X_1 \to X_0$. Here we are using the obvious
extension of Postnikov systems for an infinite complex of $D(\mathcal{A})$.
Finally, if colimits over $\mathbf{N}$ exist and are exact in $\mathcal{A}$
then
$$
\text{hocolim} Y_n[n] = (\ldots \to A_2 \to A_1 \to A_0 \to 0 \to \ldots)
$$
in $D(\mathcal{A})$. This follows immediately from
Lemma \ref{lemma-colim-hocolim}.
\end{example}

\noindent
Given a complex $X_n \to X_{n - 1} \to \ldots \to X_0$ and a Postnikov
system as in Definition \ref{definition-postnikov-system}
we can consider the maps
$$
Y_0 \to Y_1[1] \to \ldots \to Y_n[n]
$$
These maps fit together in certain distinguished triangles
and fit with the given maps between the $X_i$. Here is a
picture for $n = 3$:
$$
\xymatrix{
Y_0 \ar[rr] & &
Y_1[1] \ar[dl] \ar[rr] & &
Y_2[2] \ar[dl] \ar[rr] & &
Y_3[3] \ar[dl] \\
& X_1[1] \ar[lu]_{+1} & &
X_2[2] \ar[ll]_{+1} \ar[lu]_{+1} & &
X_3[3] \ar[ll]_{+1} \ar[lu]_{+1}
}
$$
We encourage the reader to think of $Y_n[n]$ as obtained from
$X_0, X_1[1], \ldots, X_n[n]$; for example if the maps
$X_i \to X_{i - 1}$ are zero, then we can take
$Y_n[n] = \bigoplus_{i = 0, \ldots, n} X_i[i]$.
Postnikov systems do not always exist.
Here is a simple lemma for low $n$.

\begin{lemma}
\label{lemma-postnikov-system-small-cases}
Let $\mathcal{D}$ be a triangulated category. Consider
Postnikov systems for complexes of length $n$.
\begin{enumerate}
\item For $n = 0$ Postnikov systems always exist and
any morphism (\ref{equation-map-complexes}) of complexes
extends to a unique morphism of Postnikov systems.
\item For $n = 1$ Postnikov systems always exist and
any morphism (\ref{equation-map-complexes}) of complexes
extends to a (nonunique) morphism of Postnikov systems.
\item For $n = 2$ Postnikov systems always exist but
morphisms (\ref{equation-map-complexes}) of complexes
in general do not extend to morphisms of Postnikov systems.
\item For $n > 2$ Postnikov systems do not always exist.
\end{enumerate}
\end{lemma}

\begin{proof}
The case $n = 0$ is immediate as isomorphisms are invertible.
The case $n = 1$ follows immediately from TR1 (existence of triangles)
and TR3 (extending morphisms to triangles).
For the case $n = 2$ we argue as follows.
Set $Y_0 = X_0$. By the case $n = 1$ we can choose
a Postnikov system
$$
Y_1 \to X_1 \to Y_0 \to Y_1[1]
$$
Since the composition $X_2 \to X_1 \to X_0$ is zero, we can factor
$X_2 \to X_1$ (nonuniquely) as $X_2 \to Y_1 \to X_1$ by
Lemma \ref{lemma-representable-homological}.
Then we simply fit the morphism $X_2 \to Y_1$ into a distinguished
triangle
$$
Y_2 \to X_2 \to Y_1 \to Y_2[1]
$$
to get the Postnikov system for $n = 2$.
For $n > 2$ we cannot argue similarly, as we do not
know whether the composition $X_n \to X_{n - 1} \to Y_{n - 1}$
is zero in $\mathcal{D}$.
\end{proof}

\begin{lemma}
\label{lemma-maps-postnikov-systems-vanishing}
Let $\mathcal{D}$ be a triangulated category. Given a map
(\ref{equation-map-complexes}) consider the condition
\begin{equation}
\label{equation-P}
\Hom(X_i[i - j - 1], X'_j) = 0 \text{ for }i > j + 1
\end{equation}
Then
\begin{enumerate}
\item If we have a Postnikov system for
$X'_n \to X'_{n - 1} \to \ldots \to X'_0$ then
property (\ref{equation-P}) implies that
$$
\Hom(X_i[i - j - 1], Y'_j) = 0 \text{ for }i > j + 1
$$
\item If we are given Postnikov systems for both complexes and
we have (\ref{equation-P}), then the map extends to a (nonunique) map
of Postnikov systems.
\end{enumerate}
\end{lemma}

\begin{proof}
We first prove (1) by induction on $j$. For the base case $j = 0$
there is nothing to prove as $Y'_0 \to X'_0$ is an isomorphism.
Say the result holds for $j - 1$. We consider the distinguished triangle
$$
Y'_j \to X'_j \to Y'_{j - 1} \to Y'_j[1]
$$
The long exact sequence of Lemma \ref{lemma-representable-homological}
gives an exact sequence
$$
\Hom(X_i[i - j - 1], Y'_{j - 1}[-1]) \to
\Hom(X_i[i - j - 1], Y'_j) \to
\Hom(X_i[i - j - 1], X'_j)
$$
From the induction hypothesis and (\ref{equation-P}) we conclude the outer
groups are zero and we win.

\medskip\noindent
Proof of (2). For $n = 1$ the existence of morphisms has been
established in Lemma \ref{lemma-postnikov-system-small-cases}.
For $n > 1$ by induction, we may assume given the map of
Postnikov systems of length $n - 1$. The problem is that we do
not know whether the diagram
$$
\xymatrix{
X_n \ar[r] \ar[d] & Y_{n - 1} \ar[d] \\
X'_n \ar[r] & Y'_{n - 1}
}
$$
is commutative. Denote $\alpha : X_n \to Y'_{n - 1}$ the difference.
Then we do know that the composition of $\alpha$ with
$Y'_{n - 1} \to X'_{n - 1}$ is zero (because of what it means
to be a map of Postnikov systems of length $n - 1$).
By the distinguished triangle
$Y'_{n - 1} \to X'_{n - 1} \to Y'_{n - 2} \to Y'_{n - 1}[1]$,
this means that $\alpha$ is the composition of
$Y'_{n - 2}[-1] \to Y'_{n - 1}$ with
a map $\alpha' : X_n \to Y'_{n - 2}[-1]$. Then (\ref{equation-P}) guarantees
$\alpha'$ is zero by part (1) of the lemma. Thus $\alpha$ is zero.
To finish the proof of existence, the commutativity guarantees
we can choose the dotted arrow fitting into the diagram
$$
\xymatrix{
Y_{n - 1}[-1] \ar[d] \ar[r] &
Y_n \ar[r] \ar@{..>}[d] &
X_n \ar[r] \ar[d] &
Y_{n - 1} \ar[d] \\
Y'_{n - 1}[-1] \ar[r] &
Y'_n \ar[r] &
X'_n \ar[r] &
Y'_{n - 1}
}
$$
by TR3.
\end{proof}

\begin{lemma}
\label{lemma-uniqueness-maps-postnikov-systems}
Let $\mathcal{D}$ be a triangulated category. Given a map
(\ref{equation-map-complexes}) assume we are given
Postnikov systems for both complexes. If
\begin{enumerate}
\item $\Hom(X_i[i], Y'_n[n]) = 0$ for $i = 1, \ldots, n$, or
\item $\Hom(Y_n[n], X'_{n - i}[n - i]) = 0$ for $i = 1, \ldots, n$, or
\item $\Hom(X_{j - i}[-i + 1], X'_j) = 0$ and
$\Hom(X_j, X'_{j - i}[-i]) = 0$ for $j \geq i > 0$,
\end{enumerate}
then there exists at most one morphism between these Postnikov systems.
\end{lemma}

\begin{proof}
Proof of (1). Look at the following diagram
$$
\xymatrix{
Y_0 \ar[r] \ar[d] &
Y_1[1] \ar[r] \ar[ld] &
Y_2[2] \ar[r] \ar[lld] &
\ldots \ar[r] &
Y_n[n] \ar[lllld] \\
Y'_n[n]
}
$$
The arrows are the composition of the morphism $Y_n[n] \to Y'_n[n]$
and the morphism $Y_i[i] \to Y_n[n]$. The arrow $Y_0 \to Y'_n[n]$
is determined as it is the composition $Y_0 = X_0 \to X'_0 = Y'_0 \to Y'_n[n]$.
Since we have the distinguished triangle $Y_0 \to Y_1[1] \to X_1[1]$
we see that $\Hom(X_1[1], Y'_n[n]) = 0$ guarantees that the second vertical
arrow is unique. Since we have the distinguished triangle
$Y_1[1] \to Y_2[2] \to X_2[2]$ we see that $\Hom(X_2[2], Y'_n[n]) = 0$
guarantees that the third vertical arrow is unique. And so on.

\medskip\noindent
Proof of (2). The composition $Y_n[n] \to Y'_n[n] \to X_n[n]$ is
the same as the composition $Y_n[n] \to X_n[n] \to X'_n[n]$ and hence
is unique. Then using the distinguished triangle
$Y'_{n - 1}[n - 1] \to Y'_n[n] \to X'_n[n]$ we see that it suffices
to show $\Hom(Y_n[n], Y'_{n - 1}[n - 1]) = 0$. Using the distinguished
triangles
$$
Y'_{n - i - 1}[n - i - 1] \to Y'_{n - i}[n - i] \to X'_{n - i}[n - i]
$$
we get this vanishing from our assumption. Small details omitted.

\medskip\noindent
Proof of (3). Looking at the proof of
Lemma \ref{lemma-maps-postnikov-systems-vanishing}
and arguing by induction on $n$ it suffices to show that the dotted arrow
in the morphism of triangles
$$
\xymatrix{
Y_{n - 1}[-1] \ar[d] \ar[r] &
Y_n \ar[r] \ar@{..>}[d] &
X_n \ar[r] \ar[d] &
Y_{n - 1} \ar[d] \\
Y'_{n - 1}[-1] \ar[r] &
Y'_n \ar[r] &
X'_n \ar[r] &
Y'_{n - 1}
}
$$
is unique. By Lemma \ref{lemma-uniqueness-third-arrow} part (5)
it suffices to show that $\Hom(Y_{n - 1}, X'_n) = 0$ and
$\Hom(X_n, Y'_{n - 1}[-1]) = 0$.
To prove the first vanishing we use the distinguished triangles
$Y_{n - i - 1}[-i] \to Y_{n - i}[-(i - 1)] \to X_{n - i}[-(i - 1)]$
for $i > 0$ and induction on $i$ to see that the assumed
vanishing of $\Hom(X_{n - i}[-i + 1], X'_n)$ is enough.
For the second we similarly use the distinguished triangles
$Y'_{n - i - 1}[-i - 1] \to Y'_{n - i}[-i] \to X'_{n - i}[-i]$
to see that the assumed vanishing of
$\Hom(X_n, X'_{n - i}[-i])$ is enough as well.
\end{proof}

\begin{lemma}
\label{lemma-existence-postnikov-system}
Let $\mathcal{D}$ be a triangulated category.
Let $X_n \to X_{n - 1} \to \ldots \to X_0$ be
a complex in $\mathcal{D}$. If
$$
\Hom(X_i[i - j - 2], X_j) = 0 \text{ for }i > j + 2
$$
then there exists a Postnikov system. If we have
$$
\Hom(X_i[i - j - 1], X_j) = 0 \text{ for }i > j + 1
$$
then any two Postnikov systems are isomorphic.
\end{lemma}

\begin{proof}
We argue by induction on $n$. The cases $n = 0, 1, 2$
follow from Lemma \ref{lemma-postnikov-system-small-cases}.
Assume $n > 2$.
Suppose given a Postnikov system for the complex
$X_{n - 1} \to X_{n - 2} \to \ldots \to X_0$.
The only obstruction to extending this to a Postnikov system
of length $n$ is that we have to find a morphism
$X_n \to Y_{n - 1}$ such that the composition
$X_n \to Y_{n - 1} \to X_{n - 1}$ is equal to the given map
$X_n \to X_{n - 1}$. Considering the distinguished triangle
$$
Y_{n - 1} \to X_{n - 1} \to Y_{n - 2} \to Y_{n - 1}[1]
$$
and the associated long exact sequence coming from this
and the functor $\Hom(X_n, -)$
(see Lemma \ref{lemma-representable-homological})
we find that it suffices to show that the composition
$X_n \to X_{n - 1} \to Y_{n - 2}$ is zero.
Since we know that $X_n \to X_{n - 1} \to X_{n - 2}$ is zero
we can apply the distinguished triangle
$$
Y_{n - 2} \to X_{n - 2} \to Y_{n - 3} \to Y_{n - 2}[1]
$$
to see that it suffices if $\Hom(X_n, Y_{n - 3}[-1]) = 0$.
Arguing exactly as in the proof of
Lemma \ref{lemma-maps-postnikov-systems-vanishing} part (1)
the reader easily sees this follows from the condition
stated in the lemma.

\medskip\noindent
The statement on isomorphisms follows from the existence of a map
between the Postnikov systems extending the identity on the complex
proven in Lemma \ref{lemma-maps-postnikov-systems-vanishing} part (2)
and Lemma \ref{lemma-third-isomorphism-triangle} to show all the maps are
isomorphisms.
\end{proof}










\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}
