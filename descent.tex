\input{preamble}

% OK, start here.
%
\begin{document}

\title{Descent}

\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
In the chapter on topologies on schemes
(see Topologies, Section \ref{topologies-section-introduction}) we introduced
Zariski, \'etale, fppf, smooth, syntomic and fpqc coverings of schemes.
In this chapter we discuss what kind of structures over schemes
can be descended through such coverings.
See for example \cite{Gr-I}, \cite{Gr-II}, \cite{Gr-III},
\cite{Gr-IV}, \cite{Gr-V}, and \cite{Gr-VI}.
This is also meant to introduce the notions of
descent, descent data, effective descent data, in the less formal
setting of descent questions for quasi-coherent sheaves, schemes, etc.
The formal notion, that of a stack over a site, is discussed in
the chapter on stacks (see Stacks, Section \ref{stacks-section-introduction}).

\section{Descent data for quasi-coherent sheaves}
\label{section-equivalence}

\noindent
In this chapter we will use the convention where
the projection maps $\text{pr}_i : X \times \ldots \times X \to X$
are labeled starting with $i = 0$. Hence we have
$\text{pr}_0, \text{pr}_1 : X \times X  \to X$,
$\text{pr}_0, \text{pr}_1, \text{pr}_2 : X \times X \times X  \to X$,
etc.


\begin{definition}
\label{definition-descent-datum-quasi-coherent}
Let $S$ be a scheme. Let $\{f_i : S_i \to S\}_{i \in I}$ be a family
of morphisms with target $S$.
\begin{enumerate}
\item A {\it descent datum $(\mathcal{F}_i, \varphi_{ij})$
for quasi-coherent sheaves} with respect to the given family
is given by a quasi-coherent sheaf $\mathcal{F}_i$ on $S_i$ for
each $i \in I$, an isomorphism of quasi-coherent
$\mathcal{O}_{S_i \times_S S_j}$-modules
$\varphi_{ij} : \text{pr}_0^*\mathcal{F}_i \to \text{pr}_1^*\mathcal{F}_j$
for each pair $(i, j) \in I^2$
such that for every triple of indices $(i, j, k) \in I^3$ the
diagram
$$
\xymatrix{
\text{pr}_0^*\mathcal{F}_i \ar[rd]_{\text{pr}_{01}^*\varphi_{ij}}
\ar[rr]_{\text{pr}_{02}^*\varphi_{ik}} & &
\text{pr}_2^*\mathcal{F}_k \\
& \text{pr}_1^*\mathcal{F}_j \ar[ru]_{\text{pr}_{12}^*\varphi_{jk}} &
}
$$
of $\mathcal{O}_{S_i \times_S S_j \times_S S_k}$-modules
commutes. This is called the {\it cocycle condition}.
\item A {\it morphism $\psi : (\mathcal{F}_i, \varphi_{ij}) \to
(\mathcal{F}'_i, \varphi'_{ij})$ of descent data} is given
by a family $\psi = (\psi_i)_{i\in I}$ of morphisms of
$\mathcal{O}_{S_i}$-modules $\psi_i : \mathcal{F}_i \to \mathcal{F}'_i$
such that all the diagrams
$$
\xymatrix{
\text{pr}_0^*\mathcal{F}_i \ar[r]_{\varphi_{ij}} \ar[d]_{\text{pr}_0^*\psi_i}
& \text{pr}_1^*\mathcal{F}_j \ar[d]^{\text{pr}_1^*\psi_j} \\
\text{pr}_0^*\mathcal{F}'_i \ar[r]^{\varphi'_{ij}} &
\text{pr}_1^*\mathcal{F}'_j \\
}
$$
commute.
\end{enumerate}
\end{definition}

\noindent
A good example to keep in mind is the following.
Suppose that $S = \bigcup S_i$ is an open covering.
In that case we have seen descent data for sheaves of sets in
Sheaves, Section \ref{sheaves-section-glueing-sheaves}
where we called them ``glueing data for sheaves of sets
with respect to the given covering''. Moreover, we proved
that the category of glueing data is equivalent to the category
of sheaves on $S$. We will show the analogue in the setting above when
$\{S_i \to S\}_{i\in I}$ is an fpqc covering.

\medskip\noindent
In the extreme case where the covering $\{S \to S\}$
is given by $\text{id}_S$ a descent datum is necessarily
of the form $(\mathcal{F}, \text{id}_\mathcal{F})$. The cocycle
condition guarantees that the identity on $\mathcal{F}$ is the
only permitted map in this case. The following lemma shows
in particular that to every quasi-coherent sheaf of
$\mathcal{O}_S$-modules there is associated a unique
descent datum with respect to any given family.

\begin{lemma}
\label{lemma-refine-descent-datum}
Let $\mathcal{U} = \{U_i \to U\}_{i \in I}$ and
$\mathcal{V} = \{V_j \to V\}_{j \in J}$
be families of morphisms of schemes with fixed target.
Let $(g, \alpha : I \to J, (g_i)) : \mathcal{U} \to \mathcal{V}$
be a morphism of families of maps with fixed target, see
Sites, Definition \ref{sites-definition-morphism-coverings}.
Let $(\mathcal{F}_j, \varphi_{jj'})$ be a descent
datum for quasi-coherent sheaves with respect to the
family $\{V_j \to V\}_{j \in J}$. Then
\begin{enumerate}
\item The system
$$
\left(g_i^*\mathcal{F}_{\alpha(i)},
(g_i \times g_{i'})^*\varphi_{\alpha(i)\alpha(i')}\right)
$$
is a descent datum with respect to the family $\{U_i \to U\}_{i \in I}$.
\item This construction is functorial in the descent datum
$(\mathcal{F}_j, \varphi_{jj'})$.
\item Given a second morphism $(g', \alpha' : I \to J, (g'_i))$
of families of maps with fixed target with $g = g'$
there exists a functorial isomorphism of descent data
$$
(g_i^*\mathcal{F}_{\alpha(i)},
(g_i \times g_{i'})^*\varphi_{\alpha(i)\alpha(i')})
\cong
((g'_i)^*\mathcal{F}_{\alpha'(i)},
(g'_i \times g'_{i'})^*\varphi_{\alpha'(i)\alpha'(i')}).
$$
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted. Hint: The maps
$g_i^*\mathcal{F}_{\alpha(i)} \to (g'_i)^*\mathcal{F}_{\alpha'(i)}$
which give the isomorphism of descent data in part (3)
are the pullbacks of the maps $\varphi_{\alpha(i)\alpha'(i)}$ by the
morphisms $(g_i, g'_i) : U_i \to V_{\alpha(i)} \times_V V_{\alpha'(i)}$.
\end{proof}

\noindent
Any family $\mathcal{U} = \{S_i \to S\}_{i \in I}$ is a refinement of
the trivial covering $\{S \to S\}$ in a unique way. For
a quasi-coherent sheaf $\mathcal{F}$ on $S$ we denote simply
$(\mathcal{F}|_{S_i}, can)$ the descent datum with respect to
$\mathcal{U}$ obtained by the procedure above.

\begin{definition}
\label{definition-descent-datum-effective-quasi-coherent}
Let $S$ be a scheme.
Let $\{S_i \to S\}_{i \in I}$ be a family of morphisms
with target $S$.
\begin{enumerate}
\item Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_S$-module.
We call the unique descent on $\mathcal{F}$ datum with respect to the covering
$\{S \to S\}$ the {\it trivial descent datum}.
\item The pullback of the trivial descent datum to
$\{S_i \to S\}$ is called the {\it canonical descent datum}.
Notation: $(\mathcal{F}|_{S_i}, can)$.
\item A descent datum $(\mathcal{F}_i, \varphi_{ij})$
for quasi-coherent sheaves with respect to the given covering
is said to be {\it effective} if there exists a quasi-coherent
sheaf $\mathcal{F}$ on $S$ such that $(\mathcal{F}_i, \varphi_{ij})$
is isomorphic to $(\mathcal{F}|_{S_i}, can)$.
\end{enumerate}
\end{definition}

\begin{lemma}
\label{lemma-zariski-descent-effective}
Let $S$ be a scheme.
Let $S = \bigcup U_i$ be an open covering.
Any descent datum on quasi-coherent sheaves
for the family $\mathcal{U} = \{U_i \to S\}$ is
effective. Moreover, the functor from the category of
quasi-coherent $\mathcal{O}_S$-modules to the category
of descent data with respect to $\mathcal{U}$ is fully faithful.
\end{lemma}

\begin{proof}
This follows immediately from
Sheaves, Section \ref{sheaves-section-glueing-sheaves}
and the fact that being quasi-coherent is a local property, see
Modules, Definition \ref{modules-definition-quasi-coherent}.
\end{proof}

\noindent
To prove more we first need to study the case of modules over rings.










\section{Descent for modules}
\label{section-descent-modules}

\noindent
Let $R \to A$ be a ring map.
By Simplicial, Example \ref{simplicial-example-push-outs-simplicial-object}
this gives rise to a cosimplicial $R$-algebra
$$
\xymatrix{
A
\ar@<1ex>[r]
\ar@<-1ex>[r]
&
A \otimes_R A
\ar@<0ex>[l]
\ar@<2ex>[r]
\ar@<0ex>[r]
\ar@<-2ex>[r]
&
A \otimes_R A \otimes_R A
\ar@<1ex>[l]
\ar@<-1ex>[l]
}
$$
Let us denote this $(A/R)_\bullet$ so that $(A/R)_n$ is the $(n + 1)$-fold
tensor product of $A$ over $R$. Given a map
$\varphi : [n] \to [m]$ the $R$-algebra map $(A/R)_\bullet(\varphi)$
is the map
$$
a_0 \otimes \ldots \otimes a_n
\longmapsto
\prod\nolimits_{\varphi(i) = 0} a_i
\otimes
\prod\nolimits_{\varphi(i) = 1} a_i
\otimes \ldots \otimes
\prod\nolimits_{\varphi(i) = m} a_i
$$
where we use the convention that the empty product is $1$. Thus the first
few maps, notation as in
Simplicial, Section \ref{simplicial-section-cosimplicial-object}, are
$$
\begin{matrix}
\delta^1_0 & : & a_0 & \mapsto & 1 \otimes a_0 \\
\delta^1_1 & : & a_0 & \mapsto & a_0 \otimes 1 \\
\sigma^0_0 & : & a_0 \otimes a_1 & \mapsto & a_0a_1 \\
\delta^2_0 & : & a_0 \otimes a_1 & \mapsto & 1 \otimes a_0 \otimes a_1 \\
\delta^2_1 & : & a_0 \otimes a_1 & \mapsto & a_0 \otimes 1 \otimes a_1 \\
\delta^2_2 & : & a_0 \otimes a_1 & \mapsto & a_0 \otimes a_1 \otimes 1 \\
\sigma^1_0 & : & a_0 \otimes a_1 \otimes a_2 & \mapsto & a_0a_1 \otimes a_2 \\
\sigma^1_1 & : & a_0 \otimes a_1 \otimes a_2 & \mapsto & a_0 \otimes a_1a_2
\end{matrix}
$$
and so on.

\medskip\noindent
An $R$-module $M$ gives rise to a cosimplicial $(A/R)_\bullet$-module
$(A/R)_\bullet \otimes_R M$. In other words
$M_n = (A/R)_n \otimes_R M$ and using the $R$-algebra maps
$(A/R)_n \to (A/R)_m$ to define the corresponding maps on
$M \otimes_R (A/R)_\bullet$.

\medskip\noindent
The analogue to a descent datum
for quasi-coherent sheaves in the setting of modules is the following.

\begin{definition}
\label{definition-descent-datum-modules}
Let $R \to A$ be a ring map.
\begin{enumerate}
\item A {\it descent datum $(N, \varphi)$ for modules
with respect to $R \to A$}
is given by an $A$-module $N$ and an isomorphism of
$A \otimes_R A$-modules
$$
\varphi : N \otimes_R A \to A \otimes_R N
$$
such that the {\it cocycle condition} holds: the diagram
of $A \otimes_R A \otimes_R A$-module maps
$$
\xymatrix{
N \otimes_R A \otimes_R A \ar[rr]_{\varphi_{02}}
\ar[rd]_{\varphi_{01}}
& &
A \otimes_R A \otimes_R N \\
& A \otimes_R N \otimes_R A \ar[ru]_{\varphi_{12}} &
}
$$
commutes (see below for notation).
\item A {\it morphism $(N, \varphi) \to (N', \varphi')$ of descent data}
is a morphism of $A$-modules $\psi : N \to N'$ such that
the diagram
$$
\xymatrix{
N \otimes_R A \ar[r]_\varphi \ar[d]_{\psi \otimes \text{id}_A} &
A \otimes_R N \ar[d]^{\text{id}_A \otimes \psi} \\
N' \otimes_R A \ar[r]^{\varphi'} &
A \otimes_R N'
}
$$
is commutative.
\end{enumerate}
\end{definition}

\noindent
In the definition we use the notation that
$\varphi_{01} = \varphi \otimes \text{id}_A$,
$\varphi_{12} = \text{id}_A \otimes \varphi$, and
$\varphi_{02}(n \otimes 1 \otimes 1) = \sum a_i \otimes 1 \otimes n_i$
if $\varphi(n \otimes 1) = \sum a_i \otimes n_i$. All three are
$A \otimes_R A \otimes_R A$-module homomorphisms. Equivalently we have
$$
\varphi_{ij}
=
\varphi \otimes_{(A/R)_1, \ (A/R)_\bullet(\tau^2_{ij})} (A/R)_2
$$
where $\tau^2_{ij} : [1] \to [2]$ is the map
$0 \mapsto i$, $1 \mapsto j$. Namely,
$(A/R)_{\bullet}(\tau^2_{02})(a_0 \otimes a_1) =
a_0 \otimes 1 \otimes a_1$,
and similarly for the others\footnote{Note that
$\tau^2_{ij} = \delta^2_k$, if $\{i, j, k\} = [2] = \{0, 1, 2\}$,
see Simplicial, Definition \ref{simplicial-definition-face-degeneracy}.}.

\medskip\noindent
We need some more notation to be able to state the next lemma.
Let $(N, \varphi)$ be a descent datum with respect to a ring map $R \to A$.
For $n \geq 0$ and $i \in [n]$ we set
$$
N_{n, i} =
A \otimes_R
\ldots
\otimes_R A \otimes_R N \otimes_R A \otimes_R
\ldots
\otimes_R A
$$
with the factor $N$ in the $i$th spot. It is an $(A/R)_n$-module.
If we introduce the maps $\tau^n_i : [0] \to [n]$, $0 \mapsto i$
then we see that
$$
N_{n, i} = N \otimes_{(A/R)_0, \ (A/R)_\bullet(\tau^n_i)} (A/R)_n
$$
For $0 \leq i \leq j \leq n$ we let $\tau^n_{ij} : [1] \to [n]$
be the map such that $0$ maps to $i$ and $1$ to $j$. Similarly
to the above the homomorphism $\varphi$ induces isomorphisms
$$
\varphi^n_{ij}
=
\varphi \otimes_{(A/R)_1, \ (A/R)_\bullet(\tau^n_{ij})} (A/R)_n :
N_{n, i} \longrightarrow N_{n, j}
$$
of $(A/R)_n$-modules when $i < j$. If $i = j$ we set
$\varphi^n_{ij} = \text{id}$. Since these are all isomorphisms they allow us
to move the factor $N$ to any spot we like. And the cocycle condition
exactly means that it does not matter how we do this (e.g., as a composition
of two of these or at once). Finally, for any $\beta : [n] \to [m]$
we define the morphism
$$
N_{\beta, i} : N_{n, i} \to N_{m, \beta(i)}
$$
as the unique $(A/R)_\bullet(\beta)$-semi linear map such that
$$
N_{\beta, i}(1 \otimes \ldots \otimes n \otimes \ldots \otimes 1)
=
1 \otimes \ldots \otimes n \otimes \ldots \otimes 1
$$
for all $n \in N$.
This hints at the following lemma.

\begin{lemma}
\label{lemma-descent-datum-cosimplicial}
Let $R \to A$ be a ring map.
Given a descent datum $(N, \varphi)$ we can associate to it a
cosimplicial $(A/R)_\bullet$-module $N_\bullet$\footnote{We should really
write $(N, \varphi)_\bullet$.} by the
rules $N_n = N_{n, n}$ and given $\beta : [n] \to [m]$
setting we define
$$
N_\bullet(\beta) = (\varphi^m_{\beta(n)m}) \circ N_{\beta, n} :
N_{n, n} \longrightarrow N_{m, m}.
$$
This procedure is functorial in the descent datum.
\end{lemma}

\begin{proof}
Here are the first few maps
where $\varphi(n \otimes 1) = \sum \alpha_i \otimes x_i$
$$
\begin{matrix}
\delta^1_0 & : & N & \to & A \otimes N & n & \mapsto & 1 \otimes n \\
\delta^1_1 & : & N & \to & A \otimes N & n & \mapsto &
\sum \alpha_i \otimes x_i\\
\sigma^0_0 & : & A \otimes N & \to & N & a_0 \otimes n & \mapsto & a_0n \\
\delta^2_0 & : & A \otimes N & \to & A \otimes A \otimes N &
a_0 \otimes n & \mapsto & 1 \otimes a_0 \otimes n \\
\delta^2_1 & : & A \otimes N & \to & A \otimes A \otimes N &
a_0 \otimes n & \mapsto & a_0 \otimes 1 \otimes n \\
\delta^2_2 & : & A \otimes N & \to & A \otimes A \otimes N &
a_0 \otimes n & \mapsto & \sum a_0 \otimes \alpha_i \otimes x_i \\
\sigma^1_0 & : & A \otimes A \otimes N & \to & A \otimes N &
a_0 \otimes a_1 \otimes n & \mapsto & a_0a_1 \otimes n \\
\sigma^1_1 & : & A \otimes A \otimes N & \to & A \otimes N &
a_0 \otimes a_1 \otimes n & \mapsto & a_0 \otimes a_1n
\end{matrix}
$$
with notation as in
Simplicial, Section \ref{simplicial-section-cosimplicial-object}.
We first verify the two properties $\sigma^0_0 \circ \delta^1_0 = \text{id}$
and $\sigma^0_0 \circ \delta^1_1 = \text{id}$.
The first one, $\sigma^0_0 \circ \delta^1_0 = \text{id}$, is clear from
the explicit description of the morphisms above.
To prove the second relation we have to use the cocycle condition
(because it does not holds for an arbitrary isomorphism
$\varphi : N \otimes_R A \to A \otimes_R N$). Write
$p = \sigma^0_0 \circ \delta^1_1 : N \to N$. By the description of the
maps above we deduce that $p$ is also equal to
$$
p = \varphi \otimes \text{id} :
N = (N \otimes_R A) \otimes_{(A \otimes_R A)} A
\longrightarrow
(A \otimes_R N) \otimes_{(A \otimes_R A)} A = N
$$
Since $\varphi$ is an isomorphism we see that $p$ is an isomorphism.
Write $\varphi(n \otimes 1) = \sum \alpha_i \otimes x_i$ for certain
$\alpha_i \in A$ and $x_i \in N$. Then $p(n) = \sum \alpha_ix_i$.
Next, write
$\varphi(x_i \otimes 1) = \sum \alpha_{ij} \otimes y_j$ for
certain $\alpha_{ij} \in A$ and $y_j \in N$. Then the cocycle condition
says that
$$
\sum \alpha_i \otimes \alpha_{ij} \otimes y_j
=
\sum \alpha_i \otimes 1 \otimes x_i.
$$
This means that $p(n) = \sum \alpha_ix_i = \sum \alpha_i\alpha_{ij}y_j =
\sum \alpha_i p(x_i) = p(p(n))$. Thus $p$ is a projector, and since it is
an isomorphism it is the identity.

\medskip\noindent
To prove fully that $N_\bullet$ is a cosimplicial module we have to check
all 5 types of relations of
Simplicial, Remark \ref{simplicial-remark-relations-cosimplicial}.
The relations on composing $\sigma$'s are obvious.
The relations on composing $\delta$'s come down to the
cocycle condition for $\varphi$.
In exactly the same way as above one checks the relations
$\sigma_j \circ \delta_j = \sigma_j \circ \delta_{j + 1} = \text{id}$.
Finally, the other relations on compositions of $\delta$'s and $\sigma$'s
hold for any $\varphi$ whatsoever.
\end{proof}

\noindent
Note that to an $R$-module $M$ we can associate a canonical
descent datum, namely $(M \otimes_R A, can)$ where
$can : (M \otimes_R A) \otimes_R A \to A \otimes_R (M \otimes_R A)$
is the obvious map:
$(m \otimes a) \otimes a' \mapsto a \otimes (m \otimes a')$.

\begin{lemma}
\label{lemma-canonical-descent-datum-cosimplicial}
Let $R \to A$ be a ring map.
Let $M$ be an $R$-module. The cosimplicial
$(A/R)_\bullet$-module associated to the canonical descent
datum is isomorphic to the cosimplicial module $(A/R)_\bullet \otimes_R M$.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{definition}
\label{definition-descent-datum-effective-module}
Let $R \to A$ be a ring map.
We say a descent datum $(N, \varphi)$ is {\it effective}
if there exists an $R$-module $M$ and an isomorphism
of descent data from $(M \otimes_R A, can)$ to
$(N, \varphi)$.
\end{definition}

\noindent
Let $R \to A$ be a ring map.
Let $(N, \varphi)$ be a descent datum.
We may take the cochain complex $s(N_\bullet)$ associated
with $N_\bullet$ (see
Simplicial, Section \ref{simplicial-section-dold-kan-cosimplicial}).
It has the following shape:
$$
N \to A \otimes_R N \to A \otimes_R A \otimes_R N \to \ldots
$$
We can describe the maps.
The first map is the map
$$
n \longmapsto 1 \otimes n - \varphi(n \otimes 1).
$$
The second map on pure tensors has the values
$$
a \otimes n \longmapsto 1 \otimes a \otimes n
- a \otimes 1 \otimes n + a \otimes \varphi(n \otimes 1).
$$
It is clear how the pattern continues.

\medskip\noindent
In the special case
where $N = A \otimes_R M$ we see that for any $m \in M$
the element $1 \otimes m$ is in the kernel of the first map
of the cochain complex associated to the cosimplicial
module $(A/R)_\bullet \otimes_R M$. Hence we get an extended cochain complex
\begin{equation}
\label{equation-extended-complex}
0 \to M \to A \otimes_R M \to A \otimes_R A \otimes_R M \to \ldots
\end{equation}
Here we think of the $0$ as being in degree $-2$,
the module $M$ in degree $-1$, the module $A \otimes_R M$ in
degree $0$, etc. Note that this complex has the shape
$$
0 \to R \to A \to A \otimes_R A \to A \otimes_R A \otimes_R A \to \ldots
$$
when $M = R$.

\begin{lemma}
\label{lemma-with-section-exact}
Suppose that $R \to A$ has a section.
Then for any $R$-module $M$ the extended cochain complex
(\ref{equation-extended-complex}) is exact.
\end{lemma}

\begin{proof}
By
Simplicial, Lemma \ref{simplicial-lemma-push-outs-simplicial-object-w-section}
the map $R \to (A/R)_\bullet$ is a homotopy equivalence
of cosimplicial $R$-algebras
(here $R$ denotes the constant cosimplicial $R$-algebra).
Hence $M \to (A/R)_\bullet \otimes_R M$ is
a homotopy equivalence in the category of cosimplicial
$R$-modules, because $\otimes_R M$ is a
functor from the category of $R$-algebras to the category
of $R$-modules, see
Simplicial, Lemma \ref{simplicial-lemma-functorial-homotopy}.
This implies that the induced map of associated
complexes is a homotopy equivalence, see
Simplicial, Lemma \ref{simplicial-lemma-homotopy-s-Q}.
Since the complex associated to the constant cosimplicial
$R$-module $M$ is the complex
$$
\xymatrix{
M \ar[r]^0 & M \ar[r]^1 & M \ar[r]^0 & M \ar[r]^1 & M \ldots
}
$$
we win (since the extended version simply puts an extra $M$ at
the beginning).
\end{proof}

\begin{lemma}
\label{lemma-ff-exact}
Suppose that $R \to A$ is faithfully flat, see
Algebra, Definition \ref{algebra-definition-flat}.
Then for any $R$-module $M$ the extended cochain complex
(\ref{equation-extended-complex}) is exact.
\end{lemma}

\begin{proof}
Suppose we can show there exists a faithfully flat ring map
$R \to R'$ such that the result holds for the ring map
$R' \to A' = R' \otimes_R A$. Then the result follows for
$R \to A$. Namely, for any $R$-module $M$ the cosimplicial
module $(M \otimes_R R') \otimes_{R'} (A'/R')_\bullet$ is
just the cosimplicial module $R' \otimes_R (M \otimes_R (A/R)_\bullet)$.
Hence the vanishing of cohomology of the complex associated to
$(M \otimes_R R') \otimes_{R'} (A'/R')_\bullet$ implies the
vanishing of the cohomology of the complex associated to
$M \otimes_R (A/R)_\bullet$ by faithful flatness of $R \to R'$.
Similarly for the vanishing of cohomology groups in degrees
$-1$ and $0$ of the extended complex (proof omitted).

\medskip\noindent
But we have such a faithful flat extension. Namely $R' = A$ works
because the ring map $R' = A \to A' = A \otimes_R A$ has a section
$a \otimes a' \mapsto aa'$ and
Lemma \ref{lemma-with-section-exact}
applies.
\end{proof}

\noindent
Here is how the complex relates to the question of effectivity.

\begin{lemma}
\label{lemma-recognize-effective}
Let $R \to A$ be a faithfully flat ring map.
Let $(N, \varphi)$ be a descent datum.
Then $(N, \varphi)$ is effective if and only if the canonical
map
$$
A \otimes_R H^0(s(N_\bullet)) \longrightarrow N
$$
is an isomorphism.
\end{lemma}

\begin{proof}
If $(N, \varphi)$ is effective, then we may write $N = A \otimes_R M$
with $\varphi = can$. It follows that $H^0(s(N_\bullet)) = M$ by
Lemmas \ref{lemma-canonical-descent-datum-cosimplicial}
and \ref{lemma-ff-exact}. Conversely, suppose the map of the lemma
is an isomorphism. In this case set $M = H^0(s(N_\bullet))$.
This is an $R$-submodule of $N$,
namely $M = \{n \in N \mid 1 \otimes n = \varphi(n \otimes 1)\}$.
The only thing to check is that via the isomorphism
$A \otimes_R M \to N$
the canonical descent data agrees with $\varphi$.
We omit the verification.
\end{proof}

\begin{lemma}
\label{lemma-descent-descends}
Let $R \to A$ be a faithfully flat ring map, and let $R \to R'$
be faithfully flat. Set $A' = R' \otimes_R A$. If all descent data
for $R' \to A'$ are effective, then so are all descent data for $R \to A$.
\end{lemma}

\begin{proof}
Let $(N, \varphi)$ be a descent datum for $R \to A$.
Set $N' = R' \otimes_R N = A' \otimes_A N$, and denote
$\varphi' = \text{id}_{R'} \otimes \varphi$ the base change
of the descent datum $\varphi$. Then $(N', \varphi')$ is
a descent datum for $R' \to A'$ and
$H^0(s(N'_\bullet)) = R' \otimes_R H^0(s(N_\bullet))$.
Moreover, the map
$A' \otimes_{R'} H^0(s(N'_\bullet)) \to N'$ is identified
with the base change of the $A$-module map
$A \otimes_R H^0(s(N)) \to N$ via the faithfully flat map
$A \to A'$. Hence we conclude by Lemma \ref{lemma-recognize-effective}.
\end{proof}

\noindent
Here is the main result of this section.
Its proof may seem a little clumsy; for a more highbrow approach see
Remark \ref{remark-homotopy-equivalent-cosimplicial-algebras} below.

\begin{proposition}
\label{proposition-descent-module}
\begin{slogan}
Effective descent for modules along faithfully flat ring maps.
\end{slogan}
Let $R \to A$ be a faithfully flat ring map.
Then
\begin{enumerate}
\item any descent datum on modules with respect to $R \to A$
is effective,
\item the functor $M \mapsto (A \otimes_R M, can)$ from $R$-modules
to the category of descent data is an equivalence, and
\item the inverse functor is given by $(N, \varphi) \mapsto H^0(s(N_\bullet))$.
\end{enumerate}
\end{proposition}

\begin{proof}
We only prove (1) and omit the proofs of (2) and (3).
As $R \to A$ is faithfully flat, there exists a faithfully flat
base change $R \to R'$ such that $R' \to A' = R' \otimes_R A$ has
a section (namely take $R' = A$ as in the proof of
Lemma \ref{lemma-ff-exact}). Hence, using
Lemma \ref{lemma-descent-descends}
we may assume that $R \to A$ has a section, say $\sigma : A \to R$.
Let $(N, \varphi)$ be a descent datum relative to $R \to A$.
Set
$$
M = H^0(s(N_\bullet)) = \{n \in N \mid 1 \otimes n = \varphi(n \otimes 1)\}
\subset
N
$$
By Lemma \ref{lemma-recognize-effective} it suffices to show that
$A \otimes_R M \to N$ is an isomorphism.

\medskip\noindent
Take an element $n \in N$. Write
$\varphi(n \otimes 1) = \sum a_i \otimes x_i$ for certain
$a_i \in A$ and $x_i \in N$. By Lemma \ref{lemma-descent-datum-cosimplicial}
we have $n = \sum a_i x_i$ in $N$ (because
$\sigma^0_0 \circ \delta^1_1 = \text{id}$ in any cosimplicial object).
Next, write $\varphi(x_i \otimes 1) = \sum a_{ij} \otimes y_j$ for
certain $a_{ij} \in A$ and $y_j \in N$.
The cocycle condition means that
$$
\sum a_i \otimes a_{ij} \otimes y_j = \sum a_i \otimes 1 \otimes x_i
$$
in $A \otimes_R A \otimes_R N$. We conclude two things from this.
First, by applying $\sigma$ to the first $A$ we conclude that
$\sum \sigma(a_i) \varphi(x_i \otimes 1) = \sum \sigma(a_i) \otimes x_i$
which means that $\sum \sigma(a_i) x_i \in M$. Next, by applying
$\sigma$ to the middle $A$ and multiplying out we conclude that
$\sum_i a_i (\sum_j \sigma(a_{ij}) y_j) = \sum a_i x_i = n$. Hence
by the first conclusion we see that $A \otimes_R M \to N$ is
surjective. Finally, suppose that $m_i \in M$ and
$\sum a_i m_i = 0$. Then we see by applying $\varphi$ to
$\sum a_im_i \otimes 1$ that $\sum a_i \otimes m_i = 0$.
In other words $A \otimes_R M \to N$ is injective and we win.
\end{proof}

\begin{remark}
\label{remark-standard-covering}
Let $R$ be a ring. Let $f_1, \ldots, f_n\in R$ generate the
unit ideal. The ring $A = \prod_i R_{f_i}$ is a faithfully flat
$R$-algebra. We remark that the cosimplicial ring $(A/R)_\bullet$
has the following ring in degree $n$:
$$
\prod\nolimits_{i_0, \ldots, i_n} R_{f_{i_0}\ldots f_{i_n}}
$$
Hence the results above recover
Algebra, Lemmas \ref{algebra-lemma-standard-covering},
\ref{algebra-lemma-cover-module} and \ref{algebra-lemma-glue-modules}.
But the results above actually say more because of exactness
in higher degrees. Namely, it implies that {\v C}ech cohomology of
quasi-coherent sheaves on affines is trivial. Thus we get a second
proof of Cohomology of Schemes, Lemma
\ref{coherent-lemma-cech-cohomology-quasi-coherent-trivial}.
\end{remark}

\begin{remark}
\label{remark-homotopy-equivalent-cosimplicial-algebras}
Let $R$ be a ring. Let $A_\bullet$ be a cosimplicial $R$-algebra.
In this setting a descent datum corresponds to an cosimplicial
$A_\bullet$-module $M_\bullet$ with the property that for
every $n, m \geq 0$ and every $\varphi : [n] \to [m]$ the
map $M(\varphi) : M_n \to M_m$ induces an isomorphism
$$
M_n \otimes_{A_n, A(\varphi)} A_m \longrightarrow M_m.
$$
Let us call such a cosimplicial module a {\it cartesian module}.
In this setting, the proof of Proposition \ref{proposition-descent-module}
can be split in the following steps
\begin{enumerate}
\item If $R \to R'$ and $R \to A$ are faithfully flat,
then descent data for $A/R$ are effective if
descent data for $(R' \otimes_R A)/R'$ are effective.
\item Let $A$ be an $R$-algebra. Descent data for $A/R$ correspond
to cartesian $(A/R)_\bullet$-modules.
\item If $R \to A$ has a section then $(A/R)_\bullet$ is homotopy
equivalent to $R$, the constant cosimplicial
$R$-algebra with value $R$.
\item If $A_\bullet \to B_\bullet$ is a homotopy equivalence of
cosimplicial $R$-algebras then the functor
$M_\bullet \mapsto M_\bullet \otimes_{A_\bullet} B_\bullet$
induces an equivalence of categories between cartesian
$A_\bullet$-modules and cartesian $B_\bullet$-modules.
\end{enumerate}
For (1) see Lemma \ref{lemma-descent-descends}.
Part (2) uses Lemma \ref{lemma-descent-datum-cosimplicial}.
Part (3) we have seen in the proof of Lemma \ref{lemma-with-section-exact}
(it relies on Simplicial,
Lemma \ref{simplicial-lemma-push-outs-simplicial-object-w-section}).
Moreover, part (4) is a triviality if you think about it right!
\end{remark}








\section{Descent for universally injective morphisms}
\label{section-descent-universally-injective}

\noindent
Numerous constructions in algebraic geometry are made using techniques of 
{\it descent}, such as constructing objects over a given space by first
working over a somewhat larger space which projects down to the given space,
or verifying a property of a space or a morphism by pulling back along a
covering map. The utility of such techniques is of course  dependent on
identification of a wide class of {\it effective descent morphisms}.
Early in the Grothendieckian development of modern algebraic geometry,
the class of morphisms which are {\it quasi-compact} and {\it faithfully flat} 
was shown to be effective for descending objects, morphisms, and many
properties thereof. 

\medskip\noindent
As usual, this statement comes down to a property of rings and modules.
For a homomorphism $f: R \to S$ to be an effective descent morphism for
modules, Grothendieck showed that it is sufficient for $f$ to be
faithfully flat. However, this excludes many natural examples: for instance,
any split ring homomorphism is an effective descent morphism. One natural
example of this even arises in the proof of faithfully flat descent: for
$f: R \to S$ any ring homomorphism, $1_S \otimes f: S \to S \otimes_R S$
is split by the multiplication map whether or not it is flat.

\medskip\noindent
One may then ask whether there is a natural ring-theoretic condition 
implying effective descent for modules which includes both the case of a
faithfully flat morphism and that of a split ring homomorphism. It may
surprise the reader (at least it surprised this author) to learn that a
complete answer to this question has been known since around 1970! Namely,
it is not hard to check that a necessary condition for $f: R \to S$ to be
an effective descent morphism for modules is that $f$ must be
{\it universally injective} in the category of $R$-modules, that is, for
any $R$-module $M$, the map $1_M  \otimes f: M \to M \otimes_R S$
must be injective. This then turns out to be a sufficient condition as well.
For example, if $f$ is split in the category of $R$-modules (but not
necessarily in the category of rings), then $f$ is an effective descent
morphism for modules.
 
\medskip\noindent
The history of this result is a bit involved: it was originally asserted
by Olivier \cite{olivier}, who  called universally injective morphisms
{\it pure}, but without a clear indication of proof. One can extract the
result from the work of Joyal and Tierney \cite{joyal-tierney}, but to the
best of our knowledge, the first free-standing proof to appear in the
literature is that of Mesablishvili \cite{mesablishvili1}. The first purpose
of this section is to expose Mesablishvili's proof; this requires little
modification of his original presentation aside from correcting typos, with
the one exception that we make explicit the relationship between the
customary definition of a descent datum in algebraic geometry and the one
used in \cite{mesablishvili1}. The proof turns out to be entirely
category-theoretic, and consequently can be put in the language of monads
(and thus applied in other contexts); see \cite{janelidze-tholen}.

\medskip\noindent
The second purpose of this section is to collect some information about which 
properties of modules, algebras, and morphisms can be descended along 
universally injective ring homomorphisms. The cases of finite modules
and flat modules were treated by Mesablishvili \cite{mesablishvili2}.


\subsection{Category-theoretic preliminaries}
\label{subsection-category-prelims}

\noindent
We start by recalling a few basic notions from category theory which will 
simplify the exposition. In this subsection, fix an ambient category.

\medskip\noindent
For two morphisms $g_1, g_2: B \to C$, recall that an {\it equalizer}
of $g_1$ and $g_2$  is a morphism $f: A \to B$ which satisfies
$g_1 \circ f = g_2 \circ f$ and is universal for this property.
This second statement means that any commutative diagram 
$$
\xymatrix{A' \ar[rd]^e \ar@/^1.5pc/[rrd] \ar@{-->}[d] & & \\
A \ar[r]^f & B \ar@<1ex>[r]^{g_1} \ar@<-1ex>[r]_{g_2} & 
C
}
$$
without the dashed arrow can be uniquely completed. We also say in this 
situation that the diagram
\begin{equation}
\label{equation-equalizer}
\xymatrix{
A \ar[r]^f  & B \ar@<1ex>[r]^{g_1} \ar@<-1ex>[r]_{g_2} & C
}
\end{equation}
is an equalizer. Reversing arrows gives the definition of a {\it coequalizer}.
See Categories, Sections \ref{categories-section-equalizers} and
\ref{categories-section-coequalizers}.

\medskip\noindent
Since it involves a universal property, the property of being an equalizer is 
typically not stable under applying a covariant functor. Just as for
monomorphisms and epimorphisms, one can get around this in some
cases by exhibiting splittings.

\begin{definition}
\label{definition-split-equalizer}
A {\it split equalizer} is a diagram (\ref{equation-equalizer}) with
$g_1 \circ f = g_2 \circ f$ for which there exist auxiliary morphisms
$h : B \to A$ and $i : C \to B$ such that
\begin{equation}
\label{equation-split-equalizer-conditions}
h \circ f = 1_A, \quad f \circ h = i \circ g_1, \quad i \circ g_2 = 1_B.
\end{equation}
\end{definition}

\noindent
The point is that the equalities among arrows force (\ref{equation-equalizer}) 
to be an equalizer: the map $e$ factors uniquely through $f$ by writing
$e = f \circ (h \circ e)$. Consequently, applying a covariant functor
to a split equalizer gives a split equalizer; applying a contravariant functor 
gives a {\it split coequalizer}, whose definition is apparent.

\subsection{Universally injective morphisms}
\label{subsection-universally-injective}

\noindent
Recall that $\textit{Rings}$ denotes the category of commutative rings
with $1$. For an object $R$ of $\textit{Rings}$ we denote $\text{Mod}_R$
the category of $R$-modules.

\begin{remark}
\label{remark-reflects}
Any functor $F : \mathcal{A} \to \mathcal{B}$ of abelian categories
which is exact and takes nonzero objects to nonzero objects reflects
injections and surjections. Namely, exactness implies that
$F$ preserves kernels and cokernels (compare with
Homology, Section \ref{homology-section-functors}).
For example, if $f : R \to S$ is a 
faithfully flat ring homomorphism, then
$\bullet \otimes_R S: \text{Mod}_R \to \text{Mod}_S$ has these properties.
\end{remark}

\noindent
Let $R$ be a ring. Recall that a morphism $f : M \to N$ in $\text{Mod}_R$
is {\it universally injective} if for all $P \in \text{Mod}_R$,
the morphism $f \otimes 1_P: M \otimes_R P \to N \otimes_R P$ is injective.
See Algebra, Definition \ref{algebra-definition-universally-injective}.

\begin{definition}
\label{definition-universally-injective}
A ring map $f: R \to S$ is {\it universally injective}
if it is universally injective as a morphism in $\text{Mod}_R$.
\end{definition}

\begin{example}
\label{example-split-injection-universally-injective}
Any split injection in $\text{Mod}_R$ is universally injective. In particular,
any split injection in $\textit{Rings}$ is universally injective.
\end{example}

\begin{example}
\label{example-cover-universally-injective}
For a ring $R$ and $f_1, \ldots, f_n \in R$ generating the unit
ideal, the morphism $R \to R_{f_1} \oplus \ldots \oplus R_{f_n}$ is
universally injective. Although this is immediate from
Lemma \ref{lemma-faithfully-flat-universally-injective},
it is instructive to check it directly: we immediately reduce to the case
where $R$ is local, in which case some $f_i$ must be a unit and so the map
$R \to R_{f_i}$ is an isomorphism.
\end{example}

\begin{lemma}
\label{lemma-faithfully-flat-universally-injective}
Any faithfully flat ring map is universally injective.
\end{lemma}

\begin{proof}
This is a reformulation of Algebra, Lemma
\ref{algebra-lemma-faithfully-flat-universally-injective}.
\end{proof}

\noindent
The key observation from \cite{mesablishvili1} is that universal injectivity 
can be usefully reformulated in terms of a splitting, using the usual
construction of an injective cogenerator in $\text{Mod}_R$.

\begin{definition}
\label{definition-C}
Let $R$ be a ring. Define the contravariant functor
{\it $C$} $ : \text{Mod}_R \to \text{Mod}_R$ by setting
$$
C(M) = \Hom_{\textit{Ab}}(M, \mathbf{Q}/\mathbf{Z}),
$$
with the $R$-action on $C(M)$ given by $rf(s) = f(rs)$.
\end{definition}

\noindent
This functor was denoted $M \mapsto M^\vee$ in
More on Algebra, Section \ref{more-algebra-section-injectives-modules}.

\begin{lemma}
\label{lemma-C-is-faithful}
For a ring $R$, the functor $C : \text{Mod}_R \to \text{Mod}_R$ is
exact and reflects injections and surjections.
\end{lemma}

\begin{proof}
Exactness is More on Algebra, Lemma \ref{more-algebra-lemma-vee-exact}
and the other properties follow from this, see
Remark \ref{remark-reflects}.
\end{proof}

\begin{remark}
\label{remark-adjunction}
We will use frequently the standard adjunction between $\Hom$ and tensor 
product, in the form of the natural isomorphism of contravariant functors
\begin{equation}
\label{equation-adjunction}
C(\bullet_1 \otimes_R \bullet_2) \cong \Hom_R(\bullet_1, C(\bullet_2)): 
\text{Mod}_R \times \text{Mod}_R \to \text{Mod}_R
\end{equation}
taking $f: M_1 \otimes_R M_2 \to \mathbf{Q}/\mathbf{Z}$ to the map $m_1 \mapsto 
(m_2 \mapsto f(m_1 \otimes m_2))$. See
Algebra, Lemma \ref{algebra-lemma-hom-from-tensor-product-variant}.
A corollary of this observation is that if
$$
\xymatrix@C=9pc{
C(M) \ar@<1ex>[r] \ar@<-1ex>[r] & C(N) \ar[r] & C(P)
}
$$
is a split coequalizer diagram in $\text{Mod}_R$, then so is
$$
\xymatrix@C=9pc{
C(M \otimes_R Q) \ar@<1ex>[r] \ar@<-1ex>[r] & C(N \otimes_R Q) \ar[r] & C(P 
\otimes_R Q)
}
$$
for any $Q \in \text{Mod}_R$.
\end{remark}

\begin{lemma}
\label{lemma-split-surjection}
Let $R$ be a ring. A morphism $f: M \to N$ in $\text{Mod}_R$ is universally
injective if and only if $C(f): C(N) \to C(M)$ is a split surjection.
\end{lemma}

\begin{proof}
By (\ref{equation-adjunction}), for any $P \in \text{Mod}_R$ we have a 
commutative diagram
$$
\xymatrix@C=9pc{
\Hom_R( P, C(N)) \ar[r]_{\Hom_R(P,C(f))} \ar[d]^{\cong} &
\Hom_R(P,C(M)) \ar[d]^{\cong} \\
C(P \otimes_R N ) \ar[r]^{C(1_{P} \otimes f)} & C(P \otimes_R M ).
}
$$
If $f$ is universally injective, then $1_{C(M)} \otimes f: C(M) \otimes_R M \to 
C(M) \otimes_R N$ is injective,
so both rows in the above diagram are surjective for $P = C(M)$. We may thus 
lift
$1_{C(M)} \in \Hom_R(C(M), C(M))$ to some $g \in \Hom_R(C(N), C(M))$ splitting 
$C(f)$.
Conversely, if $C(f)$ is a split surjection, then 
both rows in the above diagram are surjective,
so by Lemma \ref{lemma-C-is-faithful}, $1_{P} \otimes f$ is injective.
\end{proof}

\begin{remark}
\label{remark-functorial-splitting}
Let $f: M \to N$ be a universally injective morphism in $\text{Mod}_R$. By 
choosing a splitting
$g$ of $C(f)$, we may construct a functorial splitting of $C(1_P \otimes f)$ 
for each $P \in \text{Mod}_R$.
Namely, by (\ref{equation-adjunction}) this amounts to splitting $\Hom_R(P, 
C(f))$  functorially in $P$,
and this is achieved by the map $g \circ \bullet$.
\end{remark}


\subsection{Descent for modules and their morphisms}
\label{subsection-descent-modules-morphisms}

\noindent
Throughout this subsection, fix a ring map $f: R \to S$. As seen in
Section \ref{section-descent-modules} we can use the language of cosimplicial
algebras to talk about descent data for modules, but in this
subsection we prefer a more down to earth terminology.

\medskip\noindent
For $i = 1, 2, 3$, let $S_i$ be the $i$-fold tensor product of $S$ over $R$.
Define the ring homomorphisms $\delta_0^1, \delta_1^1: S_1 \to S_2$,
$\delta_{01}^1, \delta_{02}^1, \delta_{12}^1: S_1 \to S_3$, and
$\delta_0^2, \delta_1^2, \delta_2^2: S_2 \to S_3$ by the formulas
\begin{align*}
\delta^1_0  (a_0) & =  1 \otimes a_0 \\
\delta^1_1  (a_0) & = a_0 \otimes 1 \\
\delta^2_0  (a_0 \otimes a_1) & =  1 \otimes a_0 \otimes a_1 \\
\delta^2_1  (a_0 \otimes a_1) & =  a_0 \otimes 1 \otimes a_1 \\
\delta^2_2  (a_0 \otimes a_1) & =  a_0 \otimes a_1 \otimes 1 \\
\delta_{01}^1(a_0) & = 1 \otimes 1 \otimes a_0 \\
\delta_{02}^1(a_0) & = 1 \otimes a_0 \otimes 1 \\
\delta_{12}^1(a_0) & = a_0 \otimes 1 \otimes 1.
\end{align*}
In other words, the upper index indicates the source ring, while the lower 
index indicates where to insert factors of 1. (This notation is compatible
with the notation introduced in Section \ref{section-descent-modules}.)

\medskip\noindent
Recall\footnote{To be precise, our $\theta$ here is the inverse of
$\varphi$ from Definition \ref{definition-descent-datum-modules}.}
from Definition \ref{definition-descent-datum-modules} that for
$M \in \text{Mod}_S$, a {\it descent datum} on $M$ relative to $f$ is
an isomorphism
$$
\theta :
M \otimes_{S,\delta^1_0} S_2
\longrightarrow
M \otimes_{S,\delta^1_1} S_2
$$
of $S_2$-modules satisfying the {\it cocycle condition}
\begin{equation}
\label{equation-cocycle-condition}
(\theta \otimes \delta_2^2) \circ (\theta \otimes \delta_2^0) = (\theta \otimes 
\delta_2^1):
M \otimes_{S, \delta^1_{01}} S_3 \to M \otimes_{S,\delta^1_{12}} S_3.
\end{equation}
Let $DD_{S/R}$ be the category of $S$-modules equipped with descent data 
relative to $f$.

\medskip\noindent
For example, for $M_0 \in \text{Mod}_R$ and a choice of isomorphism
$M \cong M_0 \otimes_R S$ gives rise to a descent datum by identifying
$M \otimes_{S,\delta^1_0} S_2$ and $M \otimes_{S,\delta^1_1} S_2$
naturally with $M_0 \otimes_R S_2$. This construction in particular
defines a functor $f^*: \text{Mod}_R \to DD_{S/R}$.

\begin{definition}
\label{definition-effective-descent}
The functor $f^*: \text{Mod}_R \to DD_{S/R}$
is called {\it base extension along $f$}. We say that $f$ is a
{\it descent morphism for modules} if $f^*$ is fully
faithful. We say that $f$ is an {\it effective descent morphism for modules}
if $f^*$ is an equivalence of categories.
\end{definition}

\noindent
Our goal is to show that for $f$ universally injective, we can use $\theta$ to 
locate $M_0$ within $M$. This process makes crucial use of some equalizer
diagrams.

\begin{lemma}
\label{lemma-equalizer-M}
For $(M,\theta) \in DD_{S/R}$, the diagram
\begin{equation}
\label{equation-equalizer-M}
\xymatrix@C=8pc{
M \ar[r]^{\theta \circ (1_M \otimes \delta_0^1)} &
M \otimes_{S, \delta_1^1} S_2
\ar@<1ex>[r]^{(\theta \otimes \delta_2^2) \circ (1_M \otimes \delta^2_0)}
\ar@<-1ex>[r]_{1_{M \otimes S_2} \otimes \delta^2_1} & 
M \otimes_{S, \delta_{12}^1} S_3
}
\end{equation}
is a split equalizer.
\end{lemma}

\begin{proof}
Define the ring homomorphisms $\sigma^0_0: S_2 \to S_1$ and $\sigma_0^1, 
\sigma_1^1: S_3 \to S_2$ by the formulas
\begin{align*}
\sigma^0_0 (a_0 \otimes a_1) & = a_0a_1 \\
\sigma^1_0 (a_0 \otimes a_1 \otimes a_2) & = a_0a_1 \otimes a_2 \\
\sigma^1_1 (a_0 \otimes a_1 \otimes a_2) & = a_0 \otimes a_1a_2.
\end{align*}
We then take the auxiliary morphisms to be 
$1_M \otimes \sigma_0^0: M \otimes_{S, \delta_1^1} S_2 \to M$
and $1_M \otimes \sigma_0^1: M \otimes_{S,\delta_{12}^1} S_3 \to M \otimes_{S, 
\delta_1^1} S_2$.
Of the compatibilities required in (\ref{equation-split-equalizer-conditions}), 
the first follows from tensoring the cocycle condition
(\ref{equation-cocycle-condition}) with $\sigma_1^1$
and the others are immediate.
\end{proof}

\begin{lemma}
\label{lemma-equalizer-CM}
For $(M, \theta) \in DD_{S/R}$, the diagram
\begin{equation}
\label{equation-coequalizer-CM}
\xymatrix@C=8pc{
C(M \otimes_{S, \delta_{12}^1} S_3)
\ar@<1ex>[r]^{C((\theta \otimes \delta_2^2) \circ (1_M \otimes \delta^2_0))}
\ar@<-1ex>[r]_{C(1_{M \otimes S_2} \otimes \delta^2_1)} &
C(M \otimes_{S, \delta_1^1} S_2 )
\ar[r]^{C(\theta \circ (1_M \otimes \delta_0^1))} & C(M).
}
\end{equation}
obtained by applying $C$ to (\ref{equation-equalizer-M}) is a split
coequalizer.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-equalizer-S}
The diagram
\begin{equation}
\label{equation-equalizer-S}
\xymatrix@C=8pc{
S_1 \ar[r]^{\delta^1_1} &
S_2 \ar@<1ex>[r]^{\delta^2_2} \ar@<-1ex>[r]_{\delta^2_1} & 
S_3
}
\end{equation}
is a split equalizer.
\end{lemma}

\begin{proof}
In Lemma \ref{lemma-equalizer-M}, take $(M, \theta) = f^*(S)$.
\end{proof}

\noindent
This suggests a definition of a potential quasi-inverse functor for $f^*$.

\begin{definition}
\label{definition-pushforward}
Define the functor {\it $f_*$} $: DD_{S/R} \to \text{Mod}_R$ by taking
$f_*(M, \theta)$ to be the $R$-submodule of $M$ for which the diagram
\begin{equation}
\label{equation-equalizer-f}
\xymatrix@C=8pc{f_*(M,\theta) \ar[r] & M \ar@<1ex>^{\theta \circ (1_M \otimes 
\delta_0^1)}[r] \ar@<-1ex>_{1_M \otimes \delta_1^1}[r] & 
M \otimes_{S, \delta_1^1} S_2 
}
\end{equation}
is an equalizer.
\end{definition}

\noindent
Using Lemma \ref{lemma-equalizer-M} and the fact that the restriction functor
$\text{Mod}_S \to \text{Mod}_R$ is right adjoint to the base extension
functor $\bullet \otimes_R S: \text{Mod}_R \to \text{Mod}_S$,
we deduce that $f_*$ is right adjoint to $f^*$.

\medskip\noindent
We are ready for the key lemma. In the faithfully flat case this is a 
triviality (see Remark \ref{remark-descent-lemma}),
but in the general case some argument is needed.

\begin{lemma}
\label{lemma-descent-lemma}
If $f$ is universally injective, then the diagram
\begin{equation}
\label{equation-equalizer-f2}
\xymatrix@C=8pc{
f_*(M, \theta) \otimes_R S
\ar[r]^{\theta \circ (1_M \otimes \delta_0^1)} &
M \otimes_{S, \delta_1^1} S_2 
\ar@<1ex>[r]^{(\theta \otimes \delta_2^2) \circ (1_M \otimes \delta^2_0)}
\ar@<-1ex>[r]_{1_{M \otimes S_2} \otimes \delta^2_1} &
M \otimes_{S, \delta_{12}^1} S_3
}
\end{equation}
obtained by tensoring (\ref{equation-equalizer-f}) over $R$ with $S$ is an 
equalizer.
\end{lemma}

\begin{proof}
By
Lemma \ref{lemma-split-surjection} and
Remark \ref{remark-functorial-splitting},
the map $C(1_N \otimes f): C(N \otimes_R S) \to C(N)$ can be split functorially 
in $N$. This gives the upper vertical arrows in the commutative diagram
$$
\xymatrix@C=8pc{
C(M \otimes_{S, \delta_1^1} S_2)
\ar@<1ex>^{C(\theta \circ (1_M \otimes \delta_0^1))}[r]
\ar@<-1ex>_{C(1_M \otimes \delta_1^1)}[r] \ar[d] &
C(M) \ar[r]\ar[d] & C(f_*(M,\theta)) \ar@{-->}[d] \\
C(M \otimes_{S,\delta_{12}^1} S_3)
\ar@<1ex>^{C((\theta \otimes \delta_2^2) \circ (1_M \otimes \delta^2_0))}[r]
\ar@<-1ex>_{C(1_{M \otimes S_2} \otimes \delta^2_1)}[r] \ar[d] &
C(M \otimes_{S, \delta_1^1} S_2 )
\ar[r]^{C(\theta \circ (1_M \otimes \delta_0^1))}
\ar[d]^{C(1_M \otimes \delta_1^1)} &
C(M) \ar[d] \ar@{=}[dl] \\
C(M \otimes_{S, \delta_1^1} S_2)
\ar@<1ex>[r]^{C(\theta \circ (1_M \otimes \delta_0^1))}
\ar@<-1ex>[r]_{C(1_M \otimes \delta_1^1)} &
C(M) \ar[r] &
C(f_*(M,\theta))
}
$$
in which the compositions along the columns are identity morphisms.
The second row is the coequalizer diagram
(\ref{equation-coequalizer-CM}); this produces the dashed arrow.
From the top right square, we obtain auxiliary morphisms $C(f_*(M,\theta)) \to 
C(M)$ 
and $C(M) \to C(M\otimes_{S,\delta_1^1} S_2)$ which imply that the first row is 
a split coequalizer diagram.
By Remark \ref{remark-adjunction}, we may tensor with $S$ inside $C$ to obtain 
the split coequalizer diagram
$$
\xymatrix@C=8pc{
C(M \otimes_{S,\delta_2^2 \circ \delta_1^1} S_3)
\ar@<1ex>^{C((\theta \otimes \delta_2^2) \circ (1_M \otimes \delta^2_0))}[r] 
\ar@<-1ex>_{C(1_{M \otimes S_2} \otimes \delta^2_1)}[r] &
C(M \otimes_{S, \delta_1^1} S_2 )
\ar[r]^{C(\theta \circ (1_M \otimes \delta_0^1))} &
C(f_*(M,\theta) \otimes_R S).
}
$$
By Lemma \ref{lemma-C-is-faithful}, we conclude
(\ref{equation-equalizer-f2}) must also be an equalizer.
\end{proof}

\begin{remark}
\label{remark-descent-lemma}
If $f$ is a split injection in $\text{Mod}_R$, one can simplify the argument by 
splitting $f$ directly,
without using $C$. Things are even simpler if $f$ is faithfully flat; in this 
case,
the conclusion of Lemma \ref{lemma-descent-lemma} 
is immediate because tensoring over $R$ with $S$ preserves all equalizers.
\end{remark}

\begin{theorem}
\label{theorem-descent}
The following conditions are equivalent.
\begin{enumerate}
\item[(a)] The morphism $f$ is a descent morphism for modules.
\item[(b)] The morphism $f$ is an effective descent morphism for modules.
\item[(c)] The morphism $f$ is universally injective.
\end{enumerate}
\end{theorem}

\begin{proof}
It is clear that (b) implies (a). We now check that (a) implies (c). If $f$ is 
not universally injective, we can find $M \in \text{Mod}_R$ such that the map
$1_M \otimes f: M \to M \otimes_R S$ has nontrivial kernel $N$.
The natural projection $M \to M/N$ is not an isomorphism, but its image in 
$DD_{S/R}$ is an isomorphism.
Hence $f^*$ is not fully faithful.

\medskip\noindent
We finally check that (c) implies (b). By Lemma \ref{lemma-descent-lemma}, for
$(M, \theta) \in DD_{S/R}$,
the natural map $f^* f_*(M,\theta) \to M$ is an isomorphism of $S$-modules. On 
the other hand, for $M_0 \in \text{Mod}_R$,
we may tensor (\ref{equation-equalizer-S}) with $M_0$ over $R$ to obtain an 
equalizer sequence,
so $M_0 \to f_* f^* M$ is an isomorphism. Consequently, $f_*$ and $f^*$ are 
quasi-inverse functors, proving the claim.
\end{proof}

\subsection{Descent for properties of modules}
\label{subsection-descent-properties-modules}

\noindent
Throughout this subsection, fix a universally injective ring map $f : R \to S$,
an object $M \in \text{Mod}_R$, and a ring map $R \to A$. We now investigate
the question of which properties of $M$ or $A$ can be checked after base
extension along $f$. We start with some results from 
\cite{mesablishvili2}.

\begin{lemma}
\label{lemma-flat-to-injective}
If $M \in \text{Mod}_R$ is flat, then $C(M)$ is an injective $R$-module.
\end{lemma}

\begin{proof}
Let $0 \to N \to P \to Q \to 0$ be an exact sequence in $\text{Mod}_R$. Since 
$M$ is flat,
$$
0 \to N \otimes_R M \to P \otimes_R M \to Q \otimes_R M \to 0
$$
is exact.
By Lemma \ref{lemma-C-is-faithful},
$$
0 \to C(Q \otimes_R M) \to C(P \otimes_R M) \to C(N \otimes_R M) \to 0
$$
is exact. By (\ref{equation-adjunction}), this last sequence can be rewritten
as
$$
0 \to \Hom_R(Q, C(M)) \to \Hom_R(P, C(M)) \to \Hom_R(N, C(M)) \to 0.
$$
Hence $C(M)$ is an injective object of $\text{Mod}_R$.
\end{proof}

\begin{theorem}
\label{theorem-descend-module-properties}
If $M \otimes_R S$ has one of the following properties as an $S$-module
\begin{enumerate}
\item[(a)]
finitely generated;
\item[(b)]
finitely presented;
\item[(c)]
flat;
\item[(d)]
faithfully flat;
\item[(e)]
finite projective;
\end{enumerate}
then so does $M$ as an $R$-module (and conversely).
\end{theorem}

\begin{proof}
To prove (a), choose a finite set $\{n_i\}$ of generators of $M \otimes_R S$
in $\text{Mod}_S$. Write each $n_i$ as $\sum_j m_{ij} \otimes s_{ij}$ with
$m_{ij} \in M$ and $s_{ij} \in S$. Let $F$ be the finite free $R$-module with
basis $e_{ij}$ and let $F \to M$ be the $R$-module map sending $e_{ij}$ to
$m_{ij}$. Then $F \otimes_R S\to M \otimes_R S$ is surjective, so
$\Coker(F \to M) \otimes_R S$ is zero and hence $\Coker(F \to M)$
is zero. This proves (a).

\medskip\noindent
To see (b) assume $M \otimes_R S$ is finitely presented. Then $M$ is finitely
generated by (a). Choose a surjection $R^{\oplus n} \to M$ with kernel $K$.
Then $K \otimes_R S \to S^{\oplus r} \to M \otimes_R S \to 0$ is exact.
By Algebra, Lemma \ref{algebra-lemma-extension}
the kernel of $S^{\oplus r} \to M \otimes_R S$
is a finite $S$-module. Thus we can find finitely many elements
$k_1, \ldots, k_t \in K$ such that the images of $k_i \otimes 1$ in
$S^{\oplus r}$ generate the kernel of $S^{\oplus r} \to M \otimes_R S$.
Let $K' \subset K$ be the submodule generated by $k_1, \ldots, k_t$.
Then $M' = R^{\oplus r}/K'$ is a finitely presented $R$-module
with a morphism $M' \to M$ such that $M' \otimes_R S \to M \otimes_R S$
is an isomorphism. Thus $M' \cong M$ as desired.

\medskip\noindent
To prove (c), let $0 \to M' \to M'' \to M \to 0$ be a short exact sequence in 
$\text{Mod}_R$. Since $\bullet \otimes_R S$ is a right exact functor,
$M'' \otimes_R S \to M \otimes_R S$ is surjective. So by
Lemma \ref{lemma-C-is-faithful} the map
$C(M \otimes_R S) \to C(M'' \otimes_R S)$ is injective.
If $M \otimes_R S$ is flat, then
Lemma \ref{lemma-flat-to-injective} shows
$C(M \otimes_R S)$ is an injective object of $\text{Mod}_S$, so the injection
$C(M \otimes_R S) \to C(M'' \otimes_R S)$
is split in $\text{Mod}_S$ and hence also in $\text{Mod}_R$.
Since $C(M \otimes_R S) \to C(M)$ is a split surjection by 
Lemma \ref{lemma-split-surjection}, it follows that 
$C(M) \to C(M'')$ is a split injection in $\text{Mod}_R$. That is, the sequence
$$
0 \to C(M) \to C(M'') \to C(M') \to 0
$$
is split exact. 
For $N \in \text{Mod}_R$, by (\ref{equation-adjunction}) we see that 
$$
0 \to C(M \otimes_R N) \to C(M'' \otimes_R N) \to C(M' \otimes_R N) \to 0
$$
is split exact. By Lemma \ref{lemma-C-is-faithful}, 
$$
0 \to M' \otimes_R N \to M'' \otimes_R N \to M \otimes_R N \to 0
$$
is exact. This implies $M$ is flat over $R$. Namely, taking
$M'$ a free module surjecting onto $M$ we conclude that
$\text{Tor}_1^R(M, N) = 0$ for all modules $N$ and we can use
Algebra, Lemma \ref{algebra-lemma-characterize-flat}.
This proves (c).

\medskip\noindent
To deduce (d) from (c), note that if $N \in \text{Mod}_R$ and $M \otimes_R N$ 
is zero,
then $M \otimes_R S \otimes_S (N \otimes_R S) \cong (M \otimes_R N) \otimes_R 
S$ is zero,
so $N \otimes_R S$ is zero and hence $N$ is zero.

\medskip\noindent
To deduce (e) at this point, it suffices to recall that $M$ is finitely 
generated and projective if and only if it is finitely presented and flat.
See Algebra, Lemma \ref{algebra-lemma-finite-projective}.
\end{proof}

\noindent
There is a variant for $R$-algebras.

\begin{theorem}
\label{theorem-descend-algebra-properties}
If $A \otimes_R S$ has one of the following properties as an $S$-algebra
\begin{enumerate}
\item[(a)]
of finite type;
\item[(b)]
of finite presentation;
\item[(c)]
formally unramified;
\item[(d)]
unramified;
\item[(e)]
\'etale;
\end{enumerate}
then so does $A$ as an $R$-algebra (and of course conversely).
\end{theorem}

\begin{proof}
To prove (a), choose a finite set $\{x_i\}$ of generators of $A \otimes_R S$
over $S$. Write each $x_i$ as $\sum_j y_{ij} \otimes s_{ij}$ with
$y_{ij} \in A$ and $s_{ij} \in S$. Let $F$ be the polynomial $R$-algebra
on variables $e_{ij}$ and let $F \to M$ be the $R$-algebra map sending
$e_{ij}$ to $y_{ij}$. Then $F \otimes_R S\to A \otimes_R S$ is surjective, so
$\Coker(F \to A) \otimes_R S$ is zero and hence $\Coker(F \to A)$
is zero. This proves (a).

\medskip\noindent
To see (b) assume $A \otimes_R S$ is a finitely presented $S$-algebra.
Then $A$ is finite type over $R$ by (a). Choose a surjection
$R[x_1, \ldots, x_n] \to A$ with kernel $I$.
Then $I \otimes_R S \to S[x_1, \ldots, x_n] \to A \otimes_R S \to 0$ is exact.
By Algebra, Lemma \ref{algebra-lemma-finite-presentation-independent}
the kernel of $S[x_1, \ldots, x_n] \to A \otimes_R S$
is a finitely generated ideal. Thus we can find finitely many elements
$y_1, \ldots, y_t \in I$ such that the images of $y_i \otimes 1$ in
$S[x_1, \ldots, x_n]$ generate the kernel of
$S[x_1, \ldots, x_n] \to A \otimes_R S$.
Let $I' \subset I$ be the ideal generated by $y_1, \ldots, y_t$.
Then $A' = R[x_1, \ldots, x_n]/I'$ is a finitely presented $R$-algebra
with a morphism $A' \to A$ such that $A' \otimes_R S \to A \otimes_R S$
is an isomorphism. Thus $A' \cong A$ as desired.

\medskip\noindent
To prove (c), recall that $A$ is formally unramified over $R$ if and only
if the module of relative differentials $\Omega_{A/R}$ vanishes, see
Algebra, Lemma \ref{algebra-lemma-characterize-formally-unramified} or
\cite[Proposition~17.2.1]{EGA4}.
Since $\Omega_{(A \otimes_R S)/S} = \Omega_{A/R} \otimes_R S$,
the vanishing descends by Theorem \ref{theorem-descent}.

\medskip\noindent
To deduce (d) from the previous cases, recall that $A$ is unramified
over $R$ if and only if $A$ is formally unramified and of finite type
over $R$, see
Algebra, Lemma \ref{algebra-lemma-formally-unramified-unramified}.

\medskip\noindent
To prove (e), recall that by
Algebra, Lemma \ref{algebra-lemma-etale-flat-unramified-finite-presentation}
or \cite[Th\'eor\`eme~17.6.1]{EGA4} the algebra
$A$ is \'etale over $R$ if and only if
$A$ is flat, unramified, and of finite presentation over $R$.
\end{proof}

\begin{remark}
\label{remark-when-locally-split}
It would make things easier to have a faithfully
flat ring homomorphism $g: R \to T$ for which $T \to S \otimes_R T$ has some 
extra structure.
For instance, if one could ensure that $T \to S \otimes_R T$ is split in 
$\textit{Rings}$,
then it would follow that every property of a module or algebra which is stable 
under base extension
and which descends along faithfully flat morphisms also descends along 
universally injective morphisms.
An obvious guess would be to find $g$ for which $T$ is not only faithfully flat 
but also injective in $\text{Mod}_R$,
but even for $R = \mathbf{Z}$ no such homomorphism can exist.
\end{remark}
















\section{Fpqc descent of quasi-coherent sheaves}
\label{section-fpqc-descent-quasi-coherent}

\noindent
The main application of flat descent for modules is
the corresponding descent statement for quasi-coherent
sheaves with respect to fpqc-coverings.

\begin{lemma}
\label{lemma-standard-fpqc-covering}
Let $S$ be an affine scheme.
Let $\mathcal{U} = \{f_i : U_i \to S\}_{i = 1, \ldots, n}$
be a standard fpqc covering of $S$, see
Topologies, Definition \ref{topologies-definition-standard-fpqc}.
Any descent datum on quasi-coherent sheaves
for $\mathcal{U} = \{U_i \to S\}$ is effective.
Moreover, the functor from the category of
quasi-coherent $\mathcal{O}_S$-modules to the category
of descent data with respect to $\mathcal{U}$ is fully faithful.
\end{lemma}

\begin{proof}
This is a restatement of Proposition \ref{proposition-descent-module}
in terms of schemes. First, note that a descent datum $\xi$
for quasi-coherent sheaves with respect to $\mathcal{U}$
is exactly the same as a descent datum $\xi'$ for quasi-coherent sheaves
with respect to the covering
$\mathcal{U}' = \{\coprod_{i = 1, \ldots, n} U_i \to S\}$.
Moreover, effectivity for $\xi$ is the same as effectivity for $\xi'$.
Hence we may assume $n = 1$, i.e., $\mathcal{U} = \{U \to S\}$
where $U$ and $S$ are affine. In this case descent data
correspond to descent data on modules with respect to the ring map
$$
\Gamma(S, \mathcal{O})
\longrightarrow
\Gamma(U, \mathcal{O}).
$$
Since $U \to S$ is surjective and flat, we see that this ring map
is faithfully flat. In other words,
Proposition \ref{proposition-descent-module} applies and we win.
\end{proof}

\begin{proposition}
\label{proposition-fpqc-descent-quasi-coherent}
Let $S$ be a scheme.
Let $\mathcal{U} = \{\varphi_i : U_i \to S\}$ be an fpqc covering, see
Topologies, Definition \ref{topologies-definition-fpqc-covering}.
Any descent datum on quasi-coherent sheaves
for $\mathcal{U} = \{U_i \to S\}$ is effective.
Moreover, the functor from the category of
quasi-coherent $\mathcal{O}_S$-modules to the category
of descent data with respect to $\mathcal{U}$ is fully faithful.
\end{proposition}

\begin{proof}
Let $S = \bigcup_{j \in J} V_j$ be an affine open covering.
For $j, j' \in J$ we denote $V_{jj'} = V_j \cap V_{j'}$ the intersection
(which need not be affine). For $V \subset S$ open we denote
$\mathcal{U}_V = \{V \times_S U_i \to V\}_{i \in I}$ which is a
fpqc-covering (Topologies, Lemma \ref{topologies-lemma-fpqc}).
By definition of an fpqc covering, we can find for each $j \in J$ a
finite set $K_j$, a map $\underline{i} : K_j \to I$,
affine opens $U_{\underline{i}(k), k} \subset U_{\underline{i}(k)}$,
$k \in K_j$ such that
$\mathcal{V}_j = \{U_{\underline{i}(k), k} \to V_j\}_{k \in K_j}$ is
a standard fpqc covering of $V_j$. And of course, $\mathcal{V}_j$
is a refinement of $\mathcal{U}_{V_j}$. Picture
$$
\xymatrix{
\mathcal{V}_j \ar[r] \ar@{~>}[d] &
\mathcal{U}_{V_j} \ar[r] \ar@{~>}[d] &
\mathcal{U} \ar@{~>}[d] \\
V_j \ar@{=}[r] & V_j \ar[r] & S
}
$$
where the top horizontal arrows are morphisms of families of
morphisms with fixed target (see
Sites, Definition \ref{sites-definition-morphism-coverings}).

\medskip\noindent
To prove the proposition you show successively the
faithfulness, fullness, and essential surjectivity of the
functor from quasi-coherent sheaves to descent data.

\medskip\noindent
Faithfulness. Let $\mathcal{F}$, $\mathcal{G}$ be quasi-coherent
sheaves on $S$ and let $a, b : \mathcal{F} \to \mathcal{G}$ be
homomorphisms of $\mathcal{O}_S$-modules.
Suppose $\varphi_i^*(a) = \varphi^*(b)$ for all $i$.
Pick $s \in S$. Then $s = \varphi_i(u)$ for some $i \in I$ and
$u \in U_i$. Since $\mathcal{O}_{S, s} \to \mathcal{O}_{U_i, u}$
is flat, hence faithfully flat
(Algebra, Lemma \ref{algebra-lemma-local-flat-ff}) we see
that $a_s = b_s : \mathcal{F}_s \to \mathcal{G}_s$. Hence $a = b$.

\medskip\noindent
Fully faithfulness. Let $\mathcal{F}$, $\mathcal{G}$ be quasi-coherent
sheaves on $S$ and let
$a_i : \varphi_i^*\mathcal{F} \to \varphi_i^*\mathcal{G}$ be
homomorphisms of $\mathcal{O}_{U_i}$-modules such that
$\text{pr}_0^*a_i = \text{pr}_1^*a_j$ on $U_i \times_U U_j$.
We can pull back these morphisms to get morphisms
$$
a_k :
\mathcal{F}|_{U_{\underline{i}(k), k}}
\longrightarrow
\mathcal{G}|_{U_{\underline{i}(k), k}}
$$
$k \in K_j$ with notation as above. Moreover,
Lemma \ref{lemma-refine-descent-datum} assures us
that these define a morphism between (canonical) descent data on
$\mathcal{V}_j$. Hence, by
Lemma \ref{lemma-standard-fpqc-covering}, we get correspondingly
unique morphisms $a_j : \mathcal{F}|_{V_j} \to \mathcal{G}|_{V_j}$.
To see that $a_j|_{V_{jj'}} = a_{j'}|_{V_{jj'}}$ we use that
both $a_j$ and $a_{j'}$ agree with the pullback of the morphism
$(a_i)_{i \in I}$ of (canonical) descent data to any covering
refining both $\mathcal{V}_{j, V_{jj'}}$ and
$\mathcal{V}_{j', V_{jj'}}$, and using the faithfulness already
shown. For example the covering
$\mathcal{V}_{jj'} =
\{V_k \times_S V_{k'} \to V_{jj'}\}_{k \in K_j, k' \in K_{j'}}$
will do.

\medskip\noindent
Essential surjectivity. Let $\xi = (\mathcal{F}_i, \varphi_{ii'})$
be a descent datum for quasi-coherent sheaves relative to the covering
$\mathcal{U}$. Pull back this descent datum to get descent data
$\xi_j$ for quasi-coherent sheaves relative to the coverings
$\mathcal{V}_j$ of $V_j$. By Lemma \ref{lemma-standard-fpqc-covering}
once again there exist
quasi-coherent sheaves $\mathcal{F}_j$ on $V_j$ whose associated
canonical descent datum is isomorphic to $\xi_j$. By fully faithfulness
(proved above) we see there are isomorphisms
$$
\phi_{jj'} :
\mathcal{F}_j|_{V_{jj'}}
\longrightarrow
\mathcal{F}_{j'}|_{V_{jj'}}
$$
corresponding to the isomorphism of descent data between the pullback
of $\xi_j$ and $\xi_{j'}$ to $\mathcal{V}_{jj'}$. To see that these
maps $\phi_{jj'}$ satisfy the cocycle condition we use faithfulness
(proved above) over the triple intersections $V_{jj'j''}$. Hence, by
Lemma \ref{lemma-zariski-descent-effective}
we see that the sheaves $\mathcal{F}_j$
glue to a quasi-coherent sheaf $\mathcal{F}$ as desired.
We still have to verify that the canonical descent datum relative to
$\mathcal{U}$ associated to $\mathcal{F}$ is isomorphic to the descent
datum we started out with. This verification is omitted.
\end{proof}









\section{Galois descent for quasi-coherent sheaves}
\label{section-galois-descent}

\noindent
Galois descent for quasi-coherent sheaves is just a special
case of fpqc descent for quasi-coherent sheaves. In this section
we will explain how to translate from a Galois descent to
an fpqc descent and then apply earlier results to conclude.

\medskip\noindent
Let $k'/k$ be a field extension. Then $\{\Spec(k') \to \Spec(k)\}$
is an fpqc covering. Let $X$ be a scheme over $k$. For a $k$-algebra
$A$ we set $X_A = X \times_{\Spec(k)} \Spec(A)$. By
Topologies, Lemma \ref{topologies-lemma-fpqc}
we see that $\{X_{k'} \to X\}$ is an fpqc covering. Observe that
$$
X_{k'} \times_X X_{k'} = X_{k' \otimes_k k'}
\quad\text{and}\quad
X_{k'} \times_X X_{k'} \times_X X_{k'} = X_{k' \otimes_k k' \otimes_k k'}
$$
Thus a descent datum for quasi-coherent sheaves with respect to
$\{X_{k'} \to X\}$ is given by a quasi-coherent sheaf $\mathcal{F}$
on $X_{k'}$, an isomorphism
$\varphi : \text{pr}_0^*\mathcal{F} \to \text{pr}_1^*\mathcal{F}$
on $X_{k' \otimes_k k'}$
which satisfies an obvious cocycle condition on
$X_{k' \otimes_k k' \otimes_k k'}$.
We will work out what this means in the case of a Galois extension below.

\medskip\noindent
Let $k'/k$ be a finite Galois extension with Galois group
$G = \text{Gal}(k'/k)$. Then there are $k$-algebra isomorphisms
$$
k' \otimes_k k' \longrightarrow \prod\nolimits_{\sigma \in G} k',\quad
a \otimes b \longrightarrow \prod a\sigma(b)
$$
and
$$
k' \otimes_k k' \otimes_k k' \longrightarrow
\prod\nolimits_{(\sigma, \tau) \in G \times G} k',\quad
a \otimes b \otimes c \longrightarrow \prod a\sigma(b)\sigma(\tau(c))
$$
The reason for choosing here $a\sigma(b)\sigma(\tau(c))$
and not $a\sigma(b)\tau(c)$ is that the formulas below simplify but
it isn't strictly necessary. Given $\sigma \in G$ we denote
$$
f_\sigma = \text{id}_X \times \Spec(\sigma) :
X_{k'} \longrightarrow X_{k'}
$$
Please keep in mind that because $\Spec(-)$ is a contravariant functor we have
$f_{\sigma \tau} = f_\tau \circ f_\sigma$ and not the other way around.
Using the first isomorphism above we obtain an identification
$$
X_{k' \otimes_k k'} = \coprod\nolimits_{\sigma \in G} X_{k'}
$$
such that $\text{pr}_0$ corresponds to the map
$$
\coprod\nolimits_{\sigma \in G} X_{k'}
\xrightarrow{\coprod \text{id}}
X_{k'}
$$
and such that $\text{pr}_1$ corresponds to the map
$$
\coprod\nolimits_{\sigma \in G} X_{k'}
\xrightarrow{\coprod f_\sigma}
X_{k'}
$$
Thus we see that a descent datum $\varphi$ on $\mathcal{F}$ over $X_{k'}$
corresponds to a family of isomorphisms
$\varphi_\sigma : \mathcal{F} \to f_\sigma^*\mathcal{F}$.
To work out the cocycle condition we use the identification
$$
X_{k' \otimes_k k' \otimes_k k'} =
\coprod\nolimits_{(\sigma, \tau) \in G \times G} X_{k'}.
$$
we get from our isomorphism of algebras above.
Via this identification the map $\text{pr}_{01}$ corresponds to
the map
$$
\coprod\nolimits_{(\sigma, \tau) \in G \times G} X_{k'}
\longrightarrow
\coprod\nolimits_{\sigma \in G} X_{k'}
$$
which maps the summand with index $(\sigma, \tau)$ to the summand
with index $\sigma$ via the identity morphism. The map $\text{pr}_{12}$
corresponds to the map
$$
\coprod\nolimits_{(\sigma, \tau) \in G \times G} X_{k'}
\longrightarrow
\coprod\nolimits_{\sigma \in G} X_{k'}
$$
which maps the summand with index $(\sigma, \tau)$ to the summand
with index $\tau$ via the morphism $f_\sigma$. Finally, the map
$\text{pr}_{02}$ corresponds to the map
$$
\coprod\nolimits_{(\sigma, \tau) \in G \times G} X_{k'}
\longrightarrow
\coprod\nolimits_{\sigma \in G} X_{k'}
$$
which maps the summand with index $(\sigma, \tau)$ to the summand
with index $\sigma\tau$ via the identity morphism.
Thus the cocycle condition
$$
\text{pr}_{02}^*\varphi = \text{pr}_{12}^*\varphi \circ \text{pr}_{01}^*\varphi
$$
translates into one condition for each pair $(\sigma, \tau)$, namely
$$
\varphi_{\sigma\tau} = f_\sigma^*\varphi_\tau \circ \varphi_\sigma
$$
as maps $\mathcal{F} \to f_{\sigma\tau}^*\mathcal{F}$.
(Everything works out beautifully; for example the target of
$\varphi_\sigma$ is $f_\sigma^*\mathcal{F}$ and the
source of $f_\sigma^*\varphi_\tau$ is $f_\sigma^*\mathcal{F}$ as well.)

\begin{lemma}
\label{lemma-galois-descent}
Let $k'/k$ be a (finite) Galois extension with Galois group $G$.
Let $X$ be a scheme over $k$. The category of quasi-coherent
$\mathcal{O}_X$-modules is equivalent to the category of systems
$(\mathcal{F}, (\varphi_\sigma)_{\sigma \in G})$ where
\begin{enumerate}
\item $\mathcal{F}$ is a quasi-coherent module on $X_{k'}$,
\item $\varphi_\sigma : \mathcal{F} \to f_\sigma^*\mathcal{F}$
is an isomorphism of modules,
\item $\varphi_{\sigma\tau} = f_\sigma^*\varphi_\tau \circ \varphi_\sigma$
for all $\sigma, \tau \in G$.
\end{enumerate}
Here $f_\sigma = \text{id}_X \times \Spec(\sigma) : X_{k'} \to X_{k'}$.
\end{lemma}

\begin{proof}
As seen above a datum $(\mathcal{F}, (\varphi_\sigma)_{\sigma \in G})$
as in the lemma is the same thing as a descent datum for the
fpqc covering $\{X_{k'} \to X\}$. Thus the lemma follows from
Proposition \ref{proposition-fpqc-descent-quasi-coherent}.
\end{proof}

\noindent
A slightly more general case of the above is the following.
Suppose we have a surjective finite \'etale morphism $X \to Y$
and a finite group $G$ together with a group homomorphism
$G^{opp} \to \text{Aut}_Y(X), \sigma \mapsto f_\sigma$
such that the map
$$
G \times X \longrightarrow X \times_Y X,\quad
(\sigma, x) \longmapsto (x, f_\sigma(x))
$$
is an isomorphism. Then the same result as above holds.

\begin{lemma}
\label{lemma-galois-descent-more-general}
Let $X \to Y$, $G$, and $f_\sigma : X \to X$ be as above.
The category of quasi-coherent
$\mathcal{O}_Y$-modules is equivalent to the category of systems
$(\mathcal{F}, (\varphi_\sigma)_{\sigma \in G})$ where
\begin{enumerate}
\item $\mathcal{F}$ is a quasi-coherent $\mathcal{O}_X$-module,
\item $\varphi_\sigma : \mathcal{F} \to f_\sigma^*\mathcal{F}$
is an isomorphism of modules,
\item $\varphi_{\sigma\tau} = f_\sigma^*\varphi_\tau \circ \varphi_\sigma$
for all $\sigma, \tau \in G$.
\end{enumerate}
\end{lemma}

\begin{proof}
Since $X \to Y$ is surjective finite \'etale $\{X \to Y\}$ is
an fpqc covering. Since
$G \times X \to X \times_Y X$, $(\sigma, x) \mapsto (x, f_\sigma(x))$
is an isomorphism, we see that
$G \times G \times X \to X \times_Y X \times_Y X$,
$(\sigma, \tau, x) \mapsto (x, f_\sigma(x), f_{\sigma\tau}(x))$
is an isomorphism too. Using these identifications, the category of
data as in the lemma is the same as the category of descent data
for quasi-coherent sheaves for the covering $\{x \to Y\}$.
Thus the lemma follows from
Proposition \ref{proposition-fpqc-descent-quasi-coherent}.
\end{proof}









\section{Descent of finiteness properties of modules}
\label{section-descent-finiteness}

\noindent
In this section we prove that one can check quasi-coherent module
has a certain finiteness conditions by checking on the members of
a covering.

\begin{lemma}
\label{lemma-finite-type-descends}
Let $X$ be a scheme.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module.
Let $\{f_i : X_i \to X\}_{i \in I}$ be an fpqc covering such that
each $f_i^*\mathcal{F}$ is a finite type $\mathcal{O}_{X_i}$-module.
Then $\mathcal{F}$ is a finite type $\mathcal{O}_X$-module.
\end{lemma}

\begin{proof}
Omitted. For the affine case, see
Algebra, Lemma \ref{algebra-lemma-descend-properties-modules}.
\end{proof}

\begin{lemma}
\label{lemma-finite-type-descends-fppf}
Let $f : (X, \mathcal{O}_X) \to (Y, \mathcal{O}_Y)$ be a morphism of
locally ringed spaces. Let $\mathcal{F}$ be a sheaf of $\mathcal{O}_Y$-modules.
If
\begin{enumerate}
\item $f$ is open as a map of topological spaces,
\item $f$ is surjective and flat, and
\item $f^*\mathcal{F}$ is of finite type,
\end{enumerate}
then $\mathcal{F}$ is of finite type.
\end{lemma}

\begin{proof}
Let $y \in Y$ be a point. Choose a point $x \in X$ mapping to $y$.
Choose an open $x \in U \subset X$ and elements $s_1, \ldots, s_n$
of $f^*\mathcal{F}(U)$ which generate $f^*\mathcal{F}$ over $U$.
Since $f^*\mathcal{F} =
f^{-1}\mathcal{F} \otimes_{f^{-1}\mathcal{O}_Y} \mathcal{O}_X$
we can after shrinking $U$ assume $s_i = \sum t_{ij} \otimes a_{ij}$
with $t_{ij} \in f^{-1}\mathcal{F}(U)$ and $a_{ij} \in \mathcal{O}_X(U)$.
After shrinking $U$ further we may assume that $t_{ij}$ comes from
a section $s_{ij} \in \mathcal{F}(V)$ for some $V \subset Y$ open
with $f(U) \subset V$. Let $N$ be the number of sections $s_{ij}$ and
consider the map
$$
\sigma = (s_{ij}) : \mathcal{O}_V^{\oplus N} \to \mathcal{F}|_V
$$
By our choice of the sections we see that $f^*\sigma|_U$ is surjective.
Hence for every $u \in U$ the map
$$
\sigma_{f(u)} \otimes_{\mathcal{O}_{Y, f(u)}} \mathcal{O}_{X, u} :
\mathcal{O}_{X, u}^{\oplus N}
\longrightarrow
\mathcal{F}_{f(u)} \otimes_{\mathcal{O}_{Y, f(u)}} \mathcal{O}_{X, u}
$$
is surjective. As $f$ is flat, the local ring map
$\mathcal{O}_{Y, f(u)} \to \mathcal{O}_{X, u}$ is flat, hence
faithfully flat (Algebra, Lemma \ref{algebra-lemma-local-flat-ff}).
Hence $\sigma_{f(u)}$ is surjective. Since $f$ is open, $f(U)$ is
an open neighbourhood of $y$ and the proof is done.
\end{proof}

\begin{lemma}
\label{lemma-finite-presentation-descends}
Let $X$ be a scheme.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module.
Let $\{f_i : X_i \to X\}_{i \in I}$ be an fpqc covering such that
each $f_i^*\mathcal{F}$ is an $\mathcal{O}_{X_i}$-module of finite
presentation. Then $\mathcal{F}$ is an $\mathcal{O}_X$-module
of finite presentation.
\end{lemma}

\begin{proof}
Omitted. For the affine case, see
Algebra, Lemma \ref{algebra-lemma-descend-properties-modules}.
\end{proof}

\begin{lemma}
\label{lemma-locally-generated-by-r-sections-descends}
Let $X$ be a scheme.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module.
Let $\{f_i : X_i \to X\}_{i \in I}$ be an fpqc covering such that
each $f_i^*\mathcal{F}$ is locally generated by $r$ sections as an
$\mathcal{O}_{X_i}$-module. Then $\mathcal{F}$ is locally generated by
$r$ sections as an $\mathcal{O}_X$-module.
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-finite-type-descends} we see that $\mathcal{F}$
is of finite type. Hence Nakayama's lemma
(Algebra, Lemma \ref{algebra-lemma-NAK}) implies that $\mathcal{F}$
is generated by $r$ sections in the neighbourhood of a point $x \in X$
if and only if $\dim_{\kappa(x)} \mathcal{F}_x \otimes \kappa(x) \leq r$.
Choose an $i$ and a point $x_i \in X_i$ mapping to $x$. Then
$\dim_{\kappa(x)} \mathcal{F}_x \otimes \kappa(x) = 
\dim_{\kappa(x_i)} (f_i^*\mathcal{F})_{x_i} \otimes \kappa(x_i)$
which is $\leq r$ as $f_i^*\mathcal{F}$ is locally generated by $r$
sections.
\end{proof}

\begin{lemma}
\label{lemma-flat-descends}
Let $X$ be a scheme.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module.
Let $\{f_i : X_i \to X\}_{i \in I}$ be an fpqc covering such that
each $f_i^*\mathcal{F}$ is a flat $\mathcal{O}_{X_i}$-module.
Then $\mathcal{F}$ is a flat $\mathcal{O}_X$-module.
\end{lemma}

\begin{proof}
Omitted. For the affine case, see
Algebra, Lemma \ref{algebra-lemma-descend-properties-modules}.
\end{proof}

\begin{lemma}
\label{lemma-finite-locally-free-descends}
Let $X$ be a scheme.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module.
Let $\{f_i : X_i \to X\}_{i \in I}$ be an fpqc covering such that
each $f_i^*\mathcal{F}$ is a finite locally free $\mathcal{O}_{X_i}$-module.
Then $\mathcal{F}$ is a finite locally free $\mathcal{O}_X$-module.
\end{lemma}

\begin{proof}
This follows from the fact that a quasi-coherent sheaf is finite locally
free if and only if it is of finite presentation and flat, see
Algebra, Lemma \ref{algebra-lemma-finite-projective}.
Namely, if each $f_i^*\mathcal{F}$ is flat and of finite presentation,
then so is $\mathcal{F}$ by
Lemmas \ref{lemma-flat-descends} and
\ref{lemma-finite-presentation-descends}.
\end{proof}

\noindent
The definition of a locally projective quasi-coherent sheaf can be found in
Properties, Section \ref{properties-section-locally-projective}.

\begin{lemma}
\label{lemma-locally-projective-descends}
Let $X$ be a scheme.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module.
Let $\{f_i : X_i \to X\}_{i \in I}$ be an fpqc covering such that
each $f_i^*\mathcal{F}$ is a locally projective $\mathcal{O}_{X_i}$-module.
Then $\mathcal{F}$ is a locally projective $\mathcal{O}_X$-module.
\end{lemma}

\begin{proof}
Omitted. For Zariski coverings this is
Properties, Lemma \ref{properties-lemma-locally-projective}.
For the affine case this is
Algebra, Theorem \ref{algebra-theorem-ffdescent-projectivity}.
\end{proof}

\begin{remark}
\label{remark-locally-free-descends}
Being locally free is a property of quasi-coherent modules which
does not descend in the fpqc topology. Namely, suppose that
$R$ is a ring and that $M$ is a projective $R$-module which is
a countable direct sum $M = \bigoplus L_n$ of rank 1 locally
free modules, but not locally free, see
Examples, Lemma \ref{examples-lemma-projective-not-locally-free}.
Then $M$ becomes free on making the faithfully flat base change
$$
R \longrightarrow
\bigoplus\nolimits_{m \geq 1}
\bigoplus\nolimits_{(i_1, \ldots, i_m) \in \mathbf{Z}^{\oplus m}}
L_1^{\otimes i_1} \otimes_R \ldots \otimes_R L_m^{\otimes i_m}
$$
But we don't know what happens for fppf coverings. In other words,
we don't know the answer to the following question:
Suppose $A \to B$ is a faithfully
flat ring map of finite presentation. Let $M$ be an $A$-module
such that $M \otimes_A B$ is free. Is $M$ a locally free
$A$-module? It turns out that if $A$ is Noetherian, then the answer
is yes. This follows from the results of \cite{Bass}. But in general
we don't know the answer. If you know the answer, or have a reference,
please email
\href{mailto:stacks.project@gmail.com}{stacks.project@gmail.com}.
\end{remark}

\noindent
We also add here two results which are related to the results above, but
are of a slightly different nature.

\begin{lemma}
\label{lemma-finite-over-finite-module}
Let $f : X \to Y$ be a morphism of schemes.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module.
Assume $f$ is a finite morphism.
Then $\mathcal{F}$ is an $\mathcal{O}_X$-module of finite type
if and only if $f_*\mathcal{F}$ is an $\mathcal{O}_Y$-module of finite
type.
\end{lemma}

\begin{proof}
As $f$ is finite it is affine. This reduces us to the case where
$f$ is the morphism $\Spec(B) \to \Spec(A)$ given
by a finite ring map $A \to B$.
Moreover, then $\mathcal{F} = \widetilde{M}$ is the sheaf of modules
associated to the $B$-module $M$.
Note that $M$ is finite as a $B$-module if and only if
$M$ is finite as an $A$-module, see
Algebra, Lemma \ref{algebra-lemma-finite-module-over-finite-extension}.
Combined with
Properties, Lemma \ref{properties-lemma-finite-type-module}
this proves the lemma.
\end{proof}

\begin{lemma}
\label{lemma-finite-finitely-presented-module}
Let $f : X \to Y$ be a morphism of schemes.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module.
Assume $f$ is finite and of finite presentation.
Then $\mathcal{F}$ is an $\mathcal{O}_X$-module of finite presentation
if and only if $f_*\mathcal{F}$ is an $\mathcal{O}_Y$-module of finite
presentation.
\end{lemma}

\begin{proof}
As $f$ is finite it is affine. This reduces us to the case where
$f$ is the morphism $\Spec(B) \to \Spec(A)$ given
by a finite and finitely presented ring map $A \to B$.
Moreover, then $\mathcal{F} = \widetilde{M}$ is the sheaf of modules
associated to the $B$-module $M$.
Note that $M$ is finitely presented as a $B$-module if and only if
$M$ is finitely presented as an $A$-module, see
Algebra, Lemma \ref{algebra-lemma-finite-finitely-presented-extension}.
Combined with
Properties, Lemma \ref{properties-lemma-finite-presentation-module}
this proves the lemma.
\end{proof}
















\section{Quasi-coherent sheaves and topologies}
\label{section-quasi-coherent-sheaves}


\noindent
Let $S$ be a scheme.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_S$-module.
Consider the functor
\begin{equation}
\label{equation-quasi-coherent-presheaf}
(\Sch/S)^{opp} \longrightarrow \textit{Ab},
\quad
(f : T \to S) \longmapsto \Gamma(T, f^*\mathcal{F}).
\end{equation}

\begin{lemma}
\label{lemma-sheaf-condition-holds}
Let $S$ be a scheme.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_S$-module.
Let $\tau \in \{Zariski, \linebreak[0] fpqc, \linebreak[0] fppf, \linebreak[0]
\etale, \linebreak[0] smooth, \linebreak[0] syntomic\}$.
The functor defined in (\ref{equation-quasi-coherent-presheaf})
satisfies the sheaf condition with respect to any $\tau$-covering
$\{T_i \to T\}_{i \in I}$ of any scheme $T$ over $S$.
\end{lemma}

\begin{proof}
For $\tau \in \{Zariski, \linebreak[0] fppf, \linebreak[0] \etale,
\linebreak[0] smooth, \linebreak[0] syntomic\}$ a $\tau$-covering
is also a fpqc-covering, see the results in
Topologies, Lemmas
\ref{topologies-lemma-zariski-etale},
\ref{topologies-lemma-zariski-etale-smooth},
\ref{topologies-lemma-zariski-etale-smooth-syntomic},
\ref{topologies-lemma-zariski-etale-smooth-syntomic-fppf}, and
\ref{topologies-lemma-zariski-etale-smooth-syntomic-fppf-fpqc}.
Hence it suffices to prove the theorem
for a fpqc covering. Assume that $\{f_i : T_i \to T\}_{i \in I}$
is an fpqc covering where $f : T \to S$ is given. Suppose that
we have a family of sections $s_i \in \Gamma(T_i , f_i^*f^*\mathcal{F})$
such that $s_i|_{T_i \times_T T_j} = s_j|_{T_i \times_T T_j}$.
We have to find the correspond section $s \in \Gamma(T, f^*\mathcal{F})$.
We can reinterpret the $s_i$ as a family of maps
$\varphi_i : f_i^*\mathcal{O}_T = \mathcal{O}_{T_i} \to f_i^*f^*\mathcal{F}$
compatible with the canonical descent data associated to the
quasi-coherent sheaves $\mathcal{O}_T$ and $f^*\mathcal{F}$ on $T$.
Hence by Proposition \ref{proposition-fpqc-descent-quasi-coherent}
we see that we may (uniquely) descend
these to a map $\mathcal{O}_T \to f^*\mathcal{F}$ which gives
us our section $s$.
\end{proof}

\noindent
We may in particular make the following definition.

\begin{definition}
\label{definition-structure-sheaf}
Let $\tau \in \{Zariski, \linebreak[0] fppf, \linebreak[0]
\etale, \linebreak[0] smooth, \linebreak[0] syntomic\}$.
Let $S$ be a scheme.
Let $\Sch_\tau$ be a big site containing $S$.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_S$-module.
\begin{enumerate}
\item The {\it structure sheaf of the big site $(\Sch/S)_\tau$}
is the sheaf of rings $T/S \mapsto \Gamma(T, \mathcal{O}_T)$ which is
denoted $\mathcal{O}$ or $\mathcal{O}_S$.
\item If $\tau = \etale$ the structure sheaf of the small site
$S_\etale$ is the sheaf of rings $T/S \mapsto \Gamma(T, \mathcal{O}_T)$
which is denoted $\mathcal{O}$ or $\mathcal{O}_S$.
\item The {\it sheaf of $\mathcal{O}$-modules associated to
$\mathcal{F}$} on the big site $(\Sch/S)_\tau$
is the sheaf of $\mathcal{O}$-modules
$(f : T \to S) \mapsto \Gamma(T, f^*\mathcal{F})$
which is denoted $\mathcal{F}^a$ (and often simply $\mathcal{F}$).
\item Let $\tau = \etale$ (resp.\ $\tau = Zariski$). The
{\it sheaf of $\mathcal{O}$-modules associated to $\mathcal{F}$}
on the small site $S_\etale$ (resp.\ $S_{Zar}$) is the sheaf of
$\mathcal{O}$-modules $(f : T \to S) \mapsto \Gamma(T, f^*\mathcal{F})$
which is denoted $\mathcal{F}^a$ (and often simply $\mathcal{F}$).
\end{enumerate}
\end{definition}

\noindent
Note how we use the same notation $\mathcal{F}^a$ in each case.
No confusion can really arise from this as by definition the rule
that defines the sheaf $\mathcal{F}^a$ is independent of the site
we choose to look at.

\begin{remark}
\label{remark-Zariski-site-space}
In Topologies, Lemma \ref{topologies-lemma-Zariski-usual}
we have seen that the small Zariski site of a scheme $S$ is
equivalent to $S$ as a topological space in the sense that the
categories of sheaves are naturally equivalent. Now that $S_{Zar}$
is also endowed with a structure sheaf $\mathcal{O}$ we see
that sheaves of modules on the ringed site $(S_{Zar}, \mathcal{O})$
agree with sheaves of modules on the ringed space $(S, \mathcal{O}_S)$.
\end{remark}

\begin{remark}
\label{remark-change-topologies-ringed}
Let $f : T \to S$ be a morphism of schemes.
Each of the morphisms of sites $f_{sites}$ listed in
Topologies, Section \ref{topologies-section-change-topologies}
becomes a morphism of ringed sites. Namely, each of these morphisms of sites
$f_{sites} : (\Sch/T)_\tau \to (\Sch/S)_{\tau'}$, or
$f_{sites} : (\Sch/S)_\tau \to S_{\tau'}$ is given by the continuous
functor $S'/S \mapsto T \times_S S'/S$. Hence, given $S'/S$ we let
$$
f_{sites}^\sharp :
\mathcal{O}(S'/S)
\longrightarrow
f_{sites, *}\mathcal{O}(S'/S) =
\mathcal{O}(S \times_S S'/T)
$$
be the usual map
$\text{pr}_{S'}^\sharp : \mathcal{O}(S') \to \mathcal{O}(T \times_S S')$.
Similarly, the morphism
$i_f : \Sh(T_\tau) \to \Sh((\Sch/S)_\tau)$
for $\tau \in \{Zar, \etale\}$, see
Topologies, Lemmas \ref{topologies-lemma-put-in-T} and
\ref{topologies-lemma-put-in-T-etale},
becomes a morphism of ringed topoi because $i_f^{-1}\mathcal{O} = \mathcal{O}$.
Here are some special cases:
\begin{enumerate}
\item The morphism of big sites
$f_{big} : (\Sch/X)_{fppf} \to (\Sch/Y)_{fppf}$,
becomes a morphism of ringed sites
$$
(f_{big}, f_{big}^\sharp) :
((\Sch/X)_{fppf}, \mathcal{O}_X)
\longrightarrow
((\Sch/Y)_{fppf}, \mathcal{O}_Y)
$$
as in Modules on Sites, Definition \ref{sites-modules-definition-ringed-site}.
Similarly for the big syntomic, smooth, \'etale and Zariski sites.
\item The morphism of small sites
$f_{small} : X_\etale \to Y_\etale$
becomes a morphism of ringed sites
$$
(f_{small}, f_{small}^\sharp) :
(X_\etale, \mathcal{O}_X)
\longrightarrow
(Y_\etale, \mathcal{O}_Y)
$$
as in Modules on Sites, Definition \ref{sites-modules-definition-ringed-site}.
Similarly for the small Zariski site.
\end{enumerate}
\end{remark}

\noindent
Let $S$ be a scheme. It is clear that given an $\mathcal{O}$-module on (say)
$(\Sch/S)_{Zar}$ the pullback to (say) $(\Sch/S)_{fppf}$
is just the fppf-sheafification. To see what happens when comparing
big and small sites we have the following.

\begin{lemma}
\label{lemma-compare-sites}
Let $S$ be a scheme. Denote
$$
\begin{matrix}
\text{id}_{\tau, Zar} & : & (\Sch/S)_\tau \to S_{Zar}, &
\tau \in \{Zar, \etale, smooth, syntomic, fppf\} \\
\text{id}_{\tau, \etale} & : &
(\Sch/S)_\tau \to S_\etale, &
\tau \in \{\etale, smooth, syntomic, fppf\} \\
\text{id}_{small, \etale, Zar} & : & S_\etale \to S_{Zar},
\end{matrix}
$$
the morphisms of ringed sites of
Remark \ref{remark-change-topologies-ringed}.
Let $\mathcal{F}$ be a sheaf of $\mathcal{O}_S$-modules
which we view a sheaf of $\mathcal{O}$-modules on $S_{Zar}$. Then
\begin{enumerate}
\item $(\text{id}_{\tau, Zar})^*\mathcal{F}$ is the $\tau$-sheafification
of the Zariski sheaf
$$
(f : T \to S) \longmapsto \Gamma(T, f^*\mathcal{F})
$$
on $(\Sch/S)_\tau$, and
\item $(\text{id}_{small, \etale, Zar})^*\mathcal{F}$ is the
\'etale sheafification of the Zariski sheaf
$$
(f : T \to S) \longmapsto \Gamma(T, f^*\mathcal{F})
$$
on $S_\etale$.
\end{enumerate}
Let $\mathcal{G}$ be a sheaf of $\mathcal{O}$-modules
on $S_\etale$. Then
\begin{enumerate}
\item[(3)] $(\text{id}_{\tau, \etale})^*\mathcal{G}$ is the
$\tau$-sheafification of the \'etale sheaf
$$
(f : T \to S) \longmapsto \Gamma(T, f_{small}^*\mathcal{G})
$$
where $f_{small} : T_\etale \to S_\etale$
is the morphism of ringed small \'etale sites of
Remark \ref{remark-change-topologies-ringed}.
\end{enumerate}
\end{lemma}

\begin{proof}
Proof of (1). We first note that the result is true when $\tau = Zar$
because in that case we have the morphism of topoi
$i_f : \Sh(T_{Zar}) \to \Sh((\Sch/S)_{Zar})$
such that $\text{id}_{\tau, Zar} \circ i_f = f_{small}$ as morphisms
$T_{Zar} \to S_{Zar}$, see
Topologies, Lemmas \ref{topologies-lemma-put-in-T} and
\ref{topologies-lemma-morphism-big-small}.
Since pullback is transitive (see
Modules on Sites,
Lemma \ref{sites-modules-lemma-push-pull-composition-modules})
we see that
$i_f^*(\text{id}_{\tau, Zar})^*\mathcal{F} = f_{small}^*\mathcal{F}$
as desired. Hence, by the remark preceding this lemma we see that
$(\text{id}_{\tau, Zar})^*\mathcal{F}$ is the $\tau$-sheafification of
the presheaf $T \mapsto \Gamma(T, f^*\mathcal{F})$.

\medskip\noindent
The proof of (3) is exactly the same as the proof of (1), except that it
uses
Topologies, Lemmas \ref{topologies-lemma-put-in-T-etale} and
\ref{topologies-lemma-morphism-big-small-etale}.
We omit the proof of (2).
\end{proof}

\begin{remark}
\label{remark-change-topologies-ringed-sites}
Remark \ref{remark-change-topologies-ringed}
and
Lemma \ref{lemma-compare-sites}
have the following applications:
\begin{enumerate}
\item Let $S$ be a scheme.
The construction $\mathcal{F} \mapsto \mathcal{F}^a$ is
the pullback under the morphism of ringed sites
$\text{id}_{\tau, Zar} : ((\Sch/S)_\tau, \mathcal{O})
\to (S_{Zar}, \mathcal{O})$
or the morphism
$\text{id}_{small, \etale, Zar} :
(S_\etale, \mathcal{O}) \to (S_{Zar}, \mathcal{O})$.
\item Let $f : X \to Y$ be a morphism of schemes.
For any of the morphisms $f_{sites}$ of ringed sites of
Remark \ref{remark-change-topologies-ringed}
we have
$$
(f^*\mathcal{F})^a = f_{sites}^*\mathcal{F}^a.
$$
This follows from (1) and the fact that pullbacks are compatible with
compositions of morphisms of ringed sites, see
Modules on Sites,
Lemma \ref{sites-modules-lemma-push-pull-composition-modules}.
\end{enumerate}
\end{remark}

\begin{lemma}
\label{lemma-quasi-coherent-gives-quasi-coherent}
Let $S$ be a scheme.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_S$-module.
Let $\tau \in \{Zariski, \linebreak[0] fppf, \linebreak[0]
\etale, \linebreak[0] smooth, \linebreak[0] syntomic\}$.
\begin{enumerate}
\item The sheaf $\mathcal{F}^a$ is a quasi-coherent
$\mathcal{O}$-module on $(\Sch/S)_\tau$, as defined in
Modules on Sites, Definition \ref{sites-modules-definition-site-local}.
\item If $\tau = \etale$ (resp.\ $\tau = Zariski$), then the sheaf
$\mathcal{F}^a$ is a quasi-coherent $\mathcal{O}$-module on
$S_\etale$ (resp.\ $S_{Zar}$) as defined in
Modules on Sites, Definition \ref{sites-modules-definition-site-local}.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $\{S_i \to S\}$ be a Zariski covering such that we have exact sequences
$$
\bigoplus\nolimits_{k \in K_i} \mathcal{O}_{S_i} \longrightarrow
\bigoplus\nolimits_{j \in J_i} \mathcal{O}_{S_i} \longrightarrow
\mathcal{F} \longrightarrow 0
$$
for some index sets $K_i$ and $J_i$. This is possible by the definition
of a quasi-coherent sheaf on a ringed space
(See Modules, Definition \ref{modules-definition-quasi-coherent}).

\medskip\noindent
Proof of (1). Let $\tau \in \{Zariski, \linebreak[0] fppf, \linebreak[0]
\etale, \linebreak[0] smooth, \linebreak[0] syntomic\}$.
It is clear that $\mathcal{F}^a|_{(\Sch/S_i)_\tau}$ also
sits in an exact sequence
$$
\bigoplus\nolimits_{k \in K_i} \mathcal{O}|_{(\Sch/S_i)_\tau}
\longrightarrow
\bigoplus\nolimits_{j \in J_i} \mathcal{O}|_{(\Sch/S_i)_\tau}
\longrightarrow
\mathcal{F}^a|_{(\Sch/S_i)_\tau} \longrightarrow 0
$$
Hence $\mathcal{F}^a$ is quasi-coherent by Modules on Sites,
Lemma \ref{sites-modules-lemma-local-final-object}.

\medskip\noindent
Proof of (2). Let $\tau = \etale$.
It is clear that $\mathcal{F}^a|_{(S_i)_\etale}$ also sits
in an exact sequence
$$
\bigoplus\nolimits_{k \in K_i} \mathcal{O}|_{(S_i)_\etale}
\longrightarrow
\bigoplus\nolimits_{j \in J_i} \mathcal{O}|_{(S_i)_\etale}
\longrightarrow
\mathcal{F}^a|_{(S_i)_\etale} \longrightarrow 0
$$
Hence $\mathcal{F}^a$ is quasi-coherent by Modules on Sites,
Lemma \ref{sites-modules-lemma-local-final-object}.
The case $\tau = Zariski$ is similar (actually, it is really
tautological since the corresponding ringed topoi agree).
\end{proof}

\begin{lemma}
\label{lemma-standard-covering-Cech}
Let $S$ be a scheme. Let
\begin{enumerate}
\item[(a)] $\tau \in \{Zariski, \linebreak[0] fppf, \linebreak[0]
\etale, \linebreak[0] smooth, \linebreak[0] syntomic\}$
and $\mathcal{C} = (\Sch/S)_\tau$, or
\item[(b)] let $\tau = \etale$ and $\mathcal{C} = S_\etale$, or
\item[(c)] let $\tau = Zariski$ and $\mathcal{C} = S_{Zar}$.
\end{enumerate}
Let $\mathcal{F}$ be an abelian sheaf on $\mathcal{C}$.
Let $U \in \Ob(\mathcal{C})$ be affine.
Let $\mathcal{U} = \{U_i \to U\}_{i = 1, \ldots, n}$ be a standard affine
$\tau$-covering in $\mathcal{C}$. Then
\begin{enumerate}
\item $\mathcal{V} = \{\coprod_{i = 1, \ldots, n} U_i \to U\}$ is a
$\tau$-covering of $U$,
\item $\mathcal{U}$ is a refinement of $\mathcal{V}$, and
\item the induced map on {\v C}ech complexes
(Cohomology on Sites,
Equation (\ref{sites-cohomology-equation-map-cech-complexes}))
$$
\check{\mathcal{C}}^\bullet(\mathcal{V}, \mathcal{F})
\longrightarrow
\check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{F})
$$
is an isomorphism of complexes.
\end{enumerate}
\end{lemma}

\begin{proof}
This follows because
$$
(\coprod\nolimits_{i_0 = 1, \ldots, n} U_{i_0}) \times_U
\ldots \times_U
(\coprod\nolimits_{i_p = 1, \ldots, n} U_{i_p})
=
\coprod\nolimits_{i_0, \ldots, i_p \in \{1, \ldots, n\}}
U_{i_0} \times_U \ldots \times_U U_{i_p}
$$
and the fact that $\mathcal{F}(\coprod_a V_a) = \prod_a \mathcal{F}(V_a)$
since disjoint unions are $\tau$-coverings.
\end{proof}

\begin{lemma}
\label{lemma-standard-covering-Cech-quasi-coherent}
Let $S$ be a scheme. Let $\mathcal{F}$ be a quasi-coherent sheaf on $S$.
Let $\tau$, $\mathcal{C}$, $U$, $\mathcal{U}$ be as in
Lemma \ref{lemma-standard-covering-Cech}. Then there is an isomorphism
of complexes
$$
\check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{F}^a)
\cong
s((A/R)_\bullet \otimes_R M)
$$
(see Section \ref{section-descent-modules})
where $R = \Gamma(U, \mathcal{O}_U)$, $M = \Gamma(U, \mathcal{F}^a)$
and $R \to A$ is a faithfully flat ring map. In particular
$$
\check{H}^p(\mathcal{U}, \mathcal{F}^a) = 0
$$
for all $p \geq 1$.
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-standard-covering-Cech} we see that
$\check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{F}^a)$
is isomorphic to $\check{\mathcal{C}}^\bullet(\mathcal{V}, \mathcal{F}^a)$
where $\mathcal{V} = \{V \to U\}$ with $V = \coprod_{i = 1, \ldots n} U_i$
affine also. Set $A = \Gamma(V, \mathcal{O}_V)$. Since $\{V \to U\}$
is a $\tau$-covering we see that $R \to A$ is faithfully flat.
On the other hand, by definition of $\mathcal{F}^a$ we have
that the degree $p$ term $\check{\mathcal{C}}^p(\mathcal{V}, \mathcal{F}^a)$
is
$$
\Gamma(V \times_U \ldots \times_U V, \mathcal{F}^a)
=
\Gamma(\Spec(A \otimes_R \ldots \otimes_R A), \mathcal{F}^a)
=
A \otimes_R \ldots \otimes_R A \otimes_R M
$$
We omit the verification that the maps of the {\v C}ech complex agree with
the maps in the complex $s((A/R)_\bullet \otimes_R M)$. The vanishing
of cohomology is Lemma \ref{lemma-ff-exact}.
\end{proof}

\begin{proposition}
\label{proposition-same-cohomology-quasi-coherent}
\begin{slogan}
Cohomology of quasi-coherent sheaves is the same no matter which
topology you use.
\end{slogan}
Let $S$ be a scheme. Let $\mathcal{F}$ be a quasi-coherent sheaf on $S$.
Let $\tau \in \{Zariski, \linebreak[0] fppf, \linebreak[0]
\etale, \linebreak[0] smooth, \linebreak[0] syntomic\}$.
\begin{enumerate}
\item There is a canonical isomorphism
$$
H^q(S, \mathcal{F}) = H^q((\Sch/S)_\tau, \mathcal{F}^a).
$$
\item There are canonical isomorphisms
$$
H^q(S, \mathcal{F}) =
H^q(S_{Zar}, \mathcal{F}^a) =
H^q(S_\etale, \mathcal{F}^a).
$$
\end{enumerate}
\end{proposition}

\begin{proof}
The result for $q = 0$ is clear from the definition of $\mathcal{F}^a$.
Let $\mathcal{C} = (\Sch/S)_\tau$, or $\mathcal{C} = S_\etale$,
or $\mathcal{C} = S_{Zar}$.

\medskip\noindent
We are going to apply
Cohomology on Sites,
Lemma \ref{sites-cohomology-lemma-cech-vanish-collection}
with $\mathcal{F} = \mathcal{F}^a$,
$\mathcal{B} \subset \Ob(\mathcal{C})$ the set of affine schemes
in $\mathcal{C}$, and $\text{Cov} \subset \text{Cov}_\mathcal{C}$ the
set of standard affine $\tau$-coverings. Assumption (3) of
the lemma is satisfied by
Lemma \ref{lemma-standard-covering-Cech-quasi-coherent}.
Hence we conclude that $H^p(U, \mathcal{F}^a) = 0$ for every
affine object $U$ of $\mathcal{C}$.

\medskip\noindent
Next, let $U \in \Ob(\mathcal{C})$ be any separated object.
Denote $f : U \to S$ the structure morphism.
Let $U = \bigcup U_i$ be an affine open covering.
We may also think of this as a $\tau$-covering
$\mathcal{U} = \{U_i \to U\}$ of $U$ in $\mathcal{C}$.
Note that
$U_{i_0} \times_U \ldots \times_U U_{i_p} =
U_{i_0} \cap \ldots \cap U_{i_p}$ is affine as we assumed $U$ separated.
By
Cohomology on Sites, Lemma
\ref{sites-cohomology-lemma-cech-spectral-sequence-application}
and the result above we see that
$$
H^p(U, \mathcal{F}^a) = \check{H}^p(\mathcal{U}, \mathcal{F}^a)
= H^p(U, f^*\mathcal{F})
$$
the last equality by
Cohomology of Schemes, Lemma
\ref{coherent-lemma-cech-cohomology-quasi-coherent}.
In particular, if $S$ is separated we can take $U = S$ and
$f = \text{id}_S$ and the proposition is proved.
We suggest the reader skip the rest of the proof (or rewrite it
to give a clearer exposition).

\medskip\noindent
Choose an injective resolution $\mathcal{F} \to \mathcal{I}^\bullet$ on $S$.
Choose an injective resolution $\mathcal{F}^a \to \mathcal{J}^\bullet$
on $\mathcal{C}$. Denote $\mathcal{J}^n|_S$ the restriction of $\mathcal{J}^n$
to opens of $S$; this is a sheaf on the topological space $S$ as open
coverings are $\tau$-coverings. We get a complex
$$
0 \to \mathcal{F} \to \mathcal{J}^0|_S \to \mathcal{J}^1|_S \to \ldots
$$
which is exact since its sections over any affine open $U \subset S$
is exact (by the vanishing of $H^p(U, \mathcal{F}^a)$, $p > 0$ seen
above). Hence by
Derived Categories, Lemma \ref{derived-lemma-morphisms-lift}
there exists map of complexes
$\mathcal{J}^\bullet|_S \to \mathcal{I}^\bullet$ which in particular
induces a map
$$
R\Gamma(\mathcal{C}, \mathcal{F}^a)
=
\Gamma(S, \mathcal{J}^\bullet)
\longrightarrow
\Gamma(S, \mathcal{I}^\bullet)
=
R\Gamma(S, \mathcal{F}).
$$
Taking cohomology gives the map
$H^n(\mathcal{C}, \mathcal{F}^a) \to H^n(S, \mathcal{F})$ which
we have to prove is an isomorphism.
Let $\mathcal{U} : S = \bigcup U_i$ be an affine open covering
which we may think of as a $\tau$-covering also.
By the above we get a map of double complexes
$$
\check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{J})
=
\check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{J}|_S)
\longrightarrow
\check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{I}).
$$
This map induces a map of spectral sequences
$$
{}^\tau\! E_2^{p, q} = \check{H}^p(\mathcal{U}, \underline{H}^q(\mathcal{F}^a))
\longrightarrow
E_2^{p, q} = \check{H}^p(\mathcal{U}, \underline{H}^q(\mathcal{F}))
$$
The first spectral sequence converges to
$H^{p + q}(\mathcal{C}, \mathcal{F})$ and the second to
$H^{p + q}(S, \mathcal{F})$. On the other hand, we have seen
that the induced maps ${}^\tau\! E_2^{p, q} \to E_2^{p, q}$ are
bijections (as all the intersections are separated being opens in affines).
Whence also the maps $H^n(\mathcal{C}, \mathcal{F}^a) \to H^n(S, \mathcal{F})$
are isomorphisms, and we win.
\end{proof}

\begin{proposition}
\label{proposition-equivalence-quasi-coherent}
Let $S$ be a scheme.
Let $\tau \in \{Zariski, \linebreak[0] fppf, \linebreak[0]
\etale, \linebreak[0] smooth, \linebreak[0] syntomic\}$.
\begin{enumerate}
\item The functor $\mathcal{F} \mapsto \mathcal{F}^a$
defines an equivalence of categories
$$
\QCoh(\mathcal{O}_S)
\longrightarrow
\QCoh((\Sch/S)_\tau, \mathcal{O})
$$
between the category of quasi-coherent sheaves on $S$ and the category
of quasi-coherent $\mathcal{O}$-modules on the big $\tau$ site of $S$.
\item Let $\tau = \etale$, or $\tau = Zariski$.
The functor $\mathcal{F} \mapsto \mathcal{F}^a$
defines an equivalence of categories
$$
\QCoh(\mathcal{O}_S)
\longrightarrow
\QCoh(S_\tau, \mathcal{O})
$$
between the category of quasi-coherent sheaves on $S$ and the category
of quasi-coherent $\mathcal{O}$-modules on the small $\tau$ site of $S$.
\end{enumerate}
\end{proposition}

\begin{proof}
We have seen in Lemma \ref{lemma-quasi-coherent-gives-quasi-coherent}
that the functor is well defined.
It is straightforward to show that the functor is fully faithful (we omit
the verification). To finish the proof we will show that a
quasi-coherent $\mathcal{O}$-module on $(\Sch/S)_\tau$ gives
rise to a descent datum for quasi-coherent sheaves relative to a
$\tau$-covering of $S$. Having produced this descent datum we will appeal
to Proposition \ref{proposition-fpqc-descent-quasi-coherent} to get the
corresponding quasi-coherent sheaf on $S$.

\medskip\noindent
Let $\mathcal{G}$ be a quasi-coherent $\mathcal{O}$-modules on
the big $\tau$ site of $S$. By
Modules on Sites, Definition \ref{sites-modules-definition-site-local}
there exists a $\tau$-covering $\{S_i \to S\}_{i \in I}$ of $S$
such that each of the restrictions
$\mathcal{G}|_{(\Sch/S_i)_\tau}$ has a global presentation
$$
\bigoplus\nolimits_{k \in K_i} \mathcal{O}|_{(\Sch/S_i)_\tau}
\longrightarrow
\bigoplus\nolimits_{j \in J_i} \mathcal{O}|_{(\Sch/S_i)_\tau}
\longrightarrow
\mathcal{G}|_{(\Sch/S_i)_\tau} \longrightarrow 0
$$
for some index sets $J_i$ and $K_i$. We claim that this implies
that $\mathcal{G}|_{(\Sch/S_i)_\tau}$ is $\mathcal{F}_i^a$
for some quasi-coherent sheaf $\mathcal{F}_i$ on $S_i$. Namely,
this is clear for the direct sums
$\bigoplus\nolimits_{k \in K_i} \mathcal{O}|_{(\Sch/S_i)_\tau}$
and
$\bigoplus\nolimits_{j \in J_i} \mathcal{O}|_{(\Sch/S_i)_\tau}$.
Hence we see that $\mathcal{G}|_{(\Sch/S_i)_\tau}$ is a
cokernel of a map $\varphi : \mathcal{K}_i^a \to \mathcal{L}_i^a$
for some quasi-coherent sheaves $\mathcal{K}_i$, $\mathcal{L}_i$
on $S_i$. By the fully faithfulness of $(\ )^a$ we see that
$\varphi = \phi^a$ for some map of quasi-coherent sheaves
$\phi : \mathcal{K}_i \to \mathcal{L}_i$ on $S_i$. Then it is
clear that
$\mathcal{G}|_{(\Sch/S_i)_\tau} \cong \Coker(\phi)^a$
as claimed.

\medskip\noindent
Since $\mathcal{G}$ lives on all of the category
$(\Sch/S_i)_\tau$ we see that
$$
(\text{pr}_0^*\mathcal{F}_i)^a
\cong
\mathcal{G}|_{(\Sch/(S_i \times_S S_j))_\tau}
\cong
(\text{pr}_1^*\mathcal{F})^a
$$
as $\mathcal{O}$-modules on $(\Sch/(S_i \times_S S_j))_\tau$.
Hence, using fully faithfulness again we get canonical isomorphisms
$$
\phi_{ij} :
\text{pr}_0^*\mathcal{F}_i
\longrightarrow
\text{pr}_1^*\mathcal{F}_j
$$
of quasi-coherent modules over $S_i \times_S S_j$. We omit the verification
that these satisfy the cocycle condition. Since they do we see by
effectivity of descent for quasi-coherent sheaves and the covering
$\{S_i \to S\}$ (Proposition \ref{proposition-fpqc-descent-quasi-coherent})
that there exists a quasi-coherent sheaf $\mathcal{F}$ on $S$
with $\mathcal{F}|_{S_i} \cong \mathcal{F}_i$ compatible
with the given descent data. In other words we are given
$\mathcal{O}$-module isomorphisms
$$
\phi_i :
\mathcal{F}^a|_{(\Sch/S_i)_\tau}
\longrightarrow
\mathcal{G}|_{(\Sch/S_i)_\tau}
$$
which agree over $S_i \times_S S_j$. Hence, since
$\SheafHom_\mathcal{O}(\mathcal{F}^a, \mathcal{G})$ is
a sheaf (Modules on Sites, Lemma \ref{sites-modules-lemma-internal-hom}),
we conclude that
there is a morphism of $\mathcal{O}$-modules $\mathcal{F}^a \to \mathcal{G}$
recovering the isomorphisms $\phi_i$ above. Hence this is an isomorphism
and we win.

\medskip\noindent
The case of the sites $S_\etale$ and $S_{Zar}$ is proved in the
exact same manner.
\end{proof}

\begin{lemma}
\label{lemma-equivalence-quasi-coherent-properties}
Let $S$ be a scheme.
Let $\tau \in \{Zariski, \linebreak[0] fppf, \linebreak[0]
\etale, \linebreak[0] smooth, \linebreak[0] syntomic\}$.
Let $\mathcal{P}$ be one of the properties of modules\footnote{The list is:
free, finite free, generated by global sections,
generated by $r$ global sections, generated by finitely many global sections,
having a global presentation, having a global finite presentation,
locally free, finite locally free, locally generated by sections,
locally generated by $r$ sections, finite type, of finite presentation,
coherent, or flat.} defined in
Modules on Sites, Definitions \ref{sites-modules-definition-global},
\ref{sites-modules-definition-site-local}, and
\ref{sites-modules-definition-flat}.
The equivalences of categories
$$
\QCoh(\mathcal{O}_S)
\longrightarrow
\QCoh((\Sch/S)_\tau, \mathcal{O})
\quad\text{and}\quad
\QCoh(\mathcal{O}_S)
\longrightarrow
\QCoh(S_\tau, \mathcal{O})
$$
defined by the rule $\mathcal{F} \mapsto \mathcal{F}^a$ seen in
Proposition \ref{proposition-equivalence-quasi-coherent}
have the property
$$
\mathcal{F}\text{ has }\mathcal{P}
\Leftrightarrow
\mathcal{F}^a\text{ has }\mathcal{P}\text{ as an }\mathcal{O}\text{-module}
$$
except (possibly) when $\mathcal{P}$ is ``locally free'' or ``coherent''.
If $\mathcal{P}=$``coherent'' the equivalence
holds for $\QCoh(\mathcal{O}_S) \to \QCoh(S_\tau, \mathcal{O})$
when $S$ is locally Noetherian and $\tau$ is Zariski or \'etale.
\end{lemma}

\begin{proof}
This is immediate for the global properties, i.e., those defined in
Modules on Sites, Definition \ref{sites-modules-definition-global}.
For the local properties we can use
Modules on Sites, Lemma \ref{sites-modules-lemma-local-final-object}
to translate ``$\mathcal{F}^a$ has $\mathcal{P}$'' into a property
on the members of a covering of $X$. Hence the result follows from
Lemmas \ref{lemma-finite-type-descends},
\ref{lemma-finite-presentation-descends},
\ref{lemma-locally-generated-by-r-sections-descends},
\ref{lemma-flat-descends}, and
\ref{lemma-finite-locally-free-descends}.
Being coherent for a quasi-coherent module is the same as being
of finite type over a locally Noetherian scheme (see
Cohomology of Schemes, Lemma \ref{coherent-lemma-coherent-Noetherian})
hence this reduces
to the case of finite type modules (details omitted).
\end{proof}

\begin{lemma}
\label{lemma-equivalence-quasi-coherent-limits}
Let $S$ be a scheme.
Let $\tau \in \{Zariski, \linebreak[0] fppf, \linebreak[0]
\etale, \linebreak[0] smooth, \linebreak[0] syntomic\}$.
The functors
$$
\QCoh(\mathcal{O}_S)
\longrightarrow
\textit{Mod}((\Sch/S)_\tau, \mathcal{O})
\quad\text{and}\quad
\QCoh(\mathcal{O}_S)
\longrightarrow
\textit{Mod}(S_\tau, \mathcal{O})
$$
defined by the rule $\mathcal{F} \mapsto \mathcal{F}^a$ seen in
Proposition \ref{proposition-equivalence-quasi-coherent}
are
\begin{enumerate}
\item fully faithful,
\item compatible with direct sums,
\item compatible with colimits,
\item right exact,
\item exact as a functor
$\QCoh(\mathcal{O}_S) \to \textit{Mod}(S_\etale, \mathcal{O})$,
\item {\bf not} exact as a functor
$\QCoh(\mathcal{O}_S) \to
\textit{Mod}((\Sch/S)_\tau, \mathcal{O})$
in general,
\item given two quasi-coherent $\mathcal{O}_S$-modules
$\mathcal{F}$, $\mathcal{G}$ we have
$(\mathcal{F} \otimes_{\mathcal{O}_S} \mathcal{G})^a =
\mathcal{F}^a \otimes_\mathcal{O} \mathcal{G}^a$,
\item given two quasi-coherent $\mathcal{O}_S$-modules
$\mathcal{F}$, $\mathcal{G}$ such that $\mathcal{F}$
is of finite presentation we have
$(\SheafHom_{\mathcal{O}_S}(\mathcal{F}, \mathcal{G}))^a =
\SheafHom_\mathcal{O}(\mathcal{F}^a, \mathcal{G}^a)$, and
\item given a short exact sequence
$0 \to \mathcal{F}_1^a \to \mathcal{E} \to \mathcal{F}_2^a \to 0$
of $\mathcal{O}$-modules then $\mathcal{E}$ is
quasi-coherent\footnote{Warning: This is misleading. See part (6).}, i.e.,
$\mathcal{E}$ is in the essential image of the functor.
\end{enumerate}
\end{lemma}

\begin{proof}
Part (1) we saw in
Proposition \ref{proposition-equivalence-quasi-coherent}.

\medskip\noindent
We have seen in
Schemes, Section \ref{schemes-section-quasi-coherent}
that a colimit of quasi-coherent sheaves on a scheme is a quasi-coherent
sheaf. Moreover, in
Remark \ref{remark-change-topologies-ringed-sites}
we saw that $\mathcal{F} \mapsto \mathcal{F}^a$ is the pullback functor
for a morphism of ringed sites, hence commutes with all colimits, see
Modules on Sites, Lemma
\ref{sites-modules-lemma-exactness-pushforward-pullback}.
Thus (3) and its special case (3) hold.

\medskip\noindent
This also shows that the functor is right exact (i.e., commutes with
finite colimits), hence (4).

\medskip\noindent
The functor $\QCoh(\mathcal{O}_S) \to
\QCoh(S_\etale, \mathcal{O})$,
$\mathcal{F} \mapsto \mathcal{F}^a$
is left exact because an \'etale morphism is flat, see
Morphisms, Lemma \ref{morphisms-lemma-etale-flat}.
This proves (5).

\medskip\noindent
To see (6), suppose that $S = \Spec(\mathbf{Z})$.
Then $2 : \mathcal{O}_S \to \mathcal{O}_S$ is injective but the associated
map of $\mathcal{O}$-modules on $(\Sch/S)_\tau$ isn't
injective because $2 : \mathbf{F}_2 \to \mathbf{F}_2$ isn't injective
and $\Spec(\mathbf{F}_2)$ is an object of $(\Sch/S)_\tau$.

\medskip\noindent
We omit the proofs of (7) and (8).

\medskip\noindent
Let $0 \to \mathcal{F}_1^a \to \mathcal{E} \to \mathcal{F}_2^a \to 0$
be a short exact sequence of $\mathcal{O}$-modules with $\mathcal{F}_1$
and $\mathcal{F}_2$ quasi-coherent on $S$. Consider the restriction
$$
0 \to \mathcal{F}_1 \to \mathcal{E}|_{S_{Zar}} \to \mathcal{F}_2
$$
to $S_{Zar}$. By
Proposition \ref{proposition-same-cohomology-quasi-coherent}
we see that on any affine $U \subset S$ we have
$H^1(U, \mathcal{F}_1^a) = H^1(U, \mathcal{F}_1) = 0$.
Hence the sequence above is also exact on the right. By
Schemes, Section \ref{schemes-section-quasi-coherent}
we conclude that $\mathcal{F} = \mathcal{E}|_{S_{Zar}}$ is
quasi-coherent. Thus we obtain a commutative diagram
$$
\xymatrix{
& \mathcal{F}_1^a \ar[r] \ar[d] &
\mathcal{F}^a \ar[r] \ar[d] &
\mathcal{F}_2^a \ar[r] \ar[d] & 0 \\
0 \ar[r] &
\mathcal{F}_1^a \ar[r] &
\mathcal{E} \ar[r] &
\mathcal{F}_2^a \ar[r] & 0
}
$$
To finish the proof it suffices to show that the top row is also
right exact. To do this, denote once more $U = \Spec(A) \subset S$
an affine open of $S$. We have seen above that
$0 \to \mathcal{F}_1(U) \to \mathcal{E}(U) \to \mathcal{F}_2(U) \to 0$
is exact. For any affine scheme $V/U$,
$V = \Spec(B)$ the map $\mathcal{F}_1^a(V) \to \mathcal{E}(V)$
is injective. We have $\mathcal{F}_1^a(V) = \mathcal{F}_1(U) \otimes_A B$
by definition. The injection
$\mathcal{F}_1^a(V) \to \mathcal{E}(V)$ factors as
$$
\mathcal{F}_1(U) \otimes_A B \to
\mathcal{E}(U) \otimes_A B \to \mathcal{E}(U)
$$
Considering $A$-algebras $B$ of the form $B = A \oplus M$
we see that $\mathcal{F}_1(U) \to \mathcal{E}(U)$ is
universally injective (see
Algebra, Definition \ref{algebra-definition-universally-injective}).
Since $\mathcal{E}(U) = \mathcal{F}(U)$ we conclude that
$\mathcal{F}_1 \to \mathcal{F}$ remains injective after any base change,
or equivalently that $\mathcal{F}_1^a \to \mathcal{F}^a$ is injective.
\end{proof}


\begin{proposition}
\label{proposition-equivalence-quasi-coherent-functorial}
Let $f : T \to S$ be a morphism of schemes.
\begin{enumerate}
\item The equivalences of categories of
Proposition \ref{proposition-equivalence-quasi-coherent}
are compatible with pullback.
More precisely, we have $f^*(\mathcal{G}^a) = (f^*\mathcal{G})^a$
for any quasi-coherent sheaf $\mathcal{G}$ on $S$.
\item The equivalences of categories of
Proposition \ref{proposition-equivalence-quasi-coherent} part (1)
are {\bf not} compatible with pushforward in general.
\item If $f$ is quasi-compact and quasi-separated, and
$\tau \in \{Zariski, \etale\}$ then $f_*$ and $f_{small, *}$
preserve quasi-coherent sheaves and the diagram
$$
\xymatrix{
\QCoh(\mathcal{O}_T)
\ar[rr]_{f_*} \ar[d]_{\mathcal{F} \mapsto \mathcal{F}^a} & &
\QCoh(\mathcal{O}_S)
\ar[d]^{\mathcal{G} \mapsto \mathcal{G}^a} \\
\QCoh(T_\tau, \mathcal{O}) \ar[rr]^{f_{small, *}} & &
\QCoh(S_\tau, \mathcal{O})
}
$$
is commutative, i.e., $f_{small, *}(\mathcal{F}^a) = (f_*\mathcal{F})^a$.
\end{enumerate}
\end{proposition}

\begin{proof}
Part (1) follows from the discussion in
Remark \ref{remark-change-topologies-ringed-sites}.
Part (2) is just a warning, and can be explained in the following way:
First the statement cannot be made precise since $f_*$ does not
transform quasi-coherent sheaves into quasi-coherent sheaves in general.
Even if this is the case for $f$ (and any base change of $f$), then the
compatibility over the big sites would mean that formation of $f_*\mathcal{F}$
commutes with any base change, which does not hold in general.
An explicit example is the quasi-compact open immersion
$j : X = \mathbf{A}^2_k \setminus \{0\} \to \mathbf{A}^2_k = Y$
where $k$ is a field. We have $j_*\mathcal{O}_X = \mathcal{O}_Y$
but after base change to $\Spec(k)$ by the $0$ map
we see that the pushforward is zero.

\medskip\noindent
Let us prove (3) in case $\tau = \etale$. Note that $f$, and any
base change of $f$, transforms quasi-coherent sheaves
into quasi-coherent sheaves, see
Schemes, Lemma \ref{schemes-lemma-push-forward-quasi-coherent}.
The equality $f_{small, *}(\mathcal{F}^a) = (f_*\mathcal{F})^a$
means that for any \'etale morphism $g : U \to S$ we have
$\Gamma(U, g^*f_*\mathcal{F}) = \Gamma(U \times_S T, (g')^*\mathcal{F})$
where $g' : U \times_S T \to T$ is the projection. This is true by
Cohomology of Schemes, Lemma \ref{coherent-lemma-flat-base-change-cohomology}.
\end{proof}

\begin{lemma}
\label{lemma-higher-direct-images-small-etale}
Let $f : T \to S$ be a quasi-compact and quasi-separated morphism of schemes.
Let $\mathcal{F}$ be a quasi-coherent sheaf on $T$. For either the \'etale
or Zariski topology, there are canonical isomorphisms
$R^if_{small, *}(\mathcal{F}^a) = (R^if_*\mathcal{F})^a$.
\end{lemma}

\begin{proof}
We prove this for the \'etale topology; we omit the proof in the case
of the Zariski topology. By Cohomology of Schemes, Lemma
\ref{coherent-lemma-quasi-coherence-higher-direct-images}
the sheaves $R^if_*\mathcal{F}$ are quasi-coherent so that the assertion
makes sense. The sheaf $R^if_{small, *}\mathcal{F}^a$ is the sheaf associated
to the presheaf
$$
U \longmapsto H^i(U \times_S T, \mathcal{F}^a)
$$
where $g : U \to S$ is an object of $S_\etale$, see
Cohomology on Sites, Lemma \ref{sites-cohomology-lemma-higher-direct-images}.
By our conventions the right hand side is the \'etale
cohomology of the restriction of $\mathcal{F}^a$ to the localization
$T_\etale/U \times_S T$ which equals
$(U \times_S T)_\etale$. By
Proposition \ref{proposition-same-cohomology-quasi-coherent}
this is presheaf the same as the presheaf
$$
U \longmapsto
H^i(U \times_S T, (g')^*\mathcal{F}),
$$
where $g' : U \times_S T \to T$ is the projection. If $U$ is affine
then this is the same as $H^0(U, R^if'_*(g')^*\mathcal{F})$, see
Cohomology of Schemes, Lemma
\ref{coherent-lemma-quasi-coherence-higher-direct-images-application}.
By
Cohomology of Schemes, Lemma \ref{coherent-lemma-flat-base-change-cohomology}
this is equal to $H^0(U, g^*R^if_*\mathcal{F})$ which is the value
of $(R^if_*\mathcal{F})^a$ on $U$.
Thus the values of the sheaves of modules
$R^if_{small, *}(\mathcal{F}^a)$ and $(R^if_*\mathcal{F})^a$
on every affine object of $S_\etale$ are canonically isomorphic
which implies they are canonically isomorphic.
\end{proof}

\noindent
The results in this section say there is virtually no difference between
quasi-coherent sheaves on $S$ and quasi-coherent sheaves on any of the
sites associated to $S$ in the chapter on topologies. Hence one often
sees statements on quasi-coherent sheaves formulated in either language,
without restatements in the other.







\section{Parasitic modules}
\label{section-parasitic}

\noindent
Parasitic modules are those which are zero when restricted
to schemes flat over the base scheme. Here is the formal definition.

\begin{definition}
\label{definition-parasitic}
Let $S$ be a scheme. Let $\tau \in \{Zar, \etale,
smooth, syntomic, fppf\}$. Let $\mathcal{F}$ be a presheaf
of $\mathcal{O}$-modules on $(\Sch/S)_\tau$.
\begin{enumerate}
\item $\mathcal{F}$ is called
{\it parasitic}\footnote{This may be nonstandard notation.}
if for every flat morphism $U \to S$ we have $\mathcal{F}(U) = 0$.
\item $\mathcal{F}$ is called {\it parasitic for the $\tau$-topology}
if for every $\tau$-covering $\{U_i \to S\}_{i \in I}$ we have
$\mathcal{F}(U_i) = 0$ for all $i$.
\end{enumerate}
\end{definition}

\noindent
If $\tau = fppf$ this means that $\mathcal{F}|_{U_{Zar}} = 0$ whenever
$U \to S$ is flat and locally of finite presentation; similar for
the other cases.

\begin{lemma}
\label{lemma-cohomology-parasitic}
Let $S$ be a scheme. Let $\tau \in \{Zar, \etale, smooth,
syntomic, fppf\}$. Let $\mathcal{G}$ be a presheaf of
$\mathcal{O}$-modules on $(\Sch/S)_\tau$.
\begin{enumerate}
\item If $\mathcal{G}$ is parasitic for the $\tau$-topology, then
$H^p_\tau(U, \mathcal{G}) = 0$ for every $U$ open in $S$,
resp.\ \'etale over $S$,
resp.\ smooth over $S$,
resp.\ syntomic over $S$,
resp.\ flat and locally of finite presentation over $S$.
\item If $\mathcal{G}$ is parasitic then $H^p_\tau(U, \mathcal{G}) = 0$
for every $U$ flat over $S$.
\end{enumerate}
\end{lemma}

\begin{proof}
Proof in case $\tau = fppf$; the other cases are proved in the
exact same way. The assumption means that $\mathcal{G}(U) = 0$ for any
$U \to S$ flat and locally of finite presentation. Apply
Cohomology on Sites, Lemma \ref{sites-cohomology-lemma-cech-vanish-collection}
to the subset $\mathcal{B} \subset \Ob((\Sch/S)_{fppf})$ consisting
of $U \to S$ flat and locally of finite presentation and the collection
$\text{Cov}$ of all fppf coverings of elements of $\mathcal{B}$.
\end{proof}

\begin{lemma}
\label{lemma-direct-image-parasitic}
Let $f : T \to S$ be a morphism of schemes. For any parasitic
$\mathcal{O}$-module on $(\Sch/T)_\tau$ the pushforward
$f_*\mathcal{F}$ and the higher direct images $R^if_*\mathcal{F}$
are parasitic $\mathcal{O}$-modules on $(\Sch/S)_\tau$.
\end{lemma}

\begin{proof}
Recall that $R^if_*\mathcal{F}$ is the sheaf associated to the
presheaf
$$
U \mapsto H^i((\Sch/U \times_S T)_\tau, \mathcal{F})
$$
see
Cohomology on Sites, Lemma \ref{sites-cohomology-lemma-higher-direct-images}.
If $U \to S$ is flat, then $U \times_S T \to T$ is flat as a base change.
Hence the displayed group is zero by
Lemma \ref{lemma-cohomology-parasitic}.
If $\{U_i \to U\}$ is a $\tau$-covering then
$U_i \times_S T \to T$ is also flat.
Hence it is clear that the sheafification of the displayed
presheaf is zero on schemes $U$ flat over $S$.
\end{proof}

\begin{lemma}
\label{lemma-quasi-coherent-and-flat-base-change}
Let $S$ be a scheme. Let $\tau \in \{Zar, \etale\}$.
Let $\mathcal{G}$ be a sheaf of $\mathcal{O}$-modules on
$(\Sch/S)_{fppf}$ such that
\begin{enumerate}
\item $\mathcal{G}|_{S_\tau}$ is quasi-coherent, and
\item for every flat, locally finitely presented morphism
$g : U \to S$ the canonical map
$g_{\tau, small}^*(\mathcal{G}|_{S_\tau}) \to \mathcal{G}|_{U_\tau}$
is an isomorphism.
\end{enumerate}
Then $H^p(U, \mathcal{G}) = H^p(U, \mathcal{G}|_{U_\tau})$
for every $U$ flat and locally of finite presentation over $S$.
\end{lemma}

\begin{proof}
Let $\mathcal{F}$ be the pullback of $\mathcal{G}|_{S_\tau}$
to the big fppf site $(\Sch/S)_{fppf}$. Note that $\mathcal{F}$
is quasi-coherent. There is a canonical
comparison map $\varphi : \mathcal{F} \to \mathcal{G}$ which by
assumptions (1) and (2) induces an isomorphism
$\mathcal{F}|_{U_\tau} \to \mathcal{G}|_{U_\tau}$
for all $g : U \to S$ flat and locally of finite presentation.
Hence in the short exact sequences
$$
0 \to \Ker(\varphi) \to \mathcal{F} \to \Im(\varphi) \to 0
$$
and
$$
0 \to \Im(\varphi) \to \mathcal{G} \to \Coker(\varphi) \to 0
$$
the sheaves $\Ker(\varphi)$ and $\Coker(\varphi)$ are
parasitic for the fppf topology. By
Lemma \ref{lemma-cohomology-parasitic}
we conclude that $H^p(U, \mathcal{F}) \to H^p(U, \mathcal{G})$
is an isomorphism for $g : U \to S$ flat and locally of finite presentation.
Since the result holds for $\mathcal{F}$ by
Proposition \ref{proposition-same-cohomology-quasi-coherent}
we win.
\end{proof}













\section{Fpqc coverings are universal effective epimorphisms}
\label{section-fpqc-universal-effective-epimorphisms}

\noindent
We apply the material above to prove an interesting result, namely
Lemma \ref{lemma-fpqc-universal-effective-epimorphisms}.
By Sites, Section \ref{sites-section-representable-sheaves}
this lemma implies that the representable
presheaves on any of the sites $(\Sch/S)_\tau$ are sheaves for
$\tau \in \{Zariski, fppf, \etale, smooth, syntomic\}$. First
we prove a helper lemma.

\begin{lemma}
\label{lemma-equiv-fibre-product}
For a scheme $X$ denote $|X|$ the underlying set.
Let $f : X \to S$ be a morphism of schemes.
Then
$$
|X \times_S X| \to |X| \times_{|S|} |X|
$$
is surjective.
\end{lemma}

\begin{proof}
Follows immediately from the description of points on the
fibre product in Schemes, Lemma \ref{schemes-lemma-points-fibre-product}.
\end{proof}


\begin{lemma}
\label{lemma-universal-effective-epimorphism-affine}
Let $\{f_i : X_i \to X\}_{i \in I}$ be a family of morphisms of affine schemes.
The following are equivalent
\begin{enumerate}
\item for any quasi-coherent $\mathcal{O}_X$-module $\mathcal{F}$ we have
$$
\Gamma(X, \mathcal{F}) =
\text{Equalizer}\left(
\xymatrix{
\prod\nolimits_{i \in I} \Gamma(X_i, f_i^*\mathcal{F})
\ar@<1ex>[r] \ar@<-1ex>[r] &
\prod\nolimits_{i, j \in I}
\Gamma(X_i \times_X X_j, (f_i \times f_j)^*\mathcal{F})
}
\right)
$$
\item $\{f_i : X_i \to X\}_{i \in I}$ is a universal effective epimorphism
(Sites, Definition \ref{sites-definition-universal-effective-epimorphisms})
in the category of affine schemes.
\end{enumerate}
\end{lemma}

\begin{proof}
Assume (2) holds and let $\mathcal{F}$ be a quasi-coherent
$\mathcal{O}_X$-module. Consider the scheme
(Constructions, Section \ref{constructions-section-spec})
$$
X' = \underline{\Spec}_X(\mathcal{O}_X \oplus \mathcal{F})
$$
where $\mathcal{O}_X \oplus \mathcal{F}$ is an
$\mathcal{O}_X$-algebra with multiplication
$(f, s)(f', s') = (ff', fs' + f's)$.
If $s_i \in \Gamma(X_i, f_i^*\mathcal{F})$ is a section,
then $s_i$ determines a unique element of
$$
\Gamma(X' \times_X X_i, \mathcal{O}_{X' \times_X X_i}) =
\Gamma(X_i, \mathcal{O}_{X_i}) \oplus \Gamma(X_i, f_i^*\mathcal{F})
$$
Proof of equality omitted.
If $(s_i)_{i \in I}$ is in the equalizer of (1), then, using the equality
$$
\Mor(T, \mathbf{A}^1_\mathbf{Z}) = \Gamma(T, \mathcal{O}_T)
$$
which holds for any scheme $T$, we see that these sections define
a family of morphisms $h_i : X' \times_X X_i \to \mathbf{A}^1_\mathbf{Z}$ with
$h_i \circ \text{pr}_1 = h_j \circ \text{pr}_2$ as morphisms
$(X' \times_X X_i) \times_{X'} (X' \times_X X_j) \to \mathbf{A}^1_\mathbf{Z}$.
Since we've assume (2) we obtain a morphism
$h : X' \to \mathbf{A}^1_\mathbf{Z}$ compatible with the morphisms $h_i$
which in turn determines
an element $s \in \Gamma(X, \mathcal{F})$.
We omit the verification that $s$ maps to $s_i$ in
$\Gamma(X_i, f_i^*\mathcal{F})$.

\medskip\noindent
Assume (1). Let $T$ be an affine scheme and let $h_i : X_i \to T$
be a family of morphisms such that
$h_i \circ \text{pr}_1 = h_j \circ \text{pr}_2$ on
$X_i \times_X X_j$ for all $i, j \in I$. Then
$$
\prod h_i^\sharp :
\Gamma(T, \mathcal{O}_T)
\to
\prod \Gamma(X_i, \mathcal{O}_{X_i})
$$
maps into the equalizer and we find that we get a ring map
$\Gamma(T, \mathcal{O}_T) \to \Gamma(X, \mathcal{O}_X)$
by the assumption of the lemma for $\mathcal{F} = \mathcal{O}_X$.
This ring map corresponds to a morphism $h : X \to T$ such
that $h_i = h \circ f_i$. Hence our family is an effective
epimorphism.

\medskip\noindent
Let $p : Y \to X$ be a morphism of affines. We will show
the base changes $g_i : Y_i \to Y$ of $f_i$ form an effective epimorphism
by applying the result of the previous paragraph.
Namely, if $\mathcal{G}$ is a quasi-coherent $\mathcal{O}_Y$-module, then
$$
\Gamma(Y, \mathcal{G}) = \Gamma(X, p_*\mathcal{G}),\quad
\Gamma(Y_i, g_i^*\mathcal{G}) = \Gamma(X, f_i^*p_*\mathcal{G}),
$$
and
$$
\Gamma(Y_i \times_Y Y_j, (g_i \times g_j)^*\mathcal{G}) =
\Gamma(X, (f_i \times f_j)^*p_*\mathcal{G})
$$
by the trivial base change formula
(Cohomology of Schemes, Lemma \ref{coherent-lemma-affine-base-change}).
Thus we see property (1) lemma holds for the family $g_i$.
\end{proof}

\begin{lemma}
\label{lemma-universal-effective-epimorphism-surjective}
Let $\{f_i : X_i \to X\}_{i \in I}$ be a family of morphisms of schemes.
\begin{enumerate}
\item If the family is universal effective
epimorphism in the category of schemes, then $\coprod f_i$ is surjective.
\item If $X$ and $X_i$ are affine and the family is a universal effective
epimorphism in the category of affine schemes, then
$\coprod f_i$ is surjective.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted. Hint: perform base change by $\Spec(\kappa(x)) \to X$
to see that any $x \in X$ has to be in the image.
\end{proof}

\begin{lemma}
\label{lemma-check-universal-effective-epimorphism-affine}
Let $\{f_i : X_i \to X\}_{i \in I}$ be a family of morphisms of schemes.
If for every morphism $Y \to X$ with $Y$ affine the family of base changes
$g_i : Y_i \to Y$ forms an effective epimorphism, then
the family of $f_i$ forms a universally effective epimorphism
in the category of schemes.
\end{lemma}

\begin{proof}
Let $Y \to X$ be a morphism of schemes. We have to show that
the base changes $g_i : Y_i \to Y$ form an effective epimorphism.
To do this, assume given a scheme $T$ and morphisms $h_i : Y_i \to T$
with $h_i \circ \text{pr}_1 = h_j \circ \text{pr}_2$ on
$Y_i \times_Y Y_j$.
Choose an affine open covering $Y = \bigcup V_\alpha$.
Set $V_{\alpha, i}$ equal to the inverse image of
$V_\alpha$ in $Y_i$. Then we see that
$V_{\alpha, i}  \to V_\alpha$ is the base change of
$f_i$ by $V_\alpha \to X$. Thus by assumption
the family of restrictions $h_i|_{V_{\alpha, i}}$
come from a morphism of schemes $h_\alpha : V_\alpha \to T$.
We leave it to the reader to show that these agree
on overlaps and define the desired morphism $Y \to T$.
See discussion in Schemes, Section \ref{schemes-section-glueing-schemes}.
\end{proof}

\begin{lemma}
\label{lemma-universal-effective-epimorphism}
Let $\{f_i : X_i \to X\}_{i \in I}$ be a family of morphisms of affine
schemes. Assume the equivalent assumption of
Lemma \ref{lemma-universal-effective-epimorphism-affine} hold
and that moreover for any morphism of affines $Y \to X$ the map
$$
\coprod X_i \times_X Y \longrightarrow Y
$$
is a submersive map of topological spaces
(Topology, Definition \ref{topology-definition-submersive}).
Then our family of morphisms is a universal effective epimorphism
in the category of schemes.
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-check-universal-effective-epimorphism-affine}
it suffices to base change our family of morphisms
by $Y \to X$ with $Y$ affine. Set $Y_i = X_i \times_X Y$.
Let $T$ be a scheme and let $h_i : Y_i \to Y$ be a family of morphisms
such that $h_i \circ \text{pr}_1 = h_j \circ \text{pr}_2$
on $Y_i \times_Y Y_j$. Note that $Y$ as a set is the coequalizer
of the two maps from $\coprod Y_i \times_Y Y_j$ to $\coprod Y_i$.
Namely, surjectivity by the affine case of
Lemma \ref{lemma-universal-effective-epimorphism-surjective}
and injectivity by Lemma \ref{lemma-equiv-fibre-product}.
Hence there is a set map of underlying sets $h : Y \to T$
compatible with the maps $h_i$. By the second condition of
the lemma we see that $h$ is continuous!
Thus if $y \in Y$ and $U \subset T$ is an affine open
neighbourhood of $h(y)$, then we can find an affine open
$V \subset Y$ such that $h(V) \subset U$.
Setting $V_i = Y_i \times_Y V = X_i \times_X V$
we can use the result proved in
Lemma \ref{lemma-universal-effective-epimorphism-affine}
to see that $h|_V : V \to U \subset T$ comes from a unique
morphism of affine schemes $h_V : V \to U$ agreeing with $h_i|_{V_i}$
as morphisms of schemes for all $i$. Glueing these $h_V$
(see Schemes, Section \ref{schemes-section-glueing-schemes})
gives a morphism $Y \to T$ as desired.
\end{proof}

\begin{lemma}
\label{lemma-open-fpqc-covering}
Let $\{f_i : T_i \to T\}_{i \in I}$ be a fpqc covering.
Suppose that for each $i$ we have an open subset $W_i \subset T_i$
such that for all $i, j \in I$ we have
$\text{pr}_0^{-1}(W_i) = \text{pr}_1^{-1}(W_j)$ as open
subsets of $T_i \times_T T_j$. Then there exists a unique open subset
$W \subset T$ such that $W_i = f_i^{-1}(W)$ for each $i$.
\end{lemma}

\begin{proof}
Apply
Lemma \ref{lemma-equiv-fibre-product}
to the map $\coprod_{i \in I} T_i \to T$.
It implies there exists a subset $W \subset T$ such that
$W_i = f_i^{-1}(W)$ for each $i$, namely $W = \bigcup f_i(W_i)$.
To see that $W$ is open we may work Zariski locally on $T$.
Hence we may assume that $T$ is affine. Using the definition
of a fpqc covering, this reduces us to the case where
$\{f_i : T_i \to T\}$ is a standard fpqc covering. In this case we
may apply
Morphisms, Lemma \ref{morphisms-lemma-fpqc-quotient-topology}
to the morphism
$\coprod T_i \to T$ to conclude that $W$ is open.
\end{proof}

\begin{lemma}
\label{lemma-fpqc-universal-effective-epimorphisms}
Let $\{T_i \to T\}$ be an fpqc covering, see
Topologies, Definition \ref{topologies-definition-fpqc-covering}.
Then $\{T_i \to T\}$ is a universal effective epimorphism
in the category of schemes, see
Sites, Definition \ref{sites-definition-universal-effective-epimorphisms}.
In other words, every representable functor on the category of schemes
satisfies the sheaf condition for the fpqc topology, see
Topologies, Definition \ref{topologies-definition-sheaf-property-fpqc}.
\end{lemma}

\begin{proof}
Let $S$ be a scheme. We have to show the following:
Given morphisms $\varphi_i : T_i \to S$
such that $\varphi_i|_{T_i \times_T T_j} = \varphi_j|_{T_i \times_T T_j}$
there exists a unique morphism $T \to S$ which restricts
to $\varphi_i$ on each $T_i$.
In other words, we have to show that the functor
$h_S = \Mor_{\Sch}( - , S)$ satisfies
the sheaf property for the fpqc topology.

\medskip\noindent
If $\{T_i \to T\}$ is a Zariski covering, then this follows from
Schemes, Lemma \ref{schemes-lemma-glue}.
Thus Topologies, Lemma \ref{topologies-lemma-sheaf-property-fpqc}
reduces us to the case of a covering $\{X \to Y\}$
given by a single surjective flat morphism of affines.

\medskip\noindent
First proof. By Lemma \ref{lemma-sheaf-condition-holds}
we have the sheaf condition for quasi-coherent modules
for $\{X \to Y\}$. By Lemma \ref{lemma-open-fpqc-covering}
the morphism $X \to Y$ is universally submersive.
Hence we may apply Lemma \ref{lemma-universal-effective-epimorphism}
to see that $\{X \to Y\}$ is a universal effective epimorphism.

\medskip\noindent
Second proof. Let $R \to A$ be the faithfully flat ring map
corresponding to our surjective flat morphism $\pi : X \to Y$.
Let $f : X \to S$ be a morphism
such that $f \circ \text{pr}_1 = f \circ \text{pr}_2$
as morphisms $X \times_Y X = \Spec(A \otimes_R A) \to S$.
By Lemma \ref{lemma-equiv-fibre-product} we see that
as a map on the underlying
sets $f$ is of the form $f = g \circ \pi$ for some
(set theoretic) map $g : \Spec(R) \to S$.
By Morphisms, Lemma \ref{morphisms-lemma-fpqc-quotient-topology}
and the fact that $f$ is continuous we see that $g$
is continuous.

\medskip\noindent
Pick $y \in Y = \Spec(R)$.
Choose $U \subset S$ affine open containing $g(y)$.
Say $U = \Spec(B)$.
By the above we may choose an $r \in R$ such that
$y \in D(r) \subset g^{-1}(U)$.
The restriction of $f$ to $\pi^{-1}(D(r))$ into $U$
corresponds to a ring map $B \to A_r$. The two induced
ring maps $B \to A_r \otimes_{R_r} A_r = (A \otimes_R A)_r$ are equal
by assumption on $f$.
Note that $R_r \to A_r$ is faithfully flat.
By Lemma \ref{lemma-ff-exact} the equalizer of
the two arrows $A_r \to A_r \otimes_{R_r} A_r$ is $R_r$.
We conclude that $B \to A_r$ factors uniquely through a map $B \to R_r$.
This map in turn gives a morphism of schemes $D(r) \to U \to S$,
see Schemes, Lemma \ref{schemes-lemma-morphism-into-affine}.

\medskip\noindent
What have we proved so far? We have shown that for any prime
$\mathfrak p \subset R$, there exists a standard affine open
$D(r) \subset \Spec(R)$ such that the morphism
$f|_{\pi^{-1}(D(r))} : \pi^{-1}(D(r)) \to S$ factors uniquely
through some morphism of schemes $D(r) \to S$. We omit the
verification that these morphisms glue to the desired
morphism $\Spec(R) \to S$.
\end{proof}

\begin{lemma}
\label{lemma-coequalizer-fpqc-local}
Consider schemes $X, Y, Z$ and morphisms $a, b : X \to Y$ and
a morphism $c : Y \to Z$ with $c \circ a = c \circ b$. Set
$d = c \circ a = c \circ b$. If there exists an
fpqc covering $\{Z_i \to Z\}$ such that
\begin{enumerate}
\item for all $i$ the morphism $Y \times_{c, Z} Z_i \to Z_i$
is the coequalizer of $(a, 1) : X \times_{d, Z} Z_i \to Y \times_{c, Z} Z_i$
and $(b, 1) : X \times_{d, Z} Z_i \to Y \times_{c, Z} Z_i$, and
\item for all $i$ and $i'$ the morphism
$Y \times_{c, Z} (Z_i \times_Z Z_{i'}) \to (Z_i \times_Z Z_{i'})$
is the coequalizer of
$(a, 1) : X \times_{d, Z} (Z_i \times_Z Z_{i'}) \to
Y \times_{c, Z} (Z_i \times_Z Z_{i'})$ and
$(b, 1) : X \times_{d, Z} (Z_i \times_Z Z_{i'}) \to
Y \times_{c, Z} (Z_i \times_Z Z_{i'})$
\end{enumerate}
then $c$ is the coequalizer of $a$ and $b$.
\end{lemma}

\begin{proof}
Namely, for a scheme $T$ a morphism $Z \to T$ is the same thing as
a collection of morphism $Z_i \to T$ which agree on overlaps by
Lemma \ref{lemma-fpqc-universal-effective-epimorphisms}.
\end{proof}















\section{Descent of finiteness and smoothness properties of morphisms}
\label{section-descent-finiteness-morphisms}

\noindent
In this section we show that several properties
of morphisms (being smooth, locally of finite presentation,
and so on) descend under faithfully flat morphisms. We start
with an algebraic version. (The ``Noetherian'' reader should
consult Lemma \ref{lemma-finite-type-local-source-fppf-algebra}
instead of the next lemma.)

\begin{lemma}
\label{lemma-flat-finitely-presented-permanence-algebra}
Let $R \to A \to B$ be ring maps.
Assume $R \to B$ is of finite presentation and
$A \to B$ faithfully flat and of finite presentation.
Then $R \to A$ is of finite presentation.
\end{lemma}

\begin{proof}
Consider the algebra $C = B \otimes_A B$ together with the
pair of maps $p, q : B \to C$ given by $p(b) = b \otimes 1$
and $q(b) = 1 \otimes b$. Of course the two compositions
$A \to B \to C$ are the same. Note that as
$p : B \to C$ is flat and of finite presentation (base change of
$A \to B$), the ring map $R \to C$ is of finite presentation
(as the composite of $R \to B \to C$).

\medskip\noindent
We are going to use the criterion
Algebra, Lemma \ref{algebra-lemma-characterize-finite-presentation}
to show that $R \to A$ is of finite presentation.
Let $S$ be any $R$-algebra, and suppose that
$S = \colim_{\lambda \in \Lambda} S_\lambda$ is written
as a directed colimit of $R$-algebras.
Let $A \to S$ be an $R$-algebra homomorphism. We have to
show that $A \to S$ factors through one of the $S_\lambda$.
Consider the rings $B' = S \otimes_A B$ and
$C' = S \otimes_A C = B' \otimes_S B'$.
As $B$ is faithfully flat of finite presentation over $A$, also $B'$
is faithfully flat of finite presentation over $S$.
By Algebra, Lemma \ref{algebra-lemma-flat-finite-presentation-limit-flat}
part (2) applied to the pair $(S \to B', B')$ and the system $(S_\lambda)$
there exists a $\lambda_0 \in \Lambda$
and a flat, finitely presented $S_{\lambda_0}$-algebra
$B_{\lambda_0}$ such that $B' = S \otimes_{S_{\lambda_0}} B_{\lambda_0}$.
For $\lambda \geq \lambda_0$ set
$B_\lambda = S_\lambda \otimes_{S_{\lambda_0}} B_{\lambda_0}$ and
$C_\lambda = B_\lambda \otimes_{S_\lambda} B_\lambda$.

\medskip\noindent
We interrupt the flow of the argument to show that $S_\lambda \to B_\lambda$
is faithfully flat for $\lambda$ large enough. (This should really
be a separate lemma somewhere else, maybe in the chapter on limits.)
Since $\Spec(B_{\lambda_0}) \to \Spec(S_{\lambda_0})$ is
flat and of finite presentation it is open (see Morphisms,
Lemma \ref{morphisms-lemma-fppf-open}).
Let $I \subset S_{\lambda_0}$ be an ideal such that
$V(I) \subset \Spec(S_{\lambda_0})$ is the complement
of the image. Note that formation of the image commutes
with base change. Hence, since $\Spec(B') \to \Spec(S)$
is surjective, and $B' = B_{\lambda_0} \otimes_{S_{\lambda_0}} S$
we see that $IS = S$. Thus for some $\lambda \geq \lambda_0$ we
have $IS_{\lambda} = S_\lambda$. For this and all greater
$\lambda$ the morphism
$\Spec(B_\lambda) \to \Spec(S_\lambda)$ is surjective.

\medskip\noindent
By analogy with the notation in the first paragraph of the proof denote
$p_\lambda, q_\lambda : B_\lambda \to C_\lambda$ the two canonical maps.
Then $B' = \colim_{\lambda \geq \lambda_0} B_\lambda$
and $C' = \colim_{\lambda \geq \lambda_0} C_\lambda$.
Since $B$ and $C$ are finitely presented over $R$ there exist
(by Algebra, Lemma \ref{algebra-lemma-characterize-finite-presentation}
applied several times)
a $\lambda \geq \lambda_0$ and an $R$-algebra maps
$B \to B_\lambda$, $C \to C_\lambda$ such that
the diagram
$$
\xymatrix{
C \ar[rr] & &
C_\lambda \\
B \ar[rr]
\ar@<1ex>[u]^-p
\ar@<-1ex>[u]_-q
& &
B_\lambda
\ar@<1ex>[u]^-{p_\lambda}
\ar@<-1ex>[u]_-{q_\lambda}
}
$$
is commutative. OK, and this means that $A \to B \to B_\lambda$
maps into the equalizer of $p_\lambda$ and $q_\lambda$.
By Lemma \ref{lemma-ff-exact} we
see that $S_\lambda$ is the equalizer of $p_\lambda$ and $q_\lambda$.
Thus we get the desired ring map $A \to S_\lambda$ and we win.
\end{proof}

\noindent
Here is an easier version of this dealing with the property
of being of finite type.

\begin{lemma}
\label{lemma-finite-type-local-source-fppf-algebra}
Let $R \to A \to B$ be ring maps.
Assume $R \to B$ is of finite type and
$A \to B$ faithfully flat and of finite presentation.
Then $R \to A$ is of finite type.
\end{lemma}

\begin{proof}
By
Algebra, Lemma \ref{algebra-lemma-descend-faithfully-flat-finite-presentation}
there exists a commutative diagram
$$
\xymatrix{
R \ar[r] \ar@{=}[d] &
A_0 \ar[d] \ar[r] &
B_0 \ar[d] \\
R \ar[r] & A \ar[r] & B
}
$$
with $R \to A_0$ of finite presentation,
$A_0 \to B_0$ faithfully flat of finite presentation
and $B = A \otimes_{A_0} B_0$. Since $R \to B$ is of finite
type by assumption, we may add some elements to $A_0$ and assume
that the map $B_0 \to B$ is surjective!
In this case, since $A_0 \to B_0$ is faithfully flat, we see
that as
$$
(A_0 \to A) \otimes_{A_0} B_0 \cong (B_0 \to B)
$$
is surjective, also $A_0 \to A$ is surjective. Hence we win.
\end{proof}

\begin{lemma}
\label{lemma-flat-finitely-presented-permanence}
\begin{reference}
\cite[IV, 17.7.5 (i) and (ii)]{EGA}.
\end{reference}
Let
$$
\xymatrix{
X \ar[rr]_f \ar[rd]_p & &
Y \ar[dl]^q \\
& S
}
$$
be a commutative diagram of morphisms of schemes. Assume that $f$ is
surjective, flat and locally of finite presentation and assume
that $p$ is locally of finite presentation (resp.\ locally of finite type).
Then $q$ is locally of finite presentation (resp.\ locally of finite type).
\end{lemma}

\begin{proof}
The problem is local on $S$ and $Y$. Hence we may assume that
$S$ and $Y$ are affine. Since $f$ is flat and locally of finite
presentation, we see that $f$ is open
(Morphisms, Lemma \ref{morphisms-lemma-fppf-open}).
Hence, since $Y$ is quasi-compact, there exist finitely many affine opens
$X_i \subset X$ such that $Y = \bigcup f(X_i)$.
Clearly we may replace $X$ by $\coprod X_i$, and hence we
may assume $X$ is affine as well.
In this case the lemma is equivalent to
Lemma \ref{lemma-flat-finitely-presented-permanence-algebra}
(resp. Lemma \ref{lemma-finite-type-local-source-fppf-algebra})
above.
\end{proof}

\noindent
We use this to improve some of the results on morphisms
obtained earlier.

\begin{lemma}
\label{lemma-syntomic-smooth-etale-permanence}
Let
$$
\xymatrix{
X \ar[rr]_f \ar[rd]_p & &
Y \ar[dl]^q \\
& S
}
$$
be a commutative diagram of morphisms of schemes. Assume that
\begin{enumerate}
\item $f$ is surjective, and syntomic (resp.\ smooth, resp.\ \'etale),
\item $p$ is syntomic (resp.\ smooth, resp.\ \'etale).
\end{enumerate}
Then $q$ is syntomic (resp.\ smooth, resp.\ \'etale).
\end{lemma}

\begin{proof}
Combine Morphisms, Lemmas
\ref{morphisms-lemma-syntomic-permanence},
\ref{morphisms-lemma-smooth-permanence}, and
\ref{morphisms-lemma-etale-permanence-two}
with Lemma \ref{lemma-flat-finitely-presented-permanence} above.
\end{proof}

\noindent
Actually we can strengthen this result as follows.

\begin{lemma}
\label{lemma-smooth-permanence}
Let
$$
\xymatrix{
X \ar[rr]_f \ar[rd]_p & &
Y \ar[dl]^q \\
& S
}
$$
be a commutative diagram of morphisms of schemes. Assume that
\begin{enumerate}
\item $f$ is surjective, flat, and locally of finite presentation,
\item $p$ is smooth (resp.\ \'etale).
\end{enumerate}
Then $q$ is smooth (resp.\ \'etale).
\end{lemma}

\begin{proof}
Assume (1) and that $p$ is smooth. By
Lemma \ref{lemma-flat-finitely-presented-permanence}
we see that $q$ is locally of finite presentation.
By
Morphisms, Lemma \ref{morphisms-lemma-flat-permanence}
we see that $q$ is flat.
Hence now it suffices to show that the fibres of $q$ are smooth, see
Morphisms, Lemma \ref{morphisms-lemma-smooth-flat-smooth-fibres}.
Apply
Varieties, Lemma \ref{varieties-lemma-flat-under-smooth}
to the flat surjective morphisms $X_s \to Y_s$ for $s \in S$ to
conclude. We omit the proof of the \'etale case.
\end{proof}

\begin{remark}
\label{remark-smooth-permanence}
With the assumptions (1) and $p$ smooth in
Lemma \ref{lemma-smooth-permanence}
it is not automatically the case that $X \to Y$ is smooth.
A counter example is $S = \Spec(k)$, $X = \Spec(k[s])$,
$Y = \Spec(k[t])$ and $f$ given by $t \mapsto s^2$.
But see also Lemma \ref{lemma-syntomic-permanence}
for some information on the structure of $f$.
\end{remark}

\begin{lemma}
\label{lemma-syntomic-permanence}
Let
$$
\xymatrix{
X \ar[rr]_f \ar[rd]_p & &
Y \ar[dl]^q \\
& S
}
$$
be a commutative diagram of morphisms of schemes. Assume that
\begin{enumerate}
\item $f$ is surjective, flat, and locally of finite presentation,
\item $p$ is syntomic.
\end{enumerate}
Then both $q$ and $f$ are syntomic.
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-flat-finitely-presented-permanence} we see that $q$
is of finite presentation. By
Morphisms, Lemma \ref{morphisms-lemma-flat-permanence}
we see that $q$ is flat.
By Morphisms, Lemma \ref{morphisms-lemma-syntomic-locally-standard-syntomic}
it now suffices to show that the local rings of the fibres of
$Y \to S$ and the fibres of $X \to Y$ are local complete intersection
rings. To do this we may take the fibre of $X \to Y \to S$ at
a point $s \in S$, i.e., we may assume $S$ is the spectrum of a
field. Pick a point $x \in X$ with image $y \in Y$ and
consider the ring map
$$
\mathcal{O}_{Y, y} \longrightarrow \mathcal{O}_{X, x}
$$
This is a flat local homomorphism of local Noetherian rings.
The local ring $\mathcal{O}_{X, x}$ is a complete intersection.
Thus may use Avramov's result, see
Divided Power Algebra, Lemma \ref{dpa-lemma-avramov},
to conclude that both $\mathcal{O}_{Y, y}$ and
$\mathcal{O}_{X, x}/\mathfrak m_y\mathcal{O}_{X, x}$ are
complete intersection rings.
\end{proof}

\noindent
The following type of lemma is occasionally useful.

\begin{lemma}
\label{lemma-curiosity}
Let $X \to Y \to Z$ be morphism of schemes.
Let $P$ be one of the following properties of morphisms of schemes:
flat, locally finite type, locally finite presentation.
Assume that $X \to Z$ has $P$ and that $\{X \to Y\}$
can be refined by an fppf covering of $Y$. Then $Y \to Z$ is $P$.
\end{lemma}

\begin{proof}
Let $\Spec(C) \subset Z$ be an affine open and let
$\Spec(B) \subset Y$ be an affine open which maps into
$\Spec(C)$. The assumption on $X \to Y$ implies we can
find a standard affine fppf covering $\{\Spec(B_j) \to \Spec(B)\}$
and lifts $x_j : \Spec(B_j) \to X$. Since $\Spec(B_j)$
is quasi-compact we can find finitely many affine opens
$\Spec(A_i) \subset X$ lying over $\Spec(B)$
such that the image of each $x_j$
is contained in the union $\bigcup \Spec(A_i)$. Hence after
replacing each $\Spec(B_j)$ by a standard affine Zariski coverings
of itself we may assume we have a
standard affine fppf covering $\{\Spec(B_i) \to \Spec(B)\}$
such that each $\Spec(B_i) \to Y$ factors through an affine
open $\Spec(A_i) \subset X$ lying over $\Spec(B)$.
In other words, we have ring maps $C \to B \to A_i \to B_i$ for each $i$.
Note that we can also consider
$$
C \to B \to A = \prod A_i \to B' = \prod B_i
$$
and that the ring map $B \to \prod B_i$ is faithfully flat and
of finite presentation.

\medskip\noindent
The case $P = flat$. In this case we know that $C \to A$ is flat
and we have to prove that $C \to B$ is flat. Suppose that
$N \to N' \to N''$ is an exact sequence of $C$-modules. We want to
show that $N \otimes_C B \to N' \otimes_C B \to N'' \otimes_C B$
is exact. Let $H$ be its cohomology and let $H'$ be the cohomology
of $N \otimes_C B' \to N' \otimes_C B' \to N'' \otimes_C B'$. As
$B \to B'$ is flat we know that $H' = H \otimes_B B'$. On the other hand
$N \otimes_C A \to N' \otimes_C A \to N'' \otimes_C A$
is exact hence has zero cohomology. Hence the map
$H \to H'$ is zero (as it factors through the zero module).
Thus $H' = 0$. As $B \to B'$ is faithfully flat we conclude that
$H = 0$ as desired.

\medskip\noindent
The case $P = locally\ finite\ type$.
In this case we know that $C \to A$ is of finite type and
we have to prove that $C \to B$ is of finite type.
Because $B \to B'$ is of finite presentation (hence of finite type)
we see that $A \to B'$ is of finite type, see
Algebra, Lemma \ref{algebra-lemma-compose-finite-type}.
Therefore $C \to B'$ is of finite type and we conclude by
Lemma \ref{lemma-finite-type-local-source-fppf-algebra}.

\medskip\noindent
The case $P = locally\ finite\ presentation$.
In this case we know that $C \to A$ is of finite presentation and
we have to prove that $C \to B$ is of finite presentation.
Because $B \to B'$ is of finite presentation and $B \to A$
of finite type we see that $A \to B'$ is of finite presentation, see
Algebra, Lemma \ref{algebra-lemma-compose-finite-type}.
Therefore $C \to B'$ is of finite presentation and we conclude by
Lemma \ref{lemma-flat-finitely-presented-permanence-algebra}.
\end{proof}










\section{Local properties of schemes}
\label{section-descending-properties}

\noindent
It often happens one can prove the members of a covering of a scheme
have a certain property. In many cases this implies the scheme has the
property too. For example, if $S$ is a scheme, and $f : S' \to S$
is a surjective flat morphism such that $S'$ is a reduced scheme, then $S$ is
reduced. You can prove this by looking at local rings and using
Algebra, Lemma \ref{algebra-lemma-descent-reduced}.
We say that the property of being reduced
{\it descends through flat surjective morphisms}.
Some results of this type are collected in
Algebra, Section \ref{algebra-section-descending-properties} and
for schemes in Section \ref{section-variants}.
Some analogous results on descending properties
of morphisms are in Section \ref{section-descent-finiteness-morphisms}.

\medskip\noindent
On the other hand, there are examples of surjective flat morphisms
$f : S' \to S$ with $S$ reduced and $S'$ not, for example the morphism
$\Spec(k[x]/(x^2)) \to \Spec(k)$. Hence the property of
being reduced does not {\it ascend along flat morphisms}. Having infinite
residue fields is a property which does ascend along flat morphisms (but
does not descend along surjective flat morphisms of course). Some results
of this type are collected in
Algebra, Section \ref{algebra-section-ascending-properties}.

\medskip\noindent
Finally, we say that a property is {\it local for the flat topology}
if it ascends along flat morphisms and descends along flat surjective
morphisms. A somewhat silly example is the property of having residue
fields of a given characteristic. To be more precise, and to tie this in
with the various topologies on schemes, we make the following
formal definition.

\begin{definition}
\label{definition-property-local}
Let $\mathcal{P}$ be a property of schemes. Let
$\tau \in \{fpqc, \linebreak[0] fppf, \linebreak[0] syntomic, \linebreak[0]
smooth, \linebreak[0] \etale, \linebreak[0] Zariski\}$.
We say $\mathcal{P}$ is {\it local in the $\tau$-topology} if for any
$\tau$-covering $\{S_i \to S\}_{i \in I}$ (see
Topologies, Section \ref{topologies-section-procedure})
we have
$$
S \text{ has }\mathcal{P}
\Leftrightarrow
\text{each }S_i \text{ has }\mathcal{P}.
$$
\end{definition}

\noindent
To be sure, since isomorphisms are always coverings
we see (or require) that property $\mathcal{P}$ holds for $S$
if and only if it holds for any scheme $S'$ isomorphic to $S$.
In fact, if $\tau = fpqc, \linebreak[0] fppf, \linebreak[0] syntomic,
\linebreak[0] smooth, \linebreak[0] \etale$, or $Zariski$, then
if $S$ has $\mathcal{P}$ and $S' \to S$ is
flat, flat and locally of finite presentation, syntomic, smooth, \'etale, or
an open immersion, then $S'$ has $\mathcal{P}$. This is true because
we can always extend $\{S' \to S\}$ to a $\tau$-covering.

\medskip\noindent
We have the following implications:
$\mathcal{P}$ is local in the fpqc topology
$\Rightarrow$
$\mathcal{P}$ is local in the fppf topology
$\Rightarrow$
$\mathcal{P}$ is local in the syntomic topology
$\Rightarrow$
$\mathcal{P}$ is local in the smooth topology
$\Rightarrow$
$\mathcal{P}$ is local in the \'etale topology
$\Rightarrow$
$\mathcal{P}$ is local in the Zariski topology.
This follows from
Topologies, Lemmas
\ref{topologies-lemma-zariski-etale},
\ref{topologies-lemma-zariski-etale-smooth},
\ref{topologies-lemma-zariski-etale-smooth-syntomic},
\ref{topologies-lemma-zariski-etale-smooth-syntomic-fppf}, and
\ref{topologies-lemma-zariski-etale-smooth-syntomic-fppf-fpqc}.

\begin{lemma}
\label{lemma-descending-properties}
Let $\mathcal{P}$ be a property of schemes.
Let $\tau \in \{fpqc, \linebreak[0] fppf, \linebreak[0]
\etale, \linebreak[0] smooth, \linebreak[0] syntomic\}$.
Assume that
\begin{enumerate}
\item the property is local in the Zariski topology,
\item for any morphism of affine schemes $S' \to S$
which is flat, flat of finite presentation,
\'etale, smooth or syntomic depending on whether $\tau$ is
fpqc, fppf, \'etale, smooth, or syntomic,
property $\mathcal{P}$ holds for $S'$ if property $\mathcal{P}$
holds for $S$, and
\item for any surjective morphism of affine schemes $S' \to S$
which is flat, flat of finite presentation,
\'etale, smooth or syntomic depending on whether $\tau$ is
fpqc, fppf, \'etale, smooth, or syntomic,
property $\mathcal{P}$ holds for $S$ if property $\mathcal{P}$
holds for $S'$.
\end{enumerate}
Then $\mathcal{P}$ is $\tau$ local on the base.
\end{lemma}

\begin{proof}
This follows almost immediately from the definition of
a $\tau$-covering, see
Topologies, Definition
\ref{topologies-definition-fpqc-covering}
\ref{topologies-definition-fppf-covering}
\ref{topologies-definition-etale-covering}
\ref{topologies-definition-smooth-covering}, or
\ref{topologies-definition-syntomic-covering}
and Topologies, Lemma
\ref{topologies-lemma-fpqc-affine},
\ref{topologies-lemma-fppf-affine},
\ref{topologies-lemma-etale-affine},
\ref{topologies-lemma-smooth-affine}, or
\ref{topologies-lemma-syntomic-affine}.
Details omitted.
\end{proof}

\begin{remark}
\label{remark-descending-properties-standard}
In Lemma \ref{lemma-descending-properties} above if
$\tau = smooth$ then in condition (3) we may assume that
the morphism is a (surjective) standard smooth morphism.
Similarly, when $\tau = syntomic$ or $\tau = \etale$.
\end{remark}





\section{Properties of schemes local in the fppf topology}
\label{section-descending-properties-fppf}

\noindent
In this section we find some properties of schemes which are local on the base
in the fppf topology.

\begin{lemma}
\label{lemma-Noetherian-local-fppf}
The property $\mathcal{P}(S) =$``$S$ is locally Noetherian'' is local
in the fppf topology.
\end{lemma}

\begin{proof}
We will use Lemma \ref{lemma-descending-properties}.
First we note that ``being locally Noetherian'' is local
in the Zariski topology. This is clear from the definition,
see Properties, Definition \ref{properties-definition-noetherian}.
Next, we show that if $S' \to S$ is a flat, finitely presented
morphism of affines and $S$ is locally Noetherian, then $S'$ is
locally Noetherian. This is
Morphisms, Lemma \ref{morphisms-lemma-finite-type-noetherian}.
Finally, we have to show that if $S' \to S$ is a surjective
flat, finitely presented morphism of affines and $S'$ is
locally Noetherian, then $S$ is locally Noetherian. This follows from
Algebra, Lemma \ref{algebra-lemma-descent-Noetherian}.
Thus (1), (2) and (3) of Lemma \ref{lemma-descending-properties} hold
and we win.
\end{proof}

\begin{lemma}
\label{lemma-Jacobson-local-fppf}
The property $\mathcal{P}(S) =$``$S$ is Jacobson'' is local
in the fppf topology.
\end{lemma}

\begin{proof}
We will use Lemma \ref{lemma-descending-properties}.
First we note that ``being Jacobson'' is local
in the Zariski topology. This is
Properties, Lemma \ref{properties-lemma-locally-jacobson}.
Next, we show that if $S' \to S$ is a flat, finitely presented
morphism of affines and $S$ is Jacobson, then $S'$ is
Jacobson. This is
Morphisms, Lemma \ref{morphisms-lemma-Jacobson-universally-Jacobson}.
Finally, we have to show that if $f : S' \to S$ is a surjective
flat, finitely presented morphism of affines and $S'$ is
Jacobson, then $S$ is Jacobson. Say $S = \Spec(A)$ and
$S' = \Spec(B)$ and $S' \to S$ given by $A \to B$.
Then $A \to B$ is finitely presented and faithfully flat.
Moreover, the ring $B$ is Jacobson, see
Properties, Lemma \ref{properties-lemma-locally-jacobson}.

\medskip\noindent
By Algebra, Lemma \ref{algebra-lemma-fppf-fpqf} there exists a diagram
$$
\xymatrix{
B \ar[rr] & & B' \\
& A \ar[ru] \ar[lu] &
}
$$
with $A \to B'$ finitely presented, faithfully flat and quasi-finite.
In particular, $B \to B'$ is finite type, and we see from
Algebra, Proposition \ref{algebra-proposition-Jacobson-permanence}
that $B'$ is Jacobson. Hence we may assume that $A \to B$ is quasi-finite
as well as faithfully flat and of finite presentation.

\medskip\noindent
Assume $A$ is not Jacobson to get a contradiction.
According to Algebra, Lemma \ref{algebra-lemma-characterize-jacobson}
there exists a nonmaximal prime $\mathfrak p \subset A$ and
an element $f \in A$, $f \not \in \mathfrak p$ such that
$V(\mathfrak p) \cap D(f) = \{\mathfrak p\}$.

\medskip\noindent
This leads to a contradiction as follows. First let
$\mathfrak p \subset \mathfrak m$ be a maximal ideal of $A$.
Pick a prime $\mathfrak m' \subset B$ lying over $\mathfrak m$
(exists because $A \to B$ is faithfully flat, see
Algebra, Lemma \ref{algebra-lemma-ff-rings}).
As $A \to B$ is flat, by going down see
Algebra, Lemma \ref{algebra-lemma-flat-going-down},
we can find a prime $\mathfrak q \subset \mathfrak m'$ lying over
$\mathfrak p$. In particular we see that $\mathfrak q$ is not
maximal. Hence according to
Algebra, Lemma \ref{algebra-lemma-characterize-jacobson} again
the set $V(\mathfrak q) \cap D(f)$ is infinite
(here we finally use that $B$ is Jacobson).
All points of $V(\mathfrak q) \cap D(f)$ map to
$V(\mathfrak p) \cap D(f) = \{\mathfrak p\}$. Hence the
fibre over $\mathfrak p$ is infinite. This contradicts the
fact that $A \to B$ is quasi-finite (see
Algebra, Lemma \ref{algebra-lemma-quasi-finite}
or more explicitly
Morphisms, Lemma \ref{morphisms-lemma-quasi-finite}).
Thus the lemma is proved.
\end{proof}

\begin{lemma}
\label{lemma-locally-finite-nr-irred-local-fppf}
The property $\mathcal{P}(S) =$``every quasi-compact open of $S$
has a finite number of irreducible components'' is local
in the fppf topology.
\end{lemma}

\begin{proof}
We will use Lemma \ref{lemma-descending-properties}. First we note that
$\mathcal{P}$ is local in the Zariski topology.
Next, we show that if $T \to S$ is a flat, finitely presented
morphism of affines and $S$ has a finite number of irreducible
components, then so does $T$. Namely, since $T \to S$ is flat,
the generic points of $T$ map to the generic points of $S$, see
Morphisms, Lemma \ref{morphisms-lemma-generalizations-lift-flat}.
Hence it suffices to show that for $s \in S$ the fibre $T_s$
has a finite number of generic points. Note that $T_s$ is an
affine scheme of finite type over $\kappa(s)$, see
Morphisms, Lemma \ref{morphisms-lemma-base-change-finite-type}.
Hence $T_s$ is Noetherian and has a finite number of irreducible components
(Morphisms, Lemma \ref{morphisms-lemma-finite-type-noetherian} and
Properties, Lemma \ref{properties-lemma-Noetherian-irreducible-components}).
Finally, we have to show that if $T \to S$ is a surjective
flat, finitely presented morphism of affines and $T$ has a finite
number of irreducible components, then so does $S$. In this case
the arguments above show that every generic point of $S$ is the
image of a generic point of $T$ and the result is clear.
Thus (1), (2) and (3) of Lemma \ref{lemma-descending-properties} hold
and we win.
\end{proof}




\section{Properties of schemes local in the syntomic topology}
\label{section-descending-properties-syntomic}

\noindent
In this section we find some properties of schemes which are local on the base
in the syntomic topology.

\begin{lemma}
\label{lemma-Sk-local-syntomic}
The property $\mathcal{P}(S) =$``$S$ is locally Noetherian and $(S_k)$''
is local in the syntomic topology.
\end{lemma}

\begin{proof}
We will check (1), (2) and (3) of Lemma \ref{lemma-descending-properties}.
As a syntomic morphism is flat of finite presentation
(Morphisms, Lemmas \ref{morphisms-lemma-syntomic-flat}
and \ref{morphisms-lemma-syntomic-locally-finite-presentation})
we have already checked this for ``being locally Noetherian'' in the proof
of Lemma \ref{lemma-Noetherian-local-fppf}.
We will use this without further mention in the proof.
First we note that $\mathcal{P}$ is local in the Zariski topology.
This is clear from the definition,
see Cohomology of Schemes, Definition \ref{coherent-definition-depth}.
Next, we show that if $S' \to S$ is a syntomic morphism of affines
and $S$ has $\mathcal{P}$, then $S'$ has $\mathcal{P}$. This
is Algebra, Lemma \ref{algebra-lemma-Sk-goes-up}
(use
Morphisms, Lemma \ref{morphisms-lemma-syntomic-characterize}
and
Algebra, Definition \ref{algebra-definition-lci} and
Lemma \ref{algebra-lemma-lci-CM}).
Finally, we show that if $S' \to S$ is a surjective
syntomic morphism of affines and $S'$ has $\mathcal{P}$,
then $S$ has $\mathcal{P}$. This is
Algebra, Lemma \ref{algebra-lemma-descent-Sk}.
Thus (1), (2) and (3) of Lemma \ref{lemma-descending-properties} hold
and we win.
\end{proof}

\begin{lemma}
\label{lemma-CM-local-syntomic}
The property $\mathcal{P}(S) =$``$S$ is Cohen-Macaulay''
is local in the syntomic topology.
\end{lemma}

\begin{proof}
This is clear from Lemma \ref{lemma-Sk-local-syntomic}
above since a scheme is Cohen-Macaulay if and only if
it is locally Noetherian and $(S_k)$ for all $k \geq 0$, see
Properties, Lemma \ref{properties-lemma-scheme-CM-iff-all-Sk}.
\end{proof}







\section{Properties of schemes local in the smooth topology}
\label{section-descending-properties-smooth}

\noindent
In this section we find some properties of schemes which are local on the base
in the smooth topology.

\begin{lemma}
\label{lemma-reduced-local-smooth}
The property $\mathcal{P}(S) =$``$S$ is reduced'' is local in the smooth
topology.
\end{lemma}

\begin{proof}
We will use Lemma \ref{lemma-descending-properties}.
First we note that ``being reduced'' is local
in the Zariski topology. This is clear from the definition,
see Schemes, Definition \ref{schemes-definition-reduced}.
Next, we show that if $S' \to S$ is a smooth morphism of affines
and $S$ is reduced, then $S'$ is reduced. This is
Algebra, Lemma \ref{algebra-lemma-reduced-goes-up}.
Finally, we show that if $S' \to S$ is a surjective
smooth morphism of affines
and $S'$ is reduced, then $S$ is reduced. This is
Algebra, Lemma \ref{algebra-lemma-descent-reduced}.
Thus (1), (2) and (3) of Lemma \ref{lemma-descending-properties} hold
and we win.
\end{proof}

\begin{lemma}
\label{lemma-normal-local-smooth}
\begin{slogan}
Normality is local in the smooth topology.
\end{slogan}
The property $\mathcal{P}(S) =$``$S$ is normal'' is local in the smooth
topology.
\end{lemma}

\begin{proof}
We will use Lemma \ref{lemma-descending-properties}.
First we show ``being normal'' is local
in the Zariski topology. This is clear from the definition,
see Properties, Definition \ref{properties-definition-normal}.
Next, we show that if $S' \to S$ is a smooth morphism of affines
and $S$ is normal, then $S'$ is normal. This is
Algebra, Lemma \ref{algebra-lemma-normal-goes-up}.
Finally, we show that if $S' \to S$ is a surjective
smooth morphism of affines
and $S'$ is normal, then $S$ is normal. This is
Algebra, Lemma \ref{algebra-lemma-descent-normal}.
Thus (1), (2) and (3) of Lemma \ref{lemma-descending-properties} hold
and we win.
\end{proof}

\begin{lemma}
\label{lemma-Rk-local-smooth}
The property $\mathcal{P}(S) =$``$S$ is locally Noetherian and $(R_k)$''
is local in the smooth topology.
\end{lemma}

\begin{proof}
We will check (1), (2) and (3) of Lemma \ref{lemma-descending-properties}.
As a smooth morphism is flat of finite presentation
(Morphisms, Lemmas \ref{morphisms-lemma-smooth-flat}
and \ref{morphisms-lemma-smooth-locally-finite-presentation})
we have already checked this for ``being locally Noetherian'' in the proof
of Lemma \ref{lemma-Noetherian-local-fppf}.
We will use this without further mention in the proof.
First we note that $\mathcal{P}$ is local in the Zariski topology.
This is clear from the definition,
see Properties, Definition \ref{properties-definition-Rk}.
Next, we show that if $S' \to S$ is a smooth morphism of affines
and $S$ has $\mathcal{P}$, then $S'$ has $\mathcal{P}$. This
is Algebra, Lemmas \ref{algebra-lemma-Rk-goes-up}
(use Morphisms, Lemma \ref{morphisms-lemma-smooth-characterize},
Algebra, Lemmas \ref{algebra-lemma-base-change-smooth}
and \ref{algebra-lemma-characterize-smooth-over-field}).
Finally, we show that if $S' \to S$ is a surjective
smooth morphism of affines and $S'$ has $\mathcal{P}$,
then $S$ has $\mathcal{P}$. This is
Algebra, Lemma \ref{algebra-lemma-descent-Rk}.
Thus (1), (2) and (3) of Lemma \ref{lemma-descending-properties} hold
and we win.
\end{proof}

\begin{lemma}
\label{lemma-regular-local-smooth}
The property $\mathcal{P}(S) =$``$S$ is regular''
is local in the smooth topology.
\end{lemma}

\begin{proof}
This is clear from Lemma \ref{lemma-Rk-local-smooth}
above since a locally Noetherian scheme is regular if and only if
it is locally Noetherian and $(R_k)$ for all $k \geq 0$.
\end{proof}

\begin{lemma}
\label{lemma-Nagata-local-smooth}
The property $\mathcal{P}(S) =$``$S$ is Nagata''
is local in the smooth topology.
\end{lemma}

\begin{proof}
We will check (1), (2) and (3) of Lemma \ref{lemma-descending-properties}.
First we note that being Nagata is local in the Zariski topology.
This is Properties, Lemma \ref{properties-lemma-locally-nagata}.
Next, we show that if $S' \to S$ is a smooth morphism of affines
and $S$ is Nagata, then $S'$ is Nagata. This
is Morphisms, Lemma \ref{morphisms-lemma-finite-type-nagata}.
Finally, we show that if $S' \to S$ is a surjective
smooth morphism of affines and $S'$ is Nagata,
then $S$ is Nagata. This is
Algebra, Lemma \ref{algebra-lemma-descent-nagata}.
Thus (1), (2) and (3) of Lemma \ref{lemma-descending-properties} hold
and we win.
\end{proof}





\section{Variants on descending properties}
\label{section-variants}

\noindent
Sometimes one can descend properties, which are not local.
We put results of this kind in this section. See also
Section \ref{section-descent-finiteness-morphisms}
on descending properties of morphisms,
such as smoothness.

\begin{lemma}
\label{lemma-descend-reduced}
If $f : X \to Y$ is a flat and surjective morphism of schemes
and $X$ is reduced, then $Y$ is reduced.
\end{lemma}

\begin{proof}
The result follows by looking at local rings
(Schemes, Definition \ref{schemes-definition-reduced})
and
Algebra, Lemma \ref{algebra-lemma-descent-reduced}.
\end{proof}

\begin{lemma}
\label{lemma-descend-regular}
Let $f : X \to Y$ be a morphism of algebraic spaces.
If $f$ is locally of finite presentation, flat, and surjective and
$X$ is regular, then $Y$ is regular.
\end{lemma}

\begin{proof}
This lemma reduces to the following algebra statement: If $A \to B$ is
a faithfully flat, finitely presented ring homomorphism with $B$ Noetherian
and regular, then $A$ is Noetherian and regular. We see that
$A$ is Noetherian by
Algebra, Lemma \ref{algebra-lemma-descent-Noetherian}
and regular by
Algebra, Lemma \ref{algebra-lemma-flat-under-regular}.
\end{proof}









\section{Germs of schemes}
\label{section-germs}

\begin{definition}
\label{definition-germs}
Germs of schemes.
\begin{enumerate}
\item A pair $(X, x)$ consisting of a scheme $X$ and a point $x \in X$ is
called the {\it germ of $X$ at $x$}.
\item A {\it morphism of germs} $f : (X, x) \to (S, s)$
is an equivalence class of morphisms of schemes $f : U \to S$ with $f(x) = s$
where $U \subset X$ is an open neighbourhood of $x$. Two such
$f$, $f'$ are said to be equivalent if and only if $f$ and $f'$
agree in some open neighbourhood of $x$.
\item We define the {\it composition of morphisms of germs}
by composing representatives (this is well defined).
\end{enumerate}
\end{definition}

\noindent
Before we continue we need one more definition.

\begin{definition}
\label{definition-etale-morphism-germs}
Let $f : (X, x) \to (S, s)$ be a morphism of germs.
We say $f$ is {\it \'etale} (resp.\ {\it smooth}) if there exists a
representative $f : U \to S$ of $f$ which is an \'etale morphism
(resp.\ a smooth morphism) of schemes.
\end{definition}








\section{Local properties of germs}
\label{section-properties-germs-local}

\begin{definition}
\label{definition-local-at-point}
Let $\mathcal{P}$ be a property of germs of schemes.
We say that $\mathcal{P}$ is {\it \'etale local}
(resp.\ {\it smooth local}) if for any
\'etale (resp.\ smooth) morphism of germs $(U', u') \to (U, u)$
we have $\mathcal{P}(U, u) \Leftrightarrow \mathcal{P}(U', u')$.
\end{definition}

\noindent
Let $(X, x)$ be a germ of a scheme.
The dimension of $X$ at $x$ is the minimum of the dimensions of
open neighbourhoods of $x$ in $X$, and any small enough open neighbourhood
has this dimension. Hence this is an invariant of the isomorphism class
of the germ. We denote this simply $\dim_x(X)$.
The following lemma tells us that the assertion
$\dim_x(X) = d$ is an \'etale local property of germs.

\begin{lemma}
\label{lemma-dimension-at-point-local}
Let $f : U \to V$ be an \'etale morphism of schemes.
Let $u \in U$ and $v = f(u)$. Then $\dim_u(U) = \dim_v(V)$.
\end{lemma}

\begin{proof}
In the statement $\dim_u(U)$ is the dimension of $U$ at $u$ as defined in
Topology, Definition \ref{topology-definition-Krull}
as the minimum of the Krull dimensions of open neighbourhoods of $u$ in $U$.
Similarly for $\dim_v(V)$.

\medskip\noindent
Let us show that $\dim_v(V) \geq \dim_u(U)$.
Let $V'$ be an open neighbourhood of $v$ in $V$.
Then there exists an open neighbourhood $U'$ of $u$ in $U$
contained in $f^{-1}(V')$ such that $\dim_u(U) = \dim(U')$. Suppose that
$Z_0 \subset Z_1 \subset \ldots \subset Z_n$ is a chain of irreducible
closed subschemes of $U'$. If $\xi_i \in Z_i$ is the generic point
then we have specializations
$\xi_n \leadsto \xi_{n - 1} \leadsto \ldots \leadsto \xi_0$.
This gives specializations
$f(\xi_n) \leadsto f(\xi_{n - 1}) \leadsto \ldots \leadsto f(\xi_0)$
in $V'$. Note that $f(\xi_j) \not = f(\xi_i)$ if $i \not = j$ as
the fibres of $f$ are discrete (see
Morphisms, Lemma \ref{morphisms-lemma-etale-over-field}).
Hence we see that $\dim(V') \geq n$. The inequality
$\dim_v(V) \geq \dim_u(U)$ follows formally.

\medskip\noindent
Let us show that $\dim_u(U) \geq \dim_v(V)$.
Let $U'$ be an open neighbourhood of $u$ in $U$.
Note that $V' = f(U')$ is an open neighbourhood of $v$ by
Morphisms, Lemma \ref{morphisms-lemma-fppf-open}.
Hence $\dim(V') \geq \dim_v(V)$. Pick a chain
$Z_0 \subset Z_1 \subset \ldots \subset Z_n$ of irreducible
closed subschemes of $V'$. Let $\xi_i \in Z_i$ be the generic point,
so we have specializations
$\xi_n \leadsto \xi_{n - 1} \leadsto \ldots \leadsto \xi_0$.
Since $\xi_0 \in f(U')$ we can find a point $\eta_0 \in U'$
with $f(\eta_0) = \xi_0$. Consider the map of local rings
$$
\mathcal{O}_{V', \xi_0} \longrightarrow \mathcal{O}_{U', \eta_0}
$$
which is a flat local ring map by
Morphisms, Lemma \ref{morphisms-lemma-etale-flat}.
Note that the points $\xi_i$ correspond to primes of the ring on the left by
Schemes, Lemma \ref{schemes-lemma-specialize-points}.
Hence by going down (see
Algebra, Section \ref{algebra-section-going-up})
for the displayed ring map we can find a sequence of specializations
$\eta_n \leadsto \eta_{n - 1} \leadsto \ldots \leadsto \eta_0$
in $U'$ mapping to the sequence
$\xi_n \leadsto \xi_{n - 1} \leadsto \ldots \leadsto \xi_0$
under $f$. This implies that $\dim_u(U) \geq \dim_v(V)$.
\end{proof}

\noindent
Let $(X, x)$ be a germ of a scheme.
The isomorphism class of the local ring $\mathcal{O}_{X, x}$
is an invariant of the germ. The following lemma says that the
property $\dim(\mathcal{O}_{X, x}) = d$ is an \'etale local property
of germs.

\begin{lemma}
\label{lemma-dimension-local-ring-local}
Let $f : U \to V$ be an \'etale morphism of schemes.
Let $u \in U$ and $v = f(u)$. Then
$\dim(\mathcal{O}_{U, u}) = \dim(\mathcal{O}_{V, v})$.
\end{lemma}

\begin{proof}
The algebraic statement we are asked to prove is the following:
If $A \to B$ is an \'etale ring map and $\mathfrak q$ is a prime of
$B$ lying over $\mathfrak p \subset A$, then
$\dim(A_{\mathfrak p}) = \dim(B_{\mathfrak q})$.
This is
More on Algebra, Lemma \ref{more-algebra-lemma-dimension-etale-extension}.
\end{proof}

\noindent
Let $(X, x)$ be a germ of a scheme.
The isomorphism class of the local ring $\mathcal{O}_{X, x}$
is an invariant of the germ. The following lemma says that the
property ``$\mathcal{O}_{X, x}$ is regular'' is an \'etale local property
of germs.

\begin{lemma}
\label{lemma-regular-local-ring-local}
Let $f : U \to V$ be an \'etale morphism of schemes.
Let $u \in U$ and $v = f(u)$. Then
$\mathcal{O}_{U, u}$ is a regular local ring if and only if
$\mathcal{O}_{V, v}$ is a regular local ring.
\end{lemma}

\begin{proof}
The algebraic statement we are asked to prove is the following:
If $A \to B$ is an \'etale ring map and $\mathfrak q$ is a prime of
$B$ lying over $\mathfrak p \subset A$, then
$A_{\mathfrak p}$ is regular if and only if $B_{\mathfrak q}$ is regular.
This is More on Algebra, Lemma
\ref{more-algebra-lemma-regular-etale-extension}.
\end{proof}







\section{Properties of morphisms local on the target}
\label{section-descending-properties-morphisms}

\noindent
Suppose that $f : X \to Y$ is a morphism of schemes.
Let $g : Y' \to Y$ be a morphism of schemes.
Let $f' : X' \to Y'$ be the base change of $f$ by $g$:
$$
\xymatrix{
X' \ar[d]_{f'} \ar[r]_{g'} & X \ar[d]^f \\
Y' \ar[r]^g & Y
}
$$
Let $\mathcal{P}$ be a property of morphisms of schemes.
Then we can wonder if (a) $\mathcal{P}(f) \Rightarrow \mathcal{P}(f')$,
and also whether the converse (b) $\mathcal{P}(f') \Rightarrow \mathcal{P}(f)$
is true. If (a) holds whenever $g$ is flat, then we say $\mathcal{P}$
is preserved under flat base change. If (b) holds whenever $g$ is
surjective and flat, then we say $\mathcal{P}$ descends through
flat surjective base changes. If $\mathcal{P}$ is preserved under
flat base changes and descends through flat surjective base changes,
then we say $\mathcal{P}$ is flat local on the target.
Compare with the discussion in
Section \ref{section-descending-properties}.
This turns out to be a very important notion which
we formalize in the following definition.

\begin{definition}
\label{definition-property-morphisms-local}
Let $\mathcal{P}$ be a property of morphisms of schemes over a base.
Let $\tau \in \{fpqc, fppf, syntomic, smooth, \etale, Zariski\}$.
We say $\mathcal{P}$ is {\it $\tau$ local on the base}, or
{\it $\tau$ local on the target}, or
{\it local on the base for the $\tau$-topology} if for any
$\tau$-covering $\{Y_i \to Y\}_{i \in I}$ (see
Topologies, Section \ref{topologies-section-procedure})
and any morphism of schemes $f : X \to Y$ over $S$ we
have
$$
f \text{ has }\mathcal{P}
\Leftrightarrow
\text{each }Y_i \times_Y X \to Y_i\text{ has }\mathcal{P}.
$$
\end{definition}

\noindent
To be sure, since isomorphisms are always coverings
we see (or require) that property $\mathcal{P}$ holds for $X \to Y$
if and only if it holds for any arrow $X' \to Y'$ isomorphic to $X \to Y$.
If a property is $\tau$-local on the target then it is preserved
by base changes by morphisms which occur in $\tau$-coverings. Here
is a formal statement.

\begin{lemma}
\label{lemma-pullback-property-local-target}
Let $\tau \in \{fpqc, fppf, syntomic, smooth, \etale, Zariski\}$.
Let $\mathcal{P}$ be a property of morphisms which is $\tau$ local
on the target. Let $f : X \to Y$ have property $\mathcal{P}$.
For any morphism $Y' \to Y$ which is
flat, resp.\ flat and locally of finite presentation, resp.\ syntomic,
resp.\ \'etale, resp.\ an open immersion, the base change
$f' : Y' \times_Y X \to Y'$ of $f$ has property $\mathcal{P}$.
\end{lemma}

\begin{proof}
This is true because we can fit $Y' \to Y$ into a family of
morphisms which forms a $\tau$-covering.
\end{proof}

\noindent
A simple often used consequence of the above is that if
$f : X \to Y$ has property $\mathcal{P}$ which is $\tau$-local
on the target and $f(X) \subset V$
for some open subscheme $V \subset Y$, then also the induced
morphism $X \to V$ has $\mathcal{P}$. Proof: The base change
$f$ by $V \to Y$ gives $X \to V$.

\begin{lemma}
\label{lemma-largest-open-of-the-base}
Let $\tau \in \{fppf, syntomic, smooth, \etale\}$.
Let $\mathcal{P}$ be a property of morphisms which is $\tau$ local
on the target. For any morphism of schemes $f : X \to Y$ there exists
a largest open $W(f) \subset Y$ such that the restriction
$X_{W(f)} \to W(f)$ has $\mathcal{P}$. Moreover,
\begin{enumerate}
\item if $g : Y' \to Y$ is flat and locally of finite presentation,
syntomic, smooth, or \'etale and the base change $f' : X_{Y'} \to Y'$
has $\mathcal{P}$, then $g(Y') \subset W(f)$,
\item if $g : Y' \to Y$ is flat and locally of finite presentation,
syntomic, smooth, or \'etale, then $W(f') = g^{-1}(W(f))$, and
\item if $\{g_i : Y_i \to Y\}$ is a $\tau$-covering, then
$g_i^{-1}(W(f)) = W(f_i)$, where $f_i$ is the base change of $f$
by $Y_i \to Y$.
\end{enumerate}
\end{lemma}

\begin{proof}
Consider the union $W$ of the images $g(Y') \subset Y$ of
morphisms $g : Y' \to Y$ with the properties:
\begin{enumerate}
\item $g$ is flat and locally of finite presentation, syntomic,
smooth, or \'etale, and
\item the base change $Y' \times_{g, Y} X \to Y'$ has property
$\mathcal{P}$.
\end{enumerate}
Since such a morphism $g$ is open (see
Morphisms, Lemma \ref{morphisms-lemma-fppf-open})
we see that $W \subset Y$ is an open subset of $Y$. Since $\mathcal{P}$
is local in the $\tau$ topology the restriction $X_W \to W$ has property
$\mathcal{P}$ because we are given a covering $\{Y' \to W\}$ of $W$ such that
the pullbacks have $\mathcal{P}$. This proves the existence and proves
that $W(f)$ has property (1). To see property (2) note that
$W(f') \supset g^{-1}(W(f))$ because $\mathcal{P}$ is stable under
base change by flat and locally of finite presentation,
syntomic, smooth, or \'etale morphisms, see
Lemma \ref{lemma-pullback-property-local-target}.
On the other hand, if $Y'' \subset Y'$ is an open such that
$X_{Y''} \to Y''$ has property $\mathcal{P}$, then $Y'' \to Y$ factors
through $W$ by construction, i.e., $Y'' \subset g^{-1}(W(f))$. This
proves (2). Assertion (3) follows from (2) because each morphism
$Y_i \to Y$ is flat and locally of finite presentation, syntomic,
smooth, or \'etale by our definition of a $\tau$-covering.
\end{proof}

\begin{lemma}
\label{lemma-descending-properties-morphisms}
Let $\mathcal{P}$ be a property of morphisms of schemes over a base.
Let $\tau \in \{fpqc, fppf, \etale, smooth, syntomic\}$.
Assume that
\begin{enumerate}
\item the property is preserved under
flat, flat and locally of finite presentation, \'etale, smooth, or syntomic
base change depending on whether $\tau$ is fpqc, fppf, \'etale, smooth, or
syntomic (compare with
Schemes, Definition \ref{schemes-definition-preserved-by-base-change}),
\item the property is Zariski local on the base.
\item for any surjective morphism of affine schemes $S' \to S$
which is flat, flat of finite presentation,
\'etale, smooth or syntomic depending on whether $\tau$ is
fpqc, fppf, \'etale, smooth, or syntomic,
and any morphism of schemes $f : X \to S$ property
$\mathcal{P}$ holds for $f$ if property $\mathcal{P}$
holds for the base change $f' : X' = S' \times_S X \to S'$.
\end{enumerate}
Then $\mathcal{P}$ is $\tau$ local on the base.
\end{lemma}

\begin{proof}
This follows almost immediately from the definition of
a $\tau$-covering, see
Topologies, Definition
\ref{topologies-definition-fpqc-covering}
\ref{topologies-definition-fppf-covering}
\ref{topologies-definition-etale-covering}
\ref{topologies-definition-smooth-covering}, or
\ref{topologies-definition-syntomic-covering}
and Topologies, Lemma
\ref{topologies-lemma-fpqc-affine},
\ref{topologies-lemma-fppf-affine},
\ref{topologies-lemma-etale-affine},
\ref{topologies-lemma-smooth-affine}, or
\ref{topologies-lemma-syntomic-affine}.
Details omitted.
\end{proof}

\begin{remark}
\label{remark-descending-properties-morphisms-standard}
(This is a repeat of Remark \ref{remark-descending-properties-standard} above.)
In Lemma \ref{lemma-descending-properties-morphisms} above if
$\tau = smooth$ then in condition (3) we may assume that
the morphism is a (surjective) standard smooth morphism.
Similarly, when $\tau = syntomic$ or $\tau = \etale$.
\end{remark}




\section{Properties of morphisms local in the fpqc topology on the target}
\label{section-descending-properties-morphisms-fpqc}

\noindent
In this section we find a large number of properties
of morphisms of schemes which are local on the base
in the fpqc topology. By contrast, in
Examples, Section \ref{examples-section-non-descending-property-projective}
we will show that the properties ``projective'' and ``quasi-projective''
are not local on the base even in the Zariski topology.

\begin{lemma}
\label{lemma-descending-property-quasi-compact}
The property $\mathcal{P}(f) =$``$f$ is quasi-compact''
is fpqc local on the base.
\end{lemma}

\begin{proof}
A base change of a quasi-compact morphism is quasi-compact, see
Schemes, Lemma \ref{schemes-lemma-quasi-compact-preserved-base-change}.
Being quasi-compact is Zariski local on the base, see
Schemes, Lemma \ref{schemes-lemma-quasi-compact-affine}.
Finally, let
$S' \to S$ be a flat surjective morphism of affine schemes,
and let $f : X \to S$ be a morphism. Assume that the base change
$f' : X' \to S'$ is quasi-compact. Then $X'$ is quasi-compact,
and $X' \to X$ is surjective. Hence $X$ is quasi-compact.
This implies that $f$ is quasi-compact.
Therefore Lemma \ref{lemma-descending-properties-morphisms} applies and we win.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-quasi-separated}
The property $\mathcal{P}(f) =$``$f$ is quasi-separated''
is fpqc local on the base.
\end{lemma}

\begin{proof}
Any base change of a quasi-separated morphism is quasi-separated, see
Schemes, Lemma \ref{schemes-lemma-separated-permanence}.
Being quasi-separated is Zariski local on the base (from the
definition or by
Schemes, Lemma \ref{schemes-lemma-characterize-quasi-separated}).
Finally, let
$S' \to S$ be a flat surjective morphism of affine schemes,
and let $f : X \to S$ be a morphism. Assume that the base change
$f' : X' \to S'$ is quasi-separated. This means that
$\Delta' : X' \to X'\times_{S'} X'$ is quasi-compact.
Note that $\Delta'$ is the base change of $\Delta : X \to X \times_S X$
via $S' \to S$. By Lemma \ref{lemma-descending-property-quasi-compact}
this implies $\Delta$ is quasi-compact, and hence $f$ is
quasi-separated.
Therefore Lemma \ref{lemma-descending-properties-morphisms} applies and we win.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-universally-closed}
The property $\mathcal{P}(f) =$``$f$ is universally closed''
is fpqc local on the base.
\end{lemma}

\begin{proof}
A base change of a universally closed morphism is universally closed
by definition.
Being universally closed is Zariski local on the base (from the
definition or by
Morphisms, Lemma
\ref{morphisms-lemma-universally-closed-local-on-the-base}).
Finally, let
$S' \to S$ be a flat surjective morphism of affine schemes,
and let $f : X \to S$ be a morphism. Assume that the base change
$f' : X' \to S'$ is universally closed. Let $T \to S$ be any morphism.
Consider the diagram
$$
\xymatrix{
X' \ar[d] &
S' \times_S T \times_S X \ar[d] \ar[r] \ar[l] &
T \times_S X \ar[d] \\
S' &
S' \times_S T \ar[r] \ar[l] &
T
}
$$
in which both squares are cartesian.
Thus the assumption implies that the middle vertical
arrow is closed. The right horizontal arrows are flat, quasi-compact
and surjective (as base changes of $S' \to S$).
Hence a subset of $T$ is closed if and only if its inverse
image in $S' \times_S T$ is closed, see Morphisms,
Lemma \ref{morphisms-lemma-fpqc-quotient-topology}.
An easy diagram chase shows that the right vertical
arrow is closed too, and we conclude $X \to S$ is
universally closed.
Therefore Lemma \ref{lemma-descending-properties-morphisms} applies and we win.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-universally-open}
The property $\mathcal{P}(f) =$``$f$ is universally open''
is fpqc local on the base.
\end{lemma}

\begin{proof}
The proof is the same as the proof of
Lemma \ref{lemma-descending-property-universally-closed}.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-universally-submersive}
The property $\mathcal{P}(f) =$``$f$ is universally submersive''
is fpqc local on the base.
\end{lemma}

\begin{proof}
The proof is the same as the proof of
Lemma \ref{lemma-descending-property-universally-closed}
using that a quasi-compact flat surjective morphism is
universally submersive by
Morphisms, Lemma \ref{morphisms-lemma-fpqc-quotient-topology}.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-separated}
The property $\mathcal{P}(f) =$``$f$ is separated''
is fpqc local on the base.
\end{lemma}

\begin{proof}
A base change of a separated morphism is separated, see
Schemes, Lemma \ref{schemes-lemma-separated-permanence}.
Being separated is Zariski local on the base (from the
definition or by
Schemes, Lemma \ref{schemes-lemma-characterize-separated}).
Finally, let
$S' \to S$ be a flat surjective morphism of affine schemes,
and let $f : X \to S$ be a morphism. Assume that the base change
$f' : X' \to S'$ is separated. This means that
$\Delta' : X' \to X'\times_{S'} X'$ is a closed immersion,
hence universally closed.
Note that $\Delta'$ is the base change of $\Delta : X \to X \times_S X$
via $S' \to S$. By Lemma \ref{lemma-descending-property-universally-closed}
this implies $\Delta$ is universally closed. Since it is
an immersion
(Schemes, Lemma \ref{schemes-lemma-diagonal-immersion})
we conclude $\Delta$ is a closed immersion.
Hence $f$ is separated.
Therefore Lemma \ref{lemma-descending-properties-morphisms} applies and we win.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-surjective}
The property $\mathcal{P}(f) =$``$f$ is surjective''
is fpqc local on the base.
\end{lemma}

\begin{proof}
This is clear.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-universally-injective}
The property $\mathcal{P}(f) =$``$f$ is universally injective''
is fpqc local on the base.
\end{lemma}

\begin{proof}
A base change of a universally injective morphism is universally
injective (this is formal). Being universally injective is Zariski
local on the base; this is clear from the definition.
Finally, let
$S' \to S$ be a flat surjective morphism of affine schemes,
and let $f : X \to S$ be a morphism. Assume that the base change
$f' : X' \to S'$ is universally injective. Let $K$ be a field, and let
$a, b : \Spec(K) \to X$ be two morphisms such that
$f \circ a = f \circ b$. As $S' \to S$ is surjective and
by the discussion in Schemes,
Section \ref{schemes-section-points} there exists a field
extension $K \subset K'$ and a morphism $\Spec(K')
\to S'$ such that the following solid diagram commutes
$$
\xymatrix{
\Spec(K') \ar[rrd] \ar@{-->}[rd]_{a', b'} \ar[dd] \\
 &
X' \ar[r] \ar[d] &
S' \ar[d] \\
\Spec(K) \ar[r]^{a, b} &
X \ar[r] &
S
}
$$
As the square is cartesian we get the two dotted arrows $a'$, $b'$ making the
diagram commute. Since $X' \to S'$ is universally injective we get $a' = b'$,
by
Morphisms, Lemma \ref{morphisms-lemma-universally-injective}.
Clearly this forces $a = b$ (by the discussion in Schemes,
Section \ref{schemes-section-points}).
Therefore Lemma \ref{lemma-descending-properties-morphisms} applies and we win.

\medskip\noindent
An alternative proof would be to use the characterization of a universally
injective morphism as one whose diagonal is surjective, see
Morphisms, Lemma \ref{morphisms-lemma-universally-injective}.
The lemma then follows from the fact that
the property of being surjective is fpqc local on the base, see
Lemma \ref{lemma-descending-property-surjective}.
(Hint: use that the base change of the diagonal is the diagonal
of the base change.)
\end{proof}

\begin{lemma}
\label{lemma-descending-property-universal-homeomorphism}
The property $\mathcal{P}(f) =$``$f$ is a universal homeomorphism''
is fpqc local on the base.
\end{lemma}

\begin{proof}
This can be proved in exactly the same manner as
Lemma \ref{lemma-descending-property-universally-closed}.
Alternatively, one can use that
a map of topological spaces is a homeomorphism if and only if
it is injective, surjective, and open. Thus
a universal homeomorphism is the same thing as a
surjective, universally injective, and universally open morphism.
Thus the lemma follows from
Lemmas \ref{lemma-descending-property-surjective},
\ref{lemma-descending-property-universally-injective}, and
\ref{lemma-descending-property-universally-open}.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-locally-finite-type}
The property $\mathcal{P}(f) =$``$f$ is locally of finite type''
is fpqc local on the base.
\end{lemma}

\begin{proof}
Being locally of finite type is preserved under base change, see
Morphisms, Lemma \ref{morphisms-lemma-base-change-finite-type}.
Being locally of finite type is Zariski local on the base, see
Morphisms, Lemma \ref{morphisms-lemma-locally-finite-type-characterize}.
Finally, let
$S' \to S$ be a flat surjective morphism of affine schemes,
and let $f : X \to S$ be a morphism. Assume that the base change
$f' : X' \to S'$ is locally of finite type.
Let $U \subset X$ be an affine open. Then $U' = S' \times_S U$
is affine and of finite type over $S'$. Write
$S = \Spec(R)$,
$S' = \Spec(R')$,
$U = \Spec(A)$, and
$U' = \Spec(A')$.
We know that $R \to R'$ is faithfully flat,
$A' = R' \otimes_R A$ and $R' \to A'$ is of finite type.
We have to show that $R \to A$ is of finite type.
This is the result of
Algebra, Lemma \ref{algebra-lemma-finite-type-descends}.
It follows that $f$ is locally of finite type.
Therefore Lemma \ref{lemma-descending-properties-morphisms} applies and we win.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-locally-finite-presentation}
The property $\mathcal{P}(f) =$``$f$ is locally of finite presentation''
is fpqc local on the base.
\end{lemma}

\begin{proof}
Being locally of finite presentation is preserved under base change, see
Morphisms, Lemma \ref{morphisms-lemma-base-change-finite-presentation}.
Being locally of finite type is Zariski local on the base, see Morphisms,
Lemma \ref{morphisms-lemma-locally-finite-presentation-characterize}.
Finally, let
$S' \to S$ be a flat surjective morphism of affine schemes,
and let $f : X \to S$ be a morphism. Assume that the base change
$f' : X' \to S'$ is locally of finite presentation.
Let $U \subset X$ be an affine open. Then $U' = S' \times_S U$
is affine and of finite type over $S'$. Write
$S = \Spec(R)$,
$S' = \Spec(R')$,
$U = \Spec(A)$, and
$U' = \Spec(A')$.
We know that $R \to R'$ is faithfully flat,
$A' = R' \otimes_R A$ and $R' \to A'$ is of finite presentation.
We have to show that $R \to A$ is of finite presentation.
This is the result of
Algebra, Lemma \ref{algebra-lemma-finite-presentation-descends}.
It follows that $f$ is locally of finite presentation.
Therefore Lemma \ref{lemma-descending-properties-morphisms} applies and we win.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-finite-type}
The property $\mathcal{P}(f) =$``$f$ is of finite type''
is fpqc local on the base.
\end{lemma}

\begin{proof}
Combine Lemmas \ref{lemma-descending-property-quasi-compact}
and \ref{lemma-descending-property-locally-finite-type}.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-finite-presentation}
The property $\mathcal{P}(f) =$``$f$ is of finite presentation''
is fpqc local on the base.
\end{lemma}

\begin{proof}
Combine Lemmas \ref{lemma-descending-property-quasi-compact},
\ref{lemma-descending-property-quasi-separated} and
\ref{lemma-descending-property-locally-finite-presentation}.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-proper}
The property $\mathcal{P}(f) =$``$f$ is proper''
is fpqc local on the base.
\end{lemma}

\begin{proof}
The lemma follows by combining
Lemmas \ref{lemma-descending-property-universally-closed},
\ref{lemma-descending-property-separated}
and \ref{lemma-descending-property-finite-type}.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-flat}
The property $\mathcal{P}(f) =$``$f$ is flat''
is fpqc local on the base.
\end{lemma}

\begin{proof}
Being flat is preserved under arbitrary base change, see
Morphisms, Lemma \ref{morphisms-lemma-base-change-flat}.
Being flat is Zariski local on the base by definition.
Finally, let
$S' \to S$ be a flat surjective morphism of affine schemes,
and let $f : X \to S$ be a morphism. Assume that the base change
$f' : X' \to S'$ is flat.
Let $U \subset X$ be an affine open. Then $U' = S' \times_S U$
is affine. Write
$S = \Spec(R)$,
$S' = \Spec(R')$,
$U = \Spec(A)$, and
$U' = \Spec(A')$.
We know that $R \to R'$ is faithfully flat,
$A' = R' \otimes_R A$ and $R' \to A'$ is flat.
Goal: Show that $R \to A$ is flat.
This follows immediately from
Algebra, Lemma \ref{algebra-lemma-flatness-descends}.
Hence $f$ is flat.
Therefore Lemma \ref{lemma-descending-properties-morphisms} applies and we win.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-open-immersion}
The property $\mathcal{P}(f) =$``$f$ is an open immersion''
is fpqc local on the base.
\end{lemma}

\begin{proof}
The property of being an open immersion is stable under base change,
see Schemes, Lemma \ref{schemes-lemma-base-change-immersion}.
The property of being an open immersion is Zariski local on the base
(this is obvious).

\medskip\noindent
Let $S' \to S$ be a flat surjective morphism of affine schemes,
and let $f : X \to S$ be a morphism. Assume that the base change
$f' : X' \to S'$ is an open immersion. We claim that $f$ is an
open immersion.
Then $f'$ is universally open, and universally injective.
Hence we conclude that $f$ is universally open by
Lemma \ref{lemma-descending-property-universally-open}, and
universally injective by
Lemma \ref{lemma-descending-property-universally-injective}.
In particular $f(X) \subset S$ is open. If for every affine
open $U \subset f(X)$ we can prove that $f^{-1}(U) \to U$
is an isomorphism, then $f$ is an open immersion and we're done.
If $U' \subset S'$ denotes the inverse image of $U$,
then $U' \to U$ is a faithfully flat morphism of affines and
$(f')^{-1}(U') \to U'$ is an isomorphism (as $f'(X')$ contains $U'$
by our choice of $U$). Thus we reduce to the case discussed
in the next paragraph.

\medskip\noindent
Let $S' \to S$ be a flat surjective morphism of affine schemes,
let $f : X \to S$ be a morphism, and assume that the base change
$f' : X' \to S'$ is an isomorphism. We have to show that $f$ is an
isomorphism also. It is clear that $f$ is surjective, universally injective,
and universally open (see arguments above for the last two).
Hence $f$ is bijective, i.e., $f$ is a homeomorphism.
Thus $f$ is affine by
Morphisms, Lemma \ref{morphisms-lemma-homeomorphism-affine}.
Since
$$
\mathcal{O}(S') \to
\mathcal{O}(X') =
\mathcal{O}(S') \otimes_{\mathcal{O}(S)} \mathcal{O}(X)
$$
is an isomorphism and since $\mathcal{O}(S) \to \mathcal{O}(S')$
is faithfully flat this implies that $\mathcal{O}(S) \to \mathcal{O}(X)$
is an isomorphism. Thus $f$ is an isomorphism. This finishes the proof of
the claim above.
Therefore Lemma \ref{lemma-descending-properties-morphisms} applies and we win.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-isomorphism}
The property $\mathcal{P}(f) =$``$f$ is an isomorphism''
is fpqc local on the base.
\end{lemma}

\begin{proof}
Combine Lemmas \ref{lemma-descending-property-surjective}
and \ref{lemma-descending-property-open-immersion}.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-affine}
The property $\mathcal{P}(f) =$``$f$ is affine''
is fpqc local on the base.
\end{lemma}

\begin{proof}
A base change of an affine morphism is affine, see
Morphisms, Lemma \ref{morphisms-lemma-base-change-affine}.
Being affine is Zariski local on the base, see
Morphisms, Lemma \ref{morphisms-lemma-characterize-affine}.
Finally, let
$g : S' \to S$ be a flat surjective morphism of affine schemes,
and let $f : X \to S$ be a morphism. Assume that the base change
$f' : X' \to S'$ is affine. In other words, $X'$ is affine, say
$X' = \Spec(A')$. Also write $S = \Spec(R)$
and $S' = \Spec(R')$. We have to show that $X$ is affine.

\medskip\noindent
By Lemmas \ref{lemma-descending-property-quasi-compact}
and \ref{lemma-descending-property-separated} we see that
$X \to S$ is separated and quasi-compact. Thus
$f_*\mathcal{O}_X$ is a quasi-coherent sheaf of $\mathcal{O}_S$-algebras,
see Schemes, Lemma \ref{schemes-lemma-push-forward-quasi-coherent}.
Hence $f_*\mathcal{O}_X = \widetilde{A}$ for some $R$-algebra $A$.
In fact $A = \Gamma(X, \mathcal{O}_X)$ of course.
Also, by flat base change
(see for example
Cohomology of Schemes, Lemma \ref{coherent-lemma-flat-base-change-cohomology})
we have $g^*f_*\mathcal{O}_X = f'_*\mathcal{O}_{X'}$.
In other words, we have $A' = R' \otimes_R A$.
Consider the canonical morphism
$$
X \longrightarrow \Spec(A)
$$
over $S$ from Schemes, Lemma \ref{schemes-lemma-morphism-into-affine}.
By the above the base change of this morphism to $S'$ is an isomorphism.
Hence it is an isomorphism by
Lemma \ref{lemma-descending-property-isomorphism}.
Therefore Lemma \ref{lemma-descending-properties-morphisms} applies and we win.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-closed-immersion}
The property $\mathcal{P}(f) =$``$f$ is a closed immersion''
is fpqc local on the base.
\end{lemma}

\begin{proof}
Let $f : X \to Y$ be a morphism of schemes.
Let $\{Y_i \to Y\}$ be an fpqc covering.
Assume that each $f_i : Y_i \times_Y X \to Y_i$
is a closed immersion.
This implies that each $f_i$ is affine, see
Morphisms, Lemma \ref{morphisms-lemma-closed-immersion-affine}.
By Lemma \ref{lemma-descending-property-affine}
we conclude that $f$ is affine. It remains to show that
$\mathcal{O}_Y \to f_*\mathcal{O}_X$ is surjective.
For every $y \in Y$ there exists an $i$ and a point
$y_i \in Y_i$ mapping to $y$.
By Cohomology of Schemes, Lemma \ref{coherent-lemma-flat-base-change-cohomology}
the sheaf $f_{i, *}(\mathcal{O}_{Y_i \times_Y X})$
is the pullback of $f_*\mathcal{O}_X$.
By assumption it is a quotient of $\mathcal{O}_{Y_i}$.
Hence we see that
$$
\Big(
\mathcal{O}_{Y, y} \longrightarrow (f_*\mathcal{O}_X)_y
\Big)
\otimes_{\mathcal{O}_{Y, y}} \mathcal{O}_{Y_i, y_i}
$$
is surjective. Since $\mathcal{O}_{Y_i, y_i}$ is faithfully
flat over $\mathcal{O}_{Y, y}$ this implies the surjectivity
of $\mathcal{O}_{Y, y} \longrightarrow (f_*\mathcal{O}_X)_y$ as
desired.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-quasi-affine}
The property $\mathcal{P}(f) =$``$f$ is quasi-affine''
is fpqc local on the base.
\end{lemma}

\begin{proof}
Let $f : X \to Y$ be a morphism of schemes.
Let $\{g_i : Y_i \to Y\}$ be an fpqc covering.
Assume that each $f_i : Y_i \times_Y X \to Y_i$
is quasi-affine.
This implies that each $f_i$ is quasi-compact and separated.
By Lemmas \ref{lemma-descending-property-quasi-compact}
and \ref{lemma-descending-property-separated}
this implies that $f$ is quasi-compact and separated.
Consider the sheaf of $\mathcal{O}_Y$-algebras
$\mathcal{A} = f_*\mathcal{O}_X$.
By Schemes, Lemma \ref{schemes-lemma-push-forward-quasi-coherent}
it is a quasi-coherent $\mathcal{O}_Y$-algebra.
Consider the canonical morphism
$$
j : X \longrightarrow \underline{\Spec}_Y(\mathcal{A})
$$
see Constructions, Lemma \ref{constructions-lemma-canonical-morphism}.
By flat base change
(see for example
Cohomology of Schemes, Lemma \ref{coherent-lemma-flat-base-change-cohomology})
we have $g_i^*f_*\mathcal{O}_X = f_{i, *}\mathcal{O}_{X'}$
where $g_i : Y_i \to Y$ are the given flat
maps. Hence the base change $j_i$ of $j$ by $g_i$ is the canonical
morphism of Constructions, Lemma \ref{constructions-lemma-canonical-morphism}
for the morphism $f_i$. By assumption and
Morphisms, Lemma \ref{morphisms-lemma-characterize-quasi-affine}
all of these
morphisms $j_i$ are quasi-compact open immersions. Hence, by
Lemmas \ref{lemma-descending-property-quasi-compact} and
\ref{lemma-descending-property-open-immersion} we
see that $j$ is a quasi-compact open immersion.
Hence by
Morphisms, Lemma \ref{morphisms-lemma-characterize-quasi-affine}
again we conclude that $f$ is quasi-affine.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-quasi-compact-immersion}
The property $\mathcal{P}(f) =$``$f$ is a quasi-compact immersion''
is fpqc local on the base.
\end{lemma}

\begin{proof}
Let $f : X \to Y$ be a morphism of schemes.
Let $\{Y_i \to Y\}$ be an fpqc covering.
Write $X_i = Y_i \times_Y X$ and $f_i : X_i \to Y_i$
the base change of $f$. Also denote
$q_i : Y_i \to Y$ the given flat morphisms.
Assume each $f_i$ is a quasi-compact immersion.
By Schemes, Lemma \ref{schemes-lemma-immersions-monomorphisms}
each $f_i$ is separated.
By Lemmas \ref{lemma-descending-property-quasi-compact} and
\ref{lemma-descending-property-separated}
this implies that $f$ is quasi-compact and separated.
Let $X \to Z \to Y$ be the factorization of $f$ through its
scheme theoretic image. By
Morphisms, Lemma \ref{morphisms-lemma-quasi-compact-scheme-theoretic-image}
the closed subscheme $Z \subset Y$ is cut out by the
quasi-coherent sheaf of ideals
$\mathcal{I} = \Ker(\mathcal{O}_Y \to f_*\mathcal{O}_X)$
as $f$ is quasi-compact. By flat base change
(see for example
Cohomology of Schemes, Lemma \ref{coherent-lemma-flat-base-change-cohomology};
here we use $f$ is separated)
we see $f_{i, *}\mathcal{O}_{X_i}$ is the pullback $q_i^*f_*\mathcal{O}_X$.
Hence $Y_i \times_Y Z$ is cut out by the
quasi-coherent sheaf of ideals $q_i^*\mathcal{I} =
\Ker(\mathcal{O}_{Y_i} \to f_{i, *}\mathcal{O}_{X_i})$.
By Morphisms, Lemma \ref{morphisms-lemma-quasi-compact-immersion}
the morphisms $X_i \to Y_i \times_Y Z$
are open immersions. Hence by
Lemma \ref{lemma-descending-property-open-immersion}
we see that $X \to Z$ is an open immersion and
hence $f$ is a immersion as desired
(we already saw it was quasi-compact).
\end{proof}

\begin{lemma}
\label{lemma-descending-property-integral}
The property $\mathcal{P}(f) =$``$f$ is integral''
is fpqc local on the base.
\end{lemma}

\begin{proof}
An integral morphism is the same thing as an affine,
universally closed morphism. See
Morphisms, Lemma \ref{morphisms-lemma-integral-universally-closed}.
Hence the lemma follows on combining
Lemmas \ref{lemma-descending-property-universally-closed}
and \ref{lemma-descending-property-affine}.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-finite}
The property $\mathcal{P}(f) =$``$f$ is finite''
is fpqc local on the base.
\end{lemma}

\begin{proof}
An finite morphism is the same thing as an integral
morphism which is locally of finite type. See
Morphisms, Lemma \ref{morphisms-lemma-finite-integral}.
Hence the lemma follows on combining
Lemmas \ref{lemma-descending-property-locally-finite-type}
and \ref{lemma-descending-property-integral}.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-quasi-finite}
The properties
$\mathcal{P}(f) =$``$f$ is locally quasi-finite''
and
$\mathcal{P}(f) =$``$f$ is quasi-finite''
are fpqc local on the base.
\end{lemma}

\begin{proof}
Let $f : X \to S$ be a morphism of schemes, and let $\{S_i \to S\}$
be an fpqc covering such that each base change
$f_i : X_i \to S_i$ is locally quasi-finite.
We have already seen
(Lemma \ref{lemma-descending-property-locally-finite-type})
that ``locally of finite type'' is fpqc local
on the base, and hence we see that $f$ is locally of finite type.
Then it follows from
Morphisms, Lemma \ref{morphisms-lemma-base-change-quasi-finite}
that $f$ is locally quasi-finite. The quasi-finite case follows
as we have already seen that ``quasi-compact'' is fpqc local on the base
(Lemma \ref{lemma-descending-property-quasi-compact}).
\end{proof}

\begin{lemma}
\label{lemma-descending-property-relative-dimension-d}
The property $\mathcal{P}(f) =$``$f$ is locally of finite type
of relative dimension $d$'' is fpqc local on the base.
\end{lemma}

\begin{proof}
This follows immediately from the fact that being locally of finite
type is fpqc local on the base and
Morphisms, Lemma \ref{morphisms-lemma-dimension-fibre-after-base-change}.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-syntomic}
The property $\mathcal{P}(f) =$``$f$ is syntomic''
is fpqc local on the base.
\end{lemma}

\begin{proof}
A morphism is syntomic if and only if it is locally of finite presentation,
flat, and has locally complete intersections as fibres. We have seen
already that being flat and locally of finite presentation are
fpqc local on the base (Lemmas
\ref{lemma-descending-property-flat}, and
\ref{lemma-descending-property-locally-finite-presentation}).
Hence the result follows for syntomic from
Morphisms, Lemma \ref{morphisms-lemma-set-points-where-fibres-lci}.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-smooth}
The property $\mathcal{P}(f) =$``$f$ is smooth''
is fpqc local on the base.
\end{lemma}

\begin{proof}
A morphism is smooth if and only if it is locally of finite presentation,
flat, and has smooth fibres. We have seen
already that being flat and locally of finite presentation are
fpqc local on the base (Lemmas
\ref{lemma-descending-property-flat}, and
\ref{lemma-descending-property-locally-finite-presentation}).
Hence the result follows for smooth from
Morphisms, Lemma \ref{morphisms-lemma-set-points-where-fibres-smooth}.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-unramified}
The property $\mathcal{P}(f) =$``$f$ is unramified''
is fpqc local on the base.
The property $\mathcal{P}(f) =$``$f$ is G-unramified''
is fpqc local on the base.
\end{lemma}

\begin{proof}
A morphism is unramified (resp.\ G-unramified) if and only if it is
locally of finite type (resp.\ finite presentation)
and its diagonal morphism is an open immersion (see
Morphisms, Lemma \ref{morphisms-lemma-diagonal-unramified-morphism}).
We have seen already that being locally of finite type
(resp.\ locally of finite presentation) and an open immersion is
fpqc local on the base (Lemmas
\ref{lemma-descending-property-locally-finite-presentation},
\ref{lemma-descending-property-locally-finite-type}, and
\ref{lemma-descending-property-open-immersion}).
Hence the result follows formally.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-etale}
The property $\mathcal{P}(f) =$``$f$ is \'etale''
is fpqc local on the base.
\end{lemma}

\begin{proof}
A morphism is \'etale if and only if it flat and G-unramified.
See Morphisms, Lemma \ref{morphisms-lemma-flat-unramified-etale}.
We have seen already that being flat and G-unramified
are fpqc local on the base (Lemmas
\ref{lemma-descending-property-flat}, and
\ref{lemma-descending-property-unramified}).
Hence the result follows.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-finite-locally-free}
The property $\mathcal{P}(f) =$``$f$ is finite locally free''
is fpqc local on the base.
Let $d \geq 0$.
The property $\mathcal{P}(f) =$``$f$ is finite locally free of degree $d$''
is fpqc local on the base.
\end{lemma}

\begin{proof}
Being finite locally free is equivalent to being
finite, flat and locally of finite presentation
(Morphisms, Lemma \ref{morphisms-lemma-finite-flat}).
Hence this follows from Lemmas
\ref{lemma-descending-property-finite},
\ref{lemma-descending-property-flat}, and
\ref{lemma-descending-property-locally-finite-presentation}.
If $f : Z \to U$ is finite locally free, and $\{U_i \to U\}$ is a surjective
family of morphisms such that each pullback $Z \times_U U_i \to U_i$ has
degree $d$, then $Z \to U$ has degree $d$, for example because we
can read off the degree in a point $u \in U$ from the fibre
$(f_*\mathcal{O}_Z)_u \otimes_{\mathcal{O}_{U, u}} \kappa(u)$.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-monomorphism}
The property $\mathcal{P}(f) =$``$f$ is a monomorphism''
is fpqc local on the base.
\end{lemma}

\begin{proof}
Let $f : X \to S$ be a morphism of schemes.
Let $\{S_i \to S\}$ be an fpqc covering, and assume
each of the base changes $f_i : X_i \to S_i$ of $f$ is
a monomorphism. Let $a, b : T \to X$ be two morphisms
such that $f \circ a = f \circ b$. We have to show that $a = b$.
Since $f_i$ is a monomorphism we see that $a_i = b_i$, where
$a_i, b_i : S_i \times_S T \to X_i$ are
the base changes. In particular the compositions
$S_i \times_S T \to T \to X$ are equal.
Since $\coprod S_i \times_S T \to T$
is an epimorphism (see
e.g.\ Lemma \ref{lemma-fpqc-universal-effective-epimorphisms})
we conclude $a = b$.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-regular-immersion}
The properties
\begin{enumerate}
\item[] $\mathcal{P}(f) =$``$f$ is a Koszul-regular immersion'',
\item[] $\mathcal{P}(f) =$``$f$ is an $H_1$-regular immersion'', and
\item[] $\mathcal{P}(f) =$``$f$ is a quasi-regular immersion''
\end{enumerate}
are fpqc local on the base.
\end{lemma}

\begin{proof}
We will use the criterion of
Lemma \ref{lemma-descending-properties-morphisms}
to prove this. By
Divisors, Definition \ref{divisors-definition-regular-immersion}
being a Koszul-regular (resp.\ $H_1$-regular, quasi-regular)
immersion is Zariski local on the base. By
Divisors, Lemma \ref{divisors-lemma-flat-base-change-regular-immersion}
being a Koszul-regular (resp.\ $H_1$-regular, quasi-regular)
immersion is preserved under flat base change.
The final hypothesis (3) of
Lemma \ref{lemma-descending-properties-morphisms}
translates into the following algebra statement:
Let $A \to B$ be a faithfully flat ring map. Let $I \subset A$ be an ideal.
If $IB$ is locally on $\Spec(B)$ generated by a Koszul-regular
(resp.\ $H_1$-regular, quasi-regular) sequence in $B$, then $I \subset A$
is locally on $\Spec(A)$ generated by a Koszul-regular
(resp.\ $H_1$-regular, quasi-regular) sequence in $A$. This is
More on Algebra, Lemma \ref{more-algebra-lemma-flat-descent-regular-ideal}.
\end{proof}





\section{Properties of morphisms local in the fppf topology on the target}
\label{section-descending-properties-morphisms-fppf}

\noindent
In this section we find some properties of morphisms of schemes
for which we could not (yet) show they are local on the base in
the fpqc topology which, however, are local on the base
in the fppf topology.

\begin{lemma}
\label{lemma-descending-fppf-property-immersion}
The property $\mathcal{P}(f) =$``$f$ is an immersion''
is fppf local on the base.
\end{lemma}

\begin{proof}
The property of being an immersion is stable under base change,
see Schemes, Lemma \ref{schemes-lemma-base-change-immersion}.
The property of being an immersion is Zariski local on the base.
Finally, let
$\pi : S' \to S$ be a surjective morphism of affine schemes,
which is flat and locally of finite presentation.
Note that $\pi : S' \to S$ is open by
Morphisms, Lemma \ref{morphisms-lemma-fppf-open}.
Let $f : X \to S$ be a morphism.
Assume that the base change $f' : X' \to S'$ is an immersion.
In particular we see that $f'(X') = \pi^{-1}(f(X))$ is locally closed.
Hence by Topology, Lemma \ref{topology-lemma-open-morphism-quotient-topology}
we see that $f(X) \subset S$
is locally closed. Let $Z \subset S$ be
the closed subset $Z = \overline{f(X)} \setminus f(X)$.
By Topology, Lemma \ref{topology-lemma-open-morphism-quotient-topology}
again we see that $f'(X')$ is closed in $S' \setminus Z'$.
Hence we may apply Lemma \ref{lemma-descending-property-closed-immersion}
to the fpqc covering $\{S' \setminus Z' \to S \setminus Z\}$
and conclude that $f : X \to S \setminus Z$ is a closed
immersion. In other words, $f$ is an immersion.
Therefore Lemma \ref{lemma-descending-properties-morphisms} applies and we win.
\end{proof}






\section{Application of fpqc descent of properties of morphisms}
\label{section-application-descending-properties-morphisms}

\noindent
The following lemma may seem a bit frivolous but turns out is a useful
tool in studying \'etale and unramified morphisms.

\begin{lemma}
\label{lemma-flat-surjective-quasi-compact-monomorphism-isomorphism}
Let $f : X \to Y$ be a flat, quasi-compact, surjective monomorphism.
Then f is an isomorphism.
\end{lemma}

\begin{proof}
As $f$ is a flat, quasi-compact, surjective morphism
we see $\{X \to Y\}$ is an fpqc covering of $Y$.
The diagonal $\Delta : X \to X \times_Y X$ is an isomorphism.
This implies that the base change of $f$ by $f$ is an
isomorphism. Hence we see $f$ is an isomorphism by
Lemma \ref{lemma-descending-property-isomorphism}.
\end{proof}

\noindent
We can use this lemma to show the following important result; we also
give a proof avoiding fpqc descent.
We will discuss this and related results in more detail in
\'Etale Morphisms, Section \ref{etale-section-topological-etale}.

\begin{lemma}
\label{lemma-universally-injective-etale-open-immersion}
A universally injective \'etale morphism is an open immersion.
\end{lemma}

\begin{proof}[First proof]
Let $f : X \to Y$ be an \'etale morphism which is universally injective.
Then $f$ is open
(Morphisms, Lemma \ref{morphisms-lemma-etale-open})
hence we can replace $Y$ by $f(X)$ and we may assume that $f$ is surjective.
Then $f$ is bijective and open hence a homeomorphism. Hence $f$ is
quasi-compact. Thus by
Lemma \ref{lemma-flat-surjective-quasi-compact-monomorphism-isomorphism}
it suffices to show that $f$ is a monomorphism. As $X \to Y$ is \'etale
the morphism $\Delta_{X/Y} : X \to X \times_Y X$ is an open immersion by
Morphisms, Lemma \ref{morphisms-lemma-diagonal-unramified-morphism}
(and
Morphisms, Lemma \ref{morphisms-lemma-flat-unramified-etale}).
As $f$ is universally injective $\Delta_{X/Y}$ is also surjective, see
Morphisms, Lemma \ref{morphisms-lemma-universally-injective}.
Hence $\Delta_{X/Y}$ is an isomorphism, i.e., $X \to Y$ is a monomorphism.
\end{proof}

\begin{proof}[Second proof]
Let $f : X \to Y$ be an \'etale morphism which is universally injective.
Then $f$ is open (Morphisms, Lemma \ref{morphisms-lemma-etale-open})
hence we can replace $Y$ by $f(X)$ and we may assume that $f$ is surjective.
Since the hypotheses remain satisfied after any base change, we conclude
that $f$ is a universal homeomorphism. Therefore $f$ is integral, see
Morphisms, Lemma \ref{morphisms-lemma-universal-homeomorphism}.
It follows that $f$ is finite by
Morphisms, Lemma \ref{morphisms-lemma-finite-integral}.
It follows that $f$ is finite locally free by
Morphisms, Lemma \ref{morphisms-lemma-finite-flat}.
To finish the proof, it suffices that $f$ is finite locally
free of degree $1$ (a finite locally free morphism of degree $1$
is an isomorphism).
There is decomposition of $Y$ into open and closed subschemes
$V_d$ such that $f^{-1}(V_d) \to V_d$ is finite locally free of
degree $d$, see Morphisms, Lemma \ref{morphisms-lemma-finite-locally-free}.
If $V_d$ is not empty, we can pick a morphism $\Spec(k) \to V_d \subset Y$
where $k$ is an algebraically closed field (just take the algebraic
closure of the residue field of some point of $V_d$).
Then $\Spec(k) \times_Y X \to \Spec(k)$ is a disjoint union of
copies of $\Spec(k)$, by
Morphisms, Lemma \ref{morphisms-lemma-etale-over-field}
and the fact that $k$ is algebraically closed.
However, since $f$ is universally injective, there can only be
one copy and hence $d = 1$ as desired.
\end{proof}

\noindent
We can reformulate the hypotheses in the lemma above a bit by using the
following characterization of flat universally injective morphisms.

\begin{lemma}
\label{lemma-flat-universally-injective}
Let $f : X \to Y$ be a morphism of schemes. Let $X^0$ denote the set
of generic points of irreducible components of $X$. If
\begin{enumerate}
\item $f$ is flat and separated,
\item for $\xi \in X^0$ we have $\kappa(f(\xi)) = \kappa(\xi)$, and
\item if $\xi, \xi' \in X^0$, $\xi \not = \xi'$, then $f(\xi) \not = f(\xi')$,
\end{enumerate}
then $f$ is universally injective.
\end{lemma}

\begin{proof}
We have to show that $\Delta : X \to X \times_Y X$ is surjective, see
Morphisms, Lemma \ref{morphisms-lemma-universally-injective}.
As $X \to Y$ is separated, the image of $\Delta$ is closed.
Thus if $\Delta$ is not surjective, we can find a generic point
$\eta \in X \times_S X$ of an irreducible component of $X \times_S X$
which is not in the image of $\Delta$. The projection
$\text{pr}_1 : X \times_Y X \to X$
is flat as a base change of the flat morphism $X \to Y$, see
Morphisms, Lemma \ref{morphisms-lemma-base-change-flat}.
Hence generalizations lift along $\text{pr}_1$, see
Morphisms, Lemma \ref{morphisms-lemma-generalizations-lift-flat}.
We conclude that $\xi = \text{pr}_1(\eta) \in X^0$.
However, assumptions (2) and (3) guarantee that the scheme
$(X \times_Y X)_{f(\xi)}$ has at most one point for every $\xi \in X^0$.
In other words, we have $\Delta(\xi) = \eta$ a contradiction.
\end{proof}

\noindent
Thus we can reformulate
Lemma \ref{lemma-universally-injective-etale-open-immersion} as follows.

\begin{lemma}
\label{lemma-characterize-open-immersion}
Let $f : X \to Y$ be a morphism of schemes. Let $X^0$ denote the set
of generic points of irreducible components of $X$. If
\begin{enumerate}
\item $f$ is \'etale and separated,
\item for $\xi \in X^0$ we have $\kappa(f(\xi)) = \kappa(\xi)$, and
\item if $\xi, \xi' \in X^0$, $\xi \not = \xi'$, then $f(\xi) \not = f(\xi')$,
\end{enumerate}
then $f$ is an open immersion.
\end{lemma}

\begin{proof}
Immediate from Lemmas \ref{lemma-flat-universally-injective} and
\ref{lemma-universally-injective-etale-open-immersion}.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-proper-over-base}
Let $f : X \to Y$ be a morphism of schemes which is locally of finite type.
Let $Z$ be a closed subset of $X$. If there exists an fpqc covering
$\{Y_i \to Y\}$ such that the inverse image $Z_i \subset Y_i \times_Y X$
is proper over $Y_i$
(Cohomology of Schemes, Definition \ref{coherent-definition-proper-over-base})
then $Z$ is proper over $Y$.
\end{lemma}

\begin{proof}
Endow $Z$ with the reduced induced closed subscheme structure, see
Schemes, Definition \ref{schemes-definition-reduced-induced-scheme}.
For every $i$ the base change $Y_i \times_Y Z$ is a closed subscheme
of $Y_i \times_Y X$ whose underlying closed subset is $Z_i$.
By definition (via
Cohomology of Schemes, Lemma \ref{coherent-lemma-closed-proper-over-base})
we conclude that the projections $Y_i \times_Y Z \to Y_i$ are proper
morphisms. Hence $Z \to Y$ is a proper morphism by
Lemma \ref{lemma-descending-property-proper}.
Thus $Z$ is proper over $Y$ by definition.
\end{proof}

\begin{lemma}
\label{lemma-descending-property-ample}
Let $f : X \to S$ be a morphism of schemes.
Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module.
Let $\{g_i : S_i \to S\}_{i \in I}$ be an fpqc covering.
Let $f_i : X_i \to S_i$ be the base change of $f$ and let $\mathcal{L}_i$
be the pullback of $\mathcal{L}$ to $X_i$.
The following are equivalent
\begin{enumerate}
\item $\mathcal{L}$ is ample on $X/S$, and
\item $\mathcal{L}_i$ is ample on $X_i/S_i$
for every $i \in I$.
\end{enumerate}
\end{lemma}

\begin{proof}
The implication (1) $\Rightarrow$ (2) follows from
Morphisms, Lemma \ref{morphisms-lemma-ample-base-change}.
Assume $\mathcal{L}_i$ is ample on $X_i/S_i$ for every $i \in I$.
By Morphisms, Definition \ref{morphisms-definition-relatively-ample}
this implies that $X_i \to S_i$ is quasi-compact and by
Morphisms, Lemma \ref{morphisms-lemma-relatively-ample-separated}
this implies $X_i \to S$ is separated.
Hence $f$ is quasi-compact and separated by
Lemmas \ref{lemma-descending-property-quasi-compact} and
\ref{lemma-descending-property-separated}.

\medskip\noindent
This means that
$\mathcal{A} = \bigoplus_{d \geq 0} f_*\mathcal{L}^{\otimes d}$
is a quasi-coherent graded $\mathcal{O}_S$-algebra
(Schemes, Lemma \ref{schemes-lemma-push-forward-quasi-coherent}).
Moreover, the formation of $\mathcal{A}$ commutes with flat
base change by
Cohomology of Schemes, Lemma \ref{coherent-lemma-flat-base-change-cohomology}.
In particular, if we set
$\mathcal{A}_i = \bigoplus_{d \geq 0} f_{i, *}\mathcal{L}_i^{\otimes d}$
then we have $\mathcal{A}_i = g_i^*\mathcal{A}$.
It follows that the natural maps
$\psi_d : f^*\mathcal{A}_d \to \mathcal{L}^{\otimes d}$
of $\mathcal{O}_X$
pullback to give the natural maps
$\psi_{i, d} : f_i^*(\mathcal{A}_i)_d \to \mathcal{L}_i^{\otimes d}$
of $\mathcal{O}_{X_i}$-modules. Since $\mathcal{L}_i$ is ample on $X_i/S_i$
we see that for any point $x_i \in X_i$, there exists a $d \geq 1$
such that $f_i^*(\mathcal{A}_i)_d \to \mathcal{L}_i^{\otimes d}$
is surjective on stalks at $x_i$. This follows either directly
from the definition of a relatively ample module or from
Morphisms, Lemma \ref{morphisms-lemma-characterize-relatively-ample}.
If $x \in X$, then we can choose an $i$ and an $x_i \in X_i$
mapping to $x$. Since $\mathcal{O}_{X, x} \to \mathcal{O}_{X_i, x_i}$
is flat hence faithfully flat, we conclude that for every $x \in X$
there exists a $d \geq 1$ such that
$f^*\mathcal{A}_d \to \mathcal{L}^{\otimes d}$
is surjective on stalks at $x$.
This implies that the open subset $U(\psi) \subset X$ of
Constructions, Lemma
\ref{constructions-lemma-invertible-map-into-relative-proj}
corresponding to the map
$\psi : f^*\mathcal{A} \to \bigoplus_{d \geq 0} \mathcal{L}^{\otimes d}$
of graded $\mathcal{O}_X$-algebras
is equal to $X$. Consider the corresponding morphism
$$
r_{\mathcal{L}, \psi} : X \longrightarrow \underline{\text{Proj}}_S(\mathcal{A})
$$
It is clear from the above that the base change of
$r_{\mathcal{L}, \psi}$ to $S_i$ is the morphism
$r_{\mathcal{L}_i, \psi_i}$ which is an open immersion by
Morphisms, Lemma \ref{morphisms-lemma-characterize-relatively-ample}.
Hence $r_{\mathcal{L}, \psi}$ is an open immersion
by Lemma \ref{lemma-descending-property-open-immersion}
and we conclude $\mathcal{L}$ is ample on $X/S$ by
Morphisms, Lemma \ref{morphisms-lemma-characterize-relatively-ample}.
\end{proof}















\section{Properties of morphisms local on the source}
\label{section-properties-morphisms-local-source}

\noindent
It often happens one can prove a morphism has a certain property
after precomposing with some other morphism. In many cases this
implies the morphism has the property too. We formalize
this in the following definition.

\begin{definition}
\label{definition-property-morphisms-local-source}
Let $\mathcal{P}$ be a property of morphisms of schemes.
Let $\tau \in \{Zariski, \linebreak[0] fpqc, \linebreak[0] fppf, \linebreak[0]
\etale, \linebreak[0] smooth, \linebreak[0] syntomic\}$.
We say $\mathcal{P}$ is
{\it $\tau$ local on the source}, or
{\it local on the source for the $\tau$-topology} if for
any morphism of schemes $f : X \to Y$ over $S$, and any
$\tau$-covering $\{X_i \to X\}_{i \in I}$ we
have
$$
f \text{ has }\mathcal{P}
\Leftrightarrow
\text{each }X_i \to Y\text{ has }\mathcal{P}.
$$
\end{definition}

\noindent
To be sure, since isomorphisms are always coverings
we see (or require) that property $\mathcal{P}$ holds for $X \to Y$
if and only if it holds for any arrow $X' \to Y'$ isomorphic to $X \to Y$.
If a property is $\tau$-local on the source then it is preserved by
precomposing with morphisms which occur in $\tau$-coverings. Here
is a formal statement.

\begin{lemma}
\label{lemma-precompose-property-local-source}
Let $\tau \in \{fpqc, fppf, syntomic, smooth, \etale, Zariski\}$.
Let $\mathcal{P}$ be a property of morphisms which is $\tau$ local
on the source. Let $f : X \to Y$ have property $\mathcal{P}$.
For any morphism $a : X' \to X$ which is
flat, resp.\ flat and locally of finite presentation, resp.\ syntomic,
resp.\ \'etale, resp.\ an open immersion, the composition
$f \circ a : X' \to Y$ has property $\mathcal{P}$.
\end{lemma}

\begin{proof}
This is true because we can fit $X' \to X$ into a family of
morphisms which forms a $\tau$-covering.
\end{proof}

\begin{lemma}
\label{lemma-largest-open-of-the-source}
Let $\tau \in \{fppf, syntomic, smooth, \etale\}$.
Let $\mathcal{P}$ be a property of morphisms which is $\tau$ local
on the source. For any morphism of schemes $f : X \to Y$ there exists
a largest open $W(f) \subset X$ such that the restriction
$f|_{W(f)} : W(f) \to Y$ has $\mathcal{P}$. Moreover,
if $g : X' \to X$ is flat and locally of finite presentation,
syntomic, smooth, or \'etale and $f' = f \circ g : X' \to Y$, then
$g^{-1}(W(f)) = W(f')$.
\end{lemma}

\begin{proof}
Consider the union $W$ of the images $g(X') \subset X$ of
morphisms $g : X' \to X$ with the properties:
\begin{enumerate}
\item $g$ is flat and locally of finite presentation, syntomic,
smooth, or \'etale, and
\item the composition $X' \to X \to Y$ has property $\mathcal{P}$.
\end{enumerate}
Since such a morphism $g$ is open (see
Morphisms, Lemma \ref{morphisms-lemma-fppf-open})
we see that $W \subset X$ is an open subset of $X$. Since $\mathcal{P}$
is local in the $\tau$ topology the restriction $f|_W : W \to Y$ has property
$\mathcal{P}$ because we are given a $\tau$ covering $\{X' \to W\}$ of $W$
such that the pullbacks have $\mathcal{P}$. This proves the existence of $W(f)$.
The compatibility stated in the last sentence follows immediately
from the construction of $W(f)$.
\end{proof}

\begin{lemma}
\label{lemma-properties-morphisms-local-source}
Let $\mathcal{P}$ be a property of morphisms of schemes.
Let $\tau \in \{fpqc, \linebreak[0] fppf, \linebreak[0]
\etale, \linebreak[0] smooth, \linebreak[0] syntomic\}$.
Assume that
\begin{enumerate}
\item the property is preserved under precomposing with
flat, flat locally of finite presentation, \'etale, smooth or syntomic morphisms
depending on whether $\tau$ is fpqc, fppf, \'etale, smooth, or syntomic,
\item the property is Zariski local on the source,
\item the property is Zariski local on the target,
\item for any morphism of affine schemes $X \to Y$, and
any surjective morphism of affine schemes $X' \to X$
which is flat, flat of finite presentation,
\'etale, smooth or syntomic depending on whether $\tau$ is
fpqc, fppf, \'etale, smooth, or syntomic, property
$\mathcal{P}$ holds for $f$ if property $\mathcal{P}$
holds for the composition $f' : X' \to Y$.
\end{enumerate}
Then $\mathcal{P}$ is $\tau$ local on the source.
\end{lemma}

\begin{proof}
This follows almost immediately from the definition of
a $\tau$-covering, see
Topologies, Definition
\ref{topologies-definition-fpqc-covering}
\ref{topologies-definition-fppf-covering}
\ref{topologies-definition-etale-covering}
\ref{topologies-definition-smooth-covering}, or
\ref{topologies-definition-syntomic-covering}
and Topologies, Lemma
\ref{topologies-lemma-fpqc-affine},
\ref{topologies-lemma-fppf-affine},
\ref{topologies-lemma-etale-affine},
\ref{topologies-lemma-smooth-affine}, or
\ref{topologies-lemma-syntomic-affine}.
Details omitted. (Hint: Use locality on the source and target to
reduce the verification of property $\mathcal{P}$ to the case of
a morphism between affines. Then apply (1) and (4).)
\end{proof}

\begin{remark}
\label{remark-properties-morphisms-local-source-standard}
(This is a repeat of
Remarks \ref{remark-descending-properties-standard}
and \ref{remark-descending-properties-morphisms-standard} above.)
In Lemma \ref{lemma-properties-morphisms-local-source} above if
$\tau = smooth$ then in condition (4) we may assume that
the morphism is a (surjective) standard smooth morphism.
Similarly, when $\tau = syntomic$ or $\tau = \etale$.
\end{remark}



\section{Properties of morphisms local in the fpqc topology on the source}
\label{section-fpqc-local-source}

\noindent
Here are some properties of morphisms that are fpqc local on the source.

\begin{lemma}
\label{lemma-flat-fpqc-local-source}
The property $\mathcal{P}(f)=$``$f$ is flat'' is fpqc local on the source.
\end{lemma}

\begin{proof}
Since flatness is defined in terms of the maps of local rings
(Morphisms, Definition \ref{morphisms-definition-flat})
what has to be shown is the following
algebraic fact: Suppose $A \to B \to C$ are local homomorphisms of local
rings, and assume $B \to C$ is flat. Then $A \to B$ is
flat if and only if $A \to C$ is flat.
If $A \to B$ is flat, then $A \to C$ is flat by
Algebra, Lemma \ref{algebra-lemma-composition-flat}.
Conversely, assume $A \to C$ is flat.
Note that $B \to C$ is faithfully
flat, see
Algebra, Lemma \ref{algebra-lemma-local-flat-ff}.
Hence $A \to B$ is flat by
Algebra, Lemma \ref{algebra-lemma-flat-permanence}.
(Also see Morphisms, Lemma \ref{morphisms-lemma-flat-permanence}
for a direct proof.)
\end{proof}

\begin{lemma}
\label{lemma-injective-local-rings-fpqc-local-source}
Then property
$\mathcal{P}(f : X \to Y)=$``for every $x \in X$ the map of local
rings $\mathcal{O}_{Y, f(x)} \to \mathcal{O}_{X, x}$ is injective''
is fpqc local on the source.
\end{lemma}

\begin{proof}
Omitted. This is just a (probably misguided) attempt to be playful.
\end{proof}





\section{Properties of morphisms local in the fppf topology on the source}
\label{section-fppf-local-source}

\noindent
Here are some properties of morphisms that are fppf local on the source.

\begin{lemma}
\label{lemma-locally-finite-presentation-fppf-local-source}
The property $\mathcal{P}(f)=$``$f$ is locally of finite presentation''
is fppf local on the source.
\end{lemma}

\begin{proof}
Being locally of finite presentation is Zariski local on the source
and the target, see Morphisms,
Lemma \ref{morphisms-lemma-locally-finite-presentation-characterize}.
It is a property which is preserved under composition, see
Morphisms, Lemma \ref{morphisms-lemma-composition-finite-presentation}.
This proves
(1), (2) and (3) of Lemma \ref{lemma-properties-morphisms-local-source}.
The final condition (4) is
Lemma \ref{lemma-flat-finitely-presented-permanence-algebra}. Hence we win.
\end{proof}

\begin{lemma}
\label{lemma-locally-finite-type-fppf-local-source}
The property $\mathcal{P}(f)=$``$f$ is locally of finite type''
is fppf local on the source.
\end{lemma}

\begin{proof}
Being locally of finite type is Zariski local on the source
and the target, see Morphisms,
Lemma \ref{morphisms-lemma-locally-finite-type-characterize}.
It is a property which is preserved under composition, see
Morphisms, Lemma \ref{morphisms-lemma-composition-finite-type}, and
a flat morphism locally of finite presentation is locally of finite type, see
Morphisms, Lemma \ref{morphisms-lemma-finite-presentation-finite-type}.
This proves
(1), (2) and (3) of Lemma \ref{lemma-properties-morphisms-local-source}.
The final condition (4) is
Lemma \ref{lemma-finite-type-local-source-fppf-algebra}. Hence we win.
\end{proof}

\begin{lemma}
\label{lemma-open-fppf-local-source}
The property $\mathcal{P}(f)=$``$f$ is open''
is fppf local on the source.
\end{lemma}

\begin{proof}
Being an open morphism is clearly Zariski local on the source and the target.
It is a property which is preserved under composition, see
Morphisms, Lemma \ref{morphisms-lemma-composition-open}, and
a flat morphism of finite presentation is open, see
Morphisms, Lemma \ref{morphisms-lemma-fppf-open}
This proves
(1), (2) and (3) of Lemma \ref{lemma-properties-morphisms-local-source}.
The final condition (4) follows from
Morphisms, Lemma \ref{morphisms-lemma-fpqc-quotient-topology}.
Hence we win.
\end{proof}

\begin{lemma}
\label{lemma-universally-open-fppf-local-source}
The property $\mathcal{P}(f)=$``$f$ is universally open''
is fppf local on the source.
\end{lemma}

\begin{proof}
Let $f : X \to Y$ be a morphism of schemes.
Let $\{X_i \to X\}_{i \in I}$ be an fppf covering.
Denote $f_i : X_i \to X$ the compositions.
We have to show that $f$ is universally open if and only if
each $f_i$ is universally open. If $f$ is universally open,
then also each $f_i$ is universally open since the maps
$X_i \to X$ are universally open and compositions
of universally open morphisms are universally open
(Morphisms, Lemmas \ref{morphisms-lemma-fppf-open}
and \ref{morphisms-lemma-composition-open}).
Conversely, assume each $f_i$ is universally open.
Let $Y' \to Y$ be a morphism of schemes.
Denote $X' = Y' \times_Y X$ and $X'_i = Y' \times_Y X_i$.
Note that $\{X_i' \to X'\}_{i \in I}$ is an fppf covering also.
The morphisms $f'_i : X_i' \to Y'$ are open by assumption.
Hence by the Lemma \ref{lemma-open-fppf-local-source}
above we conclude that $f' : X' \to Y'$ is open as desired.
\end{proof}



\section{Properties of morphisms local in the syntomic topology on the source}
\label{section-syntomic-local-source}

\noindent
Here are some properties of morphisms that are syntomic local on the source.

\begin{lemma}
\label{lemma-syntomic-syntomic-local-source}
The property $\mathcal{P}(f)=$``$f$ is syntomic''
is syntomic local on the source.
\end{lemma}

\begin{proof}
Combine Lemma \ref{lemma-properties-morphisms-local-source} with
Morphisms, Lemma \ref{morphisms-lemma-syntomic-characterize}
(local for Zariski on source and target),
Morphisms, Lemma \ref{morphisms-lemma-composition-syntomic} (pre-composing),
and Lemma \ref{lemma-syntomic-smooth-etale-permanence} (part (4)).
\end{proof}




\section{Properties of morphisms local in the smooth topology on the source}
\label{section-smooth-local-source}

\noindent
Here are some properties of morphisms that are smooth local on the source.
ote also the (in some respects stronger) result
on descending smoothness via flat morphisms,
Lemma \ref{lemma-smooth-permanence}.

\begin{lemma}
\label{lemma-smooth-smooth-local-source}
The property $\mathcal{P}(f)=$``$f$ is smooth''
is smooth local on the source.
\end{lemma}

\begin{proof}
Combine Lemma \ref{lemma-properties-morphisms-local-source} with
Morphisms, Lemma \ref{morphisms-lemma-smooth-characterize}
(local for Zariski on source and target),
Morphisms, Lemma \ref{morphisms-lemma-composition-smooth} (pre-composing), and
Lemma \ref{lemma-syntomic-smooth-etale-permanence} (part (4)).
\end{proof}



\section{Properties of morphisms local in the \'etale topology on the source}
\label{section-etale-local-source}

\noindent
Here are some properties of morphisms that are \'etale local on the source.

\begin{lemma}
\label{lemma-etale-etale-local-source}
The property $\mathcal{P}(f)=$``$f$ is \'etale''
is \'etale local on the source.
\end{lemma}

\begin{proof}
Combine Lemma \ref{lemma-properties-morphisms-local-source} with
Morphisms, Lemma \ref{morphisms-lemma-etale-characterize}
(local for Zariski on source and target),
Morphisms, Lemma \ref{morphisms-lemma-composition-etale} (pre-composing), and
Lemma \ref{lemma-syntomic-smooth-etale-permanence} (part (4)).
\end{proof}

\begin{lemma}
\label{lemma-locally-quasi-finite-etale-local-source}
The property $\mathcal{P}(f)=$``$f$ is locally quasi-finite''
is \'etale local on the source.
\end{lemma}

\begin{proof}
We are going to use
Lemma \ref{lemma-properties-morphisms-local-source}.
By
Morphisms, Lemma
\ref{morphisms-lemma-locally-quasi-finite-characterize}
the property of being locally quasi-finite is local for Zariski on source
and target. By
Morphisms, Lemmas
\ref{morphisms-lemma-composition-quasi-finite} and
\ref{morphisms-lemma-etale-locally-quasi-finite}
we see the precomposition
of a locally quasi-finite morphism by an \'etale morphism is locally
quasi-finite. Finally, suppose that $X \to Y$ is a morphism of affine schemes
and that $X' \to X$ is a surjective \'etale morphism of affine schemes
such that $X' \to Y$ is locally quasi-finite. Then $X' \to Y$ is of finite
type, and by
Lemma \ref{lemma-finite-type-local-source-fppf-algebra}
we see that $X \to Y$ is of finite type also.
Moreover, by assumption $X' \to Y$ has finite fibres, and hence $X \to Y$
has finite fibres also. We conclude that $X \to Y$ is quasi-finite by
Morphisms, Lemma \ref{morphisms-lemma-quasi-finite}.
This proves the last assumption of
Lemma \ref{lemma-properties-morphisms-local-source}
and finishes the proof.
\end{proof}

\begin{lemma}
\label{lemma-unramified-etale-local-source}
The property $\mathcal{P}(f)=$``$f$ is unramified''
is \'etale local on the source.
The property $\mathcal{P}(f)=$``$f$ is G-unramified''
is \'etale local on the source.
\end{lemma}

\begin{proof}
We are going to use
Lemma \ref{lemma-properties-morphisms-local-source}.
By
Morphisms, Lemma \ref{morphisms-lemma-unramified-characterize}
the property of being unramified (resp.\ G-unramified)
is local for Zariski on source and target. By
Morphisms, Lemmas \ref{morphisms-lemma-composition-unramified} and
\ref{morphisms-lemma-etale-smooth-unramified}
we see the precomposition
of an unramified (resp.\ G-unramified) morphism by an \'etale morphism is
unramified (resp.\ G-unramified).
Finally, suppose that $X \to Y$ is a morphism of affine schemes
and that $f : X' \to X$ is a surjective \'etale morphism of affine schemes
such that $X' \to Y$ is unramified (resp.\ G-unramified).
Then $X' \to Y$ is of finite type (resp.\ finite presentation), and by
Lemma \ref{lemma-finite-type-local-source-fppf-algebra}
(resp.\ Lemma \ref{lemma-flat-finitely-presented-permanence-algebra})
we see that $X \to Y$ is of finite type (resp.\ finite presentation) also. By
Morphisms, Lemma \ref{morphisms-lemma-triangle-differentials-smooth}
we have a short exact sequence
$$
0 \to f^*\Omega_{X/Y} \to \Omega_{X'/Y} \to \Omega_{X'/X} \to 0.
$$
As $X' \to Y$ is unramified we see that the middle term is zero.
Hence, as $f$ is faithfully flat we see that $\Omega_{X/Y} = 0$.
Hence $X \to Y$ is unramified (resp.\ G-unramified), see
Morphisms, Lemma \ref{morphisms-lemma-unramified-omega-zero}.
This proves the last assumption of
Lemma \ref{lemma-properties-morphisms-local-source}
and finishes the proof.
\end{proof}




\section{Properties of morphisms \'etale local on source-and-target}
\label{section-properties-etale-local-source-target}

\noindent
Let $\mathcal{P}$ be a property of morphisms of schemes. There is an
intuitive meaning to the phrase ``$\mathcal{P}$ is \'etale local on the
source and target''. However, it turns out that this notion is not
the same as asking $\mathcal{P}$ to be both \'etale
local on the source and \'etale local on the target.
Before we discuss this further we give two silly examples.

\begin{example}
\label{example-silly-one}
Consider the property $\mathcal{P}$ of morphisms of schemes defined
by the rule $\mathcal{P}(X \to Y) = $``$Y$ is locally Noetherian''.
The reader can verify that this is \'etale local on the source and
\'etale local on the target (omitted, see
Lemma \ref{lemma-Noetherian-local-fppf}).
But it is {\bf not} true that if $f : X \to Y$ has $\mathcal{P}$
and $g : Y \to Z$ is \'etale, then $g \circ f$ has $\mathcal{P}$.
Namely, $f$ could be the identity on $Y$ and $g$ could be an open
immersion of a locally Noetherian scheme $Y$ into a non locally Noetherian
scheme $Z$.
\end{example}

\noindent
The following example is in some sense worse.

\begin{example}
\label{example-silly-two}
Consider the property $\mathcal{P}$ of morphisms of schemes defined
by the rule $\mathcal{P}(f : X \to Y) = $``for every $y \in Y$ which is
a specialization of some $f(x)$, $x \in X$ the local ring
$\mathcal{O}_{Y, y}$ is Noetherian''. Let us verify that this is
\'etale local on the source and \'etale local on the target. We will freely use
Schemes, Lemma \ref{schemes-lemma-specialize-points}.

\medskip\noindent
Local on the target:
Let $\{g_i : Y_i \to Y\}$ be an \'etale covering. Let $f_i : X_i \to Y_i$
be the base change of $f$, and denote $h_i : X_i \to X$ the projection.
Assume $\mathcal{P}(f)$. Let $f(x_i) \leadsto y_i$
be a specialization. Then $f(h_i(x_i)) \leadsto g_i(y_i)$ so
$\mathcal{P}(f)$ implies $\mathcal{O}_{Y, g_i(y_i)}$ is Noetherian.
Also $\mathcal{O}_{Y, g_i(y_i)} \to \mathcal{O}_{Y_i, y_i}$ is a
localization of an \'etale ring map.
Hence $\mathcal{O}_{Y_i, y_i}$ is Noetherian by
Algebra, Lemma \ref{algebra-lemma-Noetherian-permanence}.
Conversely, assume $\mathcal{P}(f_i)$ for all $i$. Let $f(x) \leadsto y$
be a specialization. Choose an $i$ and $y_i \in Y_i$ mapping to $y$.
Since $x$ can be viewed as a point of
$\Spec(\mathcal{O}_{Y, y}) \times_Y X$ and
$\mathcal{O}_{Y, y} \to \mathcal{O}_{Y_i, y_i}$ is faithfully flat,
there exists a point
$x_i \in \Spec(\mathcal{O}_{Y_i, y_i}) \times_Y X$
mapping to $x$. Then $x_i \in X_i$, and $f_i(x_i)$ specializes to $y_i$.
Thus we see that $\mathcal{O}_{Y_i, y_i}$ is Noetherian by
$\mathcal{P}(f_i)$ which implies that $\mathcal{O}_{Y, y}$ is
Noetherian by
Algebra, Lemma \ref{algebra-lemma-descent-Noetherian}.

\medskip\noindent
Local on the source:
Let $\{h_i : X_i \to X\}$ be an \'etale covering. Let $f_i : X_i \to Y$
be the composition $f \circ h_i$. Assume $\mathcal{P}(f)$. Let
$f(x_i) \leadsto y$ be a specialization. Then $f(h_i(x_i)) \leadsto y$ so
$\mathcal{P}(f)$ implies $\mathcal{O}_{Y, y}$ is Noetherian. Thus
$\mathcal{P}(f_i)$ holds.
Conversely, assume $\mathcal{P}(f_i)$ for all $i$. Let $f(x) \leadsto y$
be a specialization. Choose an $i$ and $x_i \in X_i$ mapping to $x$.
Then $y$ is a specialization of $f_i(x_i) = f(x)$. Hence
$\mathcal{P}(f_i)$ implies $\mathcal{O}_{Y, y}$ is Noetherian
as desired.

\medskip\noindent
We claim that there exists a commutative diagram
$$
\xymatrix{
U \ar[d]_a \ar[r]_h & V \ar[d]^b \\
X \ar[r]^f & Y
}
$$
with surjective \'etale vertical arrows, such that $h$ has $\mathcal{P}$
and $f$ does not have $\mathcal{P}$. Namely, let
$$
Y =
\Spec\Big(
\mathbf{C}[x_n; n \in \mathbf{Z}]/(x_n x_m; n \not = m)
\Big)
$$
and let $X \subset Y$ be the open subscheme which is the complement of
the point all of whose coordinates $x_n = 0$. Let $U = X$, let
$V = X \amalg Y$, let $a, b$ the obvious map, and let $h : U \to V$
be the inclusion of $U = X$ into the first summand of $V$. The claim above
holds because $U$ is locally Noetherian, but $Y$ is not.
\end{example}

\noindent
What should be the correct notion of a property which is \'etale local
on the source-and-target? We think that, by analogy with
Morphisms, Definition \ref{morphisms-definition-property-local}
it should be the following.

\begin{definition}
\label{definition-local-source-target}
Let $\mathcal{P}$ be a property of morphisms of schemes.
We say $\mathcal{P}$ is {\it \'etale local on source-and-target} if
\begin{enumerate}
\item (stable under precomposing with \'etale maps)
if $f : X \to Y$ is \'etale and $g : Y \to Z$ has $\mathcal{P}$,
then $g \circ f$ has $\mathcal{P}$,
\item (stable under \'etale base change)
if $f : X \to Y$ has $\mathcal{P}$ and $Y' \to Y$ is \'etale, then
the base change $f' : Y' \times_Y X \to Y'$ has $\mathcal{P}$, and
\item (locality) given a morphism $f : X \to Y$ the following are equivalent
\begin{enumerate}
\item $f$ has $\mathcal{P}$,
\item for every $x \in X$ there exists a commutative diagram
$$
\xymatrix{
U \ar[d]_a \ar[r]_h & V \ar[d]^b \\
X \ar[r]^f & Y
}
$$
with \'etale vertical arrows and $u \in U$ with $a(u) = x$ such that
$h$ has $\mathcal{P}$.
\end{enumerate}
\end{enumerate}
\end{definition}

\noindent
It turns out this definition excludes the behavior seen in
Examples \ref{example-silly-one} and \ref{example-silly-two}.
We will compare this to the definition in the paper
\cite{DM} by Deligne and Mumford in
Remark \ref{remark-compare-definitions}.
Moreover, a property which is \'etale local on the source-and-target is
\'etale local on the source and \'etale local on the target.
Finally, the converse is almost true as we will see in
Lemma \ref{lemma-etale-local-source-target}.

\begin{lemma}
\label{lemma-local-source-target-implies}
Let $\mathcal{P}$ be a property of morphisms of schemes which is
\'etale local on source-and-target. Then
\begin{enumerate}
\item $\mathcal{P}$ is \'etale local on the source,
\item $\mathcal{P}$ is \'etale local on the target,
\item $\mathcal{P}$ is stable under postcomposing with \'etale morphisms:
if $f : X \to Y$ has $\mathcal{P}$ and $g : Y \to Z$ is \'etale, then
$g \circ f$ has $\mathcal{P}$, and
\item $\mathcal{P}$ has a permanence property: given $f : X \to Y$ and
$g : Y \to Z$ \'etale such that $g \circ f$ has $\mathcal{P}$, then
$f$ has $\mathcal{P}$.
\end{enumerate}
\end{lemma}

\begin{proof}
We write everything out completely.

\medskip\noindent
Proof of (1). Let $f : X \to Y$ be a morphism of schemes.
Let $\{X_i \to X\}_{i \in I}$ be an \'etale covering of $X$. If each composition
$h_i : X_i \to Y$ has $\mathcal{P}$, then for each $x \in X$ we can find
an $i \in I$ and a point $x_i \in X_i$ mapping to $x$. Then
$(X_i, x_i) \to (X, x)$ is an \'etale morphism of germs, and
$\text{id}_Y : Y \to Y$ is an \'etale morphism, and $h_i$ is as in part (3) of
Definition \ref{definition-local-source-target}.
Thus we see that $f$ has $\mathcal{P}$.
Conversely, if $f$ has $\mathcal{P}$ then each $X_i \to Y$ has
$\mathcal{P}$ by
Definition \ref{definition-local-source-target} part (1).

\medskip\noindent
Proof of (2). Let $f : X \to Y$ be a morphism of schemes.
Let $\{Y_i \to Y\}_{i \in I}$ be an \'etale covering of $Y$.
Write $X_i = Y_i \times_Y X$ and $h_i : X_i \to Y_i$ for the base change
of $f$.  If each  $h_i : X_i \to Y_i$ has $\mathcal{P}$, then for each
$x \in X$ we pick an $i \in I$ and a point $x_i \in X_i$ mapping to $x$.
Then $(X_i, x_i) \to (X, x)$ is an \'etale morphism of germs, $Y_i \to Y$ is
\'etale, and $h_i$ is as in part (3) of
Definition \ref{definition-local-source-target}.
Thus we see that $f$ has $\mathcal{P}$.
Conversely, if $f$ has $\mathcal{P}$, then each $X_i \to Y_i$ has
$\mathcal{P}$ by
Definition \ref{definition-local-source-target} part (2).

\medskip\noindent
Proof of (3). Assume $f : X \to Y$ has $\mathcal{P}$ and $g : Y \to Z$ is
\'etale. For every $x \in X$ we can think of $(X, x) \to (X, x)$ as an
\'etale morphism of germs, $Y \to Z$ is an \'etale morphism, and $h = f$ is as
in part (3) of
Definition \ref{definition-local-source-target}.
Thus we see that $g \circ f$ has $\mathcal{P}$.

\medskip\noindent
Proof of (4). Let $f : X \to Y$ be a morphism and $g : Y \to Z$ \'etale
such that $g \circ f$ has $\mathcal{P}$. Then by
Definition \ref{definition-local-source-target} part (2)
we see that $\text{pr}_Y : Y \times_Z X \to Y$ has $\mathcal{P}$. But
the morphism $(f, 1) : X \to Y \times_Z X$ is \'etale as a section to the
\'etale projection $\text{pr}_X : Y \times_Z X \to X$, see
Morphisms, Lemma \ref{morphisms-lemma-etale-permanence}.
Hence $f = \text{pr}_Y \circ (f, 1)$ has $\mathcal{P}$ by
Definition \ref{definition-local-source-target} part (1).
\end{proof}

\noindent
The following lemma is the analogue of
Morphisms, Lemma \ref{morphisms-lemma-locally-P-characterize}.

\begin{lemma}
\label{lemma-local-source-target-characterize}
Let $\mathcal{P}$ be a property of morphisms of schemes which is
\'etale local on source-and-target. Let $f : X \to Y$ be a morphism
of schemes. The following are equivalent:
\begin{enumerate}
\item[(a)] $f$ has property $\mathcal{P}$,
\item[(b)] for every $x \in X$ there exists an \'etale morphism of germs
$a : (U, u) \to (X, x)$, an \'etale morphism $b : V \to Y$, and
a morphism $h : U \to V$ such that $f \circ a = b \circ h$ and
$h$ has $\mathcal{P}$,
\item[(c)]
for any commutative diagram
$$
\xymatrix{
U \ar[d]_a \ar[r]_h & V \ar[d]^b \\
X \ar[r]^f & Y
}
$$
with $a$, $b$ \'etale the morphism $h$ has $\mathcal{P}$,
\item[(d)] for some diagram as in (c)
with $a : U \to X$ surjective $h$ has $\mathcal{P}$,
\item[(e)] there exists an \'etale covering $\{Y_i \to Y\}_{i \in I}$ such
that each base change $Y_i \times_Y X \to Y_i$ has $\mathcal{P}$,
\item[(f)] there exists an \'etale covering $\{X_i \to X\}_{i \in I}$ such
that each composition $X_i \to Y$ has $\mathcal{P}$,
\item[(g)] there exists an \'etale covering $\{Y_i \to Y\}_{i \in I}$ and
for each $i \in I$ an \'etale covering
$\{X_{ij} \to Y_i \times_Y X\}_{j \in J_i}$ such that each morphism
$X_{ij} \to Y_i$ has $\mathcal{P}$.
\end{enumerate}
\end{lemma}

\begin{proof}
The equivalence of (a) and (b) is part of
Definition \ref{definition-local-source-target}.
The equivalence of (a) and (e) is
Lemma \ref{lemma-local-source-target-implies} part (2).
The equivalence of (a) and (f) is
Lemma \ref{lemma-local-source-target-implies} part (1).
As (a) is now equivalent to (e) and (f) it follows that
(a) equivalent to (g).

\medskip\noindent
It is clear that (c) implies (a). If (a) holds, then for any
diagram as in (c) the morphism $f \circ a$ has $\mathcal{P}$ by
Definition \ref{definition-local-source-target} part (1),
whereupon $h$ has $\mathcal{P}$ by
Lemma \ref{lemma-local-source-target-implies} part (4).
Thus (a) and (c) are equivalent. It is clear that (c) implies (d).
To see that (d) implies (a) assume we have a diagram as in (c)
with $a : U \to X$ surjective and $h$ having $\mathcal{P}$.
Then $b \circ h$ has $\mathcal{P}$ by
Lemma \ref{lemma-local-source-target-implies} part (3).
Since $\{a : U \to X\}$ is an \'etale covering we conclude that
$f$ has $\mathcal{P}$ by
Lemma \ref{lemma-local-source-target-implies} part (1).
\end{proof}

\noindent
It seems that the result of the following lemma is not a formality, i.e.,
it actually uses something about the geometry of \'etale morphisms.

\begin{lemma}
\label{lemma-etale-local-source-target}
Let $\mathcal{P}$ be a property of morphisms of schemes.
Assume
\begin{enumerate}
\item $\mathcal{P}$ is \'etale local on the source,
\item $\mathcal{P}$ is \'etale local on the target, and
\item $\mathcal{P}$ is stable under postcomposing with open immersions:
if $f : X \to Y$ has $\mathcal{P}$ and $Y \subset Z$ is an open
subscheme then $X \to Z$ has $\mathcal{P}$.
\end{enumerate}
Then $\mathcal{P}$ is \'etale local on the source-and-target.
\end{lemma}

\begin{proof}
Let $\mathcal{P}$ be a property of morphisms of schemes which
satisfies conditions (1), (2) and (3) of the lemma. By
Lemma \ref{lemma-precompose-property-local-source}
we see that $\mathcal{P}$ is stable under precomposing with
\'etale morphisms. By
Lemma \ref{lemma-pullback-property-local-target}
we see that $\mathcal{P}$ is stable under \'etale base change.
Hence it suffices to prove part (3) of
Definition \ref{definition-local-source-target}
holds.

\medskip\noindent
More precisely, suppose that $f : X \to Y$ is a morphism
of schemes which satisfies
Definition \ref{definition-local-source-target} part (3)(b).
In other words, for every $x \in X$ there exists an \'etale
morphism $a_x : U_x \to X$, a point $u_x \in U_x$ mapping to $x$,
an \'etale morphism $b_x : V_x \to Y$, and a morphism $h_x : U_x \to V_x$
such that $f \circ a_x = b_x \circ h_x$ and $h_x$ has $\mathcal{P}$.
The proof of the lemma is complete once we show that $f$ has $\mathcal{P}$.
Set $U = \coprod U_x$, $a = \coprod a_x$, $V = \coprod V_x$,
$b = \coprod b_x$, and $h = \coprod h_x$. We obtain a
commutative diagram
$$
\xymatrix{
U \ar[d]_a \ar[r]_h & V \ar[d]^b \\
X \ar[r]^f & Y
}
$$
with $a$, $b$ \'etale, $a$ surjective. Note that $h$ has $\mathcal{P}$
as each $h_x$ does and $\mathcal{P}$ is \'etale local on the target.
Because $a$ is surjective and $\mathcal{P}$ is \'etale local on the source,
it suffices to prove that $b \circ h$ has $\mathcal{P}$.
This reduces the lemma to proving that $\mathcal{P}$ is stable under
postcomposing with an \'etale morphism.

\medskip\noindent
During the rest of the proof we let $f : X \to Y$ be a
morphism with property $\mathcal{P}$ and $g : Y \to Z$ is an \'etale
morphism. Consider the following statements:
\begin{enumerate}
\item[(-)] With no additional assumptions $g \circ f$
has property $\mathcal{P}$.
\item[(A)] Whenever $Z$ is affine
$g \circ f$ has property $\mathcal{P}$.
\item[(AA)] Whenever $X$ and $Z$ are affine
$g \circ f$ has property $\mathcal{P}$.
\item[(AAA)] Whenever $X$, $Y$, and $Z$ are affine
$g \circ f$ has property $\mathcal{P}$.
\end{enumerate}
Once we have proved (-) the proof of the lemma will be complete.

\medskip\noindent
Claim 1: (AAA) $\Rightarrow$ (AA).
Namely, let $f : X \to Y$, $g : Y \to Z$ be as above with $X$, $Z$ affine.
As $X$ is affine hence quasi-compact we can find finitely many
affine open $Y_i \subset Y$, $i = 1, \ldots, n$ such that
$X = \bigcup_{i = 1, \ldots, n} f^{-1}(Y_i)$. Set $X_i = f^{-1}(Y_i)$. By
Lemma \ref{lemma-pullback-property-local-target}
each of the morphisms $X_i \to Y_i$ has $\mathcal{P}$.
Hence $\coprod_{i = 1, \ldots, n} X_i \to \coprod_{i = 1, \ldots, n} Y_i$
has $\mathcal{P}$ as $\mathcal{P}$ is \'etale local on the target.
By (AAA) applied to
$\coprod_{i = 1, \ldots, n} X_i \to \coprod_{i = 1, \ldots, n} Y_i$
and the \'etale morphism $\coprod_{i = 1, \ldots, n} Y_i \to Z$
we see that $\coprod_{i = 1, \ldots, n} X_i \to Z$ has $\mathcal{P}$.
Now $\{\coprod_{i = 1, \ldots, n} X_i \to X\}$ is an \'etale
covering, hence as $\mathcal{P}$ is \'etale local on the source
we conclude that $X \to Z$ has $\mathcal{P}$ as desired.

\medskip\noindent
Claim 2: (AAA) $\Rightarrow$ (A).
Namely, let $f : X \to Y$, $g : Y \to Z$ be as above with $Z$ affine.
Choose an affine open covering $X = \bigcup X_i$.
As $\mathcal{P}$ is \'etale local on the source we see that
each $f|_{X_i} : X_i \to Y$ has $\mathcal{P}$.
By (AA), which follows from (AAA) according to Claim 1, we see that
$X_i \to Z$ has $\mathcal{P}$ for each $i$.
Since $\{X_i \to X\}$ is an \'etale covering and $\mathcal{P}$ is \'etale
local on the source we conclude that
$X \to Z$ has $\mathcal{P}$.

\medskip\noindent
Claim 3: (AAA) $\Rightarrow$ (-).
Namely, let $f : X \to Y$, $g : Y \to Z$ be as above.
Choose an affine open covering $Z = \bigcup Z_i$.
Set $Y_i = g^{-1}(Z_i)$ and $X_i = f^{-1}(Y_i)$. By
Lemma \ref{lemma-pullback-property-local-target}
each of the morphisms $X_i \to Y_i$ has $\mathcal{P}$.
By (A), which follows from (AAA) according to Claim 2, we see that
$X_i \to Z_i$ has $\mathcal{P}$ for each $i$.
Since $\mathcal{P}$ is local on the target and $X_i = (g \circ f)^{-1}(Z_i)$
we conclude that $X \to Z$ has $\mathcal{P}$.

\medskip\noindent
Thus to prove the lemma it suffices to prove (AAA).
Let $f : X \to Y$ and $g : Y \to Z$ be as above $X, Y, Z$ affine.
Note that an \'etale morphism of affines has universally bounded fibres, see
Morphisms,
Lemma \ref{morphisms-lemma-etale-locally-quasi-finite} and
Lemma \ref{morphisms-lemma-locally-quasi-finite-qc-source-universally-bounded}.
Hence we can do induction on the integer $n$ bounding the degree of the fibres
of $Y \to Z$. See
Morphisms, Lemma \ref{morphisms-lemma-etale-universally-bounded}
for a description of this integer in the case of an \'etale morphism.
If $n = 1$, then $Y \to Z$ is an open immersion, see
Lemma \ref{lemma-universally-injective-etale-open-immersion},
and the result follows from assumption (3) of the lemma. Assume $n > 1$.

\medskip\noindent
Consider the following commutative diagram
$$
\xymatrix{
X \times_Z Y \ar[d] \ar[r]_{f_Y} &
Y \times_Z Y \ar[d] \ar[r]_-{\text{pr}} &
Y \ar[d] \\
X \ar[r]^f &
Y \ar[r]^g &
Z
}
$$
Note that we have a decomposition into open and closed
subschemes $Y \times_Z Y = \Delta_{Y/Z}(Y) \amalg Y'$, see
Morphisms, Lemma \ref{morphisms-lemma-diagonal-unramified-morphism}.
As a base change the degrees of the fibres of the second projection
$\text{pr} : Y \times_Z Y \to Y$ are bounded by $n$, see
Morphisms, Lemma \ref{morphisms-lemma-base-change-universally-bounded}.
On the other hand, $\text{pr}|_{\Delta(Y)} : \Delta(Y) \to Y$ is
an isomorphism and every fibre has exactly one point.
Thus, on applying
Morphisms, Lemma \ref{morphisms-lemma-etale-universally-bounded}
we conclude the degrees of the fibres of the restriction
$\text{pr}|_{Y'} : Y' \to Y$ are bounded by $n - 1$.
Set $X' = f_Y^{-1}(Y')$. Picture
$$
\xymatrix{
X \amalg X' \ar@{=}[d] \ar[r]_-{f \amalg f'} &
\Delta(Y) \amalg Y' \ar@{=}[d] \ar[r] &
Y \ar@{=}[d] \\
X \times_Z Y \ar[r]^{f_Y} &
Y \times_Z Y \ar[r]^-{\text{pr}} &
Y
}
$$
As $\mathcal{P}$ is \'etale local on the target and hence stable under
\'etale base change (see
Lemma \ref{lemma-pullback-property-local-target})
we see that $f_Y$ has $\mathcal{P}$.
Hence, as $\mathcal{P}$ is \'etale local on the source,
$f' = f_Y|_{X'}$ has $\mathcal{P}$. By induction hypothesis
we see that $X' \to Y$ has $\mathcal{P}$.
As $\mathcal{P}$ is local on the source, and
$\{X \to X \times_Z Y, X' \to X \times_Y Z\}$ is an \'etale covering,
we conclude that $\text{pr} \circ f_Y$ has $\mathcal{P}$.
Note that $g \circ f$ can be viewed as a morphism
$g \circ f : X \to g(Y)$. As $\text{pr} \circ f_Y$ is the pullback of
$g \circ f : X \to g(Y)$ via the \'etale covering $\{Y \to g(Y)\}$,
and as $\mathcal{P}$ is \'etale local on the target, we conclude that
$g \circ f : X \to g(Y)$ has property $\mathcal{P}$. Finally, applying
assumption (3) of the lemma once more we conclude that
$g \circ f : X \to Z$ has property $\mathcal{P}$.
\end{proof}

\begin{remark}
\label{remark-list-local-source-target}
Using
Lemma \ref{lemma-etale-local-source-target}
and the work done in the earlier sections of this chapter it is easy
to make a list of types of morphisms which are \'etale local on the
source-and-target. In each case we list the lemma which implies
the property is \'etale local on the source and the lemma which implies
the property is \'etale local on the target. In each case the third assumption
of
Lemma \ref{lemma-etale-local-source-target}
is trivial to check, and we omit it. Here is the list:
\begin{enumerate}
\item flat, see
Lemmas \ref{lemma-flat-fpqc-local-source} and
\ref{lemma-descending-property-flat},
\item locally of finite presentation, see
Lemmas \ref{lemma-locally-finite-presentation-fppf-local-source} and
\ref{lemma-descending-property-locally-finite-presentation},
\item locally finite type, see
Lemmas \ref{lemma-locally-finite-type-fppf-local-source} and
\ref{lemma-descending-property-locally-finite-type},
\item universally open, see
Lemmas \ref{lemma-universally-open-fppf-local-source} and
\ref{lemma-descending-property-universally-open},
\item syntomic, see
Lemmas \ref{lemma-syntomic-syntomic-local-source} and
\ref{lemma-descending-property-syntomic},
\item smooth, see
Lemmas \ref{lemma-smooth-smooth-local-source} and
\ref{lemma-descending-property-smooth},
\item \'etale, see
Lemmas \ref{lemma-etale-etale-local-source} and
\ref{lemma-descending-property-etale},
\item locally quasi-finite, see
Lemmas \ref{lemma-locally-quasi-finite-etale-local-source} and
\ref{lemma-descending-property-quasi-finite},
\item unramified, see
Lemmas \ref{lemma-unramified-etale-local-source} and
\ref{lemma-descending-property-unramified},
\item G-unramified, see
Lemmas \ref{lemma-unramified-etale-local-source} and
\ref{lemma-descending-property-unramified}, and
\item add more here as needed.
\end{enumerate}
\end{remark}

\begin{remark}
\label{remark-compare-definitions}
At this point we have three possible definitions of what it means for a
property $\mathcal{P}$ of morphisms to be ``\'etale local on the source and
target'':
\begin{enumerate}
\item[(ST)] $\mathcal{P}$ is \'etale local on the source and $\mathcal{P}$ is
\'etale local on the target,
\item[(DM)] (the definition in the paper \cite[Page 100]{DM} by
Deligne and Mumford) for every diagram
$$
\xymatrix{
U \ar[d]_a \ar[r]_h & V \ar[d]^b \\
X \ar[r]^f & Y
}
$$
with surjective \'etale vertical arrows we have
$\mathcal{P}(h) \Leftrightarrow \mathcal{P}(f)$, and
\item[(SP)] $\mathcal{P}$ is \'etale local on the source-and-target.
\end{enumerate}
In this section we have seen that (SP) $\Rightarrow$ (DM) $\Rightarrow$ (ST).
The
Examples \ref{example-silly-one} and \ref{example-silly-two}
show that neither implication can be reversed. Finally,
Lemma \ref{lemma-etale-local-source-target}
shows that the difference disappears when looking at properties of
morphisms which are stable under postcomposing with open immersions, which
in practice will always be the case.
\end{remark}

\begin{lemma}
\label{lemma-etale-etale-local-source-target}
Let $\mathcal{P}$ be a property of morphisms of schemes which
is \'etale local on the source-and-target.
Given a commutative diagram of schemes
$$
\vcenter{
\xymatrix{
X' \ar[d]_{g'} \ar[r]_{f'} & Y' \ar[d]^g \\
X \ar[r]^f & Y
}
}
\quad\text{with points}\quad
\vcenter{
\xymatrix{
x' \ar[d] \ar[r] & y' \ar[d] \\
x \ar[r] & y
}
}
$$
such that $g'$ is \'etale at $x'$ and $g$ is \'etale at $y'$, then
$x \in W(f) \Leftrightarrow x' \in W(f')$
where $W(-)$ is as in Lemma \ref{lemma-largest-open-of-the-source}.
\end{lemma}

\begin{proof}
Lemma \ref{lemma-largest-open-of-the-source} applies since
$\mathcal{P}$ is \'etale local on the source by
Lemma \ref{lemma-local-source-target-implies}.

\medskip\noindent
Assume $x \in W(f)$. Let $U' \subset X'$ and $V' \subset Y'$
be open neighbourhoods of $x'$ and $y'$ such that $f'(U') \subset V'$,
$g'(U') \subset W(f)$ and $g'|_{U'}$ and $g|_{V'}$ are \'etale.
Then $f \circ g'|_{U'} = g \circ f'|_{U'}$
has $\mathcal{P}$ by property (1) of
Definition \ref{definition-local-source-target}.
Then $f'|_{U'} : U' \to V'$ has property $\mathcal{P}$
by (4) of Lemma \ref{lemma-local-source-target-implies}.
Then by (3) of Lemma \ref{lemma-local-source-target-implies}
we conclude that $f'_{U'} : U' \to Y'$ has $\mathcal{P}$.
Hence $U' \subset W(f')$ by definition. Hence $x' \in W(f')$.

\medskip\noindent
Assume $x' \in W(f')$. Let $U' \subset X'$ and $V' \subset Y'$
be open neighbourhoods of $x'$ and $y'$ such that $f'(U') \subset V'$,
$U' \subset W(f')$ and $g'|_{U'}$ and $g|_{V'}$ are \'etale.
Then $U' \to Y'$ has $\mathcal{P}$ by definition of $W(f')$.
Then $U' \to V'$ has $\mathcal{P}$ by (4) of
Lemma \ref{lemma-local-source-target-implies}.
Then $U' \to Y$ has $\mathcal{P}$ by (3) of
Lemma \ref{lemma-local-source-target-implies}.
Let $U \subset X$ be the image of the \'etale (hence open)
morphism $g'|_U' : U' \to X$. Then $\{U' \to U\}$
is an \'etale covering and we conclude that
$U \to Y$ has $\mathcal{P}$ by (1) of
Lemma \ref{lemma-local-source-target-implies}.
Thus $U \subset W(f)$ by definition. Hence $x \in W(f)$.
\end{proof}

\begin{lemma}
\label{lemma-orbits}
Let $k$ be a field. Let $n \geq 2$. For $1 \leq i, j \leq n$ with
$i \not = j$ and $d \geq 0$ denote $T_{i, j, d}$ the automorphism
of $\mathbf{A}^n_k$ given in coordinates by
$$
(x_1, \ldots, x_n) \longmapsto
(x_1, \ldots, x_{i - 1}, x_i + x_j^d, x_{i + 1}, \ldots, x_n)
$$
Let $W \subset \mathbf{A}^n_k$ be a nonempty open subscheme
such that $T_{i, j, d}(W) = W$ for all $i, j, d$ as above.
Then either $W = \mathbf{A}^n_k$ or the characteristic of $k$
is $p > 0$ and $\mathbf{A}^n_k \setminus W$ is a finite set
of closed points whose coordinates are algebraic over $\mathbf{F}_p$.
\end{lemma}

\begin{proof}
We may replace $k$ by any extension field in order to prove this.
Let $Z$ be an irreducible component of $\mathbf{A}^n_k \setminus W$.
Assume $\dim(Z) \geq 1$, to get a contradiction.
Then there exists an extension field $k'/k$ and a $k'$-valued
point $\xi = (\xi_1, \ldots, \xi_n) \in (k')^n$ of
$Z_{k'} \subset \mathbf{A}^n_{k'}$
such that at least one of $x_1, \ldots, x_n$ is transcendental over the
prime field. Claim: the orbit of $\xi$ under the group generated by
the transformations $T_{i, j, d}$ is Zariski
dense in $\mathbf{A}^n_{k'}$. The claim will give the desired contradiction.

\medskip\noindent
If the characteristic of $k'$ is zero, then already the operators
$T_{i, j, 0}$ will be enough since these transform $\xi$ into
the points
$$
(\xi_1 + a_1, \ldots, \xi_n + a_n)
$$
for arbitrary $(a_1, \ldots, a_n) \in \mathbf{Z}_{\geq 0}^n$.
If the characteristic is $p > 0$, we may assume after renumbering
that $\xi_n$ is transcendental over $\mathbf{F}_p$. By
successively applying the operators $T_{i, n, d}$ for
$i < n$ we see the orbit of $\xi$ contains the elements
$$
(\xi_1 + P_1(\xi_n), \ldots, \xi_{n - 1} + P_{n - 1}(\xi_n), \xi_n)
$$
for arbitrary $(P_1, \ldots, P_{n - 1}) \in \mathbf{F}_p[t]$.
Thus the Zariski closure of the orbit contains the coordinate
hyperplane $x_n = \xi_n$. Repeating the argument with a different
coordinate, we conclude that the Zariski closure contains
$x_i = \xi_i + P(\xi_n)$ for any $P \in \mathbf{F}_p[t]$
such that $\xi_i + P(\xi_n)$ is transcendental over $\mathbf{F}_p$.
Since there are infinitely many such $P$ the claim follows.

\medskip\noindent
Of course the argument in the preceding paragraph also applies
if $Z = \{z\}$ has dimension $0$ and the coordinates of $z$
in $\kappa(z)$ are not algebraic over $\mathbf{F}_p$. The lemma follows.
\end{proof}

\begin{lemma}
\label{lemma-etale-tau-local-source-target}
Let $\mathcal{P}$ be a property of morphisms of schemes. Assume
\begin{enumerate}
\item $\mathcal{P}$ is \'etale local on the source,
\item $\mathcal{P}$ is smooth local on the target,
\item $\mathcal{P}$ is stable under postcomposing with open immersions:
if $f : X \to Y$ has $\mathcal{P}$ and $Y \subset Z$ is an open
subscheme then $X \to Z$ has $\mathcal{P}$.
\end{enumerate}
Given a commutative diagram of schemes
$$
\vcenter{
\xymatrix{
X' \ar[d]_{g'} \ar[r]_{f'} & Y' \ar[d]^g \\
X \ar[r]^f & Y
}
}
\quad\text{with points}\quad
\vcenter{
\xymatrix{
x' \ar[d] \ar[r] & y' \ar[d] \\
x \ar[r] & y
}
}
$$
such that $g$ is smooth $y'$ and $X' \to X \times_Y Y'$ is \'etale
at $x'$, then $x \in W(f) \Leftrightarrow x' \in W(f')$
where $W(-)$ is as in Lemma \ref{lemma-largest-open-of-the-source}.
\end{lemma}

\begin{proof}
Since $\mathcal{P}$ is \'etale local on the source we see
that $x \in W(f)$ if and only if the image of $x$ in
$X \times_Y Y'$ is in $W(X \times_Y Y' \to Y')$. Hence we
may assume the diagram in the lemma is cartesian.

\medskip\noindent
Assume $x \in W(f)$. Since $\mathcal{P}$ is smooth local on the target
we see that $(g')^{-1}W(f) = W(f) \times_Y Y' \to Y'$ has $\mathcal{P}$.
Hence $(g')^{-1}W(f) \subset W(f')$. We conclude $x' \in W(f')$.

\medskip\noindent
Assume $x' \in W(f')$.
For any open neighbourhood $V' \subset Y'$ of $y'$ we may replace
$Y'$ by $V'$ and $X'$ by $U' = (f')^{-1}V'$ because $V' \to Y'$ is smooth
and hence the base change $W(f') \cap U' \to V'$ of $W(f') \to Y'$
has property $\mathcal{P}$. Thus we may assume there exists
an \'etale morphism $Y' \to \mathbf{A}^n_Y$ over $Y$, see
Morphisms, Lemma \ref{morphisms-lemma-smooth-etale-over-affine-space}.
Picture
$$
\xymatrix{
X' \ar[r] \ar[d] & Y' \ar[d] \\
\mathbf{A}^n_X \ar[r]_{f_n} \ar[d] & \mathbf{A}^n_Y \ar[d] \\
X \ar[r]^f & Y
}
$$
By Lemma \ref{lemma-etale-local-source-target}
(and because \'etale coverings are smooth coverings)
we see that $\mathcal{P}$ is \'etale local on the source-and-target.
By Lemma \ref{lemma-etale-etale-local-source-target}
we see that $W(f')$ is the inverse image of
the open $W(f_n) \subset \mathbf{A}^n_X$. In particular
$W(f_n)$ contains a point lying over $x$.
After replacing $X$ by the image of $W(f_n)$ (which is open)
we may assume $W(f_n) \to X$ is surjective.
Claim: $W(f_n) = \mathbf{A}^n_X$.
The claim implies $f$ has $\mathcal{P}$ as
$\mathcal{P}$ is local in the smooth topology
and $\{\mathbf{A}^n_Y \to Y\}$ is a smooth covering.

\medskip\noindent
Essentially, the claim follows as $W(f_n) \subset \mathbf{A}^n_X$ is a
``translation invariant'' open which meets every fibre of
$\mathbf{A}^n_X \to X$. However, to produce an argument along these lines
one has to do \'etale localization on $Y$ to produce enough translations
and it becomes a bit annoying. Instead we use the automorphisms
of Lemma \ref{lemma-orbits} and \'etale morphisms of affine spaces.
We may assume $n \geq 2$. Namely, if $n = 0$, then we are done.
If $n = 1$, then we consider the diagram
$$
\xymatrix{
\mathbf{A}^2_X \ar[r]_{f_2} \ar[d]_p & \mathbf{A}^2_Y \ar[d] \\
\mathbf{A}^1_X \ar[r]^{f_1} & \mathbf{A}^1_Y
}
$$
We have $p^{-1}(W(f_1)) \subset W(f_2)$ (see first paragraph
of the proof). Thus $W(f_2) \to X$ is still surjective
and we may work with $f_2$. Assume $n \geq 2$.

\medskip\noindent
For any $1 \leq i, j \leq n$ with $i \not = j$ and $d \geq 0$
denote $T_{i, j, d}$ the automorphism of $\mathbf{A}^n$ defined
in Lemma \ref{lemma-orbits}. Then we get a commutative diagram
$$
\xymatrix{
\mathbf{A}^n_X \ar[r]_{f_n} \ar[d]_{T_{i, j, d}} &
\mathbf{A}^n_Y \ar[d]^{T_{i, j, d}} \\
\mathbf{A}^n_X \ar[r]^{f_n} & \mathbf{A}^n_Y
}
$$
whose vertical arrows are isomorphisms. We conclude that
$T_{i, j, d}(W(f_n)) = W(f_n)$. Applying Lemma \ref{lemma-orbits}
we conclude for any $x \in X$ the fibre $W(f_n)_x \subset \mathbf{A}^n_x$ is
either $\mathbf{A}^n_x$ (this is what we want) or $\kappa(x)$
has characteristic $p > 0$ and $W(f_n)_x$
is the complement of a finite set $Z_x \subset \mathbf{A}^n_x$
of closed points. The second possibility cannot occur. Namely,
consider the morphism $T_p : \mathbf{A}^n \to \mathbf{A}^n$ given by
$$
(x_1, \ldots, x_n) \mapsto (x_1 - x_1^p, \ldots, x_n - x_n^p)
$$
As above we get a commutative diagram
$$
\xymatrix{
\mathbf{A}^n_X \ar[r]_{f_n} \ar[d]_{T_p} &
\mathbf{A}^n_Y \ar[d]^{T_p} \\
\mathbf{A}^n_X \ar[r]^{f_n} & \mathbf{A}^n_Y
}
$$
The morphism $T_p : \mathbf{A}^n_X \to \mathbf{A}^n_X$
is \'etale at every point lying over $x$
and the morphism $T_p : \mathbf{A}^n_Y \to \mathbf{A}^n_Y$
is \'etale at every point lying over the image of $x$ in $Y$.
(Details omitted; hint: compute the derivatives.)
We conclude that
$$
T_p^{-1}(W) \cap \mathbf{A}^n_x = W \cap \mathbf{A}^n_x
$$
by Lemma \ref{lemma-etale-etale-local-source-target}
(we've already seen $\mathcal{P}$ is
\'etale local on the source-and-target).
Since $T_p : \mathbf{A}^n_x \to \mathbf{A}^n_x$ is finite \'etale
of degree $p^n > 1$ we see that if $Z_x$ is not empty then it contains
$T_p^{-1}(Z_x)$ which is bigger. This contradiction finishes
the proof.
\end{proof}





\section{Properties of morphisms of germs local on source-and-target}
\label{section-local-source-target-at-point}

\noindent
In this section we discuss the analogue of the material in
Section \ref{section-properties-etale-local-source-target}
for morphisms of germs of schemes.

\begin{definition}
\label{definition-local-source-target-at-point}
Let $\mathcal{Q}$ be a property of morphisms of germs of schemes.
We say $\mathcal{Q}$ is  {\it \'etale local on the source-and-target}
if for any commutative diagram
$$
\xymatrix{
(U', u') \ar[d]_a \ar[r]_{h'} & (V', v') \ar[d]^b \\
(U, u) \ar[r]^h & (V, v)
}
$$
of germs with \'etale vertical arrows we have
$\mathcal{Q}(h) \Leftrightarrow \mathcal{Q}(h')$.
\end{definition}

\begin{lemma}
\label{lemma-local-source-target-global-implies-local}
Let $\mathcal{P}$ be a property of morphisms of schemes
which is \'etale local on the source-and-target.
Consider the property $\mathcal{Q}$ of
morphisms of germs defined by the rule
$$
\mathcal{Q}((X, x) \to (S, s))
\Leftrightarrow
\text{there exists a representative }U \to S
\text{ which has }\mathcal{P}
$$
Then $\mathcal{Q}$ is \'etale local on the source-and-target as in
Definition \ref{definition-local-source-target-at-point}.
\end{lemma}

\begin{proof}
If a morphism of germs $(X, x) \to (S, s)$ has $\mathcal{Q}$,
then there are arbitrarily small neighbourhoods
$U \subset X$ of $x$ and $V \subset S$ of $s$
such that a representative $U \to V$ of $(X, x) \to (S, s)$ has $\mathcal{P}$.
This follows from Lemma \ref{lemma-local-source-target-implies}. Let
$$
\xymatrix{
(U', u') \ar[r]_{h'} \ar[d]_a & (V', v') \ar[d]^b \\
(U, u) \ar[r]^h & (V, v)
}
$$
be as in Definition \ref{definition-local-source-target-at-point}.
Choose $U_1 \subset U$ and a representative $h_1 : U_1 \to V$ of $h$.
Choose $V'_1 \subset V'$ and an \'etale representative $b_1 : V'_1 \to V$
of $b$ (Definition \ref{definition-etale-morphism-germs}).
Choose $U'_1 \subset U'$ and representatives $a_1 : U'_1 \to U_1$
and $h'_1 : U'_1 \to V'_1$ of $a$ and $h'$ with $a_1$ \'etale.
After shrinking $U'_1$ we may assume $h_1 \circ a_1 = b_1 \circ h'_1$.
By the initial remark of the proof, we are trying to show
$u' \in W(h'_1) \Leftrightarrow u \in W(h_1)$ where $W(-)$ is as
in Lemma \ref{lemma-largest-open-of-the-source}.
Thus the lemma follows from Lemma \ref{lemma-etale-etale-local-source-target}.
\end{proof}

\begin{lemma}
\label{lemma-local-source-target-local-implies-global}
Let $\mathcal{P}$ be a property of morphisms of schemes which is
\'etale local on source-and-target. Let $Q$ be the associated property
of morphisms of germs, see
Lemma \ref{lemma-local-source-target-global-implies-local}.
Let $f : X \to Y$ be a morphism
of schemes. The following are equivalent:
\begin{enumerate}
\item $f$ has property $\mathcal{P}$, and
\item for every $x \in X$ the morphism of germs $(X, x) \to (Y, f(x))$
has property $\mathcal{Q}$.
\end{enumerate}
\end{lemma}

\begin{proof}
The implication (1) $\Rightarrow$ (2) is direct from the definitions.
The implication (2) $\Rightarrow$ (1) also follows from part (3) of
Definition \ref{definition-local-source-target}.
\end{proof}

\noindent
A morphism of germs $(X, x) \to (S, s)$ determines a well defined
map of local rings. Hence the following lemma makes sense.

\begin{lemma}
\label{lemma-flat-at-point}
The property of morphisms of germs
$$
\mathcal{P}((X, x) \to (S, s)) =
\mathcal{O}_{S, s} \to \mathcal{O}_{X, x}\text{ is flat}
$$
is \'etale local on the source-and-target.
\end{lemma}

\begin{proof}
Given a diagram as in
Definition \ref{definition-local-source-target-at-point}
we obtain the following diagram of local homomorphisms of local rings
$$
\xymatrix{
\mathcal{O}_{U', u'} & \mathcal{O}_{V', v'} \ar[l] \\
\mathcal{O}_{U, u} \ar[u] & \mathcal{O}_{V, v} \ar[l] \ar[u]
}
$$
Note that the vertical arrows are localizations of \'etale ring maps,
in particular they are essentially of finite presentation, flat,
and unramified (see
Algebra, Section \ref{algebra-section-etale}).
In particular the vertical maps are faithfully flat, see
Algebra, Lemma \ref{algebra-lemma-local-flat-ff}.
Now, if the upper horizontal arrow is flat, then the lower horizontal
arrow is flat by an application of
Algebra, Lemma \ref{algebra-lemma-flat-permanence}
with $R = \mathcal{O}_{V, v}$, $S = \mathcal{O}_{U, u}$ and
$M = \mathcal{O}_{U', u'}$. If the lower horizontal arrow is
flat, then the ring map
$$
\mathcal{O}_{V', v'} \otimes_{\mathcal{O}_{V, v}} \mathcal{O}_{U, u}
\longleftarrow
\mathcal{O}_{V', v'}
$$
is flat by
Algebra, Lemma \ref{algebra-lemma-flat-base-change}.
And the ring map
$$
\mathcal{O}_{U', u'}
\longleftarrow
\mathcal{O}_{V', v'} \otimes_{\mathcal{O}_{V, v}} \mathcal{O}_{U, u}
$$
is a localization of a map between \'etale ring extensions of
$\mathcal{O}_{U, u}$, hence flat by
Algebra, Lemma \ref{algebra-lemma-map-between-etale}.
\end{proof}

\begin{lemma}
\label{lemma-etale-on-fiber}
Consider a commutative diagram of morphisms of schemes
$$
\xymatrix{
U' \ar[r] \ar[d] & V' \ar[d] \\
U \ar[r] & V
}
$$
with \'etale vertical arrows and a point $v' \in V'$ mapping to $v \in V$.
Then the morphism of fibres $U'_{v'} \to U_v$ is \'etale.
\end{lemma}

\begin{proof}
Note that $U'_v \to U_v$ is \'etale as a base change of the \'etale
morphism $U' \to U$. The scheme $U'_v$ is a scheme over $V'_v$. By
Morphisms, Lemma \ref{morphisms-lemma-etale-over-field}
the scheme $V'_v$ is a disjoint union of spectra
of finite separable field extensions of $\kappa(v)$.
One of these is $v' = \Spec(\kappa(v'))$. Hence
$U'_{v'}$ is an open and closed subscheme of $U'_v$ and it follows
that $U'_{v'} \to U'_v \to U_v$ is \'etale (as a composition of an
open immersion and an \'etale morphism, see
Morphisms, Section \ref{morphisms-section-etale}).
\end{proof}

\noindent
Given a morphism of germs of schemes $(X, x) \to (S, s)$
we can define the {\it fibre} as the isomorphism class of germs
$(U_s, x)$ where $U \to S$ is any representative. We will often abuse notation
and just write $(X_s, x)$.

\begin{lemma}
\label{lemma-dimension-local-ring-fibre}
Let $d \in \{0, 1, 2, \ldots, \infty\}$.
The property of morphisms of germs
$$
\mathcal{P}_d((X, x) \to (S, s)) =
\text{the local ring }
\mathcal{O}_{X_s, x}
\text{ of the fibre has dimension }d
$$
is \'etale local on the source-and-target.
\end{lemma}

\begin{proof}
Given a diagram as in
Definition \ref{definition-local-source-target-at-point}
we obtain an \'etale morphism of fibres
$U'_{v'} \to U_v$ mapping $u'$ to $u$, see
Lemma \ref{lemma-etale-on-fiber}.
Hence the result follows from
Lemma \ref{lemma-dimension-local-ring-local}.
\end{proof}

\begin{lemma}
\label{lemma-transcendence-degree-at-point}
Let $r \in \{0, 1, 2, \ldots, \infty\}$.
The property of morphisms of germs
$$
\mathcal{P}_r((X, x) \to (S, s))
\Leftrightarrow
\text{trdeg}_{\kappa(s)} \kappa(x) = r
$$
is \'etale local on the source-and-target.
\end{lemma}

\begin{proof}
Given a diagram as in
Definition \ref{definition-local-source-target-at-point}
we obtain the following diagram of local homomorphisms of local rings
$$
\xymatrix{
\mathcal{O}_{U', u'} & \mathcal{O}_{V', v'} \ar[l] \\
\mathcal{O}_{U, u} \ar[u] & \mathcal{O}_{V, v} \ar[l] \ar[u]
}
$$
Note that the vertical arrows are localizations of \'etale ring maps,
in particular they are unramified (see
Algebra, Section \ref{algebra-section-etale}).
Hence $\kappa(u) \subset \kappa(u')$ and $\kappa(v) \subset \kappa(v')$
are finite separable field extensions.
Thus we have
$\text{trdeg}_{\kappa(v)} \kappa(u) = \text{trdeg}_{\kappa(v')} \kappa(u)$
which proves the lemma.
\end{proof}

\noindent
Let $(X, x)$ be a germ of a scheme.
The dimension of $X$ at $x$ is the minimum of the dimensions of
open neighbourhoods of $x$ in $X$, and any small enough open neighbourhood
has this dimension. Hence this is an invariant of the isomorphism class
of the germ. We denote this simply $\dim_x(X)$.

\begin{lemma}
\label{lemma-dimension-at-point}
Let $d \in \{0, 1, 2, \ldots, \infty\}$.
The property of morphisms of germs
$$
\mathcal{P}_d((X, x) \to (S, s))
\Leftrightarrow
\dim_x (X_s) = d
$$
is \'etale local on the source-and-target.
\end{lemma}

\begin{proof}
Given a diagram as in
Definition \ref{definition-local-source-target-at-point}
we obtain an \'etale morphism of fibres
$U'_{v'} \to U_v$ mapping $u'$ to $u$, see
Lemma \ref{lemma-etale-on-fiber}.
Hence now the equality $\dim_u(U_v) = \dim_{u'}(U'_{v'})$ follows from
Lemma \ref{lemma-dimension-at-point-local}.
\end{proof}







\section{Descent data for schemes over schemes}
\label{section-descent-datum}

\noindent
Most of the arguments in this section are formal relying only
on the definition of a descent datum. In
Simplicial Spaces, Section \ref{spaces-simplicial-section-simplicial-descent}
we will examine the relationship with simplicial schemes which will
somewhat clarify the situation.

\begin{definition}
\label{definition-descent-datum}
Let $f : X \to S$ be a morphism of schemes.
\begin{enumerate}
\item Let $V \to X$ be a scheme over $X$.
A {\it descent datum for $V/X/S$} is an isomorphism
$\varphi : V \times_S X \to X \times_S V$ of schemes over
$X \times_S X$ satisfying the {\it cocycle condition}
that the diagram
$$
\xymatrix{
V \times_S X \times_S X \ar[rd]^{\varphi_{01}} \ar[rr]_{\varphi_{02}} &
&
X \times_S X \times_S V\\
&
X \times_S V \times_S X \ar[ru]^{\varphi_{12}}
}
$$
commutes (with obvious notation).
\item We also say that the pair $(V/X, \varphi)$ is
a {\it descent datum relative to $X \to S$}.
\item A {\it morphism $f : (V/X, \varphi) \to (V'/X, \varphi')$ of
descent data relative to $X \to S$} is a morphism
$f : V \to V'$ of schemes over $X$ such that
the diagram
$$
\xymatrix{
V \times_S X \ar[r]_{\varphi} \ar[d]_{f \times \text{id}_X} &
X \times_S V \ar[d]^{\text{id}_X \times f} \\
V' \times_S X \ar[r]^{\varphi'} & X \times_S V'
}
$$
commutes.
\end{enumerate}
\end{definition}

\noindent
There are all kinds of ``miraculous'' identities which arise out of the
definition above. For example the pullback of $\varphi$ via the diagonal
morphism $\Delta : X \to X \times_S X$ can be seen as a morphism
$\Delta^*\varphi : V \to V$.
This because $X \times_{\Delta, X \times_S X} (V \times_S X) = V$
and also $X \times_{\Delta, X \times_S X} (X \times_S V) = V$.
In fact, $\Delta^*\varphi$ is equal to the identity.
This is a good exercise if you are unfamiliar with this material.

\begin{remark}
\label{remark-easier}
Let $X \to S$ be a morphism of schemes. Let $(V/X, \varphi)$ be
a descent datum relative to $X \to S$. We may think of the
isomorphism $\varphi$ as an isomorphism
$$
(X \times_S X) \times_{\text{pr}_0, X} V
\longrightarrow
(X \times_S X) \times_{\text{pr}_1, X} V
$$
of schemes over $X \times_S X$. So loosely speaking one may
think of $\varphi$ as a map
$\varphi : \text{pr}_0^*V \to \text{pr}_1^*V$\footnote{Unfortunately,
we have chosen the ``wrong'' direction for our arrow here. In
Definitions \ref{definition-descent-datum} and
\ref{definition-descent-datum-for-family-of-morphisms}
we should have the opposite direction to what was done in
Definition \ref{definition-descent-datum-quasi-coherent}
by the general principle that ``functions'' and ``spaces'' are dual.}.
The cocycle condition then says that
$\text{pr}_{02}^*\varphi =
\text{pr}_{12}^*\varphi \circ \text{pr}_{01}^*\varphi$.
In this way it is very similar to the case of a descent datum on
quasi-coherent sheaves.
\end{remark}

\noindent
Here is the definition in case you have a family of morphisms
with fixed target.

\begin{definition}
\label{definition-descent-datum-for-family-of-morphisms}
Let $S$ be a scheme.
Let $\{X_i \to S\}_{i \in I}$ be a family of morphisms with target $S$.
\begin{enumerate}
\item A {\it descent datum $(V_i, \varphi_{ij})$ relative to the
family $\{X_i \to S\}$} is given by a scheme $V_i$ over $X_i$
for each $i \in I$, an isomorphism
$\varphi_{ij} : V_i \times_S X_j \to X_i \times_S V_j$
of schemes over $X_i \times_S X_j$ for each pair $(i, j) \in I^2$
such that for every triple of indices $(i, j, k) \in I^3$
the diagram
$$
\xymatrix{
V_i \times_S X_j \times_S X_k
\ar[rd]^{\text{pr}_{01}^*\varphi_{ij}}
\ar[rr]_{\text{pr}_{02}^*\varphi_{ik}} &
&
X_i \times_S X_j \times_S V_k\\
&
X_i \times_S V_j \times_S X_k
\ar[ru]^{\text{pr}_{12}^*\varphi_{jk}}
}
$$
of schemes over $X_i \times_S X_j \times_S X_k$ commutes
(with obvious notation).
\item A {\it morphism
$\psi : (V_i, \varphi_{ij}) \to (V'_i, \varphi'_{ij})$
of descent data} is given by a family
$\psi = (\psi_i)_{i \in I}$ of morphisms of
$X_i$-schemes $\psi_i : V_i \to V'_i$ such that all the diagrams
$$
\xymatrix{
V_i \times_S X_j \ar[r]_{\varphi_{ij}} \ar[d]_{\psi_i \times \text{id}} &
X_i \times_S V_j \ar[d]^{\text{id} \times \psi_j} \\
V'_i \times_S X_j \ar[r]^{\varphi'_{ij}} & X_i \times_S V'_j
}
$$
commute.
\end{enumerate}
\end{definition}

\noindent
This is the notion that comes up naturally for example when the question arises
whether the fibred category of relative curves is a stack in the
fpqc topology (it isn't -- at least not if you stick to schemes).

\begin{remark}
\label{remark-easier-family}
Let $S$ be a scheme.
Let $\{X_i \to S\}_{i \in I}$ be a family of morphisms with target $S$.
Let $(V_i, \varphi_{ij})$ be a descent datum relative to
$\{X_i \to S\}$. We may think of the isomorphisms $\varphi_{ij}$
as isomorphisms
$$
(X_i \times_S X_j) \times_{\text{pr}_0, X_i} V_i
\longrightarrow
(X_i \times_S X_j) \times_{\text{pr}_1, X_j} V_j
$$
of schemes over $X_i \times_S X_j$. So loosely speaking one may
think of $\varphi_{ij}$ as an isomorphism
$\text{pr}_0^*V_i \to \text{pr}_1^*V_j$ over $X_i \times_S X_j$.
The cocycle condition then says that
$\text{pr}_{02}^*\varphi_{ik} =
\text{pr}_{12}^*\varphi_{jk} \circ \text{pr}_{01}^*\varphi_{ij}$.
In this way it is very similar to the case of a descent datum on
quasi-coherent sheaves.
\end{remark}

\noindent
The reason we will usually work with the version of a family consisting
of a single morphism is the following lemma.

\begin{lemma}
\label{lemma-family-is-one}
Let $S$ be a scheme.
Let $\{X_i \to S\}_{i \in I}$ be a family of morphisms with target $S$.
Set $X = \coprod_{i \in I} X_i$, and consider it as an $S$-scheme.
There is a canonical equivalence of categories
$$
\begin{matrix}
\text{category of descent data } \\
\text{relative to the family } \{X_i \to S\}_{i \in I}
\end{matrix}
\longrightarrow
\begin{matrix}
\text{ category of descent data} \\
\text{ relative to } X/S
\end{matrix}
$$
which maps $(V_i, \varphi_{ij})$ to $(V, \varphi)$ with
$V = \coprod_{i\in I} V_i$ and $\varphi = \coprod \varphi_{ij}$.
\end{lemma}

\begin{proof}
Observe that $X \times_S X = \coprod_{ij} X_i \times_S X_j$
and similarly for higher fibre products.
Giving a morphism $V \to X$ is exactly the same as
giving a family $V_i \to X_i$. And giving a descent datum
$\varphi$ is exactly the same as giving a family $\varphi_{ij}$.
\end{proof}

\begin{lemma}
\label{lemma-pullback}
Pullback of descent data for schemes over schemes.
\begin{enumerate}
\item Let
$$
\xymatrix{
X' \ar[r]_f \ar[d]_{a'} & X \ar[d]^a \\
S' \ar[r]^h & S
}
$$
be a commutative diagram of morphisms of schemes.
The construction
$$
(V \to X, \varphi) \longmapsto f^*(V \to X, \varphi) = (V' \to X', \varphi')
$$
where $V' = X' \times_X V$ and where
$\varphi'$ is defined as the composition
$$
\xymatrix{
V' \times_{S'} X' \ar@{=}[r] &
(X' \times_X V) \times_{S'} X' \ar@{=}[r] &
(X' \times_{S'} X') \times_{X \times_S X} (V \times_S X)
\ar[d]^{\text{id} \times \varphi} \\
X' \times_{S'} V' \ar@{=}[r] &
X' \times_{S'} (X' \times_X V) &
(X' \times_{S'} X') \times_{X \times_S X} (X \times_S V) \ar@{=}[l]
}
$$
defines a functor from the category of descent data
relative to $X \to S$ to the category of descent data
relative to $X' \to S'$.
\item Given two morphisms $f_i : X' \to X$, $i = 0, 1$ making the
diagram commute the functors $f_0^*$ and $f_1^*$ are
canonically isomorphic.
\end{enumerate}
\end{lemma}

\begin{proof}
We omit the proof of (1), but we remark that the morphism
$\varphi'$ is the morphism $(f \times f)^*\varphi$ in the
notation introduced in Remark \ref{remark-easier}.
For (2) we indicate which morphism
$f_0^*V \to f_1^*V$ gives the functorial isomorphism. Namely,
since $f_0$ and $f_1$ both fit into the commutative diagram
we see there is a unique morphism $r : X' \to X \times_S X$
with $f_i = \text{pr}_i \circ r$. Then we take
\begin{eqnarray*}
f_0^*V & = &
X' \times_{f_0, X} V \\
& = &
X' \times_{\text{pr}_0 \circ r, X} V \\
& = &
X' \times_{r, X \times_S X} (X \times_S X) \times_{\text{pr}_0, X} V \\
& \xrightarrow{\varphi} &
X' \times_{r, X \times_S X} (X \times_S X) \times_{\text{pr}_1, X} V \\
& = &
X' \times_{\text{pr}_1 \circ r, X} V \\
& = &
X' \times_{f_1, X} V \\
& = & f_1^*V
\end{eqnarray*}
We omit the verification that this works.
\end{proof}

\begin{definition}
\label{definition-pullback-functor}
With $S, S', X, X', f, a, a', h$ as in Lemma \ref{lemma-pullback} the functor
$$
(V, \varphi) \longmapsto f^*(V, \varphi)
$$
constructed in that lemma is called the {\it pullback functor} on descent data.
\end{definition}

\begin{lemma}[Pullback of descent data for schemes over families]
\label{lemma-pullback-family}
Let $\mathcal{U} = \{U_i \to S'\}_{i \in I}$ and
$\mathcal{V} = \{V_j \to S\}_{j \in J}$ be families of morphisms with
fixed target. Let $\alpha : I \to J$, $h : S' \to S$ and
$g_i : U_i \to V_{\alpha(i)}$ be a morphism of families
of maps with fixed target, see
Sites, Definition \ref{sites-definition-morphism-coverings}.
\begin{enumerate}
\item Let $(Y_j, \varphi_{jj'})$ be a descent datum relative to the
family $\{V_j \to S'\}$. The system
$$
\left(
g_i^*Y_{\alpha(i)},
(g_i \times g_{i'})^*\varphi_{\alpha(i)\alpha(i')}
\right)
$$
(with notation as in Remark \ref{remark-easier-family})
is a descent datum relative to $\mathcal{V}$.
\item This construction defines a functor between descent data relative
to $\mathcal{U}$ and descent data relative to $\mathcal{V}$.
\item Given a second $\alpha' : I \to J$, $h' : S' \to S$ and
$g'_i : U_i \to V_{\alpha'(i)}$ morphism of families
of maps with fixed target, then if $h = h'$ the two resulting functors
between descent data are canonically isomorphic.
\item These functors agree, via Lemma \ref{lemma-family-is-one},
with the pullback functors constructed in Lemma \ref{lemma-pullback}.
\end{enumerate}
\end{lemma}

\begin{proof}
This follows from Lemma \ref{lemma-pullback} via the
correspondence of Lemma \ref{lemma-family-is-one}.
\end{proof}

\begin{definition}
\label{definition-pullback-functor-family}
With $\mathcal{U} = \{U_i \to S'\}_{i \in I}$,
$\mathcal{V} = \{V_j \to S\}_{j \in J}$, $\alpha : I \to J$, $h : S' \to S$,
and $g_i : U_i \to V_{\alpha(i)}$ as in Lemma \ref{lemma-pullback-family}
the functor
$$
(Y_j, \varphi_{jj'}) \longmapsto
(g_i^*Y_{\alpha(i)}, (g_i \times g_{i'})^*\varphi_{\alpha(i)\alpha(i')})
$$
constructed in that lemma
is called the {\it pullback functor} on descent data.
\end{definition}

\noindent
If $\mathcal{U}$ and $\mathcal{V}$ have the same target $S$,
and if $\mathcal{U}$ refines $\mathcal{V}$ (see
Sites, Definition \ref{sites-definition-morphism-coverings})
but no explicit pair $(\alpha, g_i)$ is given, then we can still
talk about the pullback functor since we have seen in
Lemma \ref{lemma-pullback-family} that the choice of the pair does not matter
(up to a canonical isomorphism).


\begin{definition}
\label{definition-effective}
Let $S$ be a scheme.
Let $f : X \to S$ be a morphism of schemes.
\begin{enumerate}
\item  Given a scheme $U$ over $S$ we have the
{\it trivial descent datum} of $U$ relative to
$\text{id} : S \to S$, namely the identity morphism on $U$.
\item By Lemma \ref{lemma-pullback} we get a
{\it canonical descent datum} on $X \times_S U$
relative to $X \to S$ by pulling back the trivial
descent datum via $f$. We often
denote $(X \times_S U, can)$ this descent datum.
\item A descent datum $(V, \varphi)$ relative to $X/S$ is
called {\it effective} if $(V, \varphi)$
is isomorphic to the canonical descent datum
$(X \times_S U, can)$ for some scheme $U$ over $S$.
\end{enumerate}
\end{definition}

\noindent
Thus being effective means there exists a scheme $U$
over $S$ and an isomorphism $\psi : V \to X \times_S U$
of $X$-schemes such that $\varphi$ is equal to the composition
$$
V \times_S X \xrightarrow{\psi \times \text{id}_X}
X \times_S U \times_S X =
X \times_S X \times_S U
\xrightarrow{\text{id}_X \times \psi^{-1}}
X \times_S V
$$

\begin{definition}
\label{definition-effective-family}
Let $S$ be a scheme.
Let $\{X_i \to S\}$ be a family of morphisms
with target $S$.
\begin{enumerate}
\item  Given a scheme $U$ over $S$
we have a {\it canonical descent datum} on the family of
schemes $X_i \times_S U$ by pulling back the trivial
descent datum for $U$ relative to $\{\text{id} : S \to S\}$.
We denote this descent datum $(X_i \times_S U, can)$.
\item A descent datum $(V_i, \varphi_{ij})$
relative to $\{X_i \to S\}$ is called {\it effective}
if there exists a scheme $U$ over $S$ such that
$(V_i, \varphi_{ij})$ is isomorphic to $(X_i \times_S U, can)$.
\end{enumerate}
\end{definition}












\section{Fully faithfulness of the pullback functors}
\label{section-fully-faithful}

\noindent
It turns out that the pullback functor between descent data
for fpqc-coverings is fully faithful. In other words, morphisms of schemes
satisfy fpqc descent. The goal of this section
is to prove this. The reader is encouraged instead to prove this him/herself.
The key is to use Lemma \ref{lemma-fpqc-universal-effective-epimorphisms}.

\begin{lemma}
\label{lemma-surjective-flat-epi}
A surjective and flat morphism is an epimorphism in the
category of schemes.
\end{lemma}

\begin{proof}
Suppose we have $h : X' \to X$ surjective and flat and
$a, b : X \to Y$ morphisms such that $a \circ h = b \circ h$.
As $h$ is surjective we see that $a$ and $b$ agree on underlying
topological spaces. Pick $x' \in X'$ and set $x = h(x')$ and
$y = a(x) = b(x)$. Consider the local ring maps
$$
a^\sharp_x, b^\sharp_x : \mathcal{O}_{Y, y} \to \mathcal{O}_{X, x}
$$
These become equal when composed with
the flat local homomorphism
$h^\sharp_{x'} : \mathcal{O}_{X, x} \to \mathcal{O}_{X', x'}$.
Since a flat local homomorphism is faithfully flat
(Algebra, Lemma \ref{algebra-lemma-local-flat-ff})
we conclude that $h^\sharp_{x'}$ is injective.
Hence $a^\sharp_x = b^\sharp_x$ which implies $a = b$ as desired.
\end{proof}

\begin{lemma}
\label{lemma-ff-base-change-faithful}
Let $h : S' \to S$ be a surjective, flat morphism of
schemes. The base change functor
$$
\Sch/S \longrightarrow \Sch/S', \quad
X \longmapsto S' \times_S X
$$
is faithful.
\end{lemma}

\begin{proof}
Let $X_1$, $X_2$ be schemes over $S$.
Let $\alpha, \beta : X_2 \to X_1$ be morphisms over $S$.
If $\alpha$, $\beta$ base change to the same morphism then
we get a commutative diagram as follows
$$
\xymatrix{
X_2 \ar[d]^\alpha &
S' \times_S X_2 \ar[l] \ar[d] \ar[r] &
X_2 \ar[d]^\beta \\
X_1 &
S' \times_S X_1 \ar[l] \ar[r] &
X_1
}
$$
Hence it suffices to show that $S' \times_S X_2 \to X_2$
is an epimorphism. As the base change of a surjective and
flat morphism it is surjective and flat (see
Morphisms, Lemmas \ref{morphisms-lemma-base-change-surjective}
and \ref{morphisms-lemma-base-change-flat}). Hence the lemma follows
from Lemma \ref{lemma-surjective-flat-epi}.
\end{proof}

\begin{lemma}
\label{lemma-faithful}
In the situation of Lemma \ref{lemma-pullback}
assume that $f : X' \to X$ is surjective
and flat. Then the pullback functor is faithful.
\end{lemma}

\begin{proof}
Let $(V_i, \varphi_i)$, $i = 1, 2$ be descent data for $X \to S$.
Let $\alpha, \beta : V_1 \to V_2$ be morphisms of descent data.
Suppose that $f^*\alpha = f^*\beta$. Our task is to show that
$\alpha = \beta$. Note that $\alpha$, $\beta$ are morphisms
of schemes over $X$, and that $f^*\alpha$, $f^*\beta$ are
simply the base changes of $\alpha$, $\beta$ to morphisms over
$X'$. Hence the lemma follows from Lemma \ref{lemma-ff-base-change-faithful}.
\end{proof}

\noindent
Here is the key lemma of this section.

\begin{lemma}
\label{lemma-fully-faithful}
In the situation of Lemma \ref{lemma-pullback}
assume
\begin{enumerate}
\item $\{f : X' \to X\}$ is an fpqc covering (for example if $f$ is
surjective, flat, and quasi-compact), and
\item $S = S'$.
\end{enumerate}
Then the pullback functor is fully faithful.
\end{lemma}

\begin{proof}
Assumption (1) implies that $f$ is surjective and flat.
Hence the pullback functor is faithful by
Lemma \ref{lemma-faithful}.
Let $(V, \varphi)$ and $(W, \psi)$ be two descent data relative
to $X \to S$. Set $(V', \varphi') = f^*(V, \varphi)$ and
$(W', \psi') = f^*(W, \psi)$.
Let $\alpha' : V' \to W'$ be a morphism of descent data for $X'$ over $S$.
We have to show there exists a morphism $\alpha : V \to W$ of
descent data for $X$ over $S$ whose pullback is $\alpha'$.

\medskip\noindent
Recall that $V'$ is the base change of $V$ by $f$ and that
$\varphi'$ is the base change of $\varphi$ by $f \times f$
(see Remark \ref{remark-easier}).
By assumption the diagram
$$
\xymatrix{
V' \times_S X' \ar[r]_{\varphi'} \ar[d]_{\alpha' \times \text{id}} &
X' \times_S V' \ar[d]^{\text{id} \times \alpha'} \\
W' \times_S X' \ar[r]^{\psi'} &
X' \times_S W'
}
$$
commutes. We claim the two compositions
$$
\xymatrix{
V' \times_V V' \ar[r]^-{\text{pr}_i} &
V' \ar[r]^{\alpha'} &
W' \ar[r] &
W
}
, \quad i = 0, 1
$$
are the same. The reader is advised to prove this themselves rather
than read the rest of this paragraph. (Please email if you find a
nice clean argument.)
Let $v_0, v_1$ be points of $V'$ which map to the same point $v \in V$.
Let $x_i \in X'$ be the image of $v_i$, and let
$x$ be the point of $X$ which is the image of $v$ in $X$. In other words,
$v_i = (x_i, v)$ in $V' = X' \times_X V$. Write
$\varphi(v, x) = (x, v')$ for some point $v'$ of $V$.
This is possible because $\varphi$ is
a morphism over $X \times_S X$. Denote
$v_i' = (x_i, v')$ which is a point of $V'$.
Then a calculation (using the definition of $\varphi'$)
shows that $\varphi'(v_i, x_j) = (x_i, v'_j)$. Denote
$w_i = \alpha'(v_i)$ and $w'_i = \alpha'(v_i')$.
Now we may write $w_i = (x_i, u_i)$ for some point $u_i$ of $W$,
and $w_i' = (x_i, u'_i)$ for some point $u_i'$ of $W$.
The claim is equivalent to the assertion: $u_0 = u_1$.
A formal calculation using the definition of $\psi'$
(see Lemma \ref{lemma-pullback}) shows
that the commutativity of the diagram displayed above says that
$$
((x_i, x_j), \psi(u_i, x)) = ((x_i, x_j), (x, u'_j))
$$
as points of
$(X' \times_S X') \times_{X \times_S X} (X \times_S W)$
for all $i, j \in \{0, 1\}$. This shows that $\psi(u_0, x) = \psi(u_1, x)$
and hence $u_0 = u_1$ by taking $\psi^{-1}$.
This proves the claim because the argument above was formal
and we can take scheme points (in other words, we may
take $(v_0, v_1) = \text{id}_{V' \times_V V'}$).

\medskip\noindent
At this point we can use
Lemma \ref{lemma-fpqc-universal-effective-epimorphisms}.
Namely, $\{V' \to V\}$ is a fpqc covering as
the base change of the morphism $f : X' \to X$.
Hence, by
Lemma \ref{lemma-fpqc-universal-effective-epimorphisms}
the morphism $\alpha' : V' \to W' \to W$ factors through
a unique morphism $\alpha : V \to W$ whose base change is
necessarily $\alpha'$. Finally, we see the diagram
$$
\xymatrix{
V \times_S X \ar[r]_{\varphi} \ar[d]_{\alpha \times \text{id}} &
X \times_S V \ar[d]^{\text{id} \times \alpha} \\
W \times_S X \ar[r]^{\psi} & X \times_S W
}
$$
commutes because its base change to $X' \times_S X'$
commutes and the morphism $X' \times_S X' \to X \times_S X$
is surjective and flat (use Lemma \ref{lemma-ff-base-change-faithful}).
Hence $\alpha$ is a morphism of descent data
$(V, \varphi) \to (W, \psi)$ as desired.
\end{proof}

\noindent
The following two lemmas have been obsoleted by the improved
exposition of the previous material. But they are still true!

\begin{lemma}
\label{lemma-pullback-selfmap}
Let $X \to S$ be a morphism of schemes.
Let $f : X \to X$ be a selfmap of $X$ over $S$.
In this case pullback by $f$ is isomorphic to the
identity functor on the category of descent data
relative to $X \to S$.
\end{lemma}

\begin{proof}
This is clear from Lemma \ref{lemma-pullback} since it tells us that
$f^* \cong \text{id}^*$.
\end{proof}

\begin{lemma}
\label{lemma-morphism-with-section-equivalence}
Let $f : X' \to X$ be a morphism of schemes over a base scheme $S$.
Assume there exists a morphism $g : X \to X'$ over $S$, for example
if $f$ has a section. Then the pullback functor
of Lemma \ref{lemma-pullback} defines an equivalence of
categories between the category of descent data relative to
$X/S$ and $X'/S$.
\end{lemma}

\begin{proof}
Let $g : X \to X'$ be a morphism over $S$.
Lemma \ref{lemma-pullback-selfmap} above shows that the functors
$f^* \circ g^* = (g \circ f)^*$ and $g^* \circ f^* = (f \circ g)^*$
are isomorphic
to the respective identity functors as desired.
\end{proof}

\begin{lemma}
\label{lemma-morphism-source-faithfully-flat}
Let $f : X \to X'$ be a morphism of schemes over a base scheme $S$.
Assume $X \to S$ is surjective and flat. Then the pullback functor
of Lemma \ref{lemma-pullback} is a faithful functor
from the category of descent data relative to $X'/S$ to the
category of descent data relative to $X/S$.
\end{lemma}

\begin{proof}
We may factor $X \to X'$ as $X \to X \times_S X' \to X'$.
The first morphism has a section, hence induces an equivalence of
categories of descent data by
Lemma \ref{lemma-morphism-with-section-equivalence}.
The second morphism is surjective and flat, hence induces a
faithful functor by Lemma \ref{lemma-faithful}.
\end{proof}

\begin{lemma}
\label{lemma-morphism-source-fpqc-covering}
Let $f : X \to X'$ be a morphism of schemes over a base scheme $S$.
Assume $\{X \to S\}$ is an fpqc covering (for example if $f$ is
surjective, flat and quasi-compact).
Then the pullback functor of Lemma \ref{lemma-pullback} is a
fully faithful functor from the category of descent data relative
to $X'/S$ to the category of descent data relative to $X/S$.
\end{lemma}

\begin{proof}
We may factor $X \to X'$ as $X \to X \times_S X' \to X'$.
The first morphism has a section, hence induces an equivalence of
categories of descent data by
Lemma \ref{lemma-morphism-with-section-equivalence}.
The second morphism is an fpqc covering
hence induces a fully faithful functor by Lemma \ref{lemma-fully-faithful}.
\end{proof}

\begin{lemma}
\label{lemma-fpqc-refinement-coverings-fully-faithful}
Let $S$ be a scheme.
Let $\mathcal{U} = \{U_i \to S\}_{i \in I}$, and
$\mathcal{V} = \{V_j \to S\}_{j \in J}$,
be families of morphisms with target $S$.
Let $\alpha : I \to J$, $\text{id} : S \to S$ and
$g_i : U_i \to V_{\alpha(i)}$ be a morphism of families
of maps with fixed target, see
Sites, Definition \ref{sites-definition-morphism-coverings}.
Assume that for each $j \in J$ the family
$\{g_i : U_i \to V_j\}_{\alpha(i) = j}$ is an fpqc
covering of $V_j$. Then the pullback functor
$$
\text{descent data relative to }
\mathcal{V}
\longrightarrow
\text{descent data relative to }
\mathcal{U}
$$
of Lemma \ref{lemma-pullback-family} is fully faithful.
\end{lemma}

\begin{proof}
Consider the morphism of schemes
$$
g :
X = \coprod\nolimits_{i \in I} U_i
\longrightarrow
Y = \coprod\nolimits_{j \in J} V_j
$$
over $S$ which on the $i$th component maps into the $\alpha(i)$th component
via the morphism $g_{\alpha(i)}$. We claim that $\{g : X \to Y\}$
is an fpqc covering of schemes. Namely, by
Topologies, Lemma \ref{topologies-lemma-disjoint-union-is-fpqc-covering}
for each $j$ the morphism $\{\coprod_{\alpha(i) = j} U_i \to V_j\}$ is an
fpqc covering. Thus for every affine open $V \subset V_j$
(which we may think of as an affine open of $Y$)
we can find finitely many affine opens
$W_1, \ldots, W_n \subset \coprod_{\alpha(i) = j} U_i$
(which we may think of as affine opens of $X$)
such that $V = \bigcup_{i = 1, \ldots, n} g(W_i)$.
This provides enough affine opens of $Y$ which can be covered by finitely
many affine opens of $X$ so that
Topologies, Lemma \ref{topologies-lemma-recognize-fpqc-covering} part (3)
applies, and the claim follows. Let us write $DD(X/S)$,
resp.\ $DD(\mathcal{U})$ for the category of descent data with respect
to $X/S$, resp.\ $\mathcal{U}$, and similarly for $Y/S$ and $\mathcal{V}$.
Consider the diagram
$$
\xymatrix{
DD(Y/S) \ar[r] & DD(X/S) \\
DD(\mathcal{V}) \ar[u]^{\text{Lemma }\ref{lemma-family-is-one}} \ar[r] &
DD(\mathcal{U}) \ar[u]_{\text{Lemma }\ref{lemma-family-is-one}}
}
$$
This diagram is commutative, see the proof of
Lemma \ref{lemma-pullback-family}.
The vertical arrows are equivalences. Hence the lemma follows from
Lemma \ref{lemma-fully-faithful} which shows the top horizontal arrow
of the diagram is fully faithful.
\end{proof}

\noindent
The next lemma shows that, in order to check effectiveness,
we may always Zariski refine the given family of morphisms
with target $S$.

\begin{lemma}
\label{lemma-Zariski-refinement-coverings-equivalence}
Let $S$ be a scheme.
Let $\mathcal{U} = \{U_i \to S\}_{i \in I}$, and
$\mathcal{V} = \{V_j \to S\}_{j \in J}$,
be families of morphisms with target $S$.
Let $\alpha : I \to J$, $\text{id} : S \to S$ and
$g_i : U_i \to V_{\alpha(i)}$ be a morphism of families
of maps with fixed target, see
Sites, Definition \ref{sites-definition-morphism-coverings}.
Assume that for each $j \in J$ the family
$\{g_i : U_i \to V_j\}_{\alpha(i) = j}$ is a Zariski covering (see
Topologies, Definition \ref{topologies-definition-zariski-covering})
of $V_j$. Then the pullback functor
$$
\text{descent data relative to }
\mathcal{V}
\longrightarrow
\text{descent data relative to }
\mathcal{U}
$$
of Lemma \ref{lemma-pullback-family} is an equivalence of categories.
In particular, the category of schemes over $S$
is equivalent to the category
of descent data relative to any Zariski covering of $S$.
\end{lemma}

\begin{proof}
The functor is faithful and fully faithful by
Lemma \ref{lemma-fpqc-refinement-coverings-fully-faithful}.
Let us indicate how to prove that it is essentially surjective.
Let $(X_i, \varphi_{ii'})$ be a descent datum relative to $\mathcal{U}$.
Fix $j \in J$ and set $I_j = \{i \in I \mid \alpha(i) = j\}$.
For $i, i' \in I_j$ note that there is a canonical morphism
$$
c_{ii'} : U_i \times_{g_i, V_j, g_{i'}} U_{i'} \to U_i \times_S U_{i'}.
$$
Hence we can pullback $\varphi_{ii'}$ by this morphism
and set $\psi_{ii'} = c_{ii'}^*\varphi_{ii'}$ for $i, i' \in I_j$.
In this way we obtain a descent datum $(X_i, \psi_{ii'})$
relative to the Zariski covering
$\{g_i : U_i \to V_j\}_{i \in I_j}$.
Note that $\psi_{ii'}$ is an isomorphism from the open
$X_{i, U_i \times_{V_j} U_{i'}}$ of $X_i$ to the corresponding
open of $X_{i'}$. It follows from
Schemes, Section \ref{schemes-section-glueing-schemes}
that we may glue $(X_i, \psi_{ii'})$ into a scheme
$Y_j$ over $V_j$. Moreover, the morphisms $\varphi_{ii'}$
for $i \in I_j$ and $i' \in I_{j'}$ glue to a morphism
$\varphi_{jj'} : Y_j \times_S V_{j'} \to V_j \times_S Y_{j'}$
satisfying the cocycle condition (details omitted).
Hence we obtain the desired descent datum
$(Y_j, \varphi_{jj'})$ relative to $\mathcal{V}$.
\end{proof}

\begin{lemma}
\label{lemma-refine-coverings-fully-faithful}
Let $S$ be a scheme.
Let $\mathcal{U} = \{U_i \to S\}_{i \in I}$, and
$\mathcal{V} = \{V_j \to S\}_{j \in J}$,
be fpqc-coverings of $S$.
If $\mathcal{U}$ is a refinement of $\mathcal{V}$,
then the pullback functor
$$
\text{descent data relative to }
\mathcal{V}
\longrightarrow
\text{descent data relative to }
\mathcal{U}
$$
is fully faithful.
In particular, the category of schemes over $S$
is identified with a full subcategory of the category
of descent data relative to any fpqc-covering of $S$.
\end{lemma}

\begin{proof}
Consider the fpqc-covering
$\mathcal{W} = \{U_i \times_S V_j \to S\}_{(i, j) \in I \times J}$ of $S$.
It is a refinement of both $\mathcal{U}$ and $\mathcal{V}$.
Hence we have a $2$-commutative diagram of functors and categories
$$
\xymatrix{
DD(\mathcal{V}) \ar[rd] \ar[rr] & & DD(\mathcal{U}) \ar[ld] \\
& DD(\mathcal{W}) &
}
$$
Notation as in the proof of
Lemma \ref{lemma-fpqc-refinement-coverings-fully-faithful} and
commutativity by Lemma \ref{lemma-pullback-family} part (3).
Hence clearly it suffices to prove the functors
$DD(\mathcal{V}) \to DD(\mathcal{W})$ and
$DD(\mathcal{U}) \to DD(\mathcal{W})$ are fully faithful.
This follows from
Lemma \ref{lemma-fpqc-refinement-coverings-fully-faithful}
as desired.
\end{proof}

\begin{remark}
\label{remark-morphisms-of-schemes-satisfy-fpqc-descent}
Lemma \ref{lemma-refine-coverings-fully-faithful}
says that morphisms of schemes satisfy fpqc descent.
In other words, given a scheme $S$ and schemes $X$, $Y$ over $S$
the functor
$$
(\Sch/S)^{opp} \longrightarrow \textit{Sets},
\quad
T \longmapsto \Mor_T(X_T, Y_T)
$$
satisfies the sheaf condition for the fpqc topology.
The simplest case of this is the following. Suppose that $T \to S$
is a surjective flat morphism of affines. Let $\psi_0 : X_T \to Y_T$
be a morphism of schemes over $T$ which is compatible with the
canonical descent data. Then there exists a unique morphism
$\psi : X \to Y$ whose base change to $T$ is $\psi_0$. In fact this
special case follows in a straightforward manner from
Lemma \ref{lemma-fully-faithful}.
And, in turn, that lemma is a formal consequence of the following
two facts:
(a) the base change functor by a faithfully flat morphism is faithful, see
Lemma \ref{lemma-ff-base-change-faithful}
and (b) a scheme satisfies the sheaf condition for the fpqc topology, see
Lemma \ref{lemma-fpqc-universal-effective-epimorphisms}.
\end{remark}

\begin{lemma}
\label{lemma-effective-for-fpqc-is-local-upstairs}
Let $X \to S$ be a surjective, quasi-compact, flat morphism of
schemes. Let $(V, \varphi)$ be a descent datum relative to $X/S$.
Suppose that for all $v \in V$ there exists an open subscheme
$v \in W \subset V$ such that $\varphi(W \times_S X) \subset X \times_S W$
and such that the descent datum $(W, \varphi|_{W \times_S X})$
is effective. Then $(V, \varphi)$ is effective.
\end{lemma}

\begin{proof}
Let $V = \bigcup W_i$ be an open covering with
$\varphi(W_i \times_S X) \subset X \times_S W_i$
and such that the descent datum $(W_i, \varphi|_{W_i \times_S X})$
is effective. Let $U_i \to S$ be a scheme and let
$\alpha_i : (X \times_S U_i, can) \to (W_i, \varphi|_{W_i \times_S X})$
be an isomorphism of descent data. For each pair of indices
$(i, j)$ consider the open
$\alpha_i^{-1}(W_i \cap W_j) \subset X \times_S U_i$.
Because everything is compatible with descent data
and since $\{X \to S\}$ is an fpqc covering, we
may apply Lemma \ref{lemma-open-fpqc-covering}
to find an open $V_{ij} \subset V_j$ such that
$\alpha_i^{-1}(W_i \cap W_j) = X \times_S V_{ij}$.
Now the identity morphism on $W_i \cap W_j$ is
compatible with descent data, hence comes from a
unique morphism $\varphi_{ij} : U_{ij} \to U_{ji}$ over $S$
(see Remark \ref{remark-morphisms-of-schemes-satisfy-fpqc-descent}).
Then $(U_i, U_{ij}, \varphi_{ij})$ is a glueing
data as in Schemes, Section \ref{schemes-section-glueing-schemes}
(proof omitted). Thus we may assume there is a scheme $U$ over $S$
such that $U_i \subset U$ is open, $U_{ij} = U_i \cap U_j$ and
$\varphi_{ij} = \text{id}_{U_i \cap U_j}$, see
Schemes, Lemma \ref{schemes-lemma-glue}.
Pulling back to $X$ we can use the $\alpha_i$ to
get the desired isomorphism $\alpha : X \times_S U \to V$.
\end{proof}







\section{Descending types of morphisms}
\label{section-descending-types-morphisms}

\noindent
In the following we study the question as to whether
descent data for schemes relative to a fpqc-covering
are effective. The first remark to make is that this
is not always the case. We will see this in Algebraic
Spaces, Example \ref{spaces-example-non-representable-descent}.
Even projective morphisms do not always satisfy descent
for fpqc-coverings, by Examples,
Lemma \ref{examples-lemma-non-effective-descent-projective}.

\medskip\noindent
On the other hand, if the schemes we are trying to
descend are particularly simple, then it is sometime the
case that for whole classes of schemes descent data
are effective. We will introduce terminology here that
describes this phenomenon abstractly, even though it
may lead to confusion if not used correctly later on.

\begin{definition}
\label{definition-descending-types-morphisms}
Let $\mathcal{P}$ be a property of morphisms of schemes over a base.
Let $\tau \in \{Zariski, fpqc, fppf, \etale, smooth, syntomic\}$.
We say
{\it morphisms of type $\mathcal{P}$ satisfy descent for $\tau$-coverings}
if for
any $\tau$-covering $\mathcal{U} : \{U_i \to S\}_{i \in I}$
(see Topologies, Section \ref{topologies-section-procedure}),
any descent datum $(X_i, \varphi_{ij})$ relative to $\mathcal{U}$
such that each morphism $X_i \to U_i$ has property $\mathcal{P}$
is effective.
\end{definition}

\noindent
Note that in each of the cases we have already seen that
the functor from schemes over $S$ to descent data over
$\mathcal{U}$ is fully faithful
(Lemma \ref{lemma-refine-coverings-fully-faithful} combined
with the results in Topologies that any $\tau$-covering
is also a fpqc-covering).
We have also seen that descent data are always effective with
respect to Zariski coverings
(Lemma \ref{lemma-Zariski-refinement-coverings-equivalence}).
It may be prudent to only study the notion just introduced
when $\mathcal{P}$ is either stable under any base change or at least
local on the base in the $\tau$-topology
(see Definition \ref{definition-property-morphisms-local})
in order to avoid erroneous arguments (relying on $\mathcal{P}$
when descending halfway).

\medskip\noindent
Here is the obligatory lemma reducing this question
to the case of a covering given by a single morphism of affines.

\begin{lemma}
\label{lemma-descending-types-morphisms}
Let $\mathcal{P}$ be a property of morphisms of schemes over a base.
Let $\tau \in \{fpqc, fppf, \etale, smooth, syntomic\}$.
Suppose that
\begin{enumerate}
\item $\mathcal{P}$ is stable under any base change
(see Schemes, Definition \ref{schemes-definition-preserved-by-base-change}),
and
\item for any surjective morphism of affines
$X \to S$ which is flat, flat of finite presentation,
\'etale, smooth or syntomic depending on whether $\tau$ is
fpqc, fppf, \'etale, smooth, or syntomic,
any descent datum $(V, \varphi)$ relative
to $X$ over $S$ such that $\mathcal{P}$ holds for
$V \to X$ is effective.
\end{enumerate}
Then morphisms of type $\mathcal{P}$ satisfy descent for $\tau$-coverings.
\end{lemma}

\begin{proof}
Let $S$ be a scheme.
Let $\mathcal{U} = \{\varphi_i : U_i \to S\}_{i \in I}$
be a $\tau$-covering of $S$.
Let $(X_i, \varphi_{ii'})$ be a descent datum relative to
$\mathcal{U}$ and assume that each morphism $X_i \to U_i$ has property
$\mathcal{P}$. We have to show there exists a scheme $X \to S$ such that
$(X_i, \varphi_{ii'}) \cong (U_i \times_S X, can)$.

\medskip\noindent
Before we start the proof proper we remark that for any
family of morphisms $\mathcal{V} : \{V_j \to S\}$ and any
morphism of families $\mathcal{V} \to \mathcal{U}$, if we pullback
the descent datum $(X_i, \varphi_{ii'})$ to a descent datum
$(Y_j, \varphi_{jj'})$ over $\mathcal{V}$, then each of the
morphisms $Y_j \to V_j$ has property $\mathcal{P}$ also.
This is true because we assumed that $\mathcal{P}$ is stable
under any base change and the definition of pullback
(see Definition \ref{definition-pullback-functor-family}).
We will use this without further mention.

\medskip\noindent
First, let us prove the lemma when $S$ is affine.
By Topologies, Lemma
\ref{topologies-lemma-fpqc-affine},
\ref{topologies-lemma-fppf-affine},
\ref{topologies-lemma-etale-affine},
\ref{topologies-lemma-smooth-affine}, or
\ref{topologies-lemma-syntomic-affine}
there exists a standard $\tau$-covering
$\mathcal{V} : \{V_j \to S\}_{j = 1, \ldots, m}$
which refines $\mathcal{U}$. The pullback functor
$DD(\mathcal{U}) \to DD(\mathcal{V})$
between categories of descent data is fully faithful
by Lemma \ref{lemma-refine-coverings-fully-faithful}.
Hence it suffices to prove that the descent datum over
the standard $\tau$-covering $\mathcal{V}$ is effective.
By Lemma \ref{lemma-family-is-one} this reduces to the covering
$\{\coprod_{j = 1, \ldots, m} V_j \to S\}$ for which we have
assumed the result in property (2) of the lemma.
Hence the lemma holds when $S$ is affine.

\medskip\noindent
Assume $S$ is general. Let $V \subset S$ be an affine open.
By the properties of site the family
$\mathcal{U}_V = \{V \times_S U_i \to V\}_{i \in I}$ is a
$\tau$-covering of $V$. Denote
$(X_i, \varphi_{ii'})_V$ the restriction (or pullback) of
the given descent datum to $\mathcal{U}_V$.
Hence by what we just saw we obtain a scheme $X_V$ over $V$
whose canonical descent datum with respect to
$\mathcal{U}_V$ is isomorphic to $(X_i, \varphi_{ii'})_V$.
Suppose that $V' \subset V$ is an affine open of $V$.
Then both $X_{V'}$ and $V' \times_V X_V$ have canonical
descent data isomorphic to $(X_i, \varphi_{ii'})_{V'}$.
Hence, by Lemma \ref{lemma-refine-coverings-fully-faithful}
again we obtain a canonical morphism
$\rho^V_{V'} : X_{V'} \to X_V$ over $S$ which identifies
$X_{V'}$ with the inverse image of $V'$ in $X_V$.
We omit the verification that given affine opens
$V'' \subset V' \subset V$ of $S$ we have
$\rho^V_{V''} = \rho^V_{V'} \circ \rho^{V'}_{V''}$.

\medskip\noindent
By Constructions, Lemma \ref{constructions-lemma-relative-glueing} the data
$(X_V, \rho^V_{V'})$ glue to a scheme $X \to S$.
Moreover, we are given isomorphisms $V \times_S X \to X_V$
which recover the maps $\rho^V_{V'}$. Unwinding the construction
of the schemes $X_V$ we obtain isomorphisms
$$
V \times_S U_i \times_S X
\longrightarrow
V \times_S X_i
$$
compatible with the maps $\varphi_{ii'}$ and compatible with
restricting to smaller affine opens in $X$. This implies that
the canonical descent datum on $U_i \times_S X$ is isomorphic
to the given descent datum and we win.
\end{proof}










\section{Descending affine morphisms}
\label{section-affine}

\noindent
In this section we show that
``affine morphisms satisfy descent for fpqc-coverings''.
Here is the formal statement.

\begin{lemma}
\label{lemma-affine}
Let $S$ be a scheme.
Let $\{X_i \to S\}_{i\in I}$ be an fpqc covering, see
Topologies, Definition \ref{topologies-definition-fpqc-covering}.
Let $(V_i/X_i, \varphi_{ij})$ be a descent datum
relative to $\{X_i \to S\}$. If each morphism
$V_i \to X_i$ is affine, then the descent datum is
effective.
\end{lemma}

\begin{proof}
Being affine is a property of morphisms of schemes
which is preserved under any base change, see
Morphisms, Lemma \ref{morphisms-lemma-base-change-affine}.
Hence Lemma \ref{lemma-descending-types-morphisms} applies
and it suffices to prove the statement of the lemma
in case the fpqc-covering is given by a single
$\{X \to S\}$ flat surjective morphism of affines.
Say $X = \Spec(A)$ and $S = \Spec(R)$ so
that $R \to A$ is a faithfully flat ring map.
Let $(V, \varphi)$ be a descent datum relative to $X$ over $S$
and assume that $V \to X$ is affine.
Then $V \to X$ being affine implies that $V = \Spec(B)$
for some $A$-algebra $B$ (see
Morphisms, Definition \ref{morphisms-definition-affine}).
The isomorphism $\varphi$ corresponds to an isomorphism
of rings
$$
\varphi^\sharp :
B \otimes_R A \longleftarrow A \otimes_R B
$$
as $A \otimes_R A$-algebras. The cocycle condition on $\varphi$
says that
$$
\xymatrix{
B \otimes_R A \otimes_R A & &
A \otimes_R A \otimes_R B \ar[ll] \ar[ld]\\
& A \otimes_R B \otimes_R A \ar[lu] &
}
$$
is commutative. Inverting these arrows we see that we have a
descent datum for modules with respect to $R \to A$ as in
Definition \ref{definition-descent-datum-modules}.
Hence we may apply Proposition \ref{proposition-descent-module}
to obtain an $R$-module
$C = \Ker(B \to A \otimes_R B)$
and an isomorphism $A \otimes_R C \cong B$
respecting descent data. Given any pair $c, c' \in C$
the product $cc'$ in $B$ lies in $C$ since the
map $\varphi$ is an algebra homomorphism. Hence
$C$ is an $R$-algebra whose base change to $A$ is
isomorphic to $B$ compatibly with descent data.
Applying $\Spec$ we obtain a scheme
$U$ over $S$ such that $(V, \varphi) \cong (X \times_S U, can)$
as desired.
\end{proof}

\begin{lemma}
\label{lemma-closed-immersion}
Let $S$ be a scheme.
Let $\{X_i \to S\}_{i\in I}$ be an fpqc covering, see
Topologies, Definition \ref{topologies-definition-fpqc-covering}.
Let $(V_i/X_i, \varphi_{ij})$ be a descent datum
relative to $\{X_i \to S\}$. If each morphism
$V_i \to X_i$ is a closed immersion, then the descent datum is
effective.
\end{lemma}

\begin{proof}
This is true because a closed immersion is an affine morphism
(Morphisms, Lemma \ref{morphisms-lemma-closed-immersion-affine}),
and hence Lemma \ref{lemma-affine} applies.
\end{proof}


\section{Descending quasi-affine morphisms}
\label{section-quasi-affine}

\noindent
In this section we show that
``quasi-affine morphisms satisfy descent for fpqc-coverings''.
Here is the formal statement.

\begin{lemma}
\label{lemma-quasi-affine}
Let $S$ be a scheme.
Let $\{X_i \to S\}_{i\in I}$ be an fpqc covering, see
Topologies, Definition \ref{topologies-definition-fpqc-covering}.
Let $(V_i/X_i, \varphi_{ij})$ be a descent datum
relative to $\{X_i \to S\}$. If each morphism
$V_i \to X_i$ is quasi-affine, then the descent datum is
effective.
\end{lemma}

\begin{proof}
Being quasi-affine is a property of morphisms of schemes
which is preserved under any base change, see
Morphisms, Lemma \ref{morphisms-lemma-base-change-quasi-affine}.
Hence Lemma \ref{lemma-descending-types-morphisms} applies
and it suffices to prove the statement of the lemma
in case the fpqc-covering is given by a single
$\{X \to S\}$ flat surjective morphism of affines.
Say $X = \Spec(A)$ and $S = \Spec(R)$ so
that $R \to A$ is a faithfully flat ring map.
Let $(V, \varphi)$ be a descent datum relative to $X$ over $S$
and assume that $\pi : V \to X$ is quasi-affine.

\medskip\noindent
According to Morphisms, Lemma \ref{morphisms-lemma-characterize-quasi-affine}
this means that
$$
V \longrightarrow \underline{\Spec}_X(\pi_*\mathcal{O}_V) = W
$$
is a quasi-compact open immersion of schemes over $X$.
The projections $\text{pr}_i : X \times_S X \to X$ are flat
and hence we have
$$
\text{pr}_0^*\pi_*\mathcal{O}_V =
(\pi \times \text{id}_X)_*\mathcal{O}_{V \times_S X}, \quad
\text{pr}_1^*\pi_*\mathcal{O}_V =
(\text{id}_X \times \pi)_*\mathcal{O}_{X \times_S V}
$$
by flat base change
(Cohomology of Schemes, Lemma \ref{coherent-lemma-flat-base-change-cohomology}).
Thus the isomorphism $\varphi : V \times_S X \to X \times_S V$ (which
is an isomorphism over $X \times_S X$) induces an isomorphism
of quasi-coherent sheaves of algebras
$$
\varphi^\sharp :
\text{pr}_0^*\pi_*\mathcal{O}_V
\longrightarrow
\text{pr}_1^*\pi_*\mathcal{O}_V
$$
on $X \times_S X$.
The cocycle condition for $\varphi$ implies the cocycle condition
for $\varphi^\sharp$. Another way to say this is that it produces
a descent datum $\varphi'$ on the affine scheme $W$ relative to
$X$ over $S$, which moreover has the property that the morphism
$V \to W$ is a morphism of descent data.
Hence by Lemma \ref{lemma-affine}
(or by effectivity of descent for quasi-coherent
algebras) we obtain a scheme $U' \to S$ with an isomorphism
$(W, \varphi') \cong (X \times_S U', can)$ of descent data.
We note in passing that $U'$ is affine by
Lemma \ref{lemma-descending-property-affine}.

\medskip\noindent
And now we can think of $V$ as a (quasi-compact)
open $V \subset X \times_S U'$ with the property that
it is stable under the descent datum
$$
can : X \times_S U' \times_S X \to X \times_S X \times_S U',
(x_0, u', x_1) \mapsto (x_0, x_1, u').
$$
In other words $(x_0, u') \in V \Rightarrow (x_1, u') \in V$
for any $x_0, x_1, u'$ mapping to the same point of $S$.
Because $X \to S$ is surjective we immediately find that
$V$ is the inverse image of a subset $U \subset U'$ under
the morphism $X \times_S U' \to U'$.
Because $X \to S$ is quasi-compact, flat and surjective
also $X \times_S U' \to U'$ is quasi-compact flat and surjective.
Hence by Morphisms, Lemma \ref{morphisms-lemma-fpqc-quotient-topology}
this subset $U \subset U'$ is open and we win.
\end{proof}












\section{Descent data in terms of sheaves}
\label{section-descent-data-sheaves}


\noindent
Here is another way to think about descent data
in case of a covering on a site.

\begin{lemma}
\label{lemma-descent-data-sheaves}
Let $\tau \in \{Zariski, fppf, \etale, smooth, syntomic\}$\footnote{The
fact that fpqc is missing is not a typo. See discussion
in Topologies, Section \ref{topologies-section-fpqc}.}.
Let $\Sch_\tau$ be a big $\tau$-site.
Let $S \in \Ob(\Sch_\tau)$.
Let $\{S_i \to S\}_{i \in I}$ be a covering in the
site $(\Sch/S)_\tau$. There is an equivalence of
categories
$$
\left\{
\begin{matrix}
\text{descent data }(X_i, \varphi_{ii'})\text{ such that}\\
\text{each }X_i \in \Ob((\Sch/S)_\tau)
\end{matrix}
\right\}
\leftrightarrow
\left\{
\begin{matrix}
\text{sheaves }F\text{ on }(\Sch/S)_\tau\text{ such that}\\
\text{each }h_{S_i} \times F\text{ is representable}
\end{matrix}
\right\}.
$$
Moreover,
\begin{enumerate}
\item the objects representing $h_{S_i} \times F$ on the right hand side
correspond to the schemes $X_i$ on the left hand side, and
\item the sheaf $F$ is representable if and only if the
corresponding descent datum $(X_i, \varphi_{ii'})$ is effective.
\end{enumerate}
\end{lemma}

\begin{proof}
We have seen in Section \ref{section-fpqc-universal-effective-epimorphisms}
that representable presheaves are sheaves on the site $(\Sch/S)_\tau$.
Moreover, the Yoneda lemma (Categories, Lemma \ref{categories-lemma-yoneda})
guarantees that maps between representable
sheaves correspond one to one with maps between the representing objects.
We will use these remarks without further mention during the proof.

\medskip\noindent
Let us construct the functor from right to left.
Let $F$ be a sheaf on $(\Sch/S)_\tau$ such that each
$h_{S_i} \times F$ is representable. In this case let $X_i$
be a representing object in $(\Sch/S)_\tau$.
It comes equipped with a morphism $X_i \to S_i$.
Then both $X_i \times_S S_{i'}$ and $S_i \times_S X_{i'}$
represent the sheaf $h_{S_i} \times F \times h_{S_{i'}}$
and hence we obtain an isomorphism
$$
\varphi_{ii'} : X_i \times_S S_{i'} \to S_i \times_S X_{i'}
$$
It is straightforward to see that the maps $\varphi_{ii'}$
are morphisms over $S_i \times_S S_{i'}$ and satisfy the
cocycle condition. The functor from right to left is given
by this construction $F \mapsto (X_i, \varphi_{ii'})$.

\medskip\noindent
Let us construct a functor from left to right.
For each $i$ denote $F_i$ the sheaf $h_{X_i}$.
The isomorphisms $\varphi_{ii'}$ give isomorphisms
$$
\varphi_{ii'} :
F_i \times h_{S_{i'}}
\longrightarrow
h_{S_i} \times F_{i'}
$$
over $h_{S_i} \times h_{S_{i'}}$.
Set $F$ equal to the coequalizer in the following diagram
$$
\xymatrix{
\coprod_{i, i'} F_i \times h_{S_{i'}}
\ar@<1ex>[rr]^-{\text{pr}_0}
\ar@<-1ex>[rr]_-{\text{pr}_1 \circ \varphi_{ii'}}
& &
\coprod_i F_i \ar[r]
&
F
}
$$
The cocycle condition guarantees that $h_{S_i} \times F$ is
isomorphic to $F_i$ and hence representable.
The functor from left to right is given
by this construction $(X_i, \varphi_{ii'}) \mapsto F$.

\medskip\noindent
We omit the verification that these constructions
are mutually quasi-inverse functors. The final statements
(1) and (2) follow from the constructions.
\end{proof}

\begin{remark}
\label{remark-what-product-means}
In the statement of Lemma \ref{lemma-descent-data-sheaves} the condition that
$h_{S_i} \times F$ is representable is equivalent to
the condition that the restriction of $F$ to
$(\Sch/S_i)_\tau$ is representable.
\end{remark}
















\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}


\end{document}
