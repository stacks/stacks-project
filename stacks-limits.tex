\input{preamble}

% OK, start here.
%
\begin{document}

\title{Limits of Algebraic Stacks}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
In this chapter we put material related to limits of algebraic stacks.
Many results on limits of algebraic stacks and algebraic spaces
have been obtained by David Rydh in \cite{rydh_approx}.


\section{Conventions}
\label{section-conventions}

\noindent
We continue to use the conventions and the abuse of language
introduced in
Properties of Stacks, Section \ref{stacks-properties-section-conventions}.







\section{Morphisms of finite presentation}
\label{section-finite-presentation}

\noindent
This section is the analogue of Limits of Spaces, Section
\ref{spaces-limits-section-finite-presentation}.
There we defined what it means for a transformation of functors
on $\Sch$ to be limit preserving (we suggest looking at the
characterization in Limits of Spaces, Lemma
\ref{spaces-limits-lemma-characterize-relative-limit-preserving}).
In Criteria for Representability, Section
\ref{criteria-section-limit-preserving}
we defined the notion ``limit preserving on objects''.
Recall that in Artin's Axioms, Section \ref{artin-section-limits}
we have defined what it means for a category fibred in groupoids
over $\Sch$ to be limit preserving. Combining these we get
the following notion.

\begin{definition}
\label{definition-limit-preserving}
Let $S$ be a scheme. Let $f : \mathcal{X} \to \mathcal{Y}$ be a
$1$-morphism of categories fibred in groupoids over $(\Sch/S)_{fppf}$.
We say $f$ is {\it limit preserving} if for every directed limit
$U = \lim U_i$ of affine schemes over $S$ the diagram
$$
\xymatrix{
\colim \mathcal{X}_{U_i} \ar[r] \ar[d]_f & \mathcal{X}_U \ar[d]^f \\
\colim \mathcal{Y}_{U_i} \ar[r] & \mathcal{Y}_U
}
$$
of fibre categories is $2$-cartesian.
\end{definition}

\begin{lemma}
\label{lemma-limit-preserving-objects}
Let $S$ be a scheme. Let $f : \mathcal{X} \to \mathcal{Y}$ be a
$1$-morphism of categories fibred in groupoids over $(\Sch/S)_{fppf}$.
If $f$ is limit preserving (Definition \ref{definition-limit-preserving}),
then $f$ is limit preserving on objects (Criteria for Representability, Section
\ref{criteria-section-limit-preserving}).
\end{lemma}

\begin{proof}
If for every directed limit $U = \lim U_i$ of affine schemes over $U$,
the functor
$$
\colim \mathcal{X}_{U_i} \longrightarrow
(\colim \mathcal{Y}_{U_i}) \times_{\mathcal{Y}_U} \mathcal{X}_U
$$
is essentially surjective, then $f$ is limit preserving on objects.
\end{proof}

\begin{lemma}
\label{lemma-base-change-limit-preserving}
Let $p : \mathcal{X} \to \mathcal{Y}$ and $q : \mathcal{Z} \to \mathcal{Y}$
be $1$-morphisms of categories fibred in groupoids over $(\Sch/S)_{fppf}$.
If $p : \mathcal{X} \to \mathcal{Y}$ is limit preserving, then so
is the base change
$p' : \mathcal{X} \times_\mathcal{Y} \mathcal{Z} \to \mathcal{Z}$
of $p$ by $q$.
\end{lemma}

\begin{proof}
This is formal. Let $U = \lim_{i \in I} U_i$ be the directed limit
of affine schemes $U_i$ over $S$. For each $i$ we have
$$
(\mathcal{X} \times_\mathcal{Y} \mathcal{Z})_{U_i} =
\mathcal{X}_{U_i} \times_{\mathcal{Y}_{U_i}} \mathcal{Z}_{U_i}
$$
Filtered colimits commute with $2$-fibre products of categories
(details omitted) hence if $p$ is limit preserving we get
\begin{align*}
\colim (\mathcal{X} \times_\mathcal{Y} \mathcal{Z})_{U_i}
& =
\colim \mathcal{X}_{U_i} \times_{\colim \mathcal{Y}_{U_i}}
\colim \mathcal{Z}_{U_i} \\
& =
\mathcal{X}_U \times_{\mathcal{Y}_U} \colim \mathcal{Y}_{U_i}
\times_{\colim \mathcal{Y}_{U_i}}
\colim \mathcal{Z}_{U_i} \\
& =
\mathcal{X}_U \times_{\mathcal{Y}_U} \colim \mathcal{Z}_{U_i} \\
& =
\mathcal{X}_U \times_{\mathcal{Y}_U} \mathcal{Z}_U \times_{\mathcal{Z}_U}
\colim \mathcal{Z}_{U_i} \\
& =
(\mathcal{X} \times_\mathcal{Y} \mathcal{Z})_U \times_{\mathcal{Z}_U}
\colim \mathcal{Z}_{U_i}
\end{align*}
as desired.
\end{proof}

\begin{lemma}
\label{lemma-composition-limit-preserving}
Let $p : \mathcal{X} \to \mathcal{Y}$ and $q : \mathcal{Y} \to \mathcal{Z}$
be $1$-morphisms of categories fibred in groupoids over $(\Sch/S)_{fppf}$.
If $p$ and $q$ are limit preserving, then so is the composition $q \circ p$.
\end{lemma}

\begin{proof}
This is formal. Let $U = \lim_{i \in I} U_i$ be the directed limit
of affine schemes $U_i$ over $S$. If $p$ and $q$ are limit preserving we get
\begin{align*}
\colim \mathcal{X}_{U_i}
& =
\mathcal{X}_U \times_{\mathcal{Y}_U} \colim \mathcal{Y}_{U_i} \\
& =
\mathcal{X}_U \times_{\mathcal{Y}_U} \mathcal{Y}_U
\times_{\mathcal{Z}_U} \colim \mathcal{Z}_{U_i} \\
& =
\mathcal{X}_U \times_{\mathcal{Z}_U} \colim \mathcal{Z}_{U_i}
\end{align*}
as desired.
\end{proof}

\begin{lemma}
\label{lemma-representable-by-spaces-limit-preserving}
Let $p : \mathcal{X} \to \mathcal{Y}$ be a $1$-morphism of categories
fibred in groupoids over $(\Sch/S)_{fppf}$. If $p$ is
representable by algebraic spaces, then the following are equivalent:
\begin{enumerate}
\item $p$ is limit preserving,
\item $p$ is limit preserving on objects, and
\item $p$ is locally of finite presentation (see
Algebraic Stacks,
Definition \ref{algebraic-definition-relative-representable-property}).
\end{enumerate}
\end{lemma}

\begin{proof}
In Criteria for Representability, Lemma
\ref{criteria-lemma-representable-by-spaces-limit-preserving}
we have seen that (2) and (3) are equivalent.
Thus it suffices to show that (1) and (2) are equivalent.
One direction we saw in Lemma \ref{lemma-limit-preserving-objects}.
For the other direction, let $U = \lim_{i \in I} U_i$ be the directed limit
of affine schemes $U_i$ over $S$. We have to show that
$$
\colim \mathcal{X}_{U_i} \longrightarrow
\mathcal{X}_U \times_{\mathcal{Y}_U} \colim \mathcal{Y}_{U_i}
$$
is an equivalence. Since we are assuming (2) we know that it is essentially
surjective. Hence we need to prove it is fully faithful.
Since $p$ is faithful on fibre categories
(Algebraic Stacks, Lemma
\ref{algebraic-lemma-criterion-map-representable-spaces-fibred-in-groupoids})
we see that the functor is faithful. Let $x_i$ and $x'_i$ be objects
in the fibre category of $\mathcal{X}$ over $U_i$.
The functor above sends $x_i$ to $(x_i|_U, p(x_i), can)$ where
$can$ is the canonical isomorphism $p(x_i|_U) \to p(x_i)|_U$.
Thus we assume given a morphism
$$
(\alpha, \beta_i) : (x_i|_U, p(x_i), can) \longrightarrow
(x'_i|_U, p(x'_i), can)
$$
in the category of the right hand side of the first displayed arrow
of this proof. Our task is to produce an $i' \geq i$ and a morphism
$x_i|_{U_{i'}} \to x'_i|_{U_{i'}}$ which maps to
$(\alpha, \beta_i|_{U_{i'}})$.

\medskip\noindent
Set $y_i = p(x_i)$ and $y'_i = p(x'_i)$.
By (Algebraic Stacks, Lemma
\ref{algebraic-lemma-criterion-map-representable-spaces-fibred-in-groupoids})
the functor
$$
X_{y_i} : (\Sch/U_i)^{opp} \to \textit{Sets},\quad
V/U_i \mapsto
\{(x, \phi) \mid x \in \Ob(\mathcal{X}_V), \phi : f(x) \to y_i|V\}/\cong
$$
is an algebraic space over $U_i$ and the same is true for the
analogously defined functor $X_{y'_i}$. Since (2) is equivalent to (3)
we see that $X_{y'_i}$ is locally of finite presentation over $U_i$.
Observe that $(x_i, \text{id})$ and $(x'_i, \text{id})$ define
$U_i$-valued points of $X_{y_i}$ and $X_{y'_i}$.
There is a transformation of functors
$$
\beta_i : X_{y_i} \to X_{y'_i},\quad
(x/V, \phi) \mapsto (x/V, \beta_i|_V \circ \phi)
$$
in other words, this is a morphism of algebraic spaces over $U_i$.
We claim that
$$
\xymatrix{
U \ar[d] \ar[rr] & & U_i \ar[d]^{(x'_i, \text{id})} \\
U_i \ar[r]^{(x_i, \text{id})} & X_{y_i} \ar[r]^{\beta_i} & X_{y'_i}
}
$$
commutes. Namely, this is equivalent to the condition that
the pairs $(x_i|_U, \beta_i|_U)$ and $(x'_i|_U, \text{id})$
as in the definition of the functor $X_{y'_i}$ are isomorphic.
And the morphism $\alpha : x_i|_U \to x'_i|_U$ exactly produces
such an isomorphism. Arguing backwards the reader sees that
if we can find an $i' \geq i$ such that the diagram
$$
\xymatrix{
U_{i'} \ar[d] \ar[rr] & & U_i \ar[d]^{(x'_i, \text{id})} \\
U_i \ar[r]^{(x_i, \text{id})} & X_{y_i} \ar[r]^{\beta_i} & X_{y'_i}
}
$$
commutes, then we obtain an isomorphism $x_i|_{U_{i'}} \to x'_i|_{U_{i'}}$
which is a solution to the problem posed in the preceding paragraph.
However, the diagonal morphism
$$
\Delta : X_{y'_i} \to X_{y'_i} \times_{U_i} X_{y'_i}
$$
is locally of finite presentation (Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-diagonal-morphism-finite-type})
hence the fact that $U \to U_i$ equalizes the two morphisms to $X_{y'_i}$,
means that for some $i' \geq i$ the morphism $U_{i'} \to U_i$
equalizes the two morphisms, see
Limits of Spaces, Proposition
\ref{spaces-limits-proposition-characterize-locally-finite-presentation}.
\end{proof}

\begin{lemma}
\label{lemma-limit-preserving-diagonal}
Let $p : \mathcal{X} \to \mathcal{Y}$ be a $1$-morphism of categories
fibred in groupoids over $(\Sch/S)_{fppf}$. The following are equivalent
\begin{enumerate}
\item the diagonal
$\Delta : \mathcal{X} \to \mathcal{X} \times_\mathcal{Y} \mathcal{X}$
is limit preserving, and
\item for every directed limit $U = \lim U_i$ of affine schemes over $S$
the functor
$$
\colim \mathcal{X}_{U_i} \longrightarrow
\mathcal{X}_U \times_{\mathcal{Y}_U} \colim \mathcal{Y}_{U_i}
$$
is fully faithful.
\end{enumerate}
In particular, if $p$ is limit preserving, then $\Delta$ is too.
\end{lemma}

\begin{proof}
Let $U = \lim U_i$ be a directed limit of affine schemes over $S$.
We claim that the functor
$$
\colim \mathcal{X}_{U_i} \longrightarrow
\mathcal{X}_U \times_{\mathcal{Y}_U} \colim \mathcal{Y}_{U_i}
$$
is fully faithful if and only if the functor
$$
\colim \mathcal{X}_{U_i} \longrightarrow
\mathcal{X}_U \times_{(\mathcal{X} \times_\mathcal{Y} \mathcal{X})_U}
\colim (\mathcal{X} \times_\mathcal{Y} \mathcal{X})_{U_i}
$$
is an equivalence. This will prove the lemma.
Since
$(\mathcal{X} \times_\mathcal{Y} \mathcal{X})_U =
\mathcal{X}_U \times_{\mathcal{Y}_U} \mathcal{X}_U$
and
$(\mathcal{X} \times_\mathcal{Y} \mathcal{X})_{U_i} =
\mathcal{X}_{U_i} \times_{\mathcal{Y}_{U_i}} \mathcal{X}_{U_i}$
this is a purely category theoretic assertion which we discuss
in the next paragraph.

\medskip\noindent
Let $\mathcal{I}$ be a filtered index category.
Let $(\mathcal{C}_i)$ and $(\mathcal{D}_i)$ be systems
of groupoids over $\mathcal{I}$.
Let $p : (\mathcal{C}_i) \to (\mathcal{D}_i)$ be a map
of systems of groupoids over $\mathcal{I}$.
Suppose we have a functor $p : \mathcal{C} \to \mathcal{D}$
of groupoids and functors
$f : \colim \mathcal{C}_i \to \mathcal{C}$ and
$g : \colim \mathcal{D}_i \to \mathcal{D}$
fitting into a commutative diagram
$$
\xymatrix{
\colim \mathcal{C}_i \ar[d]_p \ar[r]_f & \mathcal{C} \ar[d]^p \\
\colim \mathcal{D}_i \ar[r]^g & \mathcal{D}
}
$$
Then we claim that
$$
A : \colim \mathcal{C}_i \longrightarrow
\mathcal{C} \times_\mathcal{D} \colim \mathcal{D}_i
$$
is fully faithful if and only if the functor
$$
B : \colim \mathcal{C}_i \longrightarrow
\mathcal{C}
\times_{\Delta, \mathcal{C} \times_\mathcal{D} \mathcal{C}, f \times_g f}
\colim (\mathcal{C}_i \times_{\mathcal{D}_i} \mathcal{C}_i)
$$
is an equivalence. Set $\mathcal{C}' = \colim \mathcal{C}_i$ and
$\mathcal{D}' = \colim \mathcal{D}_i$.
Since $2$-fibre products commute with filtered colimits we see that
$A$ and $B$ become the functors
$$
A' : \mathcal{C}' \to \mathcal{C} \times_\mathcal{D} \mathcal{D}'
\quad\text{and}\quad
B' : \mathcal{C}' \longrightarrow
\mathcal{C}
\times_{\Delta, \mathcal{C} \times_\mathcal{D} \mathcal{C}, f \times_g f}
(\mathcal{C}' \times_{\mathcal{D}'} \mathcal{C}')
$$
Thus it suffices to prove that if
$$
\xymatrix{
\mathcal{C}' \ar[d]_p \ar[r]_f & \mathcal{C} \ar[d]^p \\
\mathcal{D}' \ar[r]^g & \mathcal{D}
}
$$
is a commutative diagram of groupoids, then $A'$ is fully faithful
if and only if $B'$ is an equivalence. This follows from
Categories, Lemma \ref{categories-lemma-fully-faithful-diagonal-equivalence}
(with trivial, i.e., punctual, base category) because
$$
\mathcal{C}
\times_{\Delta, \mathcal{C} \times_\mathcal{D} \mathcal{C}, f \times_g f}
(\mathcal{C}' \times_{\mathcal{D}'} \mathcal{C}') =
\mathcal{C}'
\times_{A', \mathcal{C} \times_\mathcal{D} \mathcal{D}', A'}
\mathcal{C}'
$$
This finishes the proof.
\end{proof}

\begin{lemma}
\label{lemma-locally-finite-presentation-limit-preserving}
Let $S$ be a scheme. Let $\mathcal{X}$ be an algebraic stack
over $S$. If $\mathcal{X} \to S$ is locally of finite presentation,
then $\mathcal{X}$ is limit preserving in the sense of
Artin's Axioms, Definition \ref{artin-definition-limit-preserving}
(equivalently: the morphism $\mathcal{X} \to S$ is limit preserving).
\end{lemma}

\begin{proof}
Choose a surjective smooth morphism $U \to \mathcal{X}$ for some scheme $U$.
Then $U \to S$ is locally of finite presentation, see
Morphisms of Stacks, Section
\ref{stacks-morphisms-section-finite-presentation}.
By
We can write $\mathcal{X} = [U/R]$ for some smooth groupoid in
algebraic spaces $(U, R, s, t, c)$, see
Algebraic Stacks, Lemma \ref{algebraic-lemma-stack-presentation}.
Since $U$ is locally of finite presentation over $S$
it follows that the the algebraic space $R$ is
locally of finite presentation over $S$.
Recall that $[U/R]$ is the stack in groupoids over $(\Sch/S)_{fppf}$
obtained by stackyfying the category fibred in groupoids
whose fibre category over $T$ is the groupoid $(U(T), R(T), s, t, c)$.
Since $U$ and $R$ are limit preserving as functors
(Limits of Spaces, Proposition
\ref{spaces-limits-proposition-characterize-locally-finite-presentation})
this category fibred in groupoids is limit preserving.
Thus it suffices to show that fppf stackyfication preserves
the property of being limit preserving. This is true
(hint: use Limits of Spaces, Lemma
\ref{spaces-limits-lemma-limit-fppf-topology}).
However, we give a direct proof below using that in this
case we know what the stackyfication amounts to.

\medskip\noindent
Let $T = \lim T_\lambda$ be a directed limit of affine schemes over $S$.
We have to show that the functor
$$
\colim [U/R]_{T_\lambda} \longrightarrow [U/R]_T
$$
is an equivalence of categories. Let us show this functor is
essentially surjective. Let $x \in \Ob([U/R]_T)$. In
Groupoids in Spaces, Lemma \ref{spaces-groupoids-lemma-quotient-stack-objects}
the reader finds a description of the category $[U/R]_T$.
In particular $x$ corresponds to an fppf covering
$\{T_i \to T\}_{i \in I}$ and a $[U/R]$-descent datum
$(u_i, r_{ij})$ relative to this covering.
After refining this covering we may assume it is a standard
fppf covering of the affine scheme $T$.
By Limits of Spaces, Lemma
\ref{spaces-limits-lemma-limit-fppf-topology}
we may choose a $\lambda$ and a standard fppf covering
$\{T_{\lambda, i} \to T_\lambda\}_{i \in I}$ whose base change to $T$
is equal to $\{T_i \to T\}_{i \in I}$.
For each $i$, after increasing $\lambda$, we can find
a $u_{\lambda, i} : T_{\lambda, i} \to U$ whose composition
with $T_i \to T_{\lambda, i}$ is the given morphism $u_i$
(this is where we use that $U$ is limit preserving).
Similarly, for each $i, j$, after increasing $\lambda$, we can find
a $r_{\lambda, ij} : T_{\lambda, i} \times_{T_\lambda} T_{\lambda, j} \to R$
whose composition with $T_{ij} \to T_{\lambda, ij}$ is the given morphism
$r_{ij}$ (this is where we use that $R$ is limit preserving).
After increasing $\lambda$ we can further assume that
$$
s \circ r_{\lambda, ij} = u_{\lambda, i} \circ \text{pr}_0
\quad\text{and}\quad
t \circ r_{\lambda, ij} = u_{\lambda, j} \circ \text{pr}_1,
$$
and
$$
c \circ (r_{\lambda, jk} \circ \text{pr}_{12}, r_{\lambda, ij}
\circ \text{pr}_{01}) = r_{\lambda, ik} \circ \text{pr}_{02}.
$$
In other words, we may assume that $(u_{\lambda, i}, r_{\lambda, ij})$
is a $[U/R]$-descent datum relative to the covering
$\{T_{\lambda, i} \to T_\lambda\}_{i \in I}$.
Then we obtain a corresponding object of $[U/R]$ over $T_\lambda$
whose pullback to $T$ is isomorphic to $x$ as desired.
The proof of fully faithfulness works in exactly the same
way using the description of morphisms in
in the fibre categories of $[U/T]$ given in
Groupoids in Spaces, Lemma \ref{spaces-groupoids-lemma-quotient-stack-objects}.
\end{proof}

\begin{proposition}
\label{proposition-characterize-locally-finite-presentation}
\begin{reference}
This is a special case of \cite[Lemma 2.3.15]{Emerton-Gee}
\end{reference}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks.
The following are equivalent
\begin{enumerate}
\item $f$ is limit preserving,
\item $f$ is limit preserving on objects, and
\item $f$ is locally of finite presentation.
\end{enumerate}
\end{proposition}

\begin{proof}
Assume (3). Let $T = \lim T_i$ be a directed limit of affine schemes.
Consider the functor
$$
\colim \mathcal{X}_{T_i} \longrightarrow
\mathcal{X}_T \times_{\mathcal{Y}_T} \colim \mathcal{Y}_{T_i}
$$
Let $(x, y_i, \beta)$ be an object on the right hand side, i.e.,
$x \in \Ob(\mathcal{X}_T)$, $y_i \in \Ob(\mathcal{Y}_{T_i})$, and
$\beta : f(x) \to y_i|_T$ in $\mathcal{Y}_T$.
Then we can consider $(x, y_i, \beta)$ as an object of the
algebraic stack $\mathcal{X}_{y_i} = \mathcal{X} \times_{\mathcal{Y}, y_i} T_i$
over $T$. Since $\mathcal{X}_{y_i} \to T_i$ is locally of finite presentation
(as a base change of $f$) we see that it is limit preserving
by Lemma \ref{lemma-locally-finite-presentation-limit-preserving}.
This means that $(x, y_i, \beta)$ comes from an object over $T_{i'}$
for some $i' \geq i$ and unwinding the definitions we find that
$(x, y_i, \beta)$ is in the essential image of the displayed functor.
In other words, the displayed functor is essentially surjective.
Another formulation is that this means
$f$ is limit preserving on objects.
Now we apply this to the diagonal $\Delta$ of $f$. Namely,
by Morphisms of Stacks, Lemma
\ref{stacks-morphisms-lemma-diagonal-morphism-finite-type}
the morphism $\Delta$ is locally of finite presentation.
Thus the argument above shows that $\Delta$ is limit preserving on objects.
By Lemma \ref{lemma-representable-by-spaces-limit-preserving}
this implies that $\Delta$ is limit preserving.
By Lemma \ref{lemma-limit-preserving-diagonal}
we conclude that the displayed functor above is fully faithful.
Thus it is an equivalence (as we already proved essential surjectivity)
and we conclude that (1) holds.

\medskip\noindent
The implication (1) $\Rightarrow$ (2) is trivial. Assume (2).
Choose a scheme $V$ and a surjective smooth morphism $V \to \mathcal{Y}$.
By Criteria for Representability, Lemma
\ref{criteria-lemma-base-change-limit-preserving}
the base change $\mathcal{X} \times_\mathcal{Y} V \to V$
is limit preserving on objects.
Choose a scheme $U$ and a surjective smooth morphism
$U \to \mathcal{X} \times_\mathcal{Y} V$.
Since a smooth morphism is locally of finite presentation,
we see that $U \to \mathcal{X} \times_\mathcal{Y} V$ is
limit preserving (first part of the proof).
By Criteria for Representability, Lemma
\ref{criteria-lemma-composition-limit-preserving}
we find that the composition $U \to V$ is limit preserving
on objects. We conclude that $U \to V$ is locally of finite presentation, see
Criteria for Representability, Lemma
\ref{criteria-lemma-representable-by-spaces-limit-preserving}.
This is exactly the condition that $f$ is locally of finite presentation, see
Morphisms of Stacks, Definition
\ref{stacks-morphisms-definition-locally-finite-presentation}.
\end{proof}







\section{Descending relative objects}
\label{section-descending-relative}

\noindent
This section is the analogue of
Limits of Spaces, Section \ref{spaces-limits-section-descending-relative}.

\begin{lemma}
\label{lemma-descend-a-stack-down}
Let $I$ be a directed set. Let $(X_i, f_{ii'})$ be an inverse system
of algebraic spaces over $I$. Assume
\begin{enumerate}
\item the morphisms $f_{ii'} : X_i \to X_{i'}$ are affine,
\item the spaces $X_i$ are quasi-compact and quasi-separated.
\end{enumerate}
Let $X = \lim X_i$.
If $\mathcal{X}$ is an algebraic stack of finite presentation over $X$,
then there exists an $i \in I$ and an algebraic stack $\mathcal{X}_i$
of finite presentation over $X_i$ with
$\mathcal{X} \cong \mathcal{X}_i \times_{X_i} X$ as
algebraic stacks over $X$.
\end{lemma}

\begin{proof}
By Morphisms of Stacks, Definition
\ref{stacks-morphisms-definition-locally-finite-presentation}
the morphism $\mathcal{X} \to X$ is
quasi-compact, locally of finite presentation, and quasi-separated.
Since $X$ is quasi-compact and $\mathcal{X} \to X$ is quasi-compact,
we see that $\mathcal{X}$ is quasi-compact
(Morphisms of Stacks, Definition
\ref{stacks-morphisms-definition-quasi-compact}).
Hence we can find an affine
scheme $U$ and a surjective smooth morphism $U \to \mathcal{X}$
(Properties of Stacks, Lemma
\ref{stacks-properties-lemma-quasi-compact-stack}).
Set $R = U \times_\mathcal{X} U$. We obtain a smooth groupoid
in algebraic spaces $(U, R, s, t, c)$ over $X$ such that
$\mathcal{X} = [U/R]$, see Algebraic Stacks, Lemma
\ref{algebraic-lemma-stack-presentation}.
Since $\mathcal{X} \to X$ is quasi-separated and $X$ is quasi-separated
we see that $\mathcal{X}$ is quasi-separated (Morphisms of Stacks, Lemma
\ref{stacks-morphisms-lemma-composition-separated}).
Thus $R \to U \times U$ is quasi-compact and quasi-separated
(Morphisms of Stacks, Lemma
\ref{stacks-morphisms-lemma-fibre-product-after-map})
and hence $R$ is a quasi-separated and quasi-compact algebraic space.
On the other hand $U \to X$ is locally of finite presentation
and hence also $R \to X$ is locally of finite presentation
(because $s : R \to U$ is smooth hence locally of finite presentation).
Thus $(U, R, s, t, c)$ is a groupoid object in the category
of algebraic spaces which are of finite presentation over $X$.
By Limits of Spaces, Lemma
\ref{spaces-limits-lemma-descend-finite-presentation}
there exists an $i$ and a groupoid in algebraic spaces
$(U_i, R_i, s_i, t_i, c_i)$ over $X_i$ whose pullback
to $X$ is isomorphic to $(U, R, s, t, c)$.
After increasing $i$ we may assume that
$s_i$ and $t_i$ are smooth, see
Limits of Spaces, Lemma \ref{spaces-limits-lemma-descend-smooth}.
The quotient stack $\mathcal{X}_i = [U_i/R_i]$
is an algebraic stack (Algebraic Stacks, Theorem
\ref{algebraic-theorem-smooth-groupoid-gives-algebraic-stack}).

\medskip\noindent
There is a morphism $[U/R] \to [U_i/R_i]$, see
Groupoids in Spaces, Lemma
\ref{spaces-groupoids-lemma-quotient-stack-functorial}.
We claim that combined with the morphisms
$[U/R] \to X$ and $[U_i/R_i] \to X_i$
(Groupoids in Spaces, Lemma \ref{spaces-groupoids-lemma-quotient-stack-arrows})
we obtain an isomorphism (i.e., equivalence)
$$
[U/R] \longrightarrow [U_i/R_i] \times_{X_i} X
$$
The corresponding map
$$
[U/_{\!p}R] \longrightarrow [U_i/_{\!p}R_i] \times_{X_i} X
$$
on the level of ``presheaves of groupoids'' as in
Groupoids in Spaces, Equation (\ref{spaces-groupoids-equation-quotient-stack})
is an isomorphism. Thus the claim follows from the fact that
stackification commutes with fibre products, see Stacks, Lemma
\ref{stacks-lemma-stackification-fibre-product-fibred-categories}.
\end{proof}







\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}

