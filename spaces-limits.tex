\input{preamble}

% OK, start here.
%
\begin{document}

\title{Limits of Algebraic Spaces}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
In this chapter we put material related to limits of algebraic spaces.
A first topic is the characterization of algebraic spaces $F$ locally
of finite presentation over the base $S$ as limit preserving functors.
We continue with a study of limits of inverse systems over directed
partially ordered sets with affine transition maps. We discuss absolute
Noetherian approximation for quasi-compact and quasi-separated algebraic
spaces following \cite{CLO}. Another approach is due to David Rydh (see
\cite{rydh_approx}) whose results also cover absolute Noetherian
approximation for certain algebraic stacks.


\section{Conventions}
\label{section-conventions}

\noindent
The standing assumption is that all schemes are contained in
a big fppf site $\Sch_{fppf}$. And all rings $A$ considered
have the property that $\Spec(A)$ is (isomorphic) to an
object of this big site.

\medskip\noindent
Let $S$ be a scheme and let $X$ be an algebraic space over $S$.
In this chapter and the following we will write $X \times_S X$
for the product of $X$ with itself (in the category of algebraic
spaces over $S$), instead of $X \times X$.











\section{Morphisms of finite presentation}
\label{section-finite-presentation}

\noindent
In this section we generalize
Limits, Proposition
\ref{limits-proposition-characterize-locally-finite-presentation}
to morphisms of algebraic spaces.
The motivation for the following definition comes from
the proposition just cited.

\begin{definition}
\label{definition-locally-finite-presentation}
Let $S$ be a scheme.
\begin{enumerate}
\item A functor $F : (\Sch/S)_{fppf}^{opp} \to \textit{Sets}$
is said to be {\it locally of finite presentation} or {\it limit preserving} if
for every affine scheme $T$ over $S$ which is a limit $T = \lim T_i$
of a directed inverse system of affine schemes $T_i$ over $S$, we have
$$
F(T) = \colim F(T_i).
$$
We sometimes say that $F$ is {\it locally of finite presentation over $S$}.
\item Let $F, G : (\Sch/S)_{fppf}^{opp} \to \textit{Sets}$.
A transformation of functors $a : F \to G$
is {\it locally of finite presentation} if for every scheme $T$ over $S$
and every $y \in G(T)$ the functor
$$
F_y : (\Sch/T)_{fppf}^{opp} \longrightarrow \textit{Sets}, \quad
T'/T \longmapsto \{x \in F(T') \mid a(x) = y|_{T'}\}
$$
is locally of finite presentation over $T$\footnote{The characterization (2) in
Lemma \ref{lemma-characterize-relative-limit-preserving}
may be easier to parse.}. We sometimes say that
$F$ is {\it relatively limit preserving} over $G$.
\end{enumerate}
\end{definition}

\noindent
The functor $F_y$ is in some sense the fiber of
$a : F \to G$ over $y$, except that it is a presheaf on the big fppf
site of $T$. A formula for this functor is:
\begin{equation}
\label{equation-fibre-map-functors}
F_y =
F|_{(\Sch/T)_{fppf}}
{\times}_{G|_{(\Sch/T)_{fppf}}}
*
\end{equation}
Here $*$ is the final object in the category of (pre)sheaves
on $(\Sch/T)_{fppf}$ (see
Sites, Example \ref{sites-example-singleton-sheaf})
and the map $* \to G|_{(\Sch/T)_{fppf}}$ is given by $y$.
Note that if $j : (\Sch/T)_{fppf} \to (\Sch/S)_{fppf}$
is the localization functor, then the formula above becomes
$F_y = j^{-1}F \times_{j^{-1}G} *$ and $j_!F_y$ is just the fiber product
$F \times_{G, y} T$. (See
Sites, Section \ref{sites-section-localize},
for information on localization, and especially
Sites, Remark \ref{sites-remark-localize-presheaves}
for information on $j_!$ for presheaves.)

\medskip\noindent
At this point we temporarily have two definitions of what it means
for a morphism $X \to Y$ of algebraic spaces over $S$ to be locally of finite
presentation. Namely, one by
Morphisms of Spaces,
Definition \ref{spaces-morphisms-definition-locally-finite-presentation}
and one using that $X \to Y$ is a transformation of functors so that
Definition \ref{definition-locally-finite-presentation}
applies. We will show in
Proposition \ref{proposition-characterize-locally-finite-presentation}
that these two definitions agree.

\begin{lemma}
\label{lemma-characterize-relative-limit-preserving}
Let $S$ be a scheme. Let $a : F \to G$ be a transformation of functors
$(\Sch/S)_{fppf}^{opp} \to \textit{Sets}$.
The following are equivalent
\begin{enumerate}
\item $F$ is relatively limit preserving over $G$, and
\item for every every affine scheme $T$ over $S$ which is a
limit $T = \lim T_i$ of a directed inverse system of affine
schemes $T_i$ over $S$ the diagram of sets
$$
\xymatrix{
\colim_i F(T_i) \ar[r] \ar[d]_a & F(T) \ar[d]^a \\
\colim_i G(T_i) \ar[r] & G(T)
}
$$
is a fibre product diagram.
\end{enumerate}
\end{lemma}

\begin{proof}
Assume (1). Consider $T = \lim_{i \in I} T_i$ as in (2). Let
$(y, x_T)$ be an element of the fibre product
$\colim_i G(T_i) \times_{G(T)} F(T)$.
Then $y$ comes from $y_i \in G(T_i)$ for some $i$.
Consider the functor $F_{y_i}$ on $(\Sch/T_i)_{fppf}$ as in
Definition \ref{definition-locally-finite-presentation}.
We see that $x_T \in F_{y_i}(T)$. Moreover $T = \lim_{i' \geq i} T_{i'}$
is a directed system of affine schemes over $T_i$. Hence (1) implies
that $x_T$ the image of a unique element $x$ of
$\colim_{i' \geq i} F_{y_i}(T_{i'})$. Thus $x$ is the unique
element of $\colim F(T_i)$ which maps to the pair $(y, x_T)$.
This proves that (2) holds.

\medskip\noindent
Assume (2). Let $T$ be a scheme and $y_T \in G(T)$. We have to show that
$F_{y_T}$ is limit preserving. Let $T' = \lim_{i \in I} T'_i$ be an
affine scheme over $T$ which is the directed limit of affine scheme $T'_i$
over $T$. Let $x_{T'} \in F_{y_T}$. Pick $i \in I$ which is possible as
$I$ is a directed partially ordered set. Denote $y_i \in F(T'_i)$ the
image of $y_{T'}$. Then we see that $(y_i, x_{T'})$ is an
element of the fibre product
$\colim_i G(T'_i) \times_{G(T')} F(T')$.
Hence by (2) we get a unique element $x$ of $\colim_i F(T'_i)$
mapping to $(y_i, x_{T'})$. It is clear that $x$ defines an element
of $\colim_i F_y(T'_i)$ mapping to $x_{T'}$ and we win.
\end{proof}

\begin{lemma}
\label{lemma-composition-locally-finite-presentation}
Let $S$ be a scheme contained in $\Sch_{fppf}$.
Let $F, G, H : (\Sch/S)_{fppf}^{opp} \to \textit{Sets}$.
Let $a : F \to G$, $b : G \to H$ be transformations of functors.
If $a$ and $b$ are locally of finite presentation, then
$$
b \circ a : F \longrightarrow H
$$
is locally of finite presentation.
\end{lemma}

\begin{proof}
Let $T = \lim_{i \in I} T_i$ as in characterization (2) of
Lemma \ref{lemma-characterize-relative-limit-preserving}.
Consider the diagram
$$
\xymatrix{
\colim_i F(T_i) \ar[r] \ar[d]_a & F(T) \ar[d]^a \\
\colim_i G(T_i) \ar[r] \ar[d]_b & G(T) \ar[d]^b \\
\colim_i H(T_i) \ar[r] & H(T)
}
$$
By assumption the two squares are fibre product squares. Hence the
outer rectangle is a fibre product diagram too which proves the lemma.
\end{proof}

\begin{lemma}
\label{lemma-base-change-locally-finite-presentation}
Let $S$ be a scheme contained in $\Sch_{fppf}$.
Let $F, G, H : (\Sch/S)_{fppf}^{opp} \to \textit{Sets}$.
Let $a : F \to G$, $b : H \to G$ be transformations of functors.
Consider the fibre product diagram
$$
\xymatrix{
H \times_{b, G, a} F \ar[r]_-{b'} \ar[d]_{a'} & F \ar[d]^a \\
H \ar[r]^b & G
}
$$
If $a$ is locally of finite presentation, then the base change $a'$ is
locally of finite presentation.
\end{lemma}

\begin{proof}
Omitted. Hint: This is formal.
\end{proof}

\begin{lemma}
\label{lemma-limit-fppf-topology}
Let $T$ be an affine scheme which is written as a limit
$T = \lim_{i \in I} T_i$ of a directed inverse system of affine schemes.
\begin{enumerate}
\item Let $\mathcal{V} = \{V_j \to T\}_{j = 1, \ldots, m}$ be a standard fppf
covering of $T$, see
Topologies, Definition \ref{topologies-definition-standard-fppf}.
Then there exists an index $i$ and a standard fppf covering
$\mathcal{V}_i = \{V_{i, j} \to T_i\}_{j = 1, \ldots, m}$
whose base change $T \times_{T_i} \mathcal{V}_i$ to $T$
is isomorphic to $\mathcal{V}$.
\item Let $\mathcal{V}_i$, $\mathcal{V}'_i$ be a pair of standard
fppf coverings of $T_i$. If
$f : T \times_{T_i} \mathcal{V} \to T \times_{T_i} \mathcal{V}'_i$ is
a morphism of coverings of $T$, then there exists an index
$i' \geq i$ and a morphism
$f_{i'} : T_{i'} \times_{T_i} \mathcal{V} \to
T_{i'} \times_{T_i} \mathcal{V}'_i$
whose base change to $T$ is $f$.
\item If
$f, g : \mathcal{V} \to \mathcal{V}'_i$
are morphisms of standard fppf coverings of $T_i$ whose
base changes $f_T, g_T$ to $T$ are equal then there exists an
index $i' \geq i$ such that $f_{T_{i'}} = g_{T_{i'}}$.
\end{enumerate}
In other words, the category of standard fppf coverings of $T$ is
the colimit over $I$ of the categories of standard fppf coverings of $T_i$
\end{lemma}

\begin{proof}
By
Limits, Lemma \ref{limits-lemma-descend-finite-presentation}
the category of schemes of finite presentation over $T$ is the
colimit over $I$ of the categories of finite presentation over $T_i$. By
Limits, Lemmas \ref{limits-lemma-descend-affine-finite-presentation}
and \ref{limits-lemma-descend-flat-finite-presentation}
the same is true for category of schemes which are affine, flat and
of finite presentation over $T$.
To finish the proof of the lemma it suffices to show that if
$\{V_{j, i} \to T_i\}_{j = 1, \ldots, m}$ is a finite family of
flat finitely presented morphisms with $V_{j, i}$ affine, and the
base change $\coprod_j T \times_{T_i} V_{j, i} \to T$ is surjective,
then for some $i' \geq i$ the morphism
$\coprod T_{i'} \times_{T_i} V_{j, i} \to T_{i'}$ is surjective.
Denote $W_{i'} \subset T_{i'}$, resp.\ $W \subset T$ the image.
Of course $W = T$ by assumption.
Since the morphisms are flat and of finite presentation we see that
$W_i$ is a quasi-compact open of $T_i$, see
Morphisms, Lemma \ref{morphisms-lemma-fppf-open}.
Moreover, $W = T \times_{T_i} W_i$ (formation of image commutes
with base change). Hence by
Limits, Lemma \ref{limits-lemma-descend-opens}
we conclude that $W_{i'} = T_{i'}$ for some large enough $i'$
and we win.
\end{proof}

\begin{lemma}
\label{lemma-sheafify-finite-presentation}
Let $S$ be a scheme contained in $\Sch_{fppf}$.
Let $F : (\Sch/S)_{fppf}^{opp} \to \textit{Sets}$ be a functor.
If $F$ is locally of finite presentation over $S$ then its sheafification
$F^\#$ is locally of finite presentation over $S$.
\end{lemma}

\begin{proof}
Assume $F$ is locally of finite presentation.
It suffices to show that $F^+$ is locally of finite presentation, since
$F^\# = (F^+)^+$, see
Sites, Theorem \ref{sites-theorem-plus}.
Let $T$ be an affine scheme over $S$, and let $T = \lim T_i$ be written
as the directed limit of an inverse system of affine $S$ schemes.
Recall that $F^+(T)$ is the colimit of $\check H^0(\mathcal{V}, F)$
where the limit is over all coverings of $T$ in $(\Sch/S)_{fppf}$.
Any fppf covering of an affine scheme can be refined by a standard
fppf covering, see
Topologies, Lemma \ref{topologies-lemma-fppf-affine}.
Hence we can write
$$
F^+(T)
=
\colim_{\mathcal{V}\text{ standard covering }T}
\check H^0(\mathcal{V}, F).
$$
By
Lemma \ref{lemma-limit-fppf-topology}
we may rewrite this as
$$
\colim_{i \in I}
\colim_{\mathcal{V}_i\text{ standard covering }T_i}
\check H^0(T \times_{T_i}\mathcal{V}_i, F).
$$
(The order of the colimits is irrelevant by
Categories, Lemma \ref{categories-lemma-colimits-commute}.)
Given a standard fppf covering
$\mathcal{V}_i = \{V_j \to T_i\}_{j = 1, \ldots, m}$ of $T_i$ we see that
$$
T \times_{T_i} V_j = \lim_{i' \geq i} T_{i'} \times_T V_j
$$
by
Limits, Lemma \ref{limits-lemma-scheme-over-limit}, and similarly
$$
T \times_{T_i} (V_j \times_{T_i} V_{j'}) =
\lim_{i' \geq i} T_{i'} \times_T (V_j \times_{T_i} V_{j'}).
$$
As the presheaf $F$ is locally of finite presentation this means that
$$
\check H^0(T \times_{T_i}\mathcal{V}_i, F)
=
\colim_{i' \geq i}
\check H^0(T_{i'} \times_{T_i}\mathcal{V}_i, F).
$$
Hence the colimit expression for $F^+(T)$ above collapses to
$$
\colim_{i \in I} \colim_{\mathcal{V}\text{ standard covering }T_i}
\check H^0(\mathcal{V}, F).
=
\colim_{i \in I} F^+(T_i).
$$
In other words $F^+(T) = \colim_i F^+(T_i)$ and hence
the lemma holds.
\end{proof}

\begin{lemma}
\label{lemma-sheaf-finite-presentation}
Let $S$ be a scheme.
Let $F : (\Sch/S)_{fppf}^{opp} \to \textit{Sets}$ be a functor.
Assume that
\begin{enumerate}
\item $F$ is a sheaf, and
\item there exists an fppf covering $\{U_j \to S\}_{j \in J}$ such that
$F|_{(\Sch/U_j)_{fppf}}$ is locally of finite presentation.
\end{enumerate}
Then $F$ is locally of finite presentation.
\end{lemma}

\begin{proof}
Let $T$ be an affine scheme over $S$.
Let $I$ be a directed partially ordered set, and let
$T_i$ be an inverse system of affine schemes over $S$ such that
$T = \lim T_i$. We have to show that the canonical
map $\colim F(T_i) \to F(T)$ is bijective.

\medskip\noindent
Choose some $0 \in I$ and choose a standard fppf covering
$\{V_{0, k} \to T_{0}\}_{k = 1, \ldots, m}$ which refines
the pullback $\{U_j \times_S T_0 \to T_0\}$ of the given fppf covering of $S$.
For each $i \geq 0$ we set $V_{i, k} = T_i \times_{T_0} V_{0, k}$, and
we set $V_k = T \times_{T_0} V_{0, k}$. Note that
$V_k = \lim_{i \geq 0} V_{i, k}$, see
Limits, Lemma \ref{limits-lemma-scheme-over-limit}.

\medskip\noindent
Suppose that $x, x' \in \colim F(T_i)$ map to the same
element of $F(T)$. Say $x, x'$ are given by elements $x_i, x'_i \in F(T_i)$
for some $i \in I$ (we may choose the same $i$ for both as $I$ is directed).
By assumption (2) and the fact that $x_i, x'_i$ map to the same element
of $F(T)$ this implies that
$$
x_i|_{V_{i', k}} = x'_i|_{V_{i', k}}
$$
for some suitably large $i' \in I$. We can choose the same $i'$ for each
$k$ as $k \in \{1, \ldots, m\}$ ranges over a finite set.
Since $\{V_{i', k} \to T_{i'}\}$
is an fppf covering and $F$ is a sheaf this implies that
$x_i|_{T_{i'}} = x'_i|_{T_{i'}}$ as desired. This proves that the map
$\colim F(T_i) \to F(T)$ is injective.

\medskip\noindent
To show surjectivity we argue in a similar fashion.
Let $x \in F(T)$. By assumption (2) for each $k$ we
can choose a $i$ such that $x|_{V_k}$ comes from an
element $x_{i, k} \in F(V_{i, k})$. As before we may choose a
single $i$ which works for all $k$. By the injectivity
proved above we see that
$$
x_{i, k}|_{V_{i', k} \times_{T_{i'}} V_{i', l}}
=
x_{i, l}|_{V_{i', k} \times_{T_{i'}} V_{i', l}}
$$
for some large enough $i'$. Hence by the sheaf condition of $F$
the elements $x_{i, k}|_{V_{i', k}}$ glue to an element $x_{i'} \in F(T_{i'})$
as desired.
\end{proof}

\begin{lemma}
\label{lemma-sheafify-finite-presentation-map}
Let $S$ be a scheme contained in $\Sch_{fppf}$.
Let $F, G : (\Sch/S)_{fppf}^{opp} \to \textit{Sets}$ be functors.
If $a : F \to G$ is a transformation which is locally of finite
presentation, then the induced transformation of sheaves
$F^\# \to G^\#$ is of finite presentation.
\end{lemma}

\begin{proof}
Suppose that $T$ is a scheme and $y \in G^\#(T)$.
We have to show the functor
$F^\#_y : (\Sch/T)_{fppf}^{opp} \to \textit{Sets}$
constructed from $F^\# \to G^\#$ and $y$ as in
Definition \ref{definition-locally-finite-presentation}
is locally of finite presentation.
By Equation (\ref{equation-fibre-map-functors})
we see that $F^\#_y$ is a sheaf. Choose an fppf covering
$\{V_j \to T\}_{j \in J}$ such that $y|_{V_j}$ comes from
an element $y_j \in F(V_j)$.
Note that the restriction of $F^\#$ to $(\Sch/V_j)_{fppf}$
is just $F^\#_{y_j}$. If we can show that $F^\#_{y_j}$ is
locally of finite presentation then
Lemma \ref{lemma-sheaf-finite-presentation}
guarantees that $F^\#_y$ is locally of finite presentation and
we win. This reduces us to the case $y \in G(T)$.

\medskip\noindent
Let $y \in G(T)$. In this case we claim that $F^\#_y = (F_y)^\#$.
This follows from
Equation (\ref{equation-fibre-map-functors}).
Thus this case follows from
Lemma \ref{lemma-sheafify-finite-presentation}.
\end{proof}

\begin{proposition}
\label{proposition-characterize-locally-finite-presentation}
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic
spaces over $S$. The following are equivalent:
\begin{enumerate}
\item The morphism $f$ is a morphism of algebraic spaces which is
locally of finite presentation, see
Morphisms of Spaces,
Definition \ref{spaces-morphisms-definition-locally-finite-presentation}.
\item The morphism $f : X \to Y$ is locally of finite presentation as
a transformation of functors, see
Definition \ref{definition-locally-finite-presentation}.
\end{enumerate}
\end{proposition}

\begin{proof}
Assume (1). Let $T$ be a scheme and let $y \in Y(T)$. We have to show that
$T \times_X Y$ is locally of finite presentation over $T$ in the sense of
Definition \ref{definition-locally-finite-presentation}.
Hence we are reduced to proving that if $X$ is an algebraic space which
is locally of finite presentation over $S$ as an algebraic space, then it
is locally of finite presentation as a functor
$X : (\Sch/S)_{fppf}^{opp} \to \textit{Sets}$.
To see this choose a presentation $X = U/R$, see
Spaces, Definition \ref{spaces-definition-presentation}.
It follows from
Morphisms of Spaces,
Definition \ref{spaces-morphisms-definition-locally-finite-presentation}
that both $U$ and $R$ are schemes which are locally of finite presentation
over $S$. Hence by
Limits, Proposition
\ref{limits-proposition-characterize-locally-finite-presentation}
we have
$$
U(T) = \colim U(T_i), \quad
R(T) = \colim R(T_i)
$$
whenever $T = \lim_i T_i$ in $(\Sch/S)_{fppf}$. It follows
that the presheaf
$$
(\Sch/S)_{fppf}^{opp} \longrightarrow \textit{Sets}, \quad
W \longmapsto U(W)/R(W)
$$
is locally of finite presentation. Hence by
Lemma \ref{lemma-sheafify-finite-presentation}
its sheafification $X = U/R$ is locally of finite presentation too.

\medskip\noindent
Assume (2). Choose a scheme $V$ and a surjective \'etale morphism
$V \to Y$. Next, choose a scheme $U$ and a surjective \'etale morphism
$U \to V \times_Y X$. By
Lemma \ref{lemma-base-change-locally-finite-presentation}
the transformation of functors $V \times_Y X \to V$ is locally of
finite presentation. By
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-etale-locally-finite-presentation}
the morphism of algebraic spaces $U \to V \times_Y X$ is locally
of finite presentation, hence locally of finite presentation as
a transformation of functors by the first part of the proof. By
Lemma \ref{lemma-composition-locally-finite-presentation}
the composition $U \to V \times_Y X \to V$ is locally of
finite presentation as a transformation of functors. Hence
the morphism of schemes $U \to V$ is locally of finite presentation by
Limits, Proposition
\ref{limits-proposition-characterize-locally-finite-presentation}
(modulo a set theoretic remark, see last paragraph of the proof).
This means, by definition, that (1) holds.

\medskip\noindent
Set theoretic remark. Let $U \to V$ be a morphism of
$(\Sch/S)_{fppf}$. In the statement of
Limits, Proposition
\ref{limits-proposition-characterize-locally-finite-presentation}
we characterize $U \to V$ as being locally of finite presentation
if for {\it all} directed inverse systems $(T_i, f_{ii'})$ of affine schemes
over $V$ we have $U(T) = \colim V(T_i)$, but in the current setting
we may only consider affine schemes $T_i$ over $V$ which are (isomorphic to)
an object of $(\Sch/S)_{fppf}$. So we have to make sure that there
are enough affines in $(\Sch/S)_{fppf}$ to make the proof work.
Inspecting the proof of (2) $\Rightarrow$ (1) of
Limits, Proposition
\ref{limits-proposition-characterize-locally-finite-presentation}
we see that the question reduces to the case that $U$ and $V$ are affine.
Say $U = \Spec(A)$ and $V = \Spec(B)$. By construction
of $(\Sch/S)_{fppf}$ the spectrum of any ring of cardinality
$\leq |B|$ is isomorphic to an object of $(\Sch/S)_{fppf}$.
Hence it suffices to observe that in the "only if" part of the proof of
Algebra, Lemma \ref{algebra-lemma-characterize-finite-presentation}
only $A$-algebras of cardinality $\leq |B|$ are used.
\end{proof}

\begin{remark}
\label{remark-limit-preserving}
Here is an important special case of
Proposition \ref{proposition-characterize-locally-finite-presentation}.
Let $S$ be a scheme. Let $X$ be an algebraic space over $S$.
Then $X$ is locally of finite presentation over $S$ if and only
if $X$, as a functor $(\Sch/S)^{opp} \to \textit{Sets}$,
is limit preserving. Compare with
Limits, Remark \ref{limits-remark-limit-preserving}.
\end{remark}















\section{Limits of algebraic spaces}
\label{section-limits}

\noindent
The following lemma explains how we think of limits of algebraic
spaces in this chapter. We will use (without further mention) that the
base change of an affine morphism of algebraic spaces is affine (see
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-base-change-affine}).

\begin{lemma}
\label{lemma-directed-inverse-system-has-limit}
Let $S$ be a scheme. Let $I$ be a directed partially ordered set.
Let $(X_i, f_{ii'})$ be an inverse system over $I$
in the category of algebraic spaces over $S$.
If the morphisms $f_{ii'} : X_i \to X_{i'}$ are affine, then the
limit $X = \lim_i X_i$ (as an fppf sheaf) is an algebraic space.
Moreover,
\begin{enumerate}
\item each of the morphisms $f_i : X \to X_i$ is affine,
\item for any $i \in I$ and any morphism of algebraic spaces
$T \to X_i$ we have
$$
X \times_{X_i} T = \lim_{i' \geq i} X_{i'} \times_{X_i} T.
$$
as algebraic spaces over $S$.
\end{enumerate}
\end{lemma}

\begin{proof}
Part (2) is a formal consequence of the existence of the
limit $X = \lim X_i$ as an algebraic space over $S$.
Choose an element $0 \in I$ (this is possible as a directed partially
ordered set is nonempty). Choose a scheme $U_0$ and a surjective
\'etale morphism $U_0 \to X_0$. Set $R_0 = U_0 \times_{X_0} U_0$
so that $X_0 = U_0/R_0$. For $i \geq 0$ set
$U_i = X_i \times_{X_0} U_0$ and
$R_i = X_i \times_{X_0} R_0 = U_i \times_{X_i} U_i$.
By Limits, Lemma \ref{limits-lemma-directed-inverse-system-has-limit}
we see that $U = \lim_{i \geq 0} U_i$ and $R = \lim_{i \geq 0} R_i$
are schemes. Moreover, the two morphisms $s, t : R \to U$ are the base
change of the two projections $R_0 \to U_0$ by the morphism
$U \to U_0$, in particular \'etale. The morphism $R \to U \times_S U$
defines an equivalence relation as directed a limit of equivalence relations
is an equivalence relation. Hence the morphism
$R \to U \times_S U$ is an \'etale equivalence relation. We claim that
the natural map
\begin{equation}
\label{equation-isomorphism-sheaves}
U/R \longrightarrow \lim X_i
\end{equation}
is an isomorphism of fppf sheaves on the category of schemes over $S$.
The claim implies $X = \lim X_i$ is an algebraic
space by Spaces, Theorem \ref{spaces-theorem-presentation}.

\medskip\noindent
Let $Z$ be a scheme and let $a : Z \to \lim X_i$ be a morphism.
Then $a = (a_i)$ where $a_i : Z \to X_i$. Set $W_0 = Z \times_{a_0, X_0} U_0$.
Note that $W_0 = Z \times_{a_i, X_i} U_i$ for all $i \geq 0$ by our
choice of $U_i \to X_i$ above. Hence we obtain a morphism
$W_0 \to \lim_{i \geq 0} U_i = U$. Since $W_0 \to Z$ is surjective
and \'etale, we conclude that (\ref{equation-isomorphism-sheaves})
is a surjective map of sheaves. Finally, suppose that
$Z$ is a scheme and that $a, b : Z \to U/R$ are two morphisms
which are equalized by (\ref{equation-isomorphism-sheaves}).
We have to show that $a = b$.
After replacing $Z$ by the members of an fppf covering
we may assume there exist morphisms $a', b' : Z \to U$ which
give rise to $a$ and $b$. The condition that $a, b$ are
equalized by (\ref{equation-isomorphism-sheaves}) means that
for each $i \geq 0$ the compositions $a_i', b_i' : Z \to U \to U_i$
are equal as morphisms into $U_i/R_i = X_i$. Hence
$(a_i', b_i') : Z \to U_i \times_S U_i$ factors through
$R_i$, say by some morphism $c_i : Z \to R_i$. Since
$R = \lim_{i \geq 0} R_i$ we see that $c = \lim c_i : Z \to R$
is a morphism which shows that $a, b$ are equal as morphisms
of $Z$ into $U/R$.

\medskip\noindent
Part (1) follows as we have seen above that
$U_i \times_{X_i} X = U$ and $U \to U_i$ is affine by
construction.
\end{proof}

\begin{lemma}
\label{lemma-space-over-limit}
Let $S$ be a scheme. Let $I$ be a directed partially ordered set.
Let $(X_i, f_{ii'})$ be an inverse system over $I$ of algebraic spaces
over $S$ with affine transition maps.
Let $X = \lim_i X_i$. Let $0 \in I$. Suppose that $T \to X_0$ is a
morphism of algebraic spaces. Then
$$
T \times_{X_0} X = \lim_{i \geq 0} T \times_{X_0} X_i
$$
as algebraic spaces over $S$.
\end{lemma}

\begin{proof}
The limit $X$ is an algebraic space by
Lemma \ref{lemma-directed-inverse-system-has-limit}.
The equality is formal, see
Categories, Lemma \ref{categories-lemma-colimits-commute}.
\end{proof}





\section{Descending properties}
\label{section-descent}

\noindent
This section is the analogue of Limits, Section \ref{limits-section-descent}.

\begin{situation}
\label{situation-descent}
Let $S$ be a scheme. Let $X = \lim_{i \in I} X_i$ be a limit of a directed
system of algebraic spaces over $S$ with affine transition morphisms
(Lemma \ref{lemma-directed-inverse-system-has-limit}).
We assume that $X_i$ is quasi-compact and quasi-separated for all $i \in I$.
We also choose an element $0 \in I$.
\end{situation}

\noindent
The following lemma holds a little bit more generally
(namely when we just assume each $X_i$ is a decent algebraic space).

\begin{lemma}
\label{lemma-topology-limit}
In Situation \ref{situation-descent} we have $|X| = \lim |X_i|$.
\end{lemma}

\begin{proof}
There is a canonical map $|X| \to \lim |X_i|$.
Choose an affine scheme $U_0$ and a surjective \'etale morphism $U_0 \to X_0$.
Set $U_i = X_i \times_{X_0} U_0$ and $U = X \times_{X_0} U_0$.
Set $R_i = U_i \times_{X_i} U_i$ and $R = U \times_X U$.
Recall that $U = \lim U_i$ and $R = \lim R_i$, see proof of
Lemma \ref{lemma-directed-inverse-system-has-limit}.
Recall that $|X| = |U|/|R|$ and $|X_i| = |U_i|/|R_i|$. By
Limits, Lemma \ref{limits-lemma-topology-limit} we have $|U| = \lim |U_i|$ and
$|R| = \lim |R_i|$.

\medskip\noindent
Surjectivity of $|X| \to \lim |X_i|$. Let $(x_i) \in \lim |X_i|$. Denote
$S_i \subset |U_i|$ the inverse image of $x_i$. This is a finite nonempty
set by Properties of Spaces, Lemma
\ref{spaces-properties-lemma-finite-fibres-presentation}.
Hence $\lim S_i$ is nonempty, see
Categories, Lemma \ref{categories-lemma-nonempty-limit}.
Let $(u_i) \in \lim S_i \subset \lim |U_i|$. By the above this determines
a point $u \in |U|$ which maps to an $x \in |X|$ mapping to the given
element $(x_i)$ of $\lim |X_i|$.

\medskip\noindent
Injectivity of $|X| \to \lim |X_i|$. Suppose that $x, x' \in |X|$
map to the same point of $\lim |X_i|$. Choose lifts $u, u' \in |U|$
and denote $u_i, u'_i \in |U_i|$ the images.
For each $i$ let $T_i \subset |R_i|$ be the set of points mapping
to $(u_i, u'_i) \in |U_i| \times |U_i|$. This is a finite
set by Properties of Spaces, Lemma
\ref{spaces-properties-lemma-finite-fibres-presentation}
which is nonempty as we've assumed that $x$ and $x'$ map to the
same point of $X_i$. Hence $\lim T_i$ is nonempty, see
Categories, Lemma \ref{categories-lemma-nonempty-limit}.
As before let $r \in |R| = \lim |R_i|$ be a point corresponding to an
element of $\lim T_i$. Then $r$ maps to $(u, u')$ in $|U| \times |U|$
by construction and we see that $x = x'$ in $|X|$ as desired.
\end{proof}

\begin{lemma}
\label{lemma-limit-nonempty}
In Situation \ref{situation-descent}, if each $X_i$ is nonempty, then
$|X|$ is nonempty.
\end{lemma}

\begin{proof}
Choose an affine scheme $U_0$ and a surjective \'etale morphism $U_0 \to X_0$.
Set $U_i = X_i \times_{X_0} U_0$ and $U = X \times_{X_0} U_0$.
Then each $U_i$ is a nonempty affine scheme. Hence $U = \lim U_i$
is nonempty (Limits, Lemma \ref{limits-lemma-limit-nonempty}) and thus
$X$ is nonempty.
\end{proof}

\begin{lemma}
\label{lemma-descend-section}
Notation and assumptions as in Situation \ref{situation-descent}.
Suppose that $\mathcal{F}_0$ is a quasi-coherent sheaf on $X_0$.
Set $\mathcal{F}_i = f_{0i}^*\mathcal{F}_0$ for $i \geq 0$ and set
$\mathcal{F} = f_0^*\mathcal{F}_0$. Then
$$
\Gamma(X, \mathcal{F}) = \colim_{i \geq 0} \Gamma(X_i, \mathcal{F}_i)
$$
\end{lemma}

\begin{proof}
Choose a surjective \'etale morphism $U_0 \to X_0$ where $U_0$ is an affine
scheme (Properties of Spaces, Lemma
\ref{spaces-properties-lemma-quasi-compact-affine-cover}).
Set $U_i = X_i \times_{X_0} U_0$.
Set $R_0 = U_0 \times_{X_0} U_0$ and $R_i = R_0 \times_{X_0} X_i$.
In the proof of Lemma \ref{lemma-directed-inverse-system-has-limit} we have
seen that there exists a presentation $X = U/R$ with
$U = \lim U_i$ and $R = \lim R_i$.
Note that $U_i$ and $U$ are affine and that $R_i$ and $R$ are
quasi-compact and separated (as $X_i$ is quasi-separated). Hence
Limits, Lemma \ref{limits-lemma-descend-section}
implies that
$$
\mathcal{F}(U) = \colim \mathcal{F}_i(U_i)
\quad\text{and}\quad
\mathcal{F}(R) = \colim \mathcal{F}_i(R_i).
$$
The lemma follows as
$\Gamma(X, \mathcal{F}) = \Ker(\mathcal{F}(U) \to \mathcal{F}(R))$
and similarly
$\Gamma(X_i, \mathcal{F}_i) =
\Ker(\mathcal{F}_i(U_i) \to \mathcal{F}_i(R_i))$
\end{proof}

\begin{lemma}
\label{lemma-descend-opens}
Notation and assumptions as in Situation \ref{situation-descent}.
For any quasi-compact open subspace $U \subset X$ there exists an $i$
and a quasi-compact open $U_i \subset X_i$ whose inverse image in $X$ is $U$.
\end{lemma}

\begin{proof}
Follows formally from the construction of limits in
Lemma \ref{lemma-directed-inverse-system-has-limit}
and the corresponding result for schemes:
Limits, Lemma \ref{limits-lemma-descend-opens}.
\end{proof}

\noindent
The following lemma will be superseded by the stronger
Lemma \ref{lemma-descend-isomorphism}.

\begin{lemma}
\label{lemma-descend-equality}
Notation and assumptions as in Situation \ref{situation-descent}.
Let $f_0 : Y_0 \to Z_0$ be a morphism of algebraic spaces over $X_0$.
Assume (a) $Y_0 \to X_0$ and $Z_0 \to X_0$ are representable, (b)
$Y_0$, $Z_0$ quasi-compact and quasi-separated, (c)
$f_0$ locally of finite presentation, and
(d) $Y_0 \times_{X_0} X \to Z_0 \times_{X_0} X$ an isomorphism.
Then there exists an $i \geq 0$ such that
$Y_0 \times_{X_0} X_i \to Z_0 \times_{X_0} X_i$ is an isomorphism.
\end{lemma}

\begin{proof}
Choose an affine scheme $U_0$ and a surjective \'etale morphism $U_0 \to X_0$.
Set $U_i = U_0 \times_{X_0} X_i$ and $U = U_0 \times_{X_0} X$.
Apply Limits, Lemma \ref{limits-lemma-descend-isomorphism}
to see that $Y_0 \times_{X_0} U_i \to Z_0 \times_{X_0} U_i$
is an isomorphism of schemes for some $i \geq 0$ (details omitted).
As $U_i \to X_i$ is surjective \'etale, it follows that
$Y_0 \times_{X_0} X_i \to Z_0 \times_{X_0} X_i$ is an isomorphism
(details omitted).
\end{proof}

\begin{lemma}
\label{lemma-descend-separated}
Notation and assumptions as in Situation \ref{situation-descent}.
If $X$ is separated, then $X_i$ is separated for some $i \in I$.
\end{lemma}

\begin{proof}
Choose an affine scheme $U_0$ and a surjective \'etale morphism $U_0 \to X_0$.
For $i \geq 0$ set $U_i = U_0 \times_{X_0} X_i$ and set
$U = U_0 \times_{X_0} X$. Note that $U_i$ and $U$ are affine schemes
which come equipped with surjective \'etale morphisms $U_i \to X_i$
and $U \to X$. Set $R_i = U_i \times_{X_i} U_i$ and $R = U \times_X U$
with projections $s_i, t_i : R_i \to U_i$ and $s, t : R \to U$.
Note that $R_i$ and $R$ are quasi-compact separated schemes (as the
algebraic spaces $X_i$ and $X$ are quasi-separated). The maps
$s_i : R_i \to U_i$ and $s : R \to U$ are of finite type.
By definition $X_i$ is separated if and only if
$(t_i, s_i) : R_i \to U_i \times U_i$
is a closed immersion, and since $X$ is separated by assumption,
the morphism $(t, s) : R \to U \times U$ is a closed immersion. Since
$R \to U$ is of finite type, there exists an
$i$ such that the morphism $R \to U_i \times U$ is a closed immersion
(Limits, Lemma \ref{limits-lemma-finite-type-eventually-closed}).
Fix such an $i \in I$. Apply Limits, Lemma
\ref{limits-lemma-descend-closed-immersion-finite-presentation}
to the system of morphisms $R_{i'} \to U_i \times U_{i'}$ for $i' \geq i$
(this is permissible as indeed
$R_{i'} = R_i \times_{U_i \times U_i} U_i \times U_{i'}$)
to see that $R_{i'} \to U_i \times U_{i'}$ is a closed immersion
for $i'$ sufficiently large. This implies immediately
that $R_{i'} \to U_{i'} \times U_{i'}$ is a closed immersion
finishing the proof of the lemma.
\end{proof}

\begin{lemma}
\label{lemma-limit-is-affine}
Notation and assumptions as in Situation \ref{situation-descent}.
If $X$ is affine, then there exists an $i$ such that $X_i$ is affine.
\end{lemma}

\begin{proof}
Choose $0 \in I$. Choose an affine scheme $U_0$ and a surjective
\'etale morphism $U_0 \to X_0$. Set $U = U_0 \times_{X_0} X$
and $U_i = U_0 \times_{X_0} X_i$ for $i \geq 0$. Since the transition
morphisms are affine, the algebraic spaces $U_i$ and $U$ are affine.
Thus $U \to X$ is an \'etale morphism of affine schemes. Hence we
can write $X = \Spec(A)$, $U = \Spec(B)$ and
$$
B = A[x_1, \ldots, x_n]/(g_1, \ldots, g_n)
$$
such that $\Delta = \det(\partial g_\lambda/\partial x_\mu)$ is invertible
in $B$, see Algebra, Lemma \ref{algebra-lemma-etale-standard-smooth}.
Set $A_i = \mathcal{O}_{X_i}(X_i)$. We have $A = \colim A_i$ by
Lemma \ref{lemma-descend-section}. After increasing $0$ we may assume
we have $g_{1, i}, \ldots, g_{n, i} \in A_i[x_1, \ldots, x_n]$ mapping to
$g_1, \ldots, g_n$. Set
$$
B_i = A_i[x_1, \ldots, x_n]/(g_{1, i}, \ldots, g_{n, i})
$$
for all $i \geq 0$. Increasing $0$ if necessary we may assume that
$\Delta_i = \det(\partial g_{\lambda, i}/\partial x_\mu)$ is invertible
in $B_i$ for all $i \geq 0$. Thus $A_i \to B_i$ is an \'etale ring map.
After increasing $0$ we may assume also that
$\Spec(B_i) \to \Spec(A_i)$ is surjective, see
Limits, Lemma \ref{limits-lemma-descend-surjective}. Increasing
$0$ yet again we may choose elements
$h_{1, i}, \ldots, h_{n, i} \in \mathcal{O}_{U_i}(U_i)$ which map to the
classes of $x_1, \ldots, x_n$ in $B = \mathcal{O}_U(U)$ and such that
$g_{\lambda, i}(h_{\nu, i}) = 0$ in $\mathcal{O}_{U_i}(U_i)$. Thus
we obtain a commutative diagram
\begin{equation}
\label{equation-to-show-cartesian}
\vcenter{
\xymatrix{
X_i \ar[d] & U_i \ar[l] \ar[d] \\
\Spec(A_i) & \Spec(B_i) \ar[l]
}
}
\end{equation}
By construction $B_i = B_0 \otimes_{A_0} A_i$ and
$B = B_0 \otimes_{A_0} A$. Consider the morphism
$$
f_0 : U_0 \longrightarrow X_0 \times_{\Spec(A_0)} \Spec(B_0)
$$
This is a morphism of quasi-compact and quasi-separated algebraic spaces
representable, separated and \'etale over $X_0$. The base change of $f_0$
to $X$ is an isomorphism by our choices. Hence
Lemma \ref{lemma-descend-equality}
guarantees that there exists an $i$ such that the base change of $f_0$
to $X_i$ is an isomorphism, in other words the diagram
(\ref{equation-to-show-cartesian}) is cartesian. Thus
Descent, Lemma \ref{descent-lemma-descent-data-sheaves}
applied to the fppf covering $\{\Spec(B_i) \to \Spec(A_i)\}$
combined with Descent, Lemma \ref{descent-lemma-affine}
give that $X_i \to \Spec(A_i)$ is representable by a scheme
affine over $\Spec(A_i)$ as desired. (Of course it then also follows
that $X_i = \Spec(A_i)$ but we don't need this.)
\end{proof}

\begin{lemma}
\label{lemma-limit-is-scheme}
Notation and assumptions as in Situation \ref{situation-descent}.
If $X$ is a scheme, then there exists an $i$ such that $X_i$ is a scheme.
\end{lemma}

\begin{proof}
Choose a finite affine open covering $X = \bigcup W_j$.
By Lemma \ref{lemma-descend-opens}
we can find an $i \in I$ and open subspaces $W_{j, i} \subset X_i$
whose base change to $X$ is $W_j \to X$. By
Lemma \ref{lemma-limit-is-affine} we may assume that
each $W_{j, i}$ is an affine scheme. This means that $X_i$
is a scheme (see for example
Properties of Spaces, Section \ref{spaces-properties-section-schematic}).
\end{proof}

\begin{lemma}
\label{lemma-finite-type-eventually-closed}
Let $S$ be a scheme. Let $B$ be an algebraic space over $S$.
Let $X = \lim X_i$ be a directed limit of
algebraic spaces over $B$ with affine transition morphisms.
Let $Y \to X$ be a morphism of algebraic spaces over $B$.
\begin{enumerate}
\item If $Y \to X$ is a closed immersion, $X_i$ quasi-compact, and
$Y \to B$ locally of finite type, then $Y \to X_i$ is a closed immersion
for $i$ large enough.
\item If $Y \to X$ is an immersion, $X_i$ quasi-separated, $Y \to B$
locally of finite type, and $Y$ quasi-compact, then $Y \to X_i$ is an
immersion for $i$ large enough.
\item If $Y \to X$ is an isomorphism, $X_i$ quasi-compact,
$X_i \to B$ locally of finite type, the transition morphisms
$X_{i'} \to X_i$ are closed immersions, and $Y \to B$ is locally
of finite presentation, then $Y \to X_i$ is an isomorphism for $i$
large enough.
\item If $Y \to X$ is a monomorphism, $X_i$ quasi-separated,
$Y \to B$ locally of finite type, and $Y$ quasi-compact, then
$Y \to X_i$ is a monomorphism for $i$ large enough.
\end{enumerate}
\end{lemma}

\begin{proof}
Proof of (1). Choose $0 \in I$. As $X_0$ is quasi-compact, we can choose
an affine scheme $W$ and an \'etale morphism $W \to B$ such that the image of
$|X_0| \to |B|$ is contained in $|W| \to |B|$. 
Choose an affine scheme $U_0$ and an \'etale morphism
$U_0 \to X_0 \times_B W$ such that $U_0 \to X_0$ is surjective.
(This is possible by our choice of $W$ and the fact that $X_0$ is
quasi-compact; details omitted.)
Let $V \to Y$, resp.\ $U \to X$, resp.\ $U_i \to X_i$ be the base change
of $U_0 \to X_0$ (for $i \geq 0$). It suffices to prove that $V \to U_i$
is a closed immersion for $i$ sufficiently large. Thus we reduce
to proving the result for $V \to U = \lim U_i$ over $W$. This follows from
the case of schemes, which is
Limits, Lemma \ref{limits-lemma-finite-type-eventually-closed}.

\medskip\noindent
Proof of (2). Choose $0 \in I$. Choose a quasi-compact open subspace
$X'_0 \subset X_0$ such that $Y \to X_0$ factors through $X'_0$.
After replacing $X_i$ by the inverse image of $X'_0$ for $i \geq 0$
we may assume all $X_i'$ are quasi-compact and quasi-separated.
Let $U \subset X$ be a quasi-compact open such that $Y \to X$ factors
through a closed immersion $Y \to U$ ($U$ exists as $Y$ is quasi-compact). By
Lemma \ref{lemma-descend-opens}
we may assume that $U = \lim U_i$ with $U_i \subset X_i$ quasi-compact
open. By part (1) we see that $Y \to U_i$ is a closed immersion for some
$i$. Thus (2) holds.

\medskip\noindent
Proof of (3). Choose $0 \in I$. Choose an affine scheme $U_0$
and a surjective \'etale morphism $U_0 \to X_0$.
Set $U_i = X_i \times_{X_0} U_0$,
$U = X \times_{X_0} U_0 = Y \times_{X_0} U_0$. Then $U = \lim U_i$ is a
limit of affine schemes, the transition maps of the system are closed
immersions, and $U \to U_0$ is of finite presentation (because
$U \to B$ is locally of finite presentation and $U_0 \to B$ is locally
of finite type and
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-finite-presentation-permanence}).
Thus we've reduced to the following algebra fact: If $A = \lim A_i$
is a directed colimit of $R$-algebras with surjective transition
maps and $A$ of finite presentation over $A_0$, then $A = A_i$ for
some $i$. Namely, write $A = A_0/(f_1, \ldots, f_n)$. Pick $i$ such
that $f_1, \ldots, f_n$ map to zero under the surjective map $A_0 \to A_i$.

\medskip\noindent
Proof of (4). Set $Z_i = Y \times_{X_i} Y$.
As the transition morphisms $X_{i'} \to X_i$ are affine hence separated,
the transition morphisms $Z_{i'} \to Z_i$ are closed immersions, see
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-fibre-product-after-map}.
We have $\lim Z_i = Y \times_X Y = Y$ as $Y \to X$ is a monomorphism.
Choose $0 \in I$. Since $Y \to X_0$ is locally of finite type
(Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-permanence-finite-type})
the morphism $Y \to Z_0$ is locally of finite presentation
(Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-diagonal-morphism-finite-type}).
The morphisms $Z_i \to Z_0$ are locally of finite type
(they are closed immersions).
Finally, $Z_i = Y \times_{X_i} Y$ is quasi-compact as
$X_i$ is quasi-separated and $Y$ is quasi-compact.
Thus part (3) applies to $Y = \lim_{i \geq 0} Z_i$ over $Z_0$
and we conclude $Y = Z_i$ for some $i$. This proves (4) and the lemma.
\end{proof}

\begin{lemma}
\label{lemma-eventually-separated}
Let $S$ be a scheme. Let $Y$ be an algebraic space over $S$.
Let $X = \lim X_i$ be a directed limit of algebraic spaces over $Y$
with affine transition morphisms. Assume
\begin{enumerate}
\item $Y$ is quasi-separated,
\item $X_i$ is quasi-compact and quasi-separated,
\item the morphism $X \to Y$ is separated.
\end{enumerate}
Then $X_i \to Y$ is separated for all $i$ large enough.
\end{lemma}

\begin{proof}
Let $0 \in I$. Choose an affine scheme $W$ and an \'etale morphism
$W \to Y$ such that the image of $|W| \to |Y|$ contains the image of
$|X_0| \to |Y|$. This is possible as $X_0$ is quasi-compact.
It suffices to check that $W \times_Y X_i \to W$ is separated
for some $i \geq 0$ because the diagonal of $W \times_Y X_i$
over $W$ is the base change of $X_i \to X_i \times_Y X_i$ by
the surjective \'etale morphism $(X_i \times_Y X_i) \times_Y W \to
X_i \times_Y X_i$. Since $Y$ is quasi-separated the algebraic spaces
$W \times_Y X_i$ are quasi-compact (as well as quasi-separated).
Thus we may base change to $W$ and assume $Y$ is an affine scheme.
When $Y$ is an affine scheme, we have to show that $X_i$ is a
separated algebraic space for $i$ large enough and we are given that
$X$ is a separated algebraic space. Thus this case follows from
Lemma \ref{lemma-descend-separated}.
\end{proof}












\section{Descending properties of morphisms}
\label{section-descent-of-properties}

\noindent
This section is the analogue of Section \ref{section-descent}
for properties of morphisms. We will work in the following situation.

\begin{situation}
\label{situation-descent-property}
Let $S$ be a scheme. Let $B = \lim B_i$ be a limit of a directed system
of algebraic spaces over $S$ with affine transition morphisms
(Lemma \ref{lemma-directed-inverse-system-has-limit}).
Let $0 \in I$ and let $f_0 : X_0 \to Y_0$ be a morphism of algebraic spaces
over $B_0$. Assume $B_0$, $X_0$, $Y_0$ are quasi-compact and quasi-separated.
Let $f_i : X_i \to Y_i$ be the base change of $f_0$ to $B_i$ and
let $f : X \to Y$ be the base change of $f_0$ to $B$.
\end{situation}

\begin{lemma}
\label{lemma-descend-etale}
With notation and assumptions as in
Situation \ref{situation-descent-property}. If
\begin{enumerate}
\item $f$ is \'etale,
\item $f_0$ is locally of finite presentation,
\end{enumerate}
then $f_i$ is \'etale for some $i \geq 0$.
\end{lemma}

\begin{proof}
Choose an affine scheme $V_0$ and a surjective \'etale morphism
$V_0 \to Y_0$. Choose an affine scheme $U_0$ and a surjective \'etale
morphism $U_0 \to V_0 \times_{Y_0} X_0$. Diagram
$$
\xymatrix{
U_0 \ar[d] \ar[r] & V_0 \ar[d] \\
X_0 \ar[r] & Y_0
}
$$
The vertical arrows are surjective and \'etale by construction.
We can base change this diagram to $B_i$ or $B$ to get
$$
\vcenter{
\xymatrix{
U_i \ar[d] \ar[r] & V_i \ar[d] \\
X_i \ar[r] & Y_i
}
}
\quad\text{and}\quad
\vcenter{
\xymatrix{
U \ar[d] \ar[r] & V \ar[d] \\
X \ar[r] & Y
}
}
$$
Note that $U_i, V_i, U, V$ are affine schemes,
the vertical morphisms are surjective \'etale, and the limit of the
morphisms $U_i \to V_i$ is $U \to V$. Recall that $X_i \to Y_i$ is \'etale
if and only if $U_i \to V_i$ is
\'etale and similarly $X \to Y$ is \'etale if and only if
$U \to V$ is \'etale
(Morphisms of Spaces, Definition \ref{spaces-morphisms-definition-etale}).
Since $f_0$ is locally of finite
presentation, so is the morphism $U_0 \to V_0$. Hence the lemma follows
from Limits, Lemma \ref{limits-lemma-descend-etale}.
\end{proof}

\begin{lemma}
\label{lemma-descend-surjective}
With notation and assumptions as in
Situation \ref{situation-descent-property}. If
\begin{enumerate}
\item $f$ is surjective,
\item $f_0$ is locally of finite presentation,
\end{enumerate}
then $f_i$ is surjective for some $i \geq 0$.
\end{lemma}

\begin{proof}
Choose an affine scheme $V_0$ and a surjective \'etale morphism
$V_0 \to Y_0$. Choose an affine scheme $U_0$ and a surjective \'etale
morphism $U_0 \to V_0 \times_{Y_0} X_0$. Diagram
$$
\xymatrix{
U_0 \ar[d] \ar[r] & V_0 \ar[d] \\
X_0 \ar[r] & Y_0
}
$$
The vertical arrows are surjective and \'etale by construction.
We can base change this diagram to $B_i$ or $B$ to get
$$
\vcenter{
\xymatrix{
U_i \ar[d] \ar[r] & V_i \ar[d] \\
X_i \ar[r] & Y_i
}
}
\quad\text{and}\quad
\vcenter{
\xymatrix{
U \ar[d] \ar[r] & V \ar[d] \\
X \ar[r] & Y
}
}
$$
Note that $U_i, V_i, U, V$ are affine schemes, the vertical morphisms are
surjective \'etale, the limit of the morphisms $U_i \to V_i$ is $U \to V$,
and the morphisms $U_i \to X_i \times_{Y_i} V_i$ and
$U \to X \times_Y V$ are surjective (as base changes of
$U_0 \to X_0 \times_{Y_0} V_0$). In particular, we see that
$X_i \to Y_i$ is surjective if and only if $U_i \to V_i$ is surjective
and similarly $X \to Y$ is surjective if and only if $U \to V$ is surjective.
Since $f_0$ is locally of finite
presentation, so is the morphism $U_0 \to V_0$. Hence the lemma follows
from the case of schemes (Limits, Lemma \ref{limits-lemma-descend-surjective}).
\end{proof}

\begin{lemma}
\label{lemma-descend-universally-injective}
Notation and assumptions as in Situation \ref{situation-descent-property}. If
\begin{enumerate}
\item $f$ is universally injective,
\item $f_0$ is locally of finite type,
\end{enumerate}
then $f_i$ is universally injective for some $i \geq 0$.
\end{lemma}

\begin{proof}
Recall that a morphism $X \to Y$ is universally injective if and
only if the diagonal $X \to X \times_Y X$ is surjective
(Morphisms of Spaces, Definition
\ref{spaces-morphisms-definition-universally-injective} and
Lemma \ref{spaces-morphisms-lemma-universally-injective}).
Observe that $X_0 \to X_0 \times_{Y_0} X_0$ is of locally of finite
presentation (Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-diagonal-morphism-finite-type}).
Hence the lemma follows from Lemma \ref{lemma-descend-surjective}
by considering the morphism $X_0 \to X_0 \times_{Y_0} X_0$.
\end{proof}

\begin{lemma}
\label{lemma-descend-affine}
Notation and assumptions as in Situation \ref{situation-descent-property}. If
$f$ is affine, then $f_i$ is affine for some $i \geq 0$.
\end{lemma}

\begin{proof}
Choose an affine scheme $V_0$ and a surjective \'etale morphism $V_0 \to Y_0$.
Set $V_i = V_0 \times_{Y_0} Y_i$ and $V = V_0 \times_{Y_0} Y$.
Since $f$ is affine we see that $V \times_Y X = \lim V_i \times_{Y_i} X_i$
is affine. By Lemma \ref{lemma-limit-is-affine} we see that
$V_i \times_{Y_i} X_i$ is affine for some $i \geq 0$. For this $i$ the morphism
$f_i$ is affine
(Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-affine-local}).
\end{proof}

\begin{lemma}
\label{lemma-descend-finite}
Notation and assumptions as in Situation \ref{situation-descent-property}. If
\begin{enumerate}
\item $f$ is finite,
\item $f_0$ is locally of finite type,
\end{enumerate}
then $f_i$ is finite for some $i \geq 0$.
\end{lemma}

\begin{proof}
Choose an affine scheme $V_0$ and a surjective \'etale morphism $V_0 \to Y_0$.
Set $V_i = V_0 \times_{Y_0} Y_i$ and $V = V_0 \times_{Y_0} Y$.
Since $f$ is finite we see that $V \times_Y X = \lim V_i \times_{Y_i} X_i$
is a scheme finite over $V$. By Lemma \ref{lemma-limit-is-affine} we see that
$V_i \times_{Y_i} X_i$ is affine for some $i \geq 0$. Increasing $i$ if
necessary we find that $V_i \times_{Y_i} X_i \to V_i$ is finite by
Limits, Lemma \ref{limits-lemma-descend-finite-finite-presentation}.
For this $i$ the morphism $f_i$ is finite
(Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-integral-local}).
\end{proof}

\begin{lemma}
\label{lemma-descend-closed-immersion}
Notation and assumptions as in Situation \ref{situation-descent-property}. If
\begin{enumerate}
\item $f$ is a closed immersion,
\item $f_0$ is locally of finite type,
\end{enumerate}
then $f_i$ is a closed immersion for some $i \geq 0$.
\end{lemma}

\begin{proof}
Choose an affine scheme $V_0$ and a surjective \'etale morphism $V_0 \to Y_0$.
Set $V_i = V_0 \times_{Y_0} Y_i$ and $V = V_0 \times_{Y_0} Y$.
Since $f$ is a closed immersion we see that
$V \times_Y X = \lim V_i \times_{Y_i} X_i$
is a closed subscheme of the affine scheme $V$. By
Lemma \ref{lemma-limit-is-affine} we see that
$V_i \times_{Y_i} X_i$ is affine for some $i \geq 0$. Increasing $i$ if
necessary we find that $V_i \times_{Y_i} X_i \to V_i$ is a closed immersion by
Limits, Lemma \ref{limits-lemma-descend-closed-immersion-finite-presentation}.
For this $i$ the morphism $f_i$ is a closed immersion
(Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-integral-local}).
\end{proof}

\begin{lemma}
\label{lemma-descend-separated-morphism}
Notation and assumptions as in Situation \ref{situation-descent-property}.
If $f$ is separated, then $f_i$ is separated for some $i \geq 0$.
\end{lemma}

\begin{proof}
Apply Lemma \ref{lemma-descend-closed-immersion}
to the diagonal morphism $\Delta_{X_0/Y_0} : X_0 \to X_0 \times_{Y_0} X_0$.
(Diagonal morphisms are locally of finite type
and the fibre product $X_0 \times_{Y_0} X_0$ is quasi-compact and
quasi-separated. Some details omitted.)
\end{proof}

\begin{lemma}
\label{lemma-descend-isomorphism}
Notation and assumptions as in Situation \ref{situation-descent-property}. If
\begin{enumerate}
\item $f$ is a isomorphism,
\item $f_0$ is locally of finite presentation,
\end{enumerate}
then $f_i$ is a isomorphism for some $i \geq 0$.
\end{lemma}

\begin{proof}
Being an isomorphism is equivalent to being \'etale, universally injective,
and surjective, see
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-etale-universally-injective-open}.
Thus the lemma follows from
Lemmas \ref{lemma-descend-etale},
\ref{lemma-descend-surjective}, and
\ref{lemma-descend-universally-injective}.
\end{proof}

\begin{lemma}
\label{lemma-descend-monomorphism}
Notation and assumptions as in Situation \ref{situation-descent-property}. If
\begin{enumerate}
\item $f$ is a monomorphism,
\item $f_0$ is locally of finite type,
\end{enumerate}
then $f_i$ is a monomorphism for some $i \geq 0$.
\end{lemma}

\begin{proof}
Recall that a morphism is a monomorphism if and only if the diagonal is
an isomorphism. The morphism $X_0 \to X_0 \times_{Y_0} X_0$ is locally of
finite presentation by
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-diagonal-morphism-finite-type}.
Since $X_0 \times_{Y_0} X_0$ is quasi-compact and quasi-separated
we conclude from
Lemma \ref{lemma-descend-isomorphism}
that $\Delta_i : X_i \to X_i \times_{Y_i} X_i$ is an isomorphism for
some $i \geq 0$. For this $i$ the morphism $f_i$ is a monomorphism.
\end{proof}

\begin{lemma}
\label{lemma-descend-flat}
Notation and assumptions as in Situation \ref{situation-descent-property}.
Let $\mathcal{F}_0$ be a quasi-coherent $\mathcal{O}_{X_0}$-module
and denote $\mathcal{F}_i$ the pullback to $X_i$ and $\mathcal{F}$
the pullback to $X$. If
\begin{enumerate}
\item $\mathcal{F}$ is flat over $Y$,
\item $\mathcal{F}_0$ is of finite presentation, and
\item $f_0$ is locally of finite presentation,
\end{enumerate}
then $\mathcal{F}_i$ is flat over $Y_i$ for some $i \geq 0$.
In particular, if $f_0$ is locally of finite presentation and
$f$ is flat, then $f_i$ is flat for some $i \geq 0$.
\end{lemma}

\begin{proof}
Choose an affine scheme $V_0$ and a surjective \'etale morphism
$V_0 \to Y_0$. Choose an affine scheme $U_0$ and a surjective \'etale
morphism $U_0 \to V_0 \times_{Y_0} X_0$. Diagram
$$
\xymatrix{
U_0 \ar[d] \ar[r] & V_0 \ar[d] \\
X_0 \ar[r] & Y_0
}
$$
The vertical arrows are surjective and \'etale by construction.
We can base change this diagram to $B_i$ or $B$ to get
$$
\vcenter{
\xymatrix{
U_i \ar[d] \ar[r] & V_i \ar[d] \\
X_i \ar[r] & Y_i
}
}
\quad\text{and}\quad
\vcenter{
\xymatrix{
U \ar[d] \ar[r] & V \ar[d] \\
X \ar[r] & Y
}
}
$$
Note that $U_i, V_i, U, V$ are affine schemes, the vertical morphisms are
surjective \'etale, and the limit of the morphisms $U_i \to V_i$ is
$U \to V$. Recall that $\mathcal{F}_i$ is flat over $Y_i$ if and only if
$\mathcal{F}_i|_{U_i}$ is flat over $V_i$ and similarly $\mathcal{F}$ is flat
over $Y$ if and only if $\mathcal{F}|_U$ is flat over $V$
(Morphisms of Spaces, Definition \ref{spaces-morphisms-definition-flat}).
Since $f_0$ is locally of finite presentation, so is the morphism
$U_0 \to V_0$. Hence the lemma follows
from Limits, Lemma \ref{limits-lemma-descend-module-flat-finite-presentation}.
\end{proof}

\begin{lemma}
\label{lemma-eventually-proper}
Assumptions and notation as in Situation \ref{situation-descent-property}.
If
\begin{enumerate}
\item $f$ is proper, and
\item $f_0$ is locally of finite type,
\end{enumerate}
then there exists an $i$ such that $f_i$ is proper.
\end{lemma}

\begin{proof}
Choose an affine scheme $V_0$ and a surjective \'etale morphism $V_0 \to Y_0$.
Set $V_i = Y_i \times_{Y_0} V_0$ and $V = Y \times_{Y_0} V_0$.
It suffices to prove that the base change of $f_i$ to $V_i$ is
proper, see Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-proper-local}.
Thus we may assume $Y_0$ is affine.

\medskip\noindent
By Lemma \ref{lemma-descend-separated-morphism} we see that
$f_i$ is separated for some $i \geq 0$. Replacing
$0$ by $i$ we may assume that $f_0$ is separated.
Observe that $f_0$ is quasi-compact. Thus $f_0$ is separated and
of finite type. By
Cohomology of Spaces, Lemma \ref{spaces-cohomology-lemma-weak-chow}
we can choose a diagram
$$
\xymatrix{
X_0 \ar[rd] & X_0' \ar[d] \ar[l]^\pi \ar[r] & \mathbf{P}^n_{Y_0} \ar[dl] \\
& Y_0 &
}
$$
where $X_0' \to \mathbf{P}^n_{Y_0}$ is an immersion, and
$\pi : X_0' \to X_0$ is proper and surjective. Introduce
$X' = X_0' \times_{Y_0} Y$ and $X_i' = X_0' \times_{Y_0} Y_i$.
By Morphisms of Spaces, Lemmas
\ref{spaces-morphisms-lemma-composition-proper} and
\ref{spaces-morphisms-lemma-base-change-proper}
we see that $X' \to Y$ is proper. Hence $X' \to \mathbf{P}^n_Y$ is
a closed immersion (Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-universally-closed-permanence}). By
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-image-proper-is-proper}
it suffices to prove that $X'_i \to Y_i$ is proper for some $i$.
By Lemma \ref{lemma-descend-closed-immersion}
we find that $X'_i \to \mathbf{P}^n_{Y_i}$ is
a closed immersion for $i$ large enough. Then $X'_i \to Y_i$
is proper and we win.
\end{proof}

\noindent
Recall the scheme theoretic support of
a finite type quasi-coherent module, see
Morphisms of Spaces, Definition
\ref{spaces-morphisms-definition-scheme-theoretic-support}.

\begin{lemma}
\label{lemma-eventually-proper-support}
Assumptions and notation as in Situation \ref{situation-descent-property}.
Let $\mathcal{F}_0$ be a quasi-coherent $\mathcal{O}_{X_0}$-module.
Denote $\mathcal{F}$ and $\mathcal{F}_i$ the pullbacks of
$\mathcal{F}_0$ to $X$ and $X_i$. Assume
\begin{enumerate}
\item $f_0$ is locally of finite type,
\item $\mathcal{F}_0$ is of finite type,
\item the scheme theoretic support of $\mathcal{F}$ is proper over $Y$.
\end{enumerate}
Then the scheme theoretic support of $\mathcal{F}_i$ is proper over $Y_i$
for some $i$.
\end{lemma}

\begin{proof}
We may replace $X_0$ by the scheme theoretic support of $\mathcal{F}_0$.
By Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-support-finite-type}
this guarantees that $X_i$ is the support of $\mathcal{F}_i$ and $X$ is the
support of $\mathcal{F}$. Then, if $Z \subset X$ denotes the scheme
theoretic support of $\mathcal{F}$, we see that $Z \to X$ is a universal
homeomorphism. We conclude that $X \to Y$ is proper as this is true for
$Z \to Y$ by assumption, see
Morphisms, Lemma \ref{morphisms-lemma-image-proper-is-proper}.
By Lemma \ref{lemma-eventually-proper} we see that $X_i \to Y$ is proper
for some $i$. Then it follows that the scheme theoretic support $Z_i$ of
$\mathcal{F}_i$ is proper over $Y$ by
Morphisms of Spaces, Lemmas
\ref{spaces-morphisms-lemma-closed-immersion-proper} and
\ref{spaces-morphisms-lemma-composition-proper}.
\end{proof}














\section{Descending relative objects}
\label{section-descending-relative}

\noindent
The following lemma is typical of the type of results in this section.

\begin{lemma}
\label{lemma-descend-finite-presentation}
Let $S$ be a scheme. Let $I$ be a directed partially ordered set.
Let $(X_i, f_{ii'})$ be an inverse system over $I$ of algebraic spaces
over $S$. Assume
\begin{enumerate}
\item the morphisms $f_{ii'} : X_i \to X_{i'}$ are affine,
\item the spaces $X_i$ are quasi-compact and quasi-separated.
\end{enumerate}
Let $X = \lim_i X_i$. Then the category of algebraic spaces
of finite presentation over $X$ is the colimit over $I$ of the
categories of algebraic spaces of finite presentation over $X_i$.
\end{lemma}

\begin{proof}
Pick $0 \in I$. Choose a surjective \'etale morphism $U_0 \to X_0$ where
$U_0$ is an affine scheme (Properties of Spaces, Lemma
\ref{spaces-properties-lemma-quasi-compact-affine-cover}).
Set $U_i = X_i \times_{X_0} U_0$. Set $R_0 = U_0 \times_{X_0} U_0$ and
$R_i = R_0 \times_{X_0} X_i$. Denote $s_i, t_i : R_i \to U_i$ and
$s, t : R \to U$ the two projections. In the proof of
Lemma \ref{lemma-directed-inverse-system-has-limit} we have
seen that there exists a presentation $X = U/R$ with
$U = \lim U_i$ and $R = \lim R_i$. Note that $U_i$ and $U$ are affine and
that $R_i$ and $R$ are quasi-compact and separated (as $X_i$ is
quasi-separated). Let $Y$ be an algebraic space over $S$ and let
$Y \to X$ be a morphism of finite presentation. Set $V = U \times_X Y$.
This is an algebraic space of finite presentation over $U$.
Choose an affine scheme $W$ and a surjective \'etale morphism $W \to V$.
Then $W \to Y$ is surjective \'etale as well. Set $R' = W \times_Y W$
so that $Y = W/R'$ (see Spaces, Section \ref{spaces-section-presentations}).
Note that $W$ is a scheme of finite presentation over $U$ and that $R'$
is a scheme of finite presentation over $R$ (details omitted).
By Limits, Lemma \ref{limits-lemma-descend-finite-presentation}
we can find an index $i$ and a morphism of schemes $W_i \to U_i$ of
finite presentation whose base change to $U$ gives $W \to U$. Similarly
we can find, after possibly increasing $i$, a scheme $R'_i$ of finite
presentation over $R_i$ whose base change to $R$ is $R'$.
The projection morphisms $s', t' : R' \to W$ are morphisms over
the projection morphisms $s, t : R \to U$. Hence we can view $s'$,
resp.\ $t'$ as a morphism between schemes of finite presentation over
$U$ (with structure morphism $R' \to U$ given by $R' \to R$ followed
by $s$, resp.\ $t$). Hence we can apply
Limits, Lemma \ref{limits-lemma-descend-finite-presentation}
again to see that, after possibly increasing $i$, there exist
morphisms $s'_i, t'_i : R'_i \to W_i$, whose base change to $U$
is $S', t'$. By Limits, Lemmas \ref{limits-lemma-descend-etale} and
\ref{limits-lemma-descend-monomorphism}
we may assume that $s'_i, t'_i$ are \'etale and that
$j'_i : R'_i \to W_i \times_{X_i} W_i$ is a monomorphism (here we
view $j'_i$ as a morphism of schemes of finite presentation over $U_i$ via
one of the projections -- it doesn't matter which one). Setting
$Y_i = W_i/R'_i$ (see Spaces, Theorem \ref{spaces-theorem-presentation})
we obtain an algebraic space of finite presentation
over $X_i$ whose base change to $X$ is isomorphic to $Y$.

\medskip\noindent
This shows that every algebraic space of finite presentation over $X$ comes
from an algebraic space of finite presentation over some $X_i$, i.e.,
it shows that the functor of the lemma is essentially surjective. To
show that it is fully faithful, consider an index $0 \in I$ and two
algebraic spaces $Y_0, Z_0$ of finite presentation over $X_0$.
Set $Y_i = X_i \times_{X_0} Y_0$, $Y = X \times_{X_0} Y_0$,
$Z_i = X_i \times_{X_0} Z_0$, and $Z = X \times_{X_0} Z_0$. Let
$\alpha : Y \to Z$ be a morphism of algebraic spaces over $X$.
Choose a surjective \'etale morphism $V_0 \to Y_0$ where $V_0$ is
an affine scheme. Set $V_i = V_0 \times_{Y_0} Y_i$ and
$V = V_0 \times_{Y_0} Y$ which are affine schemes endowed with
surjective \'etale morphisms to $Y_i$ and $Y$. The composition
$V \to Y \to Z \to Z_0$ comes from a (essentially unique) morphism
$V_i \to Z_0$ for some $i \geq 0$ by
Proposition \ref{proposition-characterize-locally-finite-presentation}
(applied to $Z_0 \to X_0$ which is of finite presentation by assumption).
After increasing $i$ the two compositions
$$
V_i \times_{Y_i} V_i \to V_i \to Z_0
$$
are equal as this is true in the limit. Hence we obtain a (essentially unique)
morphism $Y_i \to Z_0$. Since this is a morphism over $X_0$
it induces a morphism into $Z_i = Z_0 \times_{X_0} X_i$ as desired.
\end{proof}

\begin{lemma}
\label{lemma-descend-modules-finite-presentation}
With notation and assumptions as in
Lemma \ref{lemma-descend-finite-presentation}.
The category of $\mathcal{O}_X$-modules of finite presentation is the
colimit over $I$ of the categories $\mathcal{O}_{X_i}$-modules of finite
presentation.
\end{lemma}

\begin{proof}
Choose $0 \in I$. Choose an affine scheme $U_0$ and a surjective
\'etale morphism $U_0 \to X_0$. Set $U_i = X_i \times_{X_0} U_0$.
Set $R_0 = U_0 \times_{X_0} U_0$ and $R_i = R_0 \times_{X_0} X_i$.
Denote $s_i, t_i : R_i \to U_i$ and $s, t : R \to U$ the two
projections. In the proof of
Lemma \ref{lemma-directed-inverse-system-has-limit} we have
seen that there exists a presentation $X = U/R$ with
$U = \lim U_i$ and $R = \lim R_i$. Note that $U_i$ and $U$ are affine and
that $R_i$ and $R$ are quasi-compact and separated (as $X_i$ is
quasi-separated). Moreover, it is also true that
$R \times_{s, U, t} R = \colim R_i \times_{s_i, U_i, t_i} R_i$.
Thus we know that
$\QCoh(\mathcal{O}_U) = \colim \QCoh(\mathcal{O}_{U_i})$,
$\QCoh(\mathcal{O}_R) = \colim \QCoh(\mathcal{O}_{R_i})$,
and
$\QCoh(\mathcal{O}_{R \times_{s, U, t} R}) =
\colim \QCoh(\mathcal{O}_{R_i \times_{s_i, U_i, t_i} R_i})$ by
Limits, Lemma \ref{limits-lemma-descend-modules-finite-presentation}.
We have $\QCoh(\mathcal{O}_X) = \QCoh(U, R, s, t, c)$ and
$\QCoh(\mathcal{O}_{X_i}) = \QCoh(U_i, R_i, s_i, t_i, c_i)$,
see Properties of Spaces, Proposition
\ref{spaces-properties-proposition-quasi-coherent}.
Thus the result follows formally.
\end{proof}














\section{Absolute Noetherian approximation}
\label{section-approximation}

\noindent
We use the following result which is almost identical to
\cite[Proposition 5.7.8]{GruRay}.

\begin{lemma}
\label{lemma-filter-quasi-compact-quasi-separated}
Let $X$ be a quasi-compact and quasi-separated algebraic space over
$\Spec(\mathbf{Z})$. There exist an integer $n$ and open subspaces
$$
\emptyset = U_{n + 1} \subset
U_n \subset U_{n - 1} \subset \ldots \subset U_1 = X
$$
with the following property: setting $T_p = U_p \setminus U_{p + 1}$
(with reduced induced subspace structure) there exists a quasi-compact
separated scheme $V_p$ and a surjective \'etale morphism $f_p : V_p \to U_p$
such that $f_p^{-1}(T_p) \to T_p$ is an isomorphism.
\end{lemma}

\begin{proof}
The proof of this lemma is identical to the proof of
Decent Spaces, Lemma \ref{decent-spaces-lemma-filter-reasonable}.
Observe that a quasi-separated space is reasonable, see
Decent Spaces, Lemma \ref{decent-spaces-lemma-bounded-fibres} and
Decent Spaces, Definition \ref{decent-spaces-definition-very-reasonable}.
At the end of the argument we add that since $X$ is quasi-separated
the schemes $V \times_X \ldots \times_X V$ are all quasi-compact.
Hence the schemes $W_p$ are quasi-compact. Hence the schemes
$V_p = W_p/S_p$ are quasi-compact.
\end{proof}

\begin{proposition}
\label{proposition-approximate}
Let $X$ be a quasi-compact and quasi-separated algebraic space over
$\Spec(\mathbf{Z})$. There exist a directed partially ordered set $I$
and an inverse system of algebraic spaces $(X_i, f_{ii'})$ over $I$
such that
\begin{enumerate}
\item the transition morphisms $f_{ii'}$ are affine
\item each $X_i$ is quasi-separated and of finite type over
$\mathbf{Z}$, and
\item $X = \lim X_i$.
\end{enumerate}
\end{proposition}

\begin{proof}
Following \cite{CLO}. We apply Lemma
\ref{lemma-filter-quasi-compact-quasi-separated}
to get open subspaces $U_p \subset X$, schemes $V_p$, and morphisms
$f_p : V_p \to U_p$ with properties as stated. Note that
$f_n : V_n \to U_n$ is an \'etale morphism of algebraic spaces
whose restriction to the inverse image of $T_n = (V_n)_{red}$ is an
isomorphism. Hence $f_n$ is an isomorphism, for example by
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-etale-universally-injective-open}.
In particular $U_n$ is a quasi-compact and separated scheme.
Thus we can write $U_n = \lim U_{n, i}$ as a directed limit
of schemes of finite type over $\mathbf{Z}$ with affine transition
morphisms, see Limits, Proposition \ref{limits-proposition-approximate}.
Thus, applying descending induction on $p$, we see that we have reduced
to the problem posed in the following paragraph.

\medskip\noindent
Here we have $U \subset X$, $U = \lim U_i$, $Z \subset X$, and
$f : V \to X$ with the following properties
\begin{enumerate}
\item $X$ is a quasi-compact and quasi-separated algebraic space,
\item $V$ is a quasi-compact and separated scheme,
\item $U \subset X$ is a quasi-compact open subspace,
\item $(U_i, g_{ii'})$ is a directed system of quasi-separated algebraic spaces
of finite type over $\mathbf{Z}$ with affine transition morphisms
whose limit is $U$,
\item $Z \subset X$ is a closed subspace such that $|X| = |U| \amalg |Z|$,
\item $f : V \to X$ is a surjective \'etale morphism such that
$f^{-1}(Z) \to Z$ is an isomorphism.
\end{enumerate}
Problem: Show that the conclusion of the proposition holds for $X$.

\medskip\noindent
Note that $W = f^{-1}(U) \subset V$ is a quasi-compact open subscheme
\'etale over $U$. Hence we may apply
Lemmas \ref{lemma-descend-finite-presentation} and \ref{lemma-descend-etale}
to find an index $0 \in I$ and an \'etale morphism $W_0 \to U_0$
of finite presentation whose base change to $U$ produces $W$. Setting
$W_i = W_0 \times_{U_0} U_i$ we see that $W = \lim_{i \geq 0} W_i$. After
increasing $0$ we may assume the $W_i$ are schemes, see
Lemma \ref{lemma-limit-is-scheme}.
Moreover, $W_i$ is of finite type over $\mathbf{Z}$.

\medskip\noindent
Apply Limits, Lemma \ref{limits-lemma-approximate} to
$W = \lim_{i \geq 0} W_i$ and the inclusion $W \subset V$. Replace $I$
by the directed partially ordered set $J$ found in that lemma. This allows us
to write $V$ as a directed limit $V = \lim V_i$ of finite type schemes over
$\mathbf{Z}$ with affine transition maps such that each $V_i$ contains
$W_i$ as an open subscheme (compatible with transition morphisms).
For each $i$ we can form the push out
$$
\xymatrix{
W_i \ar[r] \ar[d]_\Delta & V_i \ar[d] \\
W_i \times_{U_i} W_i \ar[r] & R_i
}
$$
in the category of schemes. Namely, the left vertical and upper horizontal
arrows are open immersions of schemes. In other words, we can construct
$R_i$ as the glueing of $V_i$ and $W_i \times_{U_i} W_i$ along the common open
$W_i$ (see Schemes, Section \ref{schemes-section-glueing-schemes}). Note that
the \'etale projection maps $W_i \times_{U_i} W_i \to W_i$ extend
to \'etale morphisms $s_i, t_i : R_i \to V_i$. It is clear that the
morphism $j_i = (t_i, s_i) : R_i \to V_i \times V_i$ is an \'etale
equivalence relation on $V_i$. Note that $W_i \times_{U_i} W_i$ is
quasi-compact (as $U_i$ is quasi-separated and $W_i$ quasi-compact)
and $V_i$ is quasi-compact, hence $R_i$ is quasi-compact. For
$i \geq i'$ the diagram
\begin{equation}
\label{equation-cartesian}
\vcenter{
\xymatrix{
R_i \ar[r] \ar[d]_{s_i} & R_{i'} \ar[d]^{s_{i'}} \\
V_i \ar[r] & V_{i'}
}
}
\end{equation}
is cartesian because
$$
(W_{i'} \times_{U_{i'}} W_{i'}) \times_{U_{i'}} U_i =
W_{i'} \times_{U_{i'}} U_i \times_{U_i} U_i \times_{U_{i'}} W_{i'} =
W_i \times_{U_i} W_i.
$$
Consider the algebraic space $X_i = V_i/R_i$ (see
Spaces, Theorem \ref{spaces-theorem-presentation}).
As $V_i$ is of finite type over $\mathbf{Z}$ and $R_i$ is quasi-compact
we see that $X_i$ is quasi-separated and of finite type over $\mathbf{Z}$
(see
Properties of Spaces, Lemma \ref{spaces-properties-lemma-quasi-separated}
and
Morphisms of Spaces, Lemmas
\ref{spaces-morphisms-lemma-surjection-from-quasi-compact} and
\ref{spaces-morphisms-lemma-finite-type-local}).
As the construction of $R_i$ above is compatible
with transition morphisms, we obtain morphisms of algebraic spaces
$X_i \to X_{i'}$ for $i \geq i'$. The commutative diagrams
$$
\xymatrix{
V_i \ar[r] \ar[d] & V_{i'} \ar[d] \\
X_i \ar[r] & X_{i'}
}
$$
are cartesian as (\ref{equation-cartesian}) is cartesian, see
Groupoids, Lemma \ref{groupoids-lemma-criterion-fibre-product}.
Since $V_i \to V_{i'}$ is affine, this implies that $X_i \to X_{i'}$
is affine, see
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-affine-local}.
Thus we can form the limit $X' = \lim X_i$ by
Lemma \ref{lemma-directed-inverse-system-has-limit}.
We claim that $X \cong X'$ which finishes the proof of the proposition.

\medskip\noindent
Proof of the claim. Set $R = \lim R_i$.
By construction the algebraic space $X'$ comes
equipped with a surjective \'etale morphism $V \to X'$ such that
$$
V \times_{X'} V \cong R
$$
(use Lemma \ref{lemma-directed-inverse-system-has-limit}).
By construction $\lim W_i \times_{U_i} W_i = W \times_U W$ and $V = \lim V_i$
so that $R$ is the union of $W \times_U W$ and $V$ glued along $W$.
Property (6) implies the projections $V \times_X V \to V$ are isomorphisms
over $f^{-1}(Z) \subset V$. Hence the scheme $V \times_X V$ is the union
of the opens $\Delta_{V/X}(V)$ and $W \times_U W$ which intersect
along $\Delta_{W/X}(W)$. We conclude that there exists a unique isomorphism
$R \cong V \times_X V$ compatible with the projections to $V$.
Since $V \to X$ and $V \to X'$ are surjective \'etale we see that
$$
X = V/ V \times_X V = V/R = V/V \times_{X'} V = X'
$$
by Spaces, Lemma \ref{spaces-lemma-space-presentation} and we win.
\end{proof}




\section{Applications}
\label{section-applications}

\noindent
The following lemma can also be deduced directly from
Lemma \ref{lemma-filter-quasi-compact-quasi-separated}
without passing through absolute Noetherian approximation.

\begin{lemma}
\label{lemma-colimit-finitely-presented}
Let $S$ be a scheme. Let $X$ be a quasi-compact and quasi-separated algebraic
space over $S$. Every quasi-coherent $\mathcal{O}_X$-module is a
filtered colimit of finitely presented $\mathcal{O}_X$-modules.
\end{lemma}

\begin{proof}
We may view as an algebraic space over $\Spec(\mathbf{Z})$, see
Spaces, Definition \ref{spaces-definition-base-change} and
Properties of Spaces, Definition \ref{spaces-properties-definition-separated}.
Thus we may apply Proposition \ref{proposition-approximate}
and write $X = \lim X_i$ with $X_i$ of finite presentation over $\mathbf{Z}$.
Thus $X_i$ is a Noetherian algebraic space, see
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-finite-presentation-noetherian}.
The morphism $X \to X_i$ is affine, see
Lemma \ref{lemma-directed-inverse-system-has-limit}.
Conclusion by
Cohomology of Spaces, Lemma
\ref{spaces-cohomology-lemma-direct-colimit-finite-presentation}.
\end{proof}

\noindent
The rest of this section consists of straightforward
applications of Lemma \ref{lemma-colimit-finitely-presented}.

\begin{lemma}
\label{lemma-directed-colimit-finite-type}
Let $S$ be a scheme. Let $X$ be a quasi-compact and quasi-separated
algebraic space over $S$.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module.
Then $\mathcal{F}$ is the directed colimit of its finite type
quasi-coherent submodules.
\end{lemma}

\begin{proof}
If $\mathcal{G}, \mathcal{H} \subset \mathcal{F}$ are finite type
quasi-coherent $\mathcal{O}_X$-submodules then the image
of $\mathcal{G} \oplus \mathcal{H} \to \mathcal{F}$ is another
finite type quasi-coherent $\mathcal{O}_X$-submodule which contains
both of them. In this way we see that the system is directed.
To show that $\mathcal{F}$ is the colimit of this system, write
$\mathcal{F} = \colim_i \mathcal{F}_i$ as a directed
colimit of finitely presented quasi-coherent sheaves as in
Lemma \ref{lemma-colimit-finitely-presented}.
Then the images $\mathcal{G}_i = \text{Im}(\mathcal{F}_i \to \mathcal{F})$ are
finite type quasi-coherent subsheaves of $\mathcal{F}$. Since
$\mathcal{F}$ is the colimit of these the result follows.
\end{proof}

\begin{lemma}
\label{lemma-finite-directed-colimit-surjective-maps}
Let $S$ be a scheme. Let $X$ be a quasi-compact and quasi-separated
algebraic space over $S$. Let $\mathcal{F}$ be a finite type
quasi-coherent $\mathcal{O}_X$-module. Then we can write
$\mathcal{F} = \lim \mathcal{F}_i$ where each $\mathcal{F}_i$ is an
$\mathcal{O}_X$-module of finite presentation and all transition maps
$\mathcal{F}_i \to \mathcal{F}_{i'}$ surjective.
\end{lemma}

\begin{proof}
Write $\mathcal{F} = \colim \mathcal{G}_i$ as a filtered colimit of
finitely presented $\mathcal{O}_X$-modules
(Lemma \ref{lemma-colimit-finitely-presented}).
We claim that $\mathcal{G}_i \to \mathcal{F}$ is surjective for some $i$.
Namely, choose an \'etale surjection $U \to X$ where $U$ is an affine scheme.
Choose finitely many sections $s_k \in \mathcal{F}(U)$ generating
$\mathcal{F}|_U$. Since $U$ is affine we see that $s_k$ is in the image
of $\mathcal{G}_i \to \mathcal{F}$ for $i$ large enough. Hence
$\mathcal{G}_i \to \mathcal{F}$ is surjective for $i$ large enough.
Choose such an $i$ and let $\mathcal{K} \subset \mathcal{G}_i$ be the
kernel of the map $\mathcal{G}_i \to \mathcal{F}$. Write
$\mathcal{K} = \colim \mathcal{K}_a$
as the filtered colimit of its finite type quasi-coherent submodules
(Lemma \ref{lemma-directed-colimit-finite-type}). Then
$\mathcal{F} = \colim \mathcal{G}_i/\mathcal{K}_a$ is a solution
to the problem posed by the lemma.
\end{proof}

\noindent
Let $X$ be an algebraic space. In the following lemma we use the notion
of a {\it finitely presented quasi-coherent $\mathcal{O}_X$-algebra
$\mathcal{A}$}. This means that for every affine
$U = \Spec(R)$ \'etale over $X$ we have $\mathcal{A}|_U = \widetilde{A}$
where $A$ is a (commutative) $R$-algebra which is of finite presentation
as an $R$-algebra.

\begin{lemma}
\label{lemma-algebra-directed-colimit-finite-presentation}
Let $S$ be a scheme. Let $X$ be a quasi-compact and quasi-separated
algebraic space over $S$.
Let $\mathcal{A}$ be a quasi-coherent $\mathcal{O}_X$-algebra.
Then $\mathcal{A}$ is a directed colimit of finitely presented
quasi-coherent $\mathcal{O}_X$-algebras.
\end{lemma}

\begin{proof}
First we write $\mathcal{A} = \colim_i \mathcal{F}_i$ as a directed
colimit of finitely presented quasi-coherent sheaves as in
Lemma \ref{lemma-colimit-finitely-presented}.
For each $i$ let $\mathcal{B}_i = \text{Sym}(\mathcal{F}_i)$ be the
symmetric algebra on $\mathcal{F}_i$ over $\mathcal{O}_X$. Write
$\mathcal{I}_i = \Ker(\mathcal{B}_i \to \mathcal{A})$. Write
$\mathcal{I}_i = \colim_j \mathcal{F}_{i, j}$ where
$\mathcal{F}_{i, j}$ is a finite type quasi-coherent submodule of
$\mathcal{I}_i$, see
Lemma \ref{lemma-directed-colimit-finite-type}.
Set $\mathcal{I}_{i, j} \subset \mathcal{I}_i$
equal to the $\mathcal{B}_i$-ideal generated by $\mathcal{F}_{i, j}$.
Set $\mathcal{A}_{i, j} = \mathcal{B}_i/\mathcal{I}_{i, j}$.
Then $\mathcal{A}_{i, j}$ is a quasi-coherent finitely presented
$\mathcal{O}_X$-algebra. Define $(i, j) \leq (i', j')$ if
$i \leq i'$ and the map $\mathcal{B}_i \to \mathcal{B}_{i'}$
maps the ideal $\mathcal{I}_{i, j}$ into the ideal $\mathcal{I}_{i', j'}$.
Then it is clear that $\mathcal{A} = \colim_{i, j} \mathcal{A}_{i, j}$.
\end{proof}

\noindent
Let $X$ be an algebraic space. In the following lemma we use the notion
of a {\it quasi-coherent $\mathcal{O}_X$-algebra $\mathcal{A}$
of finite type}. This means that for every affine
$U = \Spec(R)$ \'etale over $X$ we have $\mathcal{A}|_U = \widetilde{A}$
where $A$ is a (commutative) $R$-algebra which is of finite type
as an $R$-algebra.

\begin{lemma}
\label{lemma-algebra-directed-colimit-finite-type}
Let $S$ be a scheme. Let $X$ be a quasi-compact and quasi-separated algebraic
space over $S$. Let $\mathcal{A}$ be a quasi-coherent $\mathcal{O}_X$-algebra.
Then $\mathcal{A}$ is the directed colimit of its finite type
quasi-coherent $\mathcal{O}_X$-subalgebras.
\end{lemma}

\begin{proof}
Omitted. Hint: Compare with the proof of
Lemma \ref{lemma-directed-colimit-finite-type}.
\end{proof}

\noindent
Let $X$ be an algebraic space. In the following lemma we use the notion
of a {\it finite (resp.\ integral) quasi-coherent
$\mathcal{O}_X$-algebra $\mathcal{A}$}. This means that for every
affine $U = \Spec(R)$ \'etale over $X$ we have
$\mathcal{A}|_U = \widetilde{A}$ where $A$ is a (commutative) $R$-algebra
which is finite (resp.\ integral) as an $R$-algebra.

\begin{lemma}
\label{lemma-integral-algebra-directed-colimit-finite}
Let $S$ be a scheme. Let $X$ be a quasi-compact and quasi-separated
algebraic space over $S$.
Let $\mathcal{A}$ be an integral quasi-coherent $\mathcal{O}_X$-algebra.
Then $\mathcal{A}$ is the directed colimit of its finite
quasi-coherent $\mathcal{O}_X$-subalgebras.
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-algebra-directed-colimit-finite-type} we have
$\mathcal{A} = \colim \mathcal{A}_i$ with $\mathcal{A}_i \subset \mathcal{A}$
of finite type. Then $\mathcal{A}_i$ is a finite quasi-coherent
$\mathcal{O}_X$-algebra by Algebra, Lemma
\ref{algebra-lemma-characterize-finite-in-terms-of-integral}.
\end{proof}

\begin{lemma}
\label{lemma-finite-algebra-directed-colimit-finite-finitely-presented}
Let $S$ be a scheme. Let $X$ be a quasi-compact and quasi-separated
algebraic space over $S$. Let $\mathcal{A}$ be a finite quasi-coherent
$\mathcal{O}_X$-algebra. Then $\mathcal{A} = \colim \mathcal{A}_i$
is a directed colimit of finite and finitely presented quasi-coherent
$\mathcal{O}_X$-algebras with surjective transition maps.
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-finite-directed-colimit-surjective-maps}
there exists a finitely presented $\mathcal{O}_X$-module
$\mathcal{F}$ and a surjection $\mathcal{F} \to \mathcal{A}$.
Using the algebra structure we obtain a surjection
$$
\text{Sym}^*_{\mathcal{O}_X}(\mathcal{F}) \longrightarrow \mathcal{A}
$$
Denote $\mathcal{J}$ the kernel. Write $\mathcal{J} = \colim \mathcal{E}_i$
as a filtered colimit of finite type $\mathcal{O}_X$-submodules
$\mathcal{E}_i$ (Lemma \ref{lemma-directed-colimit-finite-type}). Set
$$
\mathcal{A}_i = \text{Sym}^*_{\mathcal{O}_X}(\mathcal{F})/(\mathcal{E}_i)
$$
where $(\mathcal{E}_i)$ indicates the ideal sheaf generated by
the image of $\mathcal{E}_i \to \text{Sym}^*_{\mathcal{O}_X}(\mathcal{F})$.
Then each $\mathcal{A}_i$ is a finitely presented $\mathcal{O}_X$-algebra,
the transition maps are surjective, and $\mathcal{A} = \colim \mathcal{A}_i$.
To finish the proof we still
have to show that $\mathcal{A}_i$ is a finite $\mathcal{O}_X$-algebra
for $i$ sufficiently large. To do this we choose an \'etale surjective
map $U \to X$ where $U$ is an affine scheme. Take generators
$f_1, \ldots, f_m \in \Gamma(U, \mathcal{F})$.
As $\mathcal{A}(U)$ is a finite $\mathcal{O}_X(U)$-algebra we
see that for each $j$ there exists a monic polynomial
$P_j \in \mathcal{O}(U)[T]$ such that $P_j(f_j)$ is zero in $\mathcal{A}(U)$.
Since $\mathcal{A} = \colim \mathcal{A}_i$ by construction, we
have $P_j(f_j) = 0$ in $\mathcal{A}_i(U)$ for all sufficiently large $i$.
For such $i$ the algebras $\mathcal{A}_i$ are finite.
\end{proof}

\begin{lemma}
\label{lemma-extend}
Let $S$ be a scheme.
Let $X$ be a quasi-compact and quasi-separated algebraic space over $S$.
Let $U \subset X$ be a quasi-compact open.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module.
Let $\mathcal{G} \subset \mathcal{F}|_U$ be a quasi-coherent
$\mathcal{O}_U$-submodule which is of finite type. Then
there exists a quasi-coherent submodule $\mathcal{G}' \subset \mathcal{F}$
which is of finite type such that $\mathcal{G}'|_U = \mathcal{G}$.
\end{lemma}

\begin{proof}
Denote $j : U \to X$ the inclusion morphism. As $X$ is quasi-separated
and $U$ quasi-compact, the morphism $j$ is quasi-compact. Hence
$j_*\mathcal{G} \subset j_*\mathcal{F}|_U$ are quasi-coherent modules
on $X$ (Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-pushforward}).
Let $\mathcal{H} =
\Ker(j_*\mathcal{G} \oplus \mathcal{F} \to j_*\mathcal{F}|_U)$.
Then $\mathcal{H}|_U = \mathcal{G}$. By
Lemma \ref{lemma-directed-colimit-finite-type}
we can find a finite type quasi-coherent submodule
$\mathcal{H}' \subset \mathcal{H}$ such that
$\mathcal{H}'|_U = \mathcal{H}|_U = \mathcal{G}$.
Set $\mathcal{G}' = \text{Im}(\mathcal{H}' \to \mathcal{F})$
to conclude.
\end{proof}









\section{Relative approximation}
\label{section-relative-approximation}

\noindent
The title of this section refers to the following result.

\begin{lemma}
\label{lemma-relative-approximation}
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic spaces
over $S$. Assume that
\begin{enumerate}
\item $X$ is quasi-compact and quasi-separated, and
\item $Y$ is quasi-separated.
\end{enumerate}
Then $X = \lim X_i$ is a limit of a directed system of algebraic spaces
$X_i$ of finite presentation over $Y$ with affine transition morphisms
over $Y$.
\end{lemma}

\begin{proof}
Since $|f|(|X|)$ is quasi-compact we may replace $Y$ by a quasi-compact
open subspace whose set of points contains $|f|(|X|)$. Hence we may assume
$Y$ is quasi-compact as well. Write $X = \lim X_a$ and $Y = \lim Y_b$ as in
Proposition \ref{proposition-approximate}, i.e., with $X_a$ and $Y_b$
of finite type over $\mathbf{Z}$ and with affine transition morphisms.
By Proposition \ref{proposition-characterize-locally-finite-presentation}
we find that for each $b$ there exists an $a$ and a morphism
$f_{a, b} : X_a \to Y_b$ making the diagram
$$
\xymatrix{
X \ar[d] \ar[r] & Y \ar[d] \\
X_a \ar[r] & Y_b
}
$$
commute. Moreover the same proposition implies that, given a second
triple $(a', b', f_{a', b'})$, there exists an $a'' \geq a'$ such that
the compositions $X_{a''} \to X_a \to X_b$ and
$X_{a''} \to X_{a'} \to X_{b'} \to X_b$ are equal.
Consider the set of triples $(a, b, f_{a, b})$ endowed with the
partial ordering
$$
(a, b, f_{a, b}) \geq (a', b', f_{a', b'})
\Leftrightarrow
a \geq a',\ b' \geq b,\text{ and }
f_{a', b'} \circ h_{a, a'} = g_{b', b} \circ f_{a, b}
$$
where $h_{a, a'} : X_a \to X_{a'}$ and $g_{b', b} : Y_{b'} \to Y_b$
are the transition morphisms. The remarks above show that this system
is directed. It follows formally from the equalities
$X = \lim X_a$ and $Y = \lim Y_b$ that
$$
X = \lim_{(a, b, f_{a, b})} X_a \times_{f_{a, b}, Y_b} Y.
$$
where the limit is over our directed system above. The transition morphisms
$X_a \times_{Y_b} Y \to X_{a'} \times_{Y_{b'}} Y$ are affine as
the composition
$$
X_a \times_{Y_b} Y \to X_a \times_{Y_{b'}} Y \to X_{a'} \times_{Y_{b'}} Y
$$
where the first morphism is a closed immersion (by
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-fibre-product-after-map})
and the second is a base change of an affine morphism
(Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-base-change-affine})
and the composition of affine morphisms is affine
(Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-composition-affine}).
The morphisms $f_{a, b}$ are of finite presentation
(Morphisms of Spaces, Lemmas
\ref{spaces-morphisms-lemma-noetherian-finite-type-finite-presentation} and
\ref{spaces-morphisms-lemma-finite-presentation-permanence})
and hence the base changes $X_a \times_{f_{a, b}, S_b} S \to S$
are of finite presentation
(Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-base-change-finite-presentation}).
\end{proof}






\section{Finite type closed in finite presentation}
\label{section-finite-type-closed-in-finite-presentation}

\noindent
This section is the analogue of
Limits, Section \ref{limits-section-finite-type-closed-in-finite-presentation}.

\begin{lemma}
\label{lemma-affine-morphism-is-limit}
Let $S$ be a scheme. Let $f : X \to Y$ be an affine morphism of algebraic
spaces over $S$. If $Y$ quasi-compact and
quasi-separated, then $X$ is a directed limit $X = \lim X_i$
with each $X_i$ affine and of finite presentation over $Y$.
\end{lemma}

\begin{proof}
Consider the quasi-coherent $\mathcal{O}_Y$-module
$\mathcal{A} = f_*\mathcal{O}_X$. By
Lemma \ref{lemma-algebra-directed-colimit-finite-presentation}
we can write $\mathcal{A} = \colim \mathcal{A}_i$ as a directed
colimit of finitely presented
$\mathcal{O}_Y$-algebras $\mathcal{A}_i$.
Set $X_i = \underline{\Spec}_Y(\mathcal{A}_i)$, see
Morphisms of Spaces, Definition
\ref{spaces-morphisms-definition-relative-spec}.
By construction $X_i \to Y$ is affine and of finite presentation
and $X = \lim X_i$.
\end{proof}

\begin{lemma}
\label{lemma-finite-in-finite-and-finite-presentation}
Let $S$ be a scheme. Let $f : X \to Y$ be a finite morphism of algebraic
spaces over $S$. Assume $Y$ quasi-compact and quasi-separated.
Then $X$ can be written as a directed limit $X = \lim X_i$
where the transition maps are closed immersions and the objects
$X_i$ are finite and of finite presentation over $Y$.
\end{lemma}

\begin{proof}
Consider the finite quasi-coherent $\mathcal{O}_Y$-module
$\mathcal{A} = f_*\mathcal{O}_X$. By
Lemma \ref{lemma-algebra-directed-colimit-finite-presentation}
we can write $\mathcal{A} = \colim \mathcal{A}_i$ as a directed
colimit of finite and finitely presented $\mathcal{O}_Y$-algebras
$\mathcal{A}_i$ with surjective transition maps.
Set $X_i = \underline{\Spec}_Y(\mathcal{A}_i)$, see
Morphisms of Spaces, Definition
\ref{spaces-morphisms-definition-relative-spec}.
By construction $X_i \to Y$ is finite and of finite presentation,
the transition maps are closed immersions, and $X = \lim X_i$.
\end{proof}

\begin{lemma}
\label{lemma-quasi-affine-closed-in-finite-presentation}
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic spaces
over $S$. Assume
\begin{enumerate}
\item $f$ is locally of finite type and quasi-affine, and
\item $Y$ is quasi-compact and quasi-separated.
\end{enumerate}
Then there exists a morphism of finite presentation
$f' : X' \to Y$ and a closed immersion $X \to X'$ over $Y$.
\end{lemma}

\begin{proof}
By Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-characterize-quasi-affine}
we can find a factorization $X \to Z \to Y$ where
$X \to Z$ is a quasi-compact open immersion and
$Z \to Y$ is affine. Write $Z = \lim Z_i$ with $Z_i$ affine and
of finite presentation over $Y$ (Lemma \ref{lemma-affine-morphism-is-limit}).
For some $0 \in I$ we can find a quasi-compact open $U_0 \subset Z_0$
such that $X$ is isomorphic to the inverse image of $U_0$ in $Z$
(Lemma \ref{lemma-descend-opens}). Let $U_i$ be the inverse image of
$U_0$ in $Z_i$, so $U = \lim U_i$. By
Lemma \ref{lemma-finite-type-eventually-closed}
we see that $X \to U_i$ is a closed immersion for some $i$ large enough.
Setting $X' = U_i$ finishes the proof.
\end{proof}

\begin{lemma}
\label{lemma-finite-type-closed-in-finite-presentation}
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic spaces
over $S$. Assume:
\begin{enumerate}
\item $f$ is of locally of finite type.
\item $X$ is quasi-compact and quasi-separated, and
\item $Y$ is quasi-compact and quasi-separated.
\end{enumerate}
Then there exists a morphism of finite presentation
$f' : X' \to Y$ and a closed immersion $X \to X'$ of
algebraic spaces over $Y$.
\end{lemma}

\begin{proof}
By Proposition \ref{proposition-approximate}
we can write $X = \lim_i X_i$ with $X_i$ quasi-separated of finite type over
$\mathbf{Z}$ and with transition morphisms $f_{ii'} : X_i \to X_{i'}$ affine.
Consider the commutative diagram
$$
\xymatrix{
X \ar[r] \ar[rd] & X_{i, Y} \ar[r] \ar[d] & X_i \ar[d] \\
& Y \ar[r] & \Spec(\mathbf{Z})
}
$$
Note that $X_i$ is of finite presentation over $\Spec(\mathbf{Z})$, see
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-noetherian-finite-type-finite-presentation}.
Hence the base change $X_{i, Y} \to Y$ is of finite presentation by
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-base-change-finite-presentation}.
Observe that $\lim X_{i, Y} = X \times Y$ and that $X \to X \times Y$ is a
monomorphism. By Lemma \ref{lemma-finite-type-eventually-closed}
we see that $X \to X_{i, Y}$ is a monomorphism for $i$ large enough.
Fix such an $i$. Note that $X \to X_{i, Y}$ is locally of finite type
(Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-permanence-finite-type})
and a monomorphism, hence separated and locally quasi-finite
(Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-monomorphism-loc-finite-type-loc-quasi-finite}).
Hence $X \to X_{i, Y}$ is representable.
Hence $X \to X_{i, Y}$ is quasi-affine because we can use the
principle Spaces, Lemma
\ref{spaces-lemma-representable-transformations-property-implication}
and the result for morphisms of schemes More on Morphisms, Lemma
\ref{more-morphisms-lemma-quasi-finite-separated-quasi-affine}.
Thus Lemma \ref{lemma-quasi-affine-closed-in-finite-presentation}
gives a factorization $X \to X' \to X_{i, Y}$
with $X \to X'$ a closed immersion and $X' \to X_{i, Y}$ of finite
presentation. Finally, $X' \to Y$ is of finite presentation as a
composition of morphisms of finite presentation
(Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-composition-finite-presentation}).
\end{proof}

\begin{proposition}
\label{proposition-separated-closed-in-finite-presentation}
Let $S$ be a scheme. $f : X \to Y$ be a morphism of algebraic spaces
over $S$. Assume
\begin{enumerate}
\item $f$ is of finite type and separated, and
\item $Y$ is quasi-compact and quasi-separated.
\end{enumerate}
Then there exists a separated morphism of finite presentation
$f' : X' \to Y$ and a closed immersion $X \to X'$ over $Y$.
\end{proposition}

\begin{proof}
By Lemma \ref{lemma-finite-type-closed-in-finite-presentation}
there is a closed immersion $X \to Z$ with $Z/Y$ of
finite presentation. Let $\mathcal{I} \subset \mathcal{O}_Z$
be the quasi-coherent sheaf of ideals defining $X$ as a closed
subscheme of $Y$. By
Lemma \ref{lemma-directed-colimit-finite-type}
we can write $\mathcal{I}$ as a directed colimit
$\mathcal{I} = \colim_{a \in A} \mathcal{I}_a$ of its
quasi-coherent sheaves of ideals of finite type.
Let $X_a \subset Z$ be the closed subspace defined by $\mathcal{I}_a$.
These form an inverse system indexed by $A$.
The transition morphisms $X_a \to X_{a'}$ are affine because
they are closed immersions. Each $X_a$ is quasi-compact and quasi-separated
since it is a closed subspace of $Z$ and $Z$ is quasi-compact and
quasi-separated by our assumptions.
We have $X = \lim_a X_a$ as follows directly from the
fact that $\mathcal{I} = \colim_{a \in A} \mathcal{I}_a$.
Each of the morphisms $X_a \to Z$ is of finite presentation, see
Morphisms, Lemma \ref{morphisms-lemma-closed-immersion-finite-presentation}.
Hence the morphisms $X_a \to Y$ are of finite presentation.
Thus it suffices to show that $X_a \to Y$ is separated for some
$a \in A$. This follows from Lemma \ref{lemma-eventually-separated}
as we have assumed that $X \to Y$ is separated.
\end{proof}






\section{Embedding into affine space}
\label{section-embedding}

\noindent
Some technical lemmas to be used in the proof of Chow's lemma later.

\begin{lemma}
\label{lemma-embedding-into-affine-over-ls-qs}
Let $S$ be a scheme. Let $f : U \to X$ be a morphism of algebraic
spaces over $S$. Assume $U$ is an affine scheme, $f$ is locally of
finite type, and $X$ quasi-separated and locally separated.
Then there exists an immersion $U \to \mathbf{A}^n_X$ over $X$.
\end{lemma}

\begin{proof}
Say $U = \Spec(A)$. Write $A = \colim A_i$ as a filtered colimit
of finite type $\mathbf{Z}$-subalgebras. For each $i$ the morphism
$U \to U_i = \Spec(A_i)$ induces a morphism
$$
U \longrightarrow X \times U_i
$$
over $X$. In the limit the morphism $U \to X \times U$ is an immersion
as $X$ is locally separated, see
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-semi-diagonal}.
By Lemma \ref{lemma-finite-type-eventually-closed}
we see that $U \to X \times U_i$ is an immersion for some $i$.
Since $U_i$ is isomorphic to a closed subscheme of
$\mathbf{A}^n_{\mathbf{Z}}$ the lemma follows.
\end{proof}

\begin{remark}
\label{remark-cannot-embed-in-general}
We have seen in Examples, Section \ref{examples-section-embedding-affines}
that Lemma \ref{lemma-embedding-into-affine-over-ls-qs}
does not hold if we drop the assumption that $X$ be locally separated.
This raises the question: Does
Lemma \ref{lemma-embedding-into-affine-over-ls-qs}
hold if we drop the assumption that $X$ be quasi-separated?
If you know the answer, please email
\href{mailto:stacks.project@gmail.com}{stacks.project@gmail.com}.
\end{remark}

\begin{lemma}
\label{lemma-embedding-into-affine-over-qs}
Let $S$ be a scheme. Let $f : Y \to X$ be a morphism of algebraic
spaces over $S$. Assume $X$ Noetherian and $f$ of finite presentation.
Then there exists a dense open $V \subset Y$ and an immersion
$V \to \mathbf{A}^n_X$.
\end{lemma}

\begin{proof}
The assumptions imply that $Y$ is Noetherian
(Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-finite-presentation-noetherian}).
Then $Y$ is quasi-separated, hence has a dense open subscheme
(Properties of Spaces, Proposition
\ref{spaces-properties-proposition-locally-quasi-separated-open-dense-scheme}).
Thus we may assume that $Y$ is a Noetherian scheme.
By removing intersections of irreducible components of $Y$
(use Topology, Lemma \ref{topology-lemma-Noetherian} and
Properties, Lemma \ref{properties-lemma-Noetherian-topology})
we may assume that $Y$ is a disjoint union of irreducible
Noetherian schemes. Since there is an immersion
$$
\mathbf{A}^n_X \amalg \mathbf{A}^m_X
\longrightarrow
\mathbf{A}^{\max(n, m) + 1}_X
$$
(details omitted) we see that it suffices to prove the result in case
$Y$ is irreducible.

\medskip\noindent
Assume $Y$ is an irreducible scheme. Let $T \subset |X|$ be the closure of the
image of $f : Y \to X$. Note that since $|Y|$ and $|X|$ are sober topological
spaces (Properties of Spaces, Lemma
\ref{spaces-properties-lemma-quasi-separated-sober})
$T$ is irreducible with a unique generic point $\xi$ which is the
image of the generic point $\eta$ of $Y$.
Let $\mathcal{I} \subset X$ be a quasi-coherent sheaf of ideals
cutting out the reduced induced space structure on $T$
(Properties of Spaces, Definition
\ref{spaces-properties-definition-reduced-induced-space}).
Since $\mathcal{O}_{Y, \eta}$ is an Artinian local ring we see
that for some $n > 0$ we have $f^{-1}\mathcal{I}^n \mathcal{O}_{Y, \eta} = 0$.
As $f^{-1}\mathcal{I}\mathcal{O}_Y$ is a finite type quasi-coherent ideal
we conclude that $f^{-1}\mathcal{I}^n\mathcal{O}_V = 0$ for
some nonempty open $V \subset Y$. Let $Z \subset X$ be the closed subspace
cut out by $\mathcal{I}^n$. By construction $V \to Y \to X$ factors through
$Z$. Because $\mathbf{A}^n_Z \to \mathbf{A}^n_X$ is an immersion,
we may replace $X$ by $Z$ and $Y$ by $V$.
Hence we reach the situation where $Y$ and $X$ are irreducible and
$Y \to X$ maps the generic point of $Y$ onto the generic point of $X$.

\medskip\noindent
Assume $Y$ and $X$ are irreducible, $Y$ is a scheme,
and $Y \to X$ maps the generic point of
$Y$ onto the generic point of $X$. By Properties of Spaces, Proposition
\ref{spaces-properties-proposition-locally-quasi-separated-open-dense-scheme}
$X$ has a dense open subscheme $U \subset X$. Choose a nonempty affine
open $V \subset Y$ whose image in $X$ is contained in $U$. By
Morphisms, Lemma \ref{morphisms-lemma-quasi-affine-finite-type-over-S}
we may factor $V \to U$ as $V \to \mathbf{A}^n_U \to U$. Composing
with $\mathbf{A}^n_U \to \mathbf{A}^n_X$ we obtain the desired immersion.
\end{proof}








\section{Sections with support in a closed subset}
\label{section-sections-with-support-in-closed}

\noindent
This section is the analogue of
Properties, Section \ref{properties-section-sections-with-support-in-closed}.

\begin{lemma}
\label{lemma-quasi-coherent-finite-type-ideals}
Let $S$ be a scheme.
Let $X$ be a quasi-compact and quasi-separated algebraic space.
Let $U \subset X$ be an open subspace. The following are equivalent:
\begin{enumerate}
\item $U \to X$ is quasi-compact,
\item $U$ is quasi-compact, and
\item there exists a finite type quasi-coherent sheaf of ideals
$\mathcal{I} \subset \mathcal{O}_X$ such that
$|X| \setminus |U| = |V(\mathcal{I})|$.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $W$ be an affine scheme and let $\varphi : W \to X$ be a surjective
\'etale morphism, see Properties of Spaces, Lemma
\ref{spaces-properties-lemma-quasi-compact-affine-cover}.
If (1) holds, then $\varphi^{-1}(U) \to W$ is quasi-compact, hence
$\varphi^{-1}(U)$ is quasi-compact, hence $U$ is quasi-compact
(as $|\varphi^{-1}(U)| \to |U|$ is surjective). If (2) holds, then
$\varphi^{-1}(U)$ is quasi-compact because $\varphi$ is quasi-compact
since $X$ is quasi-separated (Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-quasi-compact-quasi-separated-permanence}).
Hence $\varphi^{-1}(U) \to W$ is a quasi-compact morphism of schemes by
Properties, Lemma \ref{properties-lemma-quasi-coherent-finite-type-ideals}.
It follows that $U \to X$ is quasi-compact by
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-quasi-compact-local}.
Thus (1) and (2) are equivalent.

\medskip\noindent
Assume (1) and (2). By
Properties of Spaces, Lemma
\ref{spaces-properties-lemma-reduced-closed-subspace} there exists
a unique quasi-coherent sheaf of ideals $\mathcal{J}$ cutting
out the reduced induced closed subspace structure on $|X| \setminus |U|$.
Note that $\mathcal{J}|_U = \mathcal{O}_U$ which is an
$\mathcal{O}_U$-modules of finite type.
As $U$ is quasi-compact it follows from
Lemma \ref{lemma-directed-colimit-finite-type}
that there exists a quasi-coherent subsheaf
$\mathcal{I} \subset \mathcal{J}$ which is of finite type
and has the property that $\mathcal{I}|_U = \mathcal{J}|_U$.
Then $|X| \setminus |U| = |V(\mathcal{I})|$ and we obtain (3). Conversely,
if $\mathcal{I}$ is as in (3), then $\varphi^{-1}(U) \subset W$
is a quasi-compact open by the lemma for schemes
(Properties, Lemma \ref{properties-lemma-quasi-coherent-finite-type-ideals})
applied to $\varphi^{-1}\mathcal{I}$ on $W$.
Thus (2) holds.
\end{proof}

\begin{lemma}
\label{lemma-sections-annihilated-by-ideal}
Let $S$ be a scheme. Let $X$ be an algebraic space over $S$.
Let $\mathcal{I} \subset \mathcal{O}_X$ be a quasi-coherent sheaf of ideals.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module.
Consider the sheaf of $\mathcal{O}_X$-modules $\mathcal{F}'$
which associates to every object $U$ of $X_\etale$ the module
$$
\mathcal{F}'(U)
=
\{s \in \mathcal{F}(U) \mid
\mathcal{I}s = 0\}
$$
Assume $\mathcal{I}$ is of finite type. Then
\begin{enumerate}
\item $\mathcal{F}'$ is a quasi-coherent sheaf of $\mathcal{O}_X$-modules,
\item for affine $U$ in $X_\etale$ we have
$\mathcal{F}'(U) = \{s \in \mathcal{F}(U) \mid \mathcal{I}(U)s = 0\}$, and
\item $\mathcal{F}'_x = \{s \in \mathcal{F}_x \mid \mathcal{I}_x s = 0\}$.
\end{enumerate}
\end{lemma}

\begin{proof}
It is clear that the rule defining $\mathcal{F}'$ gives a subsheaf
of $\mathcal{F}$. Hence we may work \'etale locally on $X$ to verify
the other statements. Thus the lemma reduces to the case of schemes
which is
Properties, Lemma \ref{properties-lemma-sections-annihilated-by-ideal}.
\end{proof}

\begin{definition}
\label{definition-subsheaf-sections-annihilated-by-ideal}
Let $S$ be a scheme. Let $X$ be an algebraic space over $S$.
Let $\mathcal{I} \subset \mathcal{O}_X$ be a quasi-coherent
sheaf of ideals of finite type.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module.
The subsheaf $\mathcal{F}' \subset \mathcal{F}$ defined in
Lemma \ref{lemma-sections-annihilated-by-ideal} above is called
the {\it subsheaf of sections annihilated by $\mathcal{I}$}.
\end{definition}

\begin{lemma}
\label{lemma-push-sections-annihilated-by-ideal}
Let $S$ be a scheme.
Let $f : X \to Y$ be a quasi-compact and quasi-separated morphism
of algebraic spaces over $S$.
Let $\mathcal{I} \subset \mathcal{O}_Y$ be a quasi-coherent
sheaf of ideals of finite type. Let $\mathcal{F}$ be a quasi-coherent
$\mathcal{O}_X$-module. Let $\mathcal{F}' \subset \mathcal{F}$
be the subsheaf of sections annihilated by $f^{-1}\mathcal{I}\mathcal{O}_X$.
Then $f_*\mathcal{F}' \subset f_*\mathcal{F}$ is the subsheaf
of sections annihilated by $\mathcal{I}$.
\end{lemma}

\begin{proof}
Omitted. Hint: The assumption that $f$ is quasi-compact and
quasi-separated implies that $f_*\mathcal{F}$ is quasi-coherent
(Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-pushforward})
so that Lemma \ref{lemma-sections-annihilated-by-ideal} applies
to $\mathcal{I}$ and $f_*\mathcal{F}$.
\end{proof}

\noindent
Next we come to the sheaf of sections supported in a closed subset.
Again this isn't always a quasi-coherent sheaf, but if the complement
of the closed is ``retrocompact'' in the given algebraic space, then
it is.

\begin{lemma}
\label{lemma-sections-supported-on-closed-subset}
Let $S$ be a scheme. Let $X$ be an algebraic space over $S$.
Let $T \subset |X|$ be a closed subset and let $U \subset X$ be
the open subspace such that $T \amalg |U| = |X|$.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module.
Consider the sheaf of $\mathcal{O}_X$-modules $\mathcal{F}'$
which associates to every object $\varphi : W \to X$ of
$X_\etale$ the module
$$
\mathcal{F}'(W)
=
\{s \in \mathcal{F}(W) \mid
\text{the support of }s\text{ is contained in }|\varphi|^{-1}(T)\}
$$
If $U \to X$ is quasi-compact, then
\begin{enumerate}
\item for $W$ affine there exist a finitely generated
ideal $I \subset \mathcal{O}_X(W)$ such that $|\varphi|^{-1}(T) = V(I)$,
\item for $W$ and $I$ as in (1) we have
$\mathcal{F}'(W) = \{x \in \mathcal{F}(W) \mid
I^nx = 0 \text{ for some } n\}$,
\item $\mathcal{F}'$ is a quasi-coherent sheaf of $\mathcal{O}_X$-modules.
\end{enumerate}
\end{lemma}

\begin{proof}
It is clear that the rule defining $\mathcal{F}'$ gives a subsheaf
of $\mathcal{F}$. Hence we may work \'etale locally on $X$ to verify
the other statements. Thus the lemma reduces to the case of schemes
which is
Properties, Lemma \ref{properties-lemma-sections-supported-on-closed-subset}.
\end{proof}

\begin{definition}
\label{definition-subsheaf-sections-supported-on-closed}
Let $S$ be a scheme. Let $X$ be an algebraic space over $S$.
Let $T \subset |X|$ be a closed subset whose complement
corresponds to an open subspace $U \subset X$
with quasi-compact inclusion morphism $U \to X$.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module.
The quasi-coherent subsheaf $\mathcal{F}' \subset \mathcal{F}$ defined in
Lemma \ref{lemma-sections-supported-on-closed-subset} above is called
the {\it subsheaf of sections supported on $T$}.
\end{definition}

\begin{lemma}
\label{lemma-push-sections-supported-on-closed-subset}
Let $S$ be a scheme.
Let $f : X \to Y$ be a quasi-compact and quasi-separated morphism
of algebraic spaces over $S$. Let $T \subset |Y|$ be a closed subset.
Assume $|Y| \setminus T$ corresponds to an open subspace $V \subset Y$
such that $V \to Y$ is quasi-compact. Let $\mathcal{F}$ be a quasi-coherent
$\mathcal{O}_X$-module. Let $\mathcal{F}' \subset \mathcal{F}$
be the subsheaf of sections supported on $|f|^{-1}T$.
Then $f_*\mathcal{F}' \subset f_*\mathcal{F}$ is the subsheaf
of sections supported on $T$.
\end{lemma}

\begin{proof}
Omitted. Hints: $|X| \setminus |f|^{-1}T$ is the support of the open subspace
$U = f^{-1}V \subset X$. Since $V \to Y$ is quasi-compact, so is
$U \to X$ (by base change). The assumption that $f$ is quasi-compact and
quasi-separated implies that $f_*\mathcal{F}$ is quasi-coherent.
Hence Lemma \ref{lemma-sections-supported-on-closed-subset}
applies to $T$ and $f_*\mathcal{F}$ as well as to
$|f|^{-1}T$ and $\mathcal{F}$. The equality of the given quasi-coherent
modules is immediate from the definitions.
\end{proof}















\section{Characterizing affine spaces}
\label{section-affine}

\noindent
This section is the analogue of Limits, Section \ref{limits-section-affine}.

\begin{lemma}
\label{lemma-affine}
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic spaces
over $S$. Assume that $f$ is surjective and finite, and assume that $X$
is affine. Then $Y$ is affine.
\end{lemma}

\begin{proof}
We may and do view $f : X \to Y$ as a morphism of algebraic space over
$\Spec(\mathbf{Z})$ (see
Spaces, Definition \ref{spaces-definition-base-change}).
Note that a finite morphism is affine and universally closed, see
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-integral-universally-closed}.
By Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-image-universally-closed-separated}
we see that $Y$ is a separated algebraic space.
As $f$ is surjective and $X$ is quasi-compact we see that $Y$ is
quasi-compact.

\medskip\noindent
By Lemma \ref{lemma-finite-in-finite-and-finite-presentation}
we can write $X = \lim X_a$ with each $X_a \to Y$ finite and of
finite presentation. By
Lemma \ref{lemma-limit-is-affine}
we see that $X_a$ is affine for $a$ large enough.
Hence we may and do assume that $f : X \to Y$ is finite, surjective, and
of finite presentation.

\medskip\noindent
By Proposition \ref{proposition-approximate} we may write
$Y = \lim Y_i$ as a directed limit of algebraic
spaces of finite presentation over $\mathbf{Z}$.
By Lemma \ref{lemma-descend-finite-presentation} we can
find $0 \in I$ and a morphism $X_0 \to Y_0$ of finite presentation
such that $X_i = X_0 \times_{Y_0} Y_i$ for $i \geq 0$
and such that $X = \lim_i X_i$. By
Lemma \ref{lemma-descend-finite}
we see that $X_i \to Y_i$ is finite for $i$ large enough.
By Lemma \ref{lemma-descend-surjective}
we see that $X_i \to Y_i$ is surjective for $i$ large enough.
By Lemma \ref{lemma-limit-is-affine} we see that $X_i$ is
affine for $i$ large enough. Hence for $i$ large enough we can apply
Cohomology of Spaces, Lemma
\ref{spaces-cohomology-lemma-image-affine-finite-morphism-affine-Noetherian}
to conclude that $Y_i$ is affine. This implies that $Y$ is affine and
we conclude.
\end{proof}

\begin{proposition}
\label{proposition-affine}
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic spaces
over $S$. Assume that $f$ is surjective and integral, and assume that $X$
is affine. Then $Y$ is affine.
\end{proposition}

\begin{proof}
We may and do view $f : X \to Y$ as a morphism of algebraic space over
$\Spec(\mathbf{Z})$ (see
Spaces, Definition \ref{spaces-definition-base-change}).
Note that integral morphisms are affine and universally closed, see
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-integral-universally-closed}.
By Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-image-universally-closed-separated}
we see that $Y$ is a separated algebraic space.
As $f$ is surjective and $X$ is quasi-compact we see that $Y$ is
quasi-compact.

\medskip\noindent
Consider the sheaf $\mathcal{A} = f_*\mathcal{O}_X$.
This is a quasi-coherent sheaf of $\mathcal{O}_Y$-algebras, see
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-pushforward}.
By Lemma \ref{lemma-colimit-finitely-presented}
we can write $\mathcal{A} = \colim_i \mathcal{F}_i$ as a filtered
colimit of finite type $\mathcal{O}_Y$-modules. Let
$\mathcal{A}_i \subset \mathcal{A}$ be the $\mathcal{O}_Y$-subalgebra
generated by $\mathcal{F}_i$. Since the map of algebras
$\mathcal{O}_Y \to \mathcal{A}$ is integral, we see that each $\mathcal{A}_i$
is a finite quasi-coherent $\mathcal{O}_Y$-algebra. Hence
$$
X_i = \underline{\Spec}_Y(\mathcal{A}_i) \longrightarrow Y
$$
is a finite morphism of algebraic spaces. (Insert future reference to
$\underline{\Spec}$ construction for algebraic spaces here.) It is clear
that $X = \lim_i X_i$. Hence by
Lemma \ref{lemma-limit-is-affine}
we see that for $i$ sufficiently large the scheme $X_i$ is affine.
Moreover, since $X \to Y$ factors through each $X_i$ we see that
$X_i \to Y$ is surjective. Hence we conclude that $Y$ is affine by
Lemma \ref{lemma-affine}.
\end{proof}

\noindent
The following corollary of the result above can be found in
\cite{CLO}.

\begin{lemma}
\label{lemma-reduction-scheme}
Let $S$ be a scheme. Let $X$ be an algebraic space over $S$.
If $X_{red}$ is a scheme, then $X$ is a scheme.
\end{lemma}

\begin{proof}
Let $U' \subset X_{red}$ be an open affine subscheme.
Let $U \subset X$ be the open subspace corresponding to the open
$|U'| \subset |X_{red}| = |X|$. Then $U' \to U$ is surjective and
integral. Hence $U$ is affine by
Proposition \ref{proposition-affine}.
Thus every point is contained in an open subscheme of $X$, i.e.,
$X$ is a scheme.
\end{proof}

\begin{lemma}
\label{lemma-integral-universally-bijective-scheme}
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic spaces
over $S$. Assume $f$ is integral and induces a bijection $|X| \to |Y|$.
Then $X$ is a scheme if and only if $Y$ is a scheme.
\end{lemma}

\begin{proof}
An integral morphism is representable by definition, hence if $Y$
is a scheme, so is $X$. Conversely, assume that $X$ is a scheme.
Let $U \subset X$ be an affine open. An integral morphism is
closed and $|f|$ is bijective, hence $|f|(|U|) \subset |Y|$
is open as the complement of $|f|(|X| \setminus |U|)$. Let
$V \subset Y$ be the open subspace with $|V| = |f|(|U|)$, see
Properties of Spaces, Lemma \ref{spaces-properties-lemma-open-subspaces}.
Then $U \to V$ is integral and surjective, hence
$V$ is an affine scheme by Proposition \ref{proposition-affine}.
This concludes the proof.
\end{proof}

\begin{lemma}
\label{lemma-check-closed-infinitesimally}
Let $S$ be a scheme.
Let $f : X \to B$ and $B' \to N$ be morphisms of algebraic spaces over $S$.
Assume
\begin{enumerate}
\item $B' \to B$ is a closed immersion,
\item $|B'| \to |B|$ is a homeomorphism,
\item $X \times_B B' \to B'$ is a closed immersion, and
\item $X \to B$ is of finite type.
\end{enumerate}
Then $f : X \to B$ is a closed immersion.
\end{lemma}

\begin{proof}
Assumptions (1) and (2) imply that $B_{red} = B'_{red}$.
Set $X' = X \times_B B'$. Then $X' \to X$ is closed immersion
and $X'_{red} = X_{red}$. Let $U \to B$ be an \'etale morphism
with $U$ affine. Then $X' \times_B U \to X \times_B U$ is a
closed immersion of algebraic spaces inducing an isomorphism
on underlying reduced spaces. Since $X' \times_B U$ is a scheme
(as $B' \to B$ and $X' \to B'$ are representable) so is
$X \times_B U$ by Lemma \ref{lemma-reduction-scheme}.
Hence $X \to B$ is representable too. Thus we reduce to the
case of schemes, see
Morphisms, Lemma \ref{morphisms-lemma-check-closed-infinitesimally}.
\end{proof}





















\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}

