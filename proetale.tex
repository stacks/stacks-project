\input{preamble}

% OK, start here.
%
\begin{document}

\title{Pro-\'etale Cohomology}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
The material in this chapter and more can be found in the preprint \cite{BS}.

\medskip\noindent
The goal of this chapter is to introduce the pro-\'etale topology and to
develop the basic theory of cohomology of abelian sheaves in this topology.
A secondary goal is to show how using the pro-\'etale topology simplifies
the introduction of $\ell$-adic cohomology in algebraic geometry.

\medskip\noindent
Here is a brief overview of the history of $\ell$-adic \'etale cohomology
as we have understood it.
In \cite[Expos\'es V and VI]{SGA5} Grothendieck et al developed a theory for
dealing with $\ell$-adic sheaves as inverse systems of sheaves of
$\mathbf{Z}/\ell^n\mathbf{Z}$-modules.
In his second paper on the Weil conjectures (\cite{WeilII}) Deligne introduced
a derived category of $\ell$-adic sheaves as a certain 2-limit of categories
of complexes of sheaves of $\mathbf{Z}/\ell^n\mathbf{Z}$-modules on the
\'etale site of a scheme $X$. This approach is used in the paper by
Beilinson, Bernstein, and Deligne (\cite{BBD}) as the basis for their
beautiful theory of perverse sheaves. In a paper entitled ``Continuous
\'Etale Cohomology'' (\cite{Jannsen}) Uwe Jannsen discusses an important
variant of the cohomology of a $\ell$-adic sheaf on a variety over a field.
His paper is followed up by a paper of Torsten Ekedahl (\cite{Ekedahl})
who discusses the adic formalism needed to work comfortably with derived
categories defined as limits.

\medskip\noindent
It turns out that, working with the pro-\'etale site of a scheme,
one can avoid some of the technicalities these authors encountered.
This comes at the expense of having to work with non-Noetherian schemes,
even when one is only interested in working with $\ell$-adic sheaves
and cohomology of such on varieties over an algebraically closed field.

\medskip\noindent
A very important and remarkable feature of the
(small) pro-\'etale site of a scheme is.
that it has enough quasi-compact w-contractible objects. The existence
of these objects implies
a number of useful and (perhaps) unusual consequences for the derived category
of abelian sheaves and for inverse systems of sheaves.
This is exactly the feature that will allow us to handle
the intricacies of working with $\ell$-adic sheaves, but as we
will see it has a number of other benefits as well.




\section{Some topology}
\label{section-topology}

\noindent
Some preliminaries. We have defined {\it spectral spaces} and
{\it spectral maps} of spectral spaces in
Topology, Section \ref{topology-section-spectral}.
The spectrum of a ring is a spectral space, see
Algebra, Lemma \ref{algebra-lemma-spec-spectral}.

\begin{lemma}
\label{lemma-spectral-split}
Let $X$ be a spectral space. Let $X_0 \subset X$ be the set of closed points.
The following are equivalent
\begin{enumerate}
\item Every open covering of $X$ can be refined by a finite
disjoint union decomposition $X = \coprod U_i$ with $U_i$
open and closed in $X$.
\item The composition $X_0 \to X \to \pi_0(X)$ is bijective.
\end{enumerate}
Moreover, if $X_0$ is closed in $X$ and every point of $X$ specializes
to a unique point of $X_0$, then these conditions are satisfied.
\end{lemma}

\begin{proof}
We will use without further mention that
$X_0$ is quasi-compact
(Topology, Lemma \ref{topology-lemma-closed-points-quasi-compact})
and $\pi_0(X)$ is profinite
(Topology, Lemma \ref{topology-lemma-spectral-pi0}).
Picture
$$
\xymatrix{
X_0 \ar[rd]_f \ar[r] & X \ar[d]^\pi \\
& \pi_0(X)
}
$$
If (2) holds, the continuous bijective map $f : X_0 \to \pi_0(X)$ is
a homeomorphism by
Topology, Lemma \ref{topology-lemma-bijective-map}.
Given an open covering $X = \bigcup U_i$, we get an open covering
$\pi_0(X) = \bigcup f(X_0 \cap U_i)$. By
Topology, Lemma \ref{topology-lemma-profinite-refine-open-covering}
we can find a finite open covering of the form $\pi_0(X) = \coprod V_j$
which refines this covering.
Since $X_0 \to \pi_0(X)$ is bijective each connected component of
$X$ has a unique closed point, whence is equal to the set of points
specializing to this closed point. Hence $\pi^{-1}(V_j)$ is the
set of points specializing to the points of $f^{-1}(V_j)$.
Now, if $f^{-1}(V_j) \subset X_0 \cap U_i \subset U_i$, then
it follows that $\pi^{-1}(V_j) \subset U_i$ (because the open set
$U_i$ is closed under generalizations). In this way we see
that the open covering $X = \coprod \pi^{-1}(V_j)$ refines
the covering we started out with. In this way we see that
(2) implies (1).

\medskip\noindent
Assume (1). Let $x, y \in X$ be closed points. Then we have the open covering
$X = (X \setminus \{x\}) \cup (X \setminus \{y\})$.
It follows from (1) that there exists a disjoint union decomposition
$X = U \amalg V$ with $U$ and $V$ open (and closed) and $x \in U$ and
$y \in V$. In particular we see that every connected component of $X$
has at most one closed point. By
Topology, Lemma \ref{topology-lemma-quasi-compact-closed-point}
every connected component (being closed) also does have a closed point.
Thus $X_0 \to \pi_0(X)$ is bijective. In this way we see that (1) implies (2).

\medskip\noindent
Assume $X_0$ is closed in $X$ and every point specializes to a unique
point of $X_0$. Then $X_0$ is a spectral space
(Topology, Lemma \ref{topology-lemma-spectral-sub})
consisting of closed points, hence profinite
(Topology, Lemma \ref{topology-lemma-characterize-profinite-spectral}).
Let $x, y \in X_0$ be distinct. By
Topology, Lemma \ref{topology-lemma-profinite-refine-open-covering}
we can find a disjoint union decomposition
$X_0 = U_0 \amalg V_0$ with $U_0$ and $V_0$ open and closed
and $x \in U_0$ and $y \in V_0$.
Let $U \subset X$, resp.\ $V \subset X$
be the set of points specializing to $U_0$, resp.\ $V_0$.
Observe that $X = U \amalg V$.
By Topology, Lemma \ref{topology-lemma-make-spectral-space}
we see that $U$ is an intersection of quasi-compact open subsets.
Hence $U$ is closed in the constructible topology.
Since $U$ is closed under specialization, we see that
$U$ is closed by Topology, Lemma
\ref{topology-lemma-constructible-stable-specialization-closed}.
By symmetry $V$ is closed and hence $U$ and $V$ are both
open and closed.
This proves that $x, y$ are not in the same connected component of $X$.
In other words, $X_0 \to \pi_0(X)$ is injective. The map is also
surjective by
Topology, Lemma \ref{topology-lemma-quasi-compact-closed-point}
and the fact that connected components are closed.
In this way we see that the final condition implies (2).
\end{proof}

\begin{example}
\label{example-not-w-local}
Let $T$ be a profinite space. Let $t \in T$ be a point and assume
that $T \setminus \{t\}$ is not quasi-compact.
Let $X = T \times \{0, 1\}$. Consider the topology on $X$
with a subbase given by the sets
$U \times \{0, 1\}$ for $U \subset T$ open, $X \setminus \{(t, 0)\}$,
and $U \times \{1\}$ for $U \subset T$ open with $t \not \in U$.
The set of closed points of $X$ is $X_0 = T \times \{0\}$ and
$(t, 1)$ is in the closure of $X_0$.
Moreover, $X_0 \to \pi_0(X)$ is a bijection.
This example shows that conditions (1) and (2) of
Lemma \ref{lemma-spectral-split} do no imply the set of closed points
is closed.
\end{example}

\noindent
It turns out it is more convenient to work with spectral
spaces which have the slightly stronger property mentioned in
the final statement of Lemma \ref{lemma-spectral-split}.
We give this property a name.

\begin{definition}
\label{definition-w-local}
A spectral space $X$ is {\it w-local} if the set of closed points $X_0$
is closed and every point of $X$ specializes to a unique closed point.
A continuous map $f : X \to Y$ of w-local spaces is {\it w-local}
if it is spectral and maps any closed point of $X$ to a closed point of $Y$.
\end{definition}

\noindent
We have seen in the proof of Lemma \ref{lemma-spectral-split}
that in this case $X_0 \to \pi_0(X)$ is a homeomorphism and that
$X_0 \cong \pi_0(X)$ is a profinite space. Moreover, a connected
component of $X$ is exactly the set of points specializing to
a given $x \in X_0$.

\begin{lemma}
\label{lemma-closed-subspace-w-local}
Let $X$ be a w-local spectral space. If $Y \subset X$ is closed,
then $Y$ is w-local.
\end{lemma}

\begin{proof}
The subset $Y_0 \subset Y$ of closed points is closed because
$Y_0 = X_0 \cap Y$. Since $X$ is $w$-local, every $y \in Y$ specializes
to a unique point of $X_0$. This specialization is in $Y$, and hence
also in $Y_0$, because $\overline{\{y\}}\subset Y$. In conclusion, $Y$
is $w$-local.
\end{proof}

\begin{lemma}
\label{lemma-silly}
Let $X$ be a spectral space. Let
$$
\xymatrix{
Y \ar[r] \ar[d] & T \ar[d] \\
X \ar[r] & \pi_0(X)
}
$$
be a cartesian diagram in the category of topological spaces
with $T$ profinite. Then $Y$ is spectral and $T = \pi_0(Y)$.
If moreover $X$ is w-local, then $Y$ is w-local, $Y \to X$ is w-local,
and the set of closed points of $Y$ is the inverse image of the
set of closed points of $X$.
\end{lemma}

\begin{proof}
Note that $Y$ is a closed subspace of $X \times T$ as $\pi_0(X)$
is a profinite space hence Hausdorff
(use Topology, Lemmas \ref{topology-lemma-spectral-pi0} and
\ref{topology-lemma-fibre-product-closed}).
Since $X \times T$ is spectral
(Topology, Lemma \ref{topology-lemma-product-spectral-spaces})
it follows that $Y$ is spectral
(Topology, Lemma \ref{topology-lemma-spectral-sub}).
Let $Y \to \pi_0(Y) \to T$ be the canonical factorization
(Topology, Lemma \ref{topology-lemma-space-connected-components}).
It is clear that $\pi_0(Y) \to T$ is surjective.
The fibres of $Y \to T$ are homeomorphic to the fibres of
$X \to \pi_0(X)$. Hence these fibres are connected. It follows
that $\pi_0(Y) \to T$ is injective. We conclude that $\pi_0(Y) \to T$
is a homeomorphism by
Topology, Lemma \ref{topology-lemma-bijective-map}.

\medskip\noindent
Next, assume that $X$ is w-local and let $X_0 \subset X$ be the
set of closed points. The inverse image $Y_0 \subset Y$ of $X_0$ in
$Y$ maps bijectively onto $T$ as $X_0 \to \pi_0(X)$ is a bijection
by Lemma \ref{lemma-spectral-split}. Moreover, $Y_0$ is quasi-compact
as a closed subset of the spectral space $Y$. Hence
$Y_0 \to \pi_0(Y) = T$ is a homeomorphism by
Topology, Lemma \ref{topology-lemma-bijective-map}.
It follows that all points of $Y_0$ are closed in $Y$.
Conversely, if $y \in Y$ is a closed point, then
it is closed in the fibre of $Y \to \pi_0(Y) = T$
and hence its image $x$ in $X$ is closed in the (homeomorphic) fibre of
$X \to \pi_0(X)$. This implies $x \in X_0$ and hence $y \in Y_0$.
Thus $Y_0$ is the collection of closed points of $Y$
and for each $y \in Y_0$ the set of generalizations of $y$ is
the fibre of $Y \to \pi_0(Y)$. The lemma follows.
\end{proof}




\section{Local isomorphisms}
\label{section-local-isomorphism}

\noindent
We start with a definition.

\begin{definition}
\label{definition-local-isomorphism}
Let $\varphi : A \to B$ be a ring map.
\begin{enumerate}
\item We say $A \to B$ is a {\it local isomorphism} if for every prime
$\mathfrak q \subset B$ there exists a $g \in B$, $g \not \in \mathfrak q$
such that $A \to B_g$ induces an open immersion $\Spec(B_g) \to \Spec(A)$.
\item We say $A \to B$ {\it identifies local rings} if for every prime
$\mathfrak q \subset B$ the canonical map
$A_{\varphi^{-1}(\mathfrak q)} \to B_\mathfrak q$ is an isomorphism.
\end{enumerate}
\end{definition}

\noindent
We list some elementary properties.

\begin{lemma}
\label{lemma-base-change-local-isomorphism}
Let $A \to B$ and $A \to A'$ be ring maps. Let $B' = B \otimes_A A'$
be the base change of $B$.
\begin{enumerate}
\item If $A \to B$ is a local isomorphism, then $A' \to B'$ is a
local isomorphism.
\item If $A \to B$ identifies local rings, then $A' \to B'$
identifies local rings.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-composition-local-isomorphism}
Let $A \to B$ and $B \to C$ be ring maps.
\begin{enumerate}
\item If $A \to B$ and $B \to C$ are local isomorphisms, then $A \to C$
is a local isomorphism.
\item If $A \to B$ and $B \to C$ identify local rings, then $A \to C$
identifies local rings.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-local-isomorphism-permanence}
Let $A$ be a ring. Let $B \to C$ be an $A$-algebra homomorphism.
\begin{enumerate}
\item If $A \to B$ and $A \to C$ are local isomorphisms, then $B \to C$
is a local isomorphism.
\item If $A \to B$ and $A \to C$ identify local rings, then $B \to C$
identifies local rings.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-local-isomorphism-implies}
Let $A \to B$ be a local isomorphism. Then
\begin{enumerate}
\item $A \to B$ is \'etale,
\item $A \to B$ identifies local rings,
\item $A \to B$ is quasi-finite.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-structure-local-isomorphism}
Let $A \to B$ be a local isomorphism. Then there exist $n \geq 0$,
$g_1, \ldots, g_n \in B$, $f_1, \ldots, f_n \in A$ such that
$(g_1, \ldots, g_n) = B$ and $A_{f_i} \cong B_{g_i}$.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-fully-faithful-spaces-over-X}
Let $p : (Y, \mathcal{O}_Y) \to (X, \mathcal{O}_X)$ and
$q : (Z, \mathcal{O}_Z) \to (X, \mathcal{O}_X)$
be morphisms of locally ringed spaces.
If $\mathcal{O}_Y = p^{-1}\mathcal{O}_X$, then
$$
\Mor_{\text{LRS}/(X, \mathcal{O}_X)}((Z, \mathcal{O}_Z), (Y, \mathcal{O}_Y))
\longrightarrow
\Mor_{\textit{Top}/X}(Z, Y),\quad
(f, f^\sharp) \longmapsto f
$$
is bijective. Here $\text{LRS}/(X, \mathcal{O}_X)$ is the category of
locally ringed spaces over $X$ and $\textit{Top}/X$ is the category
of topological spaces over $X$.
\end{lemma}

\begin{proof}
This is immediate from the definitions.
\end{proof}

\begin{lemma}
\label{lemma-local-isomorphism-fully-faithful}
Let $A$ be a ring. Set $X = \Spec(A)$. The functor
$$
B \longmapsto \Spec(B)
$$
from the category of $A$-algebras $B$ such that $A \to B$ identifies
local rings to the category of
topological spaces over $X$ is fully faithful.
\end{lemma}

\begin{proof}
This follows from Lemma \ref{lemma-fully-faithful-spaces-over-X}
and the fact that if $A \to B$ identifies local rings, then the pullback
of the structure sheaf of $\Spec(A)$ via $p : \Spec(B) \to \Spec(A)$
is equal to the structure sheaf of $\Spec(B)$.
\end{proof}




\section{Ind-Zariski algebra}
\label{section-ind-zariski}

\noindent
We start with a definition; please see Remark \ref{remark-slightly-stronger}
for a comparison with the corresponding definition of the article \cite{BS}.

\begin{definition}
\label{definition-ind-zariski}
A ring map $A \to B$ is said to be {\it ind-Zariski} if $B$ can be written
as a filtered colimit $B = \colim B_i$ with each $A \to B_i$ a local
isomorphism.
\end{definition}

\noindent
An example of an Ind-Zariski map is a localization $A \to S^{-1}A$, see
Algebra, Lemma \ref{algebra-lemma-localization-colimit}.
The category of ind-Zariski algebras is closed under several natural
operations.

\begin{lemma}
\label{lemma-base-change-ind-zariski}
Let $A \to B$ and $A \to A'$ be ring maps. Let $B' = B \otimes_A A'$
be the base change of $B$.
If $A \to B$ is ind-Zariski, then $A' \to B'$ is ind-Zariski.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-composition-ind-zariski}
Let $A \to B$ and $B \to C$ be ring maps. If $A \to B$ and $B \to C$
are ind-Zariski, then $A \to C$ is ind-Zariski.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-ind-zariski-permanence}
Let $A$ be a ring. Let $B \to C$ be an $A$-algebra homomorphism.
If $A \to B$ and $A \to C$ are ind-Zariski, then $B \to C$
is ind-Zariski.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-ind-ind-zariski}
A filtered colimit of ind-Zariski $A$-algebras is ind-Zariski over $A$.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-ind-zariski-implies}
Let $A \to B$ be ind-Zariski. Then $A \to B$ identifies local rings,
\end{lemma}

\begin{proof}
Omitted.
\end{proof}







\section{Constructing w-local affine schemes}
\label{section-construction}

\noindent
An affine scheme $X$ is called {\it w-local} if its underlying
topological space is w-local (Definition \ref{definition-w-local}).
It turns out given any ring $A$ there is a canonical faithfully
flat ind-Zariski ring map $A \to A_w$ such that $\Spec(A_w)$ is
w-local. The key to constructing $A_w$ is the following simple lemma.

\begin{lemma}
\label{lemma-localization}
Let $A$ be a ring. Set $X = \Spec(A)$. Let $Z \subset X$ be a locally closed
subscheme which is of the form $D(f) \cap V(I)$ for some $f \in A$ and
ideal $I \subset A$. Then
\begin{enumerate}
\item there exists a multiplicative subset $S \subset A$ such that
$\Spec(S^{-1}A)$ maps by a homeomorphism to the set of points of $X$
specializing to $Z$,
\item the $A$-algebra $A_Z^\sim = S^{-1}A$ depends only on
the underlying locally closed subset $Z \subset X$,
\item $Z$ is a closed subscheme of $\Spec(A_Z^\sim)$,
\end{enumerate}
If $A \to A'$ is a ring map and $Z' \subset X' = \Spec(A')$ is a
locally closed subscheme of the same form which maps into $Z$,
then there is a unique $A$-algebra map
$A_Z^\sim \to (A')_{Z'}^\sim$.
\end{lemma}

\begin{proof}
Let $S \subset A$ be the multiplicative set of elements which map
to invertible elements of $\Gamma(Z, \mathcal{O}_Z) = (A/I)_f$.
If $\mathfrak p$ is a prime of $A$ which does not specialize to $Z$,
then $\mathfrak p$ generates the unit ideal in $(A/I)_f$. Hence
we can write $f^n =  g + h$ for some $n \geq 0$, $g \in \mathfrak p$,
$h \in I$. Then $g \in S$ and we see that $\mathfrak p$ is not in
the spectrum of $S^{-1}A$. Conversely, if $\mathfrak p$ does specialize
to $Z$, say $\mathfrak p \subset \mathfrak q \supset I$ with
$f \not \in \mathfrak q$, then we see that $S^{-1}A$ maps to
$A_\mathfrak q$ and hence $\mathfrak p$ is in the spectrum of $S^{-1}A$.
This proves (1).

\medskip\noindent
The isomorphism class of the localization $S^{-1}A$ depends only
on the corresponding subset $\Spec(S^{-1}A) \subset \Spec(A)$, whence
(2) holds. By construction $S^{-1}A$ maps surjectively onto
$(A/I)_f$, hence (3). The final statement follows as the multiplicative subset
$S' \subset A'$ corresponding to $Z'$ contains the image of the
multiplicative subset $S$.
\end{proof}

\noindent
Let $A$ be a ring. Let $E \subset A$ be a finite subset. We get a
stratification of $X = \Spec(A)$ into locally closed subschemes by
looking at the vanishing behaviour of the elements of $E$. More precisely,
given a disjoint union decomposition $E = E' \amalg E''$ we set
\begin{equation}
\label{equation-stratum}
Z(E', E'') =
\bigcap\nolimits_{f \in E'} D(f) \cap \bigcap\nolimits_{f \in E''} V(f) =
D(\prod\nolimits_{f \in E'} f) \cap V( \sum\nolimits_{f \in E''} fA)
\end{equation}
The points of $Z(E', E'')$ are exactly those $x \in X$ such that
$f \in E'$ maps to a nonzero element in $\kappa(x)$ and $f \in E''$
maps to zero in $\kappa(x)$. Thus it is clear that
\begin{equation}
\label{equation-stratify}
X = \coprod\nolimits_{E = E' \amalg E''} Z(E', E'')
\end{equation}
set theoretically. Observe that each stratum is constructible.

\begin{lemma}
\label{lemma-refine}
Let $X = \Spec(A)$ as above. Given any finite stratification
$X = \coprod T_i$ by constructible subsets, there exists a finite
subset $E \subset A$ such that the stratification (\ref{equation-stratify})
refines $X = \coprod T_i$.
\end{lemma}

\begin{proof}
We may write $T_i = \bigcup_j U_{i, j} \cap V_{i, j}^c$ as a finite union
for some $U_{i, j}$ and $V_{i, j}$ quasi-compact open in $X$.
Then we may write $U_{i, j} = \bigcup D(f_{i, j, k})$ and
$V_{i, j} = \bigcup D(g_{i, j, l})$. Then we set
$E = \{f_{i, j, k}\} \cup \{g_{i, j, l}\}$. This does the job, because
the stratification (\ref{equation-stratify}) is the one whose strata are
labeled by the vanishing pattern of the elements of $E$ which
clearly refines the given stratification.
\end{proof}

\noindent
We continue the discussion.
Given a finite subset $E \subset A$ we set
\begin{equation}
\label{equation-ring}
A_E = \prod\nolimits_{E = E' \amalg E''} A_{Z(E', E'')}^\sim
\end{equation}
with notation as in Lemma \ref{lemma-localization}. This makes sense because
(\ref{equation-stratum}) shows that each $Z(E', E'')$ has the correct shape.
We take the spectrum of this ring and denote it
\begin{equation}
\label{equation-spectrum}
X_E = \Spec(A_E) = \coprod\nolimits_{E = E' \amalg E''} X_{E', E''}
\end{equation}
with $X_{E', E''} = \Spec(A_{Z(E', E'')}^\sim)$. Note that
\begin{equation}
\label{equation-closed}
Z_E = \coprod\nolimits_{E = E' \amalg E''} Z(E', E'')
\longrightarrow
X_E
\end{equation}
is a closed subscheme. By construction the closed subscheme $Z_E$
contains all the closed points of the affine scheme $X_E$ as every point
of $X_{E', E''}$ specializes to a point of $Z(E', E'')$.

\medskip\noindent
Let $I(A)$ be the partially ordered set of all finite subsets of $A$.
This is a directed partially ordered set. For $E_1 \subset E_2$ there
is a canonical transition map $A_{E_1} \to A_{E_2}$ of $A$-algebras.
Namely, given a decomposition $E_2 = E'_2 \amalg E''_2$ we set
$E'_1 = E_1 \cap E'_2$ and $E''_1 = E_1 \cap E''_2$. Then observe that
$Z(E'_1, E''_1) \subset Z(E'_2, E''_2)$ hence a unique $A$-algebra map
$A_{Z(E'_1, E''_1)}^\sim \to A_{Z(E'_2, E''_2)}^\sim$ by
Lemma \ref{lemma-localization}. Using these maps collectively we obtain
the desired ring map $A_{E_1} \to A_{E_2}$. Observe that the corresponding
map of affine schemes
\begin{equation}
\label{equation-transition}
X_{E_2} \longrightarrow X_{E_1}
\end{equation}
maps $Z_{E_2}$ into $Z_{E_1}$. By uniqueness we obtain a system of
$A$-algebras over $I(A)$ and we set
\begin{equation}
\label{equation-colimit-ring}
A_w = \colim_{E \in I(A)} A_E
\end{equation}
This $A$-algebra is ind-Zariski and faithfully flat over $A$.
Finally, we set $X_w = \Spec(A_w)$ and endow it with the closed subscheme
$Z = \lim_{E \in I(A)} Z_E$. In a formula
\begin{equation}
\label{equation-final}
X_w = \lim_{E \in I(A)} X_E \supset Z = \lim_{E \in I(A)} Z_E
\end{equation}

\begin{lemma}
\label{lemma-make-w-local}
Let $X = \Spec(A)$ be an affine scheme. With $A \to A_w$, $X_w = \Spec(A_w)$,
and $Z \subset X_w$ as above.
\begin{enumerate}
\item $A \to A_w$ is ind-Zariski and faithfully flat,
\item $X_w \to X$ induces a bijection $Z \to X$,
\item $Z$ is the set of closed points of $X_w$,
\item $Z$ is a reduced scheme, and
\item every point of $X_w$ specializes to a unique point of $Z$.
\end{enumerate}
In particular, $X_w$ is w-local (Definition \ref{definition-w-local}).
\end{lemma}

\begin{proof}
The map $A \to A_w$ is ind-Zariski by construction.
For every $E$ the morphism $Z_E \to X$ is a bijection, hence (2).
As $Z \subset X_w$ we conclude $X_w \to X$ is surjective and
$A \to A_w$ is faithfully flat by
Algebra, Lemma \ref{algebra-lemma-ff-rings}. This proves (1).

\medskip\noindent
Suppose that $y \in X_w$, $y \not \in Z$. Then there
exists an $E$ such that the image of $y$ in $X_E$ is not contained in
$Z_E$. Then for all $E \subset E'$ also $y$ maps to an element of $X_{E'}$
not contained in $Z_{E'}$. Let $T_{E'} \subset X_{E'}$ be the reduced
closed subscheme which is the closure of the image of $y$. It is
clear that $T = \lim_{E \subset E'} T_{E'}$ is the closure of $y$ in $X_w$.
For every $E \subset E'$ the scheme $T_{E'} \cap Z_{E'}$ is nonempty
by construction of $X_{E'}$. Hence $\lim T_{E'} \cap Z_{E'}$ is nonempty
and we conclude that $T \cap Z$ is nonempty. Thus $y$ is not a closed point.
It follows that every closed point of $X_w$ is in $Z$.

\medskip\noindent
Suppose that $y \in X_w$ specializes to $z, z' \in Z$. We will show that
$z = z'$ which will finish the proof of (3) and will imply (5).
Let $x, x' \in X$ be the images of $z$ and $z'$. Since $Z \to X$ is
bijective it suffices to show that $x = x'$. If $x \not = x'$, then
there exists an $f \in A$ such that $x \in D(f)$ and $x' \in V(f)$
(or vice versa). Set $E = \{f\}$ so that
$$
X_E = \Spec(A_f) \amalg \Spec(A_{V(f)}^\sim)
$$
Then we see that $z$ and $z'$ map $x_E$ and $x'_E$ which are in different
parts of the given decomposition of $X_E$ above. But then it impossible
for $x_E$ and $x'_E$ to be specializations of a common point.
This is the desired contradiction.

\medskip\noindent
Recall that given a finite subset $E \subset A$ we have $Z_E$
is a disjoint union of the locally closed subschemes $Z(E', E'')$
each isomorphic to the spectrum of $(A/I)_f$ where $I$ is the ideal
generated by $E''$ and $f$ the product of the elements of $E'$.
Any nilpotent element $b$ of $(A/I)_f$ is the class of $g/f^n$
for some $g \in A$. Then setting $E' = E \cup \{g\}$ the reader
verifies that $b$ is pulls back to zero under the transition map
$Z_{E'} \to Z_E$ of the system. This proves (4).
\end{proof}

\begin{remark}
\label{remark-size-w}
Let $A$ be a ring. Let $\kappa$ be an infinite cardinal bigger or
equal than the cardinality of $A$. Then the cardinality of $A_w$
(Lemma \ref{lemma-make-w-local})
is at most $\kappa$. Namely, each $A_E$ has cardinality at most
$\kappa$ and the set of finite subsets of $A$ has cardinality at most $\kappa$
as well. Thus the result follows as $\kappa \otimes \kappa = \kappa$, see
Sets, Section \ref{sets-section-cardinals}.
\end{remark}

\begin{lemma}[Universal property of the construction]
\label{lemma-universal}
Let $A$ be a ring. Let $A \to A_w$ be the ring map constructed in
Lemma \ref{lemma-make-w-local}. For any ring map $A \to B$ such that
$\Spec(B)$ is w-local, there is a unique factorization $A \to A_w \to B$
such that $\Spec(B) \to \Spec(A_w)$ is w-local.
\end{lemma}

\begin{proof}
Denote $Y = \Spec(B)$ and $Y_0 \subset Y$ the set of closed points.
Denote $f : Y \to X$ the given morphism.
Recall that $Y_0$ is profinite, in particular every constructible
subset of $Y_0$ is open and closed. Let $E \subset A$ be a finite subset.
Recall that $A_w = \colim A_E$ and that the set of closed points of
$\Spec(A_w)$ is the limit of the closed subsets $Z_E \subset X_E = \Spec(A_E)$.
Thus it suffices to show there is a unique factorization $A \to A_E \to B$
such that $Y \to X_E$ maps $Y_0$ into $Z_E$.
Since $Z_E \to X = \Spec(A)$ is bijective, and since the strata
$Z(E', E'')$ are constructible we see that
$$
Y_0 = \coprod f^{-1}(Z(E', E'')) \cap Y_0
$$
is a disjoint union decomposition into open and closed subsets.
As $Y_0 = \pi_0(Y)$ we obtain a corresponding decomposition of
$Y$ into open and closed pieces. Thus it suffices to construct
the factorization in case $f(Y_0) \subset Z(E', E'')$ for
some decomposition $E = E' \amalg E''$.
In this case $f(Y)$ is contained in the set of points of $X$
specializing to $Z(E', E'')$ which is homeomorphic to $X_{E', E''}$.
Thus we obtain a unique continuous map $Y \to X_{E', E''}$ over $X$. By
Lemma \ref{lemma-fully-faithful-spaces-over-X}
this corresponds to a unique morphism of schemes
$Y \to X_{E', E''}$ over $X$. This finishes the proof.
\end{proof}

\noindent
Recall that the spectrum of a ring is profinite if and only if
every point is closed. There are in fact a whole slew of equivalent
conditions that imply this. See
Algebra, Lemma \ref{algebra-lemma-ring-with-only-minimal-primes} or
Topology, Lemma \ref{topology-lemma-characterize-profinite-spectral}.

\begin{lemma}
\label{lemma-profinite-goes-up}
Let $A$ be a ring such that $\Spec(A)$ is profinite. Let $A \to B$ be a
ring map. Then $\Spec(B)$ is profinite in each of the following cases:
\begin{enumerate}
\item if $\mathfrak q,\mathfrak q' \subset B$ lie over the same
prime of $A$, then neither $\mathfrak q \subset \mathfrak q'$, nor
$\mathfrak q' \subset \mathfrak q$,
\item $A \to B$ induces algebraic extensions of residue fields,
\item $A \to B$ is a local isomorphism,
\item $A \to B$ identifies local rings,
\item $A \to B$ is weakly \'etale,
\item $A \to B$ is quasi-finite,
\item $A \to B$ is unramified,
\item $A \to B$ is \'etale,
\item $B$ is a filtered colimit of $A$-algebras as in (1) -- (8),
\item etc.
\end{enumerate}
\end{lemma}

\begin{proof}
By the references mentioned above
(Algebra, Lemma \ref{algebra-lemma-ring-with-only-minimal-primes} or
Topology, Lemma \ref{topology-lemma-characterize-profinite-spectral})
there are no specializations between distinct points of $\Spec(A)$ and
$\Spec(B)$ is profinite if and only if there are no specializations
between distinct points of $\Spec(B)$. These specializations can only
happen in the fibres of $\Spec(B) \to \Spec(A)$. In this way we see
that (1) is true.

\medskip\noindent
The assumption in (2) implies all primes of $B$ are maximal by
Algebra, Lemma \ref{algebra-lemma-finite-residue-extension-closed}.
Thus (2) holds.
If $A \to B$ is a local isomorphism or identifies local rings,
then the residue field extensions are trivial, so (3) and (4)
follow from (2).
If $A \to B$ is weakly \'etale, then More on Algebra, Lemma
\ref{more-algebra-lemma-weakly-etale-residue-field-extensions}
tells us it induces separable algebraic residue field extensions, so
(5) follows from (2).
If $A \to B$ is quasi-finite, then the fibres are finite discrete
topological spaces. Hence (6) follows from (1).
Hence (3) follows from (1). Cases (7) and (8)
follow from this as unramified and \'etale ring map are quasi-finite
(Algebra, Lemmas
\ref{algebra-lemma-unramified-quasi-finite} and
\ref{algebra-lemma-etale-quasi-finite}).
If $B = \colim B_i$ is a filtered colimit of $A$-algebras, then
$\Spec(B) = \lim \Spec(B_i)$ in the category of topological spaces by
Limits, Lemma \ref{limits-lemma-inverse-limit-top}.
Hence if each $\Spec(B_i)$ is profinite, so is $\Spec(B)$ by
Topology, Lemma \ref{topology-lemma-directed-inverse-limit-profinite}.
This proves (9).
\end{proof}

\begin{lemma}
\label{lemma-localize-along-closed-profinite}
Let $A$ be a ring. Let $V(I) \subset \Spec(A)$ be a closed subset
which is a profinite topological space. Then there exists an
ind-Zariski ring map $A \to B$ such that $\Spec(B)$ is w-local,
the set of closed points is $V(IB)$, and $A/I \cong B/IB$.
\end{lemma}

\begin{proof}
Let $A \to A_w$ and $Z \subset Y = \Spec(A_w)$ as in
Lemma \ref{lemma-make-w-local}.
Let $T \subset Z$ be the inverse image of $V(I)$.
Then $T \to V(I)$ is a homeomorphism by
Topology, Lemma \ref{topology-lemma-bijective-map}.
Let $B = (A_w)_T^\sim$, see Lemma \ref{lemma-localization}.
It is clear that $B$ is w-local with closed points $V(IB)$.
The ring map $A/I \to B/IB$ is ind-Zariski
and induces a homeomorphism on underlying
topological spaces. Hence it is an isomorphism by
Lemma \ref{lemma-local-isomorphism-fully-faithful}.
\end{proof}

\begin{lemma}
\label{lemma-w-local-algebraic-residue-field-extensions}
Let $A$ be a ring such that $X = \Spec(A)$ is w-local. Let $I \subset A$
be the radical ideal cutting out the set $X_0$ of closed points in $X$.
Let $A \to B$ be a ring map inducing algebraic extensions on residue
fields at primes. Then
\begin{enumerate}
\item every point of $Z = V(IB)$ is a closed point of $\Spec(B)$,
\item there exists an ind-Zariski ring map $B \to C$ such that
\begin{enumerate}
\item $B/IB \to C/IC$ is an isomorphism,
\item the space $Y = \Spec(C)$ is w-local,
\item the induced map $p : Y \to X$ is w-local, and
\item $p^{-1}(X_0)$ is the set of closed points of $Y$.
\end{enumerate}
\end{enumerate}
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-profinite-goes-up} applied to $A/I \to B/IB$
all points of $Z = V(IB) = \Spec(B/IB)$ are closed, in fact $\Spec(B/IB)$
is a profinite space.
To finish the proof we apply Lemma \ref{lemma-localize-along-closed-profinite}
to $IB \subset B$.
\end{proof}





\section{Identifying local rings versus ind-Zariski}
\label{section-connected-components}

\noindent
An ind-Zariski ring map $A \to B$ identifies local rings
(Lemma \ref{lemma-ind-zariski-implies}). The converse does not hold
(Examples, Section \ref{examples-section-not-ind-etale}).
However, it turns out that there is a kind of structure theorem for
ring maps which identify local rings in terms of ind-Zariski
ring maps, see Proposition \ref{proposition-maps-wich-identify-local-rings}.

\medskip\noindent
Let $A$ be a ring. Let $X = \Spec(A)$. The space of connected
components $\pi_0(X)$ is a profinite space by
Topology, Lemma \ref{topology-lemma-spectral-pi0}
(and Algebra, Lemma \ref{algebra-lemma-spec-spectral}).

\begin{lemma}
\label{lemma-construct}
Let $A$ be a ring. Let $X = \Spec(A)$. Let $T \subset \pi_0(X)$ be a
closed subset. There exists a surjective ind-Zariski ring map $A \to B$
such that $\Spec(B) \to \Spec(A)$ induces a homeomorphism of $\Spec(B)$
with the inverse image of $T$ in $X$.
\end{lemma}

\begin{proof}
Let $Z \subset X$ be the inverse image of $T$. Then $Z$ is the intersection
$Z = \bigcap Z_\alpha$ of the open and closed subsets of $X$ containing $Z$,
see Topology, Lemma \ref{topology-lemma-closed-union-connected-components}.
For each $\alpha$ we have $Z_\alpha = \Spec(A_\alpha)$ where
$A \to A_\alpha$ is a local isomorphism (a localization at an idempotent).
Setting $B = \colim A_\alpha$ proves the lemma.
\end{proof}

\begin{lemma}
\label{lemma-construct-profinite}
Let $A$ be a ring and let $X = \Spec(A)$. Let $T$ be a profinite space and
let $T \to \pi_0(X)$ be a continuous map. There exists an
ind-Zariski ring map $A \to B$ such that with $Y = \Spec(B)$ the diagram
$$
\xymatrix{
Y \ar[r] \ar[d] & \pi_0(Y) \ar[d] \\
X \ar[r] & \pi_0(X)
}
$$
is cartesian in the category of topological spaces and such that
$\pi_0(Y) = T$ as spaces over $\pi_0(X)$.
\end{lemma}

\begin{proof}
Namely, write $T = \lim T_i$ as the limit of an inverse system finite
discrete spaces over a directed set (see
Topology, Lemma \ref{topology-lemma-profinite}). For each $i$ let
$Z_i = \Im(T \to \pi_0(X) \times T_i)$. This is a closed subset.
Observe that $X \times T_i$ is the spectrum of $A_i = \prod_{t \in T_i} A$
and that $A \to A_i$ is a local isomorphism. By Lemma \ref{lemma-construct}
we see that $Z_i \subset \pi_0(X \times T_i) = \pi_0(X) \times T_i$
corresponds to a surjection $A_i \to B_i$ which is ind-Zariski
such that $\Spec(B_i) = X \times_{\pi_0(X)} Z_i$ as subsets of
$X \times T_i$. The transition maps $T_i \to T_{i'}$ induce maps
$Z_i \to Z_{i'}$ and $X \times_{\pi_0(X)} Z_i \to X \times_{\pi_0(X)} Z_{i'}$.
Hence ring maps $B_{i'} \to B_i$
(Lemmas \ref{lemma-local-isomorphism-fully-faithful} and
\ref{lemma-ind-zariski-implies}).
Set $B = \colim B_i$. Because $T = \lim Z_i$ we have
$X \times_{\pi_0(X)} T = \lim  X \times_{\pi_0(X)} Z_i$
and hence $Y = \Spec(B) = \lim \Spec(B_i)$
fits into the cartesian diagram
$$
\xymatrix{
Y \ar[r] \ar[d] & T \ar[d] \\
X \ar[r] & \pi_0(X)
}
$$
of topological spaces. By Lemma \ref{lemma-silly}
we conclude that $T = \pi_0(Y)$.
\end{proof}

\begin{example}
\label{example-construct-space}
Let $k$ be a field. Let $T$ be a profinite topological space.
There exists an ind-Zariski ring map $k \to A$ such that
$\Spec(A)$ is homeomorphic to $T$. Namely, just apply
Lemma \ref{lemma-construct-profinite} to $T \to \pi_0(\Spec(k)) = \{*\}$.
In fact, in this case we have
$$
A = \colim \text{Map}(T_i, k)
$$
whenever we write $T = \lim T_i$ as a filtered limit with each $T_i$ finite.
\end{example}

\begin{lemma}
\label{lemma-w-local-morphism-equal-points-stalks-is-iso}
Let $A \to B$ be ring map such that
\begin{enumerate}
\item $A \to B$ identifies local rings,
\item the topological spaces $\Spec(B)$, $\Spec(A)$ are w-local,
\item $\Spec(B) \to \Spec(A)$ is w-local, and
\item $\pi_0(\Spec(B)) \to \pi_0(\Spec(A))$ is bijective.
\end{enumerate}
Then $A \to B$ is an isomorphism
\end{lemma}

\begin{proof}
Let $X_0 \subset X = \Spec(A)$ and $Y_0 \subset Y = \Spec(B)$ be the
sets of closed points. By assumption $Y_0$ maps into $X_0$ and
the induced map $Y_0 \to X_0$ is a bijection.
As a space $\Spec(A)$ is the disjoint union of the spectra
of the local rings of $A$ at closed points.
Similarly for $B$. Hence $X \to Y$ is a bijection.
Since $A \to B$ is flat we have going down
(Algebra, Lemma \ref{algebra-lemma-flat-going-down}).
Thus Algebra, Lemma \ref{algebra-lemma-unique-prime-over-localize-below}
shows for any prime $\mathfrak q \subset B$ lying over
$\mathfrak p \subset A$ we have $B_\mathfrak q = B_\mathfrak p$.
Since $B_\mathfrak q = A_\mathfrak p$ by assumption, we
see that $A_\mathfrak p = B_\mathfrak p$ for all primes $\mathfrak p$
of $A$. Thus $A = B$ by
Algebra, Lemma \ref{algebra-lemma-characterize-zero-local}.
\end{proof}

\begin{lemma}
\label{lemma-w-local-morphism-equal-stalks-is-ind-zariski}
Let $A \to B$ be ring map such that
\begin{enumerate}
\item $A \to B$ identifies local rings,
\item the topological spaces $\Spec(B)$, $\Spec(A)$ are w-local, and
\item $\Spec(B) \to \Spec(A)$ is w-local.
\end{enumerate}
Then $A \to B$ is ind-Zariski.
\end{lemma}

\begin{proof}
Set $X = \Spec(A)$ and $Y = \Spec(B)$. Let $X_0 \subset X$ and
$Y_0 \subset Y$ be the set of closed points. Let $A \to A'$ be the ind-Zariski
morphism of affine schemes such that with $X' = \Spec(A')$ the diagram
$$
\xymatrix{
X' \ar[r] \ar[d] & \pi_0(X') \ar[d] \\
X \ar[r] & \pi_0(X)
}
$$
is cartesian in the category of topological spaces and such that
$\pi_0(X') = \pi_0(Y)$ as spaces over $\pi_0(X)$, see
Lemma \ref{lemma-construct-profinite}. By
Lemma \ref{lemma-silly} we see that $X'$ is w-local and
the set of closed points $X'_0 \subset X'$ is the inverse image of $X_0$.

\medskip\noindent
We obtain a continuous map $Y \to X'$ of underlying topological spaces
over $X$ identifying $\pi_0(Y)$ with $\pi_0(X')$. By
Lemma \ref{lemma-local-isomorphism-fully-faithful}
(and Lemma \ref{lemma-ind-zariski-implies})
this is corresponds to a morphism of affine schemes $Y \to X'$
over $X$. Since $Y \to X$ maps $Y_0$ into $X_0$ we see that
$Y \to X'$ maps $Y_0$ into $X'_0$, i.e., $Y \to X'$ is w-local.
By Lemma \ref{lemma-w-local-morphism-equal-points-stalks-is-iso}
we see that $Y \cong X'$ and we win.
\end{proof}

\noindent
The following proposition is a warm up for the type of result
we will prove later.

\begin{proposition}
\label{proposition-maps-wich-identify-local-rings}
Let $A \to B$ be a ring map which identifies local rings.
Then there exists a faithfully flat, ind-Zariski ring map
$B \to B'$ such that $A \to B'$ is ind-Zariski.
\end{proposition}

\begin{proof}
Let $A \to A_w$, resp. $B \to B_w$ be the faithfully flat, ind-Zariski ring
map constructed in Lemma \ref{lemma-make-w-local} for $A$, resp.\ $B$.
Since $\Spec(B_w)$ is w-local, there exists a unique factorization
$A \to A_w \to B_w$ such that $\Spec(B_w) \to \Spec(A_w)$ is w-local
by Lemma \ref{lemma-universal}. Note that $A_w \to B_w$ identifies
local rings, see
Lemma \ref{lemma-local-isomorphism-permanence}.
By Lemma \ref{lemma-w-local-morphism-equal-stalks-is-ind-zariski}
this means $A_w \to B_w$ is ind-Zariski. Since $B \to B_w$ is
faithfully flat, ind-Zariski (Lemma \ref{lemma-make-w-local})
and the composition $A \to B \to B_w$ is ind-Zariski
(Lemma \ref{lemma-composition-ind-zariski})
the proposition is proved.
\end{proof}

\noindent
The proposition above allows us to characterize the affine, weakly contractible
objects in the pro-Zariski site of an affine scheme.

\begin{lemma}
\label{lemma-w-local-extremally-disconnected}
Let $A$ be a ring. The following are equivalent
\begin{enumerate}
\item every faithfully flat ring map $A \to B$ identifying local rings
has a section,
\item every faithfully flat ind-Zariski ring map $A \to B$ has a section, and
\item $A$ satisfies
\begin{enumerate}
\item $\Spec(A)$ is w-local, and
\item $\pi_0(\Spec(A))$ is extremally disconnected.
\end{enumerate}
\end{enumerate}
\end{lemma}

\begin{proof}
The equivalence of (1) and (2) follows immediately from
Proposition \ref{proposition-maps-wich-identify-local-rings}.

\medskip\noindent
Assume (3)(a) and (3)(b). Let $A \to B$ be faithfully flat and ind-Zariski.
We will use without further mention the fact that a flat map
$A \to B$ is faithfully flat if and only if every closed point
of $\Spec(A)$ is in the image of $\Spec(B) \to \Spec(A)$
We will show that $A \to B$ has a section.

\medskip\noindent
Let $I \subset A$ be an ideal such that $V(I) \subset \Spec(A)$ is
the set of closed points of $\Spec(A)$. 
We may replace $B$ by the ring $C$ constructed in
Lemma \ref{lemma-w-local-algebraic-residue-field-extensions}
for $A \to B$ and $I \subset A$.
Thus we may assume $\Spec(B)$ is w-local such that the set of
closed points of $\Spec(B)$ is $V(IB)$.

\medskip\noindent
Assume $\Spec(B)$ is w-local and the set of closed points of $\Spec(B)$
is $V(IB)$. Choose a continuous section to the surjective
continuous map $V(IB) \to V(I)$. This is possible as
$V(I) \cong \pi_0(\Spec(A))$ is extremally disconnected, see
Topology, Proposition
\ref{topology-proposition-projective-in-category-hausdorff-qc}.
The image is a closed subspace $T \subset \pi_0(\Spec(B)) \cong V(JB)$
mapping homeomorphically onto $\pi_0(A)$. Replacing $B$ by the ind-Zariski
quotient ring constructed in Lemma \ref{lemma-construct}
we see that we may assume $\pi_0(\Spec(B)) \to \pi_0(\Spec(A))$
is bijective. At this point $A \to B$ is an isomorphism by
Lemma \ref{lemma-w-local-morphism-equal-points-stalks-is-iso}.

\medskip\noindent
Assume (1) or equivalently (2). Let $A \to A_w$ be the ring map constructed in
Lemma \ref{lemma-make-w-local}. By (1) there is a section $A_w \to A$.
Thus $\Spec(A)$ is homeomorphic to a closed subset of $\Spec(A_w)$. By
Lemma \ref{lemma-closed-subspace-w-local} we see (3)(a) holds.
Finally, let $T \to \pi_0(A)$ be a surjective map with $T$ an
extremally disconnected, quasi-compact, Hausdorff topological space
(Topology, Lemma \ref{topology-lemma-existence-projective-cover}).
Choose $A \to B$ as in Lemma \ref{lemma-construct-profinite}
adapted to $T \to \pi_0(\Spec(A))$. By (1) there is a section
$B \to A$. Thus we see that $T = \pi_0(\Spec(B)) \to \pi_0(\Spec(A))$
has a section. A formal categorical argument, using
Topology, Proposition
\ref{topology-proposition-projective-in-category-hausdorff-qc},
implies that $\pi_0(\Spec(A))$ is extremally disconnected.
\end{proof}

\begin{lemma}
\label{lemma-find-Zariski-w-contractible}
Let $A$ be a ring. There exists a faithfully flat, ind-Zariski ring
map $A \to B$ such that $B$ satisfies the equivalent conditions
of Lemma \ref{lemma-w-local-extremally-disconnected}.
\end{lemma}

\begin{proof}
We first apply Lemma \ref{lemma-make-w-local} to see that we may assume that
$\Spec(A)$ is w-local.
Choose an extremally disconnected space $T$ and a surjective
continuous map $T \to \pi_0(\Spec(A))$, see
Topology, Lemma \ref{topology-lemma-existence-projective-cover}.
Note that $T$ is profinite. Apply Lemma \ref{lemma-construct-profinite}
to find an ind-Zariski ring map $A \to B$ such that
$\pi_0(\Spec(B)) \to \pi_0(\Spec(A))$ realizes $T \to \pi_0(\Spec(A))$
and such that
$$
\xymatrix{
\Spec(B) \ar[r] \ar[d] & \pi_0(\Spec(B)) \ar[d] \\
\Spec(A) \ar[r] & \pi_0(\Spec(A))
}
$$
is cartesian in the category of topological spaces. Note that $\Spec(B)$
is w-local, that $\Spec(B) \to \Spec(A)$ is w-local, and that the
set of closed points of $\Spec(B)$ is the inverse image of the
set of closed points of $\Spec(A)$, see Lemma \ref{lemma-silly}.
Thus condition (3) of
Lemma \ref{lemma-w-local-extremally-disconnected}
holds for $B$.
\end{proof}

\begin{remark}
\label{remark-slightly-stronger}
In each of Lemmas \ref{lemma-construct}, \ref{lemma-construct-profinite},
Proposition \ref{proposition-maps-wich-identify-local-rings}, and
Lemma \ref{lemma-find-Zariski-w-contractible} we find an ind-Zariski ring
map with some properties. In the paper \cite{BS} the authors use the notion
of an ind-(Zariski localization) which is a filtered colimit of finite
products of principal localizations. It is possible to replace ind-Zariski
by ind-(Zariski localization) in each of the results listed above.
However, we do not need this and the notion of an ind-Zariski homomorphism
of rings as defined here has slightly better formal properties. Moreover,
the notion of an ind-Zariski ring map is the natural analogue of the
notion of an ind-\'etale ring map defined in the next section.
\end{remark}




\section{Ind-\'etale algebra}
\label{section-ind-etale}

\noindent
We start with a definition.

\begin{definition}
\label{definition-ind-etale}
A ring map $A \to B$ is said to be {\it ind-\'etale} if $B$ can be written
as a filtered colimit of \'etale $A$-algebras.
\end{definition}

\noindent
The category of ind-\'etale algebras is closed under a number of natural
operations.

\begin{lemma}
\label{lemma-base-change-ind-etale}
Let $A \to B$ and $A \to A'$ be ring maps. Let $B' = B \otimes_A A'$
be the base change of $B$.
If $A \to B$ is ind-\'etale, then $A' \to B'$ is ind-\'etale.
\end{lemma}

\begin{proof}
This is Algebra, Lemma \ref{algebra-lemma-base-change-colimit-etale}.
\end{proof}

\begin{lemma}
\label{lemma-composition-ind-etale}
Let $A \to B$ and $B \to C$ be ring maps. If $A \to B$ and $B \to C$
are ind-\'etale, then $A \to C$ is ind-\'etale.
\end{lemma}

\begin{proof}
This is Algebra, Lemma \ref{algebra-lemma-composition-colimit-etale}.
\end{proof}

\begin{lemma}
\label{lemma-ind-ind-etale}
A filtered colimit of ind-\'etale $A$-algebras is ind-\'etale over $A$.
\end{lemma}

\begin{proof}
This is Algebra, Lemma \ref{algebra-lemma-colimit-colimit-etale}.
\end{proof}

\begin{lemma}
\label{lemma-ind-etale-permanence}
Let $A$ be a ring. Let $B \to C$ be an $A$-algebra map of ind-\'etale
$A$-algebras. Then $C$ is an ind-\'etale $B$-algebra.
\end{lemma}

\begin{proof}
This is Algebra, Lemma \ref{algebra-lemma-colimits-of-etale}.
\end{proof}

\begin{lemma}
\label{lemma-ind-etale-implies}
Let $A \to B$ be ind-\'etale. Then $A \to B$ is weakly \'etale
(More on Algebra, Definition \ref{more-algebra-definition-weakly-etale}).
\end{lemma}

\begin{proof}
This follows from More on Algebra, Lemma
\ref{more-algebra-lemma-when-weakly-etale}.
\end{proof}

\begin{lemma}
\label{lemma-lift-ind-etale}
Let $A$ be a ring and let $I \subset A$ be an ideal. The base change functor
$$
\text{ind-\'etale }A\text{-algebras}
\longrightarrow
\text{ind-\'etale }A/I\text{-algebras},\quad
C \longmapsto C/IC
$$
has a fully faithful right adjoint $v$. In particular, given
an ind-\'etale $A/I$-algebra $\overline{C}$ there exists
an ind-\'etale $A$-algebra $C = v(\overline{C})$ such that
$\overline{C} = C/IC$.
\end{lemma}

\begin{proof}
Let $\overline{C}$ be an ind-\'etale $A/I$-algebra.
Consider the category $\mathcal{C}$ of factorizations
$A \to B \to \overline{C}$ where $A \to B$ is \'etale.
(We ignore some set theoretical issues in this proof.)
We will show that this category is directed and that
$C = \colim_\mathcal{C} B$ is an ind-\'etale $A$-algebra
such that $\overline{C} = C/IC$.

\medskip\noindent
We first prove that $\mathcal{C}$ is directed
(Categories, Definition \ref{categories-definition-directed}).
The category is nonempty as $A \to A \to \overline{C}$ is an object.
Suppose that $A \to B \to \overline{C}$ and $A \to B' \to \overline{C}$
are two objects of $\mathcal{C}$. Then $A \to B \otimes_A B' \to \overline{C}$
is another (use Algebra, Lemma \ref{algebra-lemma-etale}).
Suppose that $f, g : B \to B'$ are two maps between
objects $A \to B \to \overline{C}$ and $A \to B' \to \overline{C}$
of $\mathcal{C}$. Then a coequalizer is
$A \to B' \otimes_{f, B, g} B' \to \overline{C}$.
This is an object of $\mathcal{C}$ by
Algebra, Lemmas \ref{algebra-lemma-etale} and
\ref{algebra-lemma-map-between-etale}.
Thus the category $\mathcal{C}$ is directed.

\medskip\noindent
Write $\overline{C} = \colim \overline{B_i}$ as a filtered colimit with
$\overline{B_i}$ \'etale over $A/I$. For every $i$
there exists $A \to B_i$ \'etale with $\overline{B_i} = B_i/IB_i$, see
Algebra, Lemma \ref{algebra-lemma-lift-etale}.
Thus $C \to \overline{C}$ is surjective.
Since $C/IC \to \overline{C}$ is ind-\'etale
(Lemma \ref{lemma-ind-etale-permanence})
we see that it is flat. Hence $\overline{C}$ is a localization of
$C/IC$ at some multiplicative subset $S \subset C/IC$
(Algebra, Lemma \ref{algebra-lemma-pure}).
Take an $f \in C$ mapping to an element of $S \subset C/IC$.
Choose $A \to B \to \overline{C}$ in $\mathcal{C}$ and $g \in B$
mapping to $f$ in the colimit. Then we see that $A \to B_g \to \overline{C}$
is an object of $\mathcal{C}$ as well. Thus $f$ is an invertible
element of $C$. It follows that $C/IC = \overline{C}$.

\medskip\noindent
Next, we claim that for an ind-\'etale algebra $D$ over $A$ we have
$$
\Mor_A(D, C) = \Mor_{A/I}(D/ID, \overline{C})
$$
Namely, let $D/ID \to \overline{C}$ be an $A/I$-algebra map.
Write $D = \colim_{i \in I} D_i$ as a colimit over a directed set $I$
with $D_i$ \'etale over $A$. By choice of $\mathcal{C}$
we obtain a transformation $I \to \mathcal{C}$ and hence a map
$D \to C$ compatible with maps to $\overline{C}$. Whence the claim.

\medskip\noindent
It follows that the functor $v$ defined by the rule
$$
\overline{C} 
\longmapsto
v(\overline{C}) = \colim_{A \to B \to \overline{C}} B
$$
is a right adjoint to the base change functor $u$ as required by the lemma.
The functor $v$ is fully faithful because
$u \circ v = \text{id}$ by construction, see
Categories, Lemma \ref{categories-lemma-adjoint-fully-faithful}.
\end{proof}









\section{Constructing ind-\'etale algebras}
\label{section-construction-ind-etale}

\noindent
Let $A$ be a ring. Recall that any \'etale ring map $A \to B$ is isomorphic
to a standard smooth ring map of relative dimension $0$. Such a ring map
is of the form
$$
A \longrightarrow A[x_1, \ldots, x_n]/(f_1, \ldots, f_n)
$$
where the determinant of the $n \times n$-matrix with entries
$\partial f_i/\partial x_j$ is invertible in the quotient ring. See
Algebra, Lemma \ref{algebra-lemma-etale-standard-smooth}.

\medskip\noindent
Let $S(A)$ be the set of all {\it faithfully flat}\footnote{In the presence
of flatness, e.g., for smooth or \'etale ring maps,
this just means that the induced map on spectra is surjective. See
Algebra, Lemma \ref{algebra-lemma-ff-rings}.}
standard smooth $A$-algebras of relative dimension $0$.
Let $I(A)$ be the partially ordered (by inclusion) set of finite
subsets $E$ of $S(A)$. Note that $I(A)$ is a directed partially
ordered set. For $E = \{A \to B_1, \ldots, A \to B_n\}$ set
$$
B_E = B_1 \otimes_A \ldots \otimes_A B_n
$$
Observe that $B_E$ is a faithfully flat \'etale $A$-algebra.
For $E \subset E'$, there is a canonical transition map $B_E \to B_{E'}$
of \'etale $A$-algebras. Namely, say $E = \{A \to B_1, \ldots, A \to B_n\}$
and $E' = \{A \to B_1, \ldots, A \to B_{n + m}\}$ then
$B_E \to B_{E'}$ sends $b_1 \otimes \ldots \otimes b_n$ to the
element $b_1 \otimes \ldots \otimes b_n \otimes 1 \otimes \ldots \otimes 1$
of $B_{E'}$. This construction defines a system of faithfully flat
\'etale $A$-algebras over $I(A)$ and we set
$$
T(A) = \colim_{E \in I(A)} B_E
$$
Observe that $T(A)$ is a faithfully flat ind-\'etale $A$-algebra
(Algebra, Lemma \ref{algebra-lemma-colimit-faithfully-flat}). By construction
given any faithfully flat \'etale $A$-algebra $B$ there is a (non-unique)
$A$-algebra map $B \to T(A)$. Namely, pick some $(A \to B_0) \in S(A)$
and an isomorphism $B \cong B_0$. Then the canonical coprojection
$$
B \to B_0 \to 
T(A) = \colim_{E \in I(A)} B_E
$$
is the desired map.

\begin{lemma}
\label{lemma-first-construction}
Given a ring $A$ there exists a faithfully flat ind-\'etale $A$-algebra $C$
such that every faithfully flat \'etale ring map $C \to B$ has a section.
\end{lemma}

\begin{proof}
Set $T^1(A) = T(A)$ and $T^{n + 1}(A) = T(T^n(A))$. Let
$$
C = \colim T^n(A)
$$
This algebra is faithfully flat over each $T^n(A)$ and in particular
over $A$, see
Algebra, Lemma \ref{algebra-lemma-colimit-faithfully-flat}.
Moreover, $C$ is ind-\'etale over $A$ by Lemma \ref{lemma-ind-ind-etale}.
If $C \to B$ is \'etale, then there exists an $n$ and an \'etale
ring map $T^n(A) \to B'$ such that $B = C \otimes_{T^n(A)} B'$, see
Algebra, Lemma \ref{algebra-lemma-etale}.
If $C \to B$ is faithfully flat, then $\Spec(B) \to \Spec(C) \to \Spec(T^n(A))$
is surjective, hence $\Spec(B') \to \Spec(T^n(A))$ is surjective.
In other words, $T^n(A) \to B'$ is faithfully flat.
By our construction, there is a $T^n(A)$-algebra map
$B' \to T^{n + 1}(A)$. This induces a $C$-algebra map $B \to C$
which finishes the proof.
\end{proof}

\begin{remark}
\label{remark-size-T}
Let $A$ be a ring. Let $\kappa$ be an infinite cardinal bigger or
equal than the cardinality of $A$. Then the cardinality of $T(A)$
is at most $\kappa$. Namely, each $B_E$ has cardinality at most
$\kappa$ and the index set $I(A)$ has cardinality at most $\kappa$
as well. Thus the result follows as $\kappa \otimes \kappa = \kappa$, see
Sets, Section \ref{sets-section-cardinals}. It follows that the
ring constructed in the proof of Lemma \ref{lemma-first-construction}
has cardinality at most $\kappa$ as well.
\end{remark}

\begin{remark}
\label{remark-first-construction-functorial}
The construction $A \mapsto T(A)$ is functorial in the following sense:
If $A \to A'$ is a ring map, then we can construct a commutative diagram
$$
\xymatrix{
A \ar[r] \ar[d] & T(A) \ar[d] \\
A' \ar[r] & T(A')
}
$$
Namely, given $(A \to A[x_1, \ldots, x_n]/(f_1, \ldots, f_n))$ in
$S(A)$ we can use the ring map $\varphi : A \to A'$ to obtain a corresponding
element $(A' \to A'[x_1, \ldots, x_n]/(f^\varphi_1, \ldots, f^\varphi_n))$
of $S(A')$ where $f^\varphi$ means the polynomial obtained by applying
$\varphi$ to the coefficients of the polynomial $f$.
Moreover, there is a commutative diagram
$$
\xymatrix{
A \ar[r] \ar[d] & A[x_1, \ldots, x_n]/(f_1, \ldots, f_n) \ar[d] \\
A' \ar[r] & A'[x_1, \ldots, x_n]/(f^\varphi_1, \ldots, f^\varphi_n)
}
$$
which is a in the category of rings. For $E \subset S(A)$ finite, set
$E' = \varphi(E)$ and define $B_E \to B_{E'}$ in the obvious manner.
Taking the colimit gives the desired map $T(A) \to T(A')$, see
Categories, Lemma \ref{categories-lemma-functorial-colimit}.
\end{remark}

\begin{lemma}
\label{lemma-have-sections-quotient}
Let $A$ be a ring such that every faithfully flat \'etale ring map
$A \to B$ has a section. Then the same is true for every quotient ring
$A/I$.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-have-sections-strictly-henselian}
Let $A$ be a ring such that every faithfully flat \'etale ring map
$A \to B$ has a section. Then every local ring of $A$ at a maximal
ideal is strictly henselian.
\end{lemma}

\begin{proof}
Let $\mathfrak m$ be a maximal ideal of $A$. Let $A \to B$ be an
\'etale ring map and let $\mathfrak q \subset B$ be a prime
lying over $\mathfrak m$. By the description of the strict henselization
$A_\mathfrak m^{sh}$ in
Algebra, Lemma \ref{algebra-lemma-strict-henselization-different}
it suffices to show that $A_\mathfrak m = B_\mathfrak q$.
Note that there are finitely many primes
$\mathfrak q = \mathfrak q_1, \mathfrak q_2, \ldots, \mathfrak q_n$
lying over $\mathfrak m$ and there are no specializations
between them as an \'etale ring map is quasi-finite, see
Algebra, Lemma \ref{algebra-lemma-etale-quasi-finite}.
Thus $\mathfrak q_i$ is a maximal ideal and we can find
$g \in \mathfrak q_2 \cap \ldots \cap \mathfrak q_n$, $g \not \in \mathfrak q$
(Algebra, Lemma \ref{algebra-lemma-silly}).
After replacing $B$ by $B_g$ we see that $\mathfrak q$
is the only prime of $B$ lying over $\mathfrak m$.
The image $U \subset \Spec(A)$ of $\Spec(B) \to \Spec(A)$ is
open (Algebra, Proposition \ref{algebra-proposition-fppf-open}).
Thus the complement $\Spec(A) \setminus U$ is closed
and we can find $f \in A$, $f \not \in \mathfrak p$ such that
$\Spec(A) = U \cup D(f)$. The ring map $A \to B \times A_f$
is faithfully flat and \'etale, hence has a section
$\sigma : B \times A_f \to A$ by assumption on $A$.
Observe that $\sigma$ is \'etale, hence flat as a map between \'etale
$A$-algebras (Algebra, Lemma \ref{algebra-lemma-map-between-etale}).
Since $\mathfrak q$ is the only prime of $B \times A_f$ lying
over $A$ we find that $A_\mathfrak p \to B_\mathfrak q$ has
a section which is also flat. Thus
$A_\mathfrak p \to B_\mathfrak q \to A_\mathfrak p$
are flat local ring maps whose composition is the identity. Since
a flat local homomorphism of local rings is injective we conclude these
maps are isomorphisms as desired.
\end{proof}

\begin{lemma}
\label{lemma-have-sections-localize}
Let $A$ be a ring such that every faithfully flat \'etale ring map
$A \to B$ has a section. Let $Z \subset \Spec(A)$ be a closed subscheme
of the form $D(f) \cap V(I)$ and let $A \to A_Z^\sim$ be as constructed
in Lemma \ref{lemma-localization}.
Then every faithfully flat \'etale ring map $A_Z^\sim \to C$ has
a section.
\end{lemma}

\begin{proof}
There exists an \'etale ring map $A \to B'$ such that
$C = B' \otimes_A A_Z^\sim$ as $A_Z^\sim$-algebras.
The image $U' \subset \Spec(A)$ of $\Spec(B') \to \Spec(A)$
is open and contains $V(I)$, hence we can find $f \in I$ such
that $\Spec(A) = U' \cup D(f)$. Then $A \to B' \times A_f$
is \'etale and faithfully flat. By assumption there is a section
$B' \times A_f \to A$. Localizing we obtain the desired section
$C \to A_Z^\sim$.
\end{proof}

\begin{lemma}
\label{lemma-get-w-local-algebraic-residue-field-extensions}
Let $A \to B$ be a ring map inducing algebraic extensions on residue fields.
There exists a commutative diagram
$$
\xymatrix{
B \ar[r] & D \\
A \ar[r] \ar[u] & C \ar[u]
}
$$
with the following properties:
\begin{enumerate}
\item $A \to C$ is faithfully flat and ind-\'etale,
\item $B \to D$ is faithfully flat and ind-\'etale,
\item $\Spec(C)$ is w-local,
\item $\Spec(D)$ is w-local,
\item $\Spec(D) \to \Spec(C)$ is w-local,
\item the set of closed points of $\Spec(D)$ is the inverse image
of the set of closed points of $\Spec(C)$,
\item the set of closed points of $\Spec(C)$ surjects onto $\Spec(A)$,
\item the set of closed points of $\Spec(D)$ surjects onto $\Spec(B)$,
\item for $\mathfrak m \subset C$ maximal the local ring
$C_\mathfrak m$ is strictly henselian.
\end{enumerate}
\end{lemma}

\begin{proof}
There is a faithfully flat, ind-Zariski ring map $A \to A'$ such that
$\Spec(A')$ is w-local and such that the set of closed points of
$\Spec(A')$ maps onto $\Spec(A)$, see Lemma \ref{lemma-make-w-local}.
Let $I \subset A'$ be the ideal such that $V(I)$ is the set
of closed points of $\Spec(A')$.
Choose $A' \to C'$ as in Lemma \ref{lemma-first-construction}.
Note that the local rings $C'_{\mathfrak m'}$ at maximal ideals
$\mathfrak m' \subset C'$ are strictly henselian by
Lemma \ref{lemma-have-sections-strictly-henselian}.
We apply Lemma \ref{lemma-w-local-algebraic-residue-field-extensions}
to $A' \to C'$ and $I \subset A'$ to get $C' \to C$ with $C'/IC' \cong C/IC$.
Note that since $A' \to C'$ is faithfully flat, $\Spec(C'/IC')$
surjects onto the set of closed points of $A'$ and in particular
onto $\Spec(A)$. Moreover, as $V(IC) \subset \Spec(C)$
is the set of closed points of $C$ and $C' \to C$ is ind-Zariski
(and identifies local rings) we obtain properties (1), (3), (7), and (9).

\medskip\noindent
Denote $J \subset C$ the ideal such that $V(J)$ is the set of closed
points of $\Spec(C)$. Set $D' = B \otimes_A C$. The ring
map $C \to D'$ induces algebraic residue field extensions. Keep in mind that
since $V(J) \to \Spec(A)$ is surjective the map $T = V(JD) \to \Spec(B)$
is surjective too. Apply
Lemma \ref{lemma-w-local-algebraic-residue-field-extensions}
to $C \to D'$ and $J \subset C$ to get 
$D' \to D$ with $D'/JD' \cong D/JD$.
All of the remaining properties given in the lemma are
immediate from the results of
Lemma \ref{lemma-w-local-algebraic-residue-field-extensions}.
\end{proof}








\section{Weakly \'etale versus pro-\'etale}
\label{section-weakly-etale}

\noindent
Recall that a ring homomorphism $A \to B$ is {\it weakly \'etale}
if $A \to B$ is flat and $B \otimes_A B \to B$ is flat. We have
proved some properties of such ring maps in
More on Algebra, Section \ref{more-algebra-section-weakly-etale}.
In particular, if $A \to B$ is a local homomorphism, and $A$ is a
strictly henselian local rings, then $A = B$, see
More on Algebra, Theorem \ref{more-algebra-theorem-olivier}.
Using this theorem and the work we've done above we obtain
the following structure theorem for weakly \'etale ring maps.

\begin{proposition}
\label{proposition-weakly-etale}
Let $A \to B$ be a weakly \'etale ring map.
Then there exists a faithfully flat, ind-\'etale ring map
$B \to B'$ such that $A \to B'$ is ind-\'etale.
\end{proposition}

\begin{proof}
The ring map $A \to B$ induces (separable) algebraic extensions of
residue fields, see More on Algebra, Lemma
\ref{more-algebra-lemma-weakly-etale-residue-field-extensions}.
Thus we may apply
Lemma \ref{lemma-get-w-local-algebraic-residue-field-extensions}
and choose a diagram
$$
\xymatrix{
B \ar[r] & D \\
A \ar[r] \ar[u] & C \ar[u]
}
$$
with the properties as listed in the lemma. Note that $C \to D$
is weakly \'etale by
More on Algebra, Lemma \ref{more-algebra-lemma-weakly-etale-permanence}.
Pick a maximal ideal $\mathfrak m \subset D$. By construction
this lies over a maximal ideal $\mathfrak m' \subset C$.
By More on Algebra, Theorem \ref{more-algebra-theorem-olivier}
the ring map $C_{\mathfrak m'} \to D_\mathfrak m$ is an isomorphism.
As every point of $\Spec(C)$ specializes to a closed point we conclude that
$C \to D$ identifies local rings.
Thus Proposition \ref{proposition-maps-wich-identify-local-rings}
applies to the ring map $C \to D$. Pick $D \to D'$ faithfully flat
and ind-Zariski such that $C \to D'$ is ind-Zariski. Then
$B \to D'$ is a solution to the problem posed in the proposition.
\end{proof}





\section{The V topology and the pro-h topology}
\label{section-V-versus-pro-h}

\noindent
The V topology was introduced in
Topologies, Section \ref{topologies-section-V}.
The h topology was introduced in
More on Flatness, Section \ref{flat-section-h}.
A kind of intermediate topology, namely the ph topology,
was introduced in Topologies, Section \ref{topologies-section-ph}.

\medskip\noindent
Given a topology $\tau$ on a suitable category $\mathcal{C}$
of schemes, we can introduce a ``pro-$\tau$ topology''
on $\mathcal{C}$ as follows. Recall that for $X$ in $\mathcal{C}$
we use $h_X$ to denote the representable presheaf associated to $X$.
Let us temporarily say a morphism $X \to Y$ of $\mathcal{C}$
is a $\tau$-cover\footnote{This should not be confused with
the notion of a covering. For example if $\tau = \etale$,
any morphism $X \to Y$ which has a section is a $\tau$-covering. But our
definition of \'etale coverings $\{V_i \to Y\}_{i \in I}$
forces each $V_i \to Y$ to be \'etale.}
if the $\tau$-sheafification of $h_X \to h_Y$
is surjective. Then we can define the pro-$\tau$ topology
as the coarsest topology such that
\begin{enumerate}
\item the pro-$\tau$ topology is finer than the $\tau$ topology, and
\item $X \to Y$ is a pro-$\tau$-cover if
$Y$ is affine and $X = \lim X_\lambda$ is a directed
limit of affine schemes $X_\lambda$ over $Y$ such that
$h_{X_\lambda} \to h_Y$ is a $\tau$-cover for all $\lambda$.
\end{enumerate}
We use this pedantic formulation because we do not want to
specify a choice of pro-$\tau$ coverings: for different $\tau$
different choices of collections of coverings are suitable.
For example, in Section \ref{section-proetale} we will see that
in order to define the pro-\'etale topology looking at families
of weakly \'etale morphisms with some finiteness property works well.
More generally, the proposed construction given in this paragraph is
meant mainly to motivate the results in this section and we will never
implicitly define a pro-$\tau$ topology using this method.

\medskip\noindent
The following lemma tells us that the
pro-V topology is equal to the V topology.

\begin{lemma}
\label{lemma-pro-V-V}
Let $Y$ be an affine scheme. Let $X = \lim X_i$ be a directed limit
of affine schemes over $Y$. The following are equivalent
\begin{enumerate}
\item $\{X \to Y\}$ is a standard V covering
(Topologies, Definition \ref{topologies-definition-standard-V-covering}), and
\item $\{X_i \to Y\}$ is a standard V covering for all $i$.
\end{enumerate}
\end{lemma}

\begin{proof}
A singleton $\{X \to Y\}$ is a standard V covering if and only if
given a morphism $g : \Spec(V) \to Y$ there is an extension of
valuation rings $V \subset W$ and a commutative diagram
$$
\xymatrix{
\Spec(W) \ar[r] \ar[d] & X \ar[d] \\
\Spec(V) \ar[r]^g & Y
}
$$
Thus (1) $\Rightarrow$ (2) is immediate from the definition.
Conversely, assume (2) and let $g : \Spec(V) \to Y$ as above
be given. Write $\Spec(V) \times_Y X_i = \Spec(A_i)$.
Since $\{X_i \to Y\}$ is a standard V covering, we may choose
a valuation ring $W_i$ and a ring map $A_i \to W_i$ such that
the composition $V \to A_i \to W_i$ is an extension of valuation
rings. In particular, the quotient $A'_i$ of $A_i$ by its
$V$-torsion is a faitfhully flat $V$-algebra. Flatness by
More on Algebra, Lemma
\ref{more-algebra-lemma-valuation-ring-torsion-free-flat} and
surjectivity on spectra because $A_i \to W_i$ factors through $A'_i$.
Thus
$$
A = \colim A'_i
$$
is a faithfully flat $V$-algebra
(Algebra, Lemma \ref{algebra-lemma-colimit-faithfully-flat}).
Since $\{\Spec(A) \to \Spec(V)\}$ is a standard fpqc cover, it
is a standard V cover
(Topologies, Lemma \ref{topologies-lemma-standard-fpqc-standard-V})
and hence we can choose $\Spec(W) \to \Spec(A)$ such that
$V \to W$ is an extension of valuation rings. Since we can compose
with the morphism $\Spec(A) \to X = \Spec(\colim A_i)$
the proof is complete.
\end{proof}

\noindent
The following lemma tells us that the pro-h topology is equal to the
pro-ph topology is equal to the V topology.

\begin{lemma}
\label{lemma-pro-h-V}
Let $X \to Y$ be a morphism of affine schemes. The following are equivalent
\begin{enumerate}
\item $\{X \to Y\}$ is a standard V covering
(Topologies, Definition \ref{topologies-definition-standard-V-covering}),
\item $X = \lim X_i$ is a directed limit of affine schemes over $Y$
such that $\{X_i \to Y\}$ is a ph covering for each $i$, and
\item $X = \lim X_i$ is a directed limit of affine schemes over $Y$
such that $\{X_i \to Y\}$ is an h covering for each $i$.
\end{enumerate}
\end{lemma}

\begin{proof}
Proof of (2) $\Rightarrow$ (1). Recall that a V covering given by a
single arrow between affines is a standard V covering, see
Topologies, Definition \ref{topologies-definition-V-covering} and
Lemma \ref{topologies-lemma-refine-standard-V}.
Recall that any ph covering is a V covering, see
Topologies, Lemma
\ref{topologies-lemma-zariski-etale-smooth-syntomic-fppf-fpqc-ph-V}.
Hence if $X = \lim X_i$ as in (2), then $\{X_i \to Y\}$
is a standard V covering for each $i$. Thus by
Lemma \ref{lemma-pro-V-V} we see that (1) is true.

\medskip\noindent
Proof of (3) $\Rightarrow$ (2). This is clear because an h covering
is always a ph covering, see
More on Flatness, Definition \ref{flat-definition-h-covering}.

\medskip\noindent
Proof of (1) $\Rightarrow$ (3). This is the interesting direction, but
the interesting content in this proof is hidden in More on Flatness, Lemma
\ref{flat-lemma-equivalence-h-v-locally-finite-presentation}.
Write $X = \Spec(A)$ and $Y = \Spec(R)$. We can write
$A = \colim A_i$ with $A_i$ of finite presentation over $R$, see
Algebra, Lemma \ref{algebra-lemma-ring-colimit-fp}.
Set $X_i = \Spec(A_i)$. Then $\{X_i \to Y\}$ is a standard V covering
for all $i$ by (1) and
Topologies, Lemma \ref{topologies-lemma-refine-standard-V}.
Hence $\{X_i \to Y\}$ is an h covering by
More on Flatness, Definition \ref{flat-definition-h-covering}.
This finishes the proof.
\end{proof}

\noindent
The following lemma tells us, roughly speaking, that an h sheaf
which is limit preserving satisfies the sheaf condition for V coverings.
Please also compare with Remark \ref{remark-h-limit-preserving}.

\begin{lemma}
\label{lemma-h-limit-preserving}
Let $S$ be a scheme. Let $F$ be a contravariant functor defined
on the category of all schemes over $S$. If
\begin{enumerate}
\item $F$ satisfies the sheaf property for the h topology, and
\item $F$ is limit preserving
(Limits, Remark \ref{limits-remark-limit-preserving}),
\end{enumerate}
then $F$ satisfies the sheaf property for the V topology.
\end{lemma}

\begin{proof}
We will prove this by verifying (1) and (2') of
Topologies, Lemma \ref{topologies-lemma-sheaf-property-V}.
The sheaf property for Zariski coverings follows from
the fact that $F$ has the sheaf property for all h coverings.
Finally, suppose that $X \to Y$ is a morphism of affine schemes
over $S$ such that $\{X \to Y\}$ is a V covering.
By Lemma \ref{lemma-pro-h-V} we can write $X = \lim X_i$
as a directed limit of affine schemes
over $Y$ such that $\{X_i \to Y\}$ is an h covering for each $i$.
We obtain
\begin{align*}
&
\text{Equalizer}(
\xymatrix{
F(X) \ar@<1ex>[r] \ar@<-1ex>[r] &
F(X \times_Y X)
}
)
\\
& =
\text{Equalizer}(
\xymatrix{
\colim F(X_i) \ar@<1ex>[r] \ar@<-1ex>[r] &
\colim F(X_i \times_Y X_i)
}
)
\\
& =
\colim
\text{Equalizer}(
\xymatrix{
F(X_i) \ar@<1ex>[r] \ar@<-1ex>[r] &
F(X_i \times_Y X_i)
}
)
\\
& =
\colim F(Y) = F(Y)
\end{align*}
which is what we wanted to show.
The first equality because $F$ is limit preserving and $X = \lim X_i$ and
$X \times_Y X = \lim X_i \times_Y X_i$.
The second equality because filtered colimits are exact.
The third equality because $F$ satisfies the sheaf property
for h coverings.
\end{proof}

\begin{remark}
\label{remark-h-limit-preserving}
Let $S$ be a scheme contained in a big site $\Sch_h$. Let $F$ be a sheaf
of sets on $(\Sch/S)_h$ such that $F(T) = \colim F(T_i)$ whenever
$T = \lim T_i$ is a directed limit of affine schemes in $(\Sch/S)_h$.
In this situation $F$ extends uniquely to a contravariant functor $F'$
on the category of all schemes over $S$ such that (a) $F'$ satisfies the
sheaf property for the h topology and (b) $F'$ is limit preserving.
See More on Flatness, Lemma \ref{flat-lemma-extend-sheaf-h}.
In this situation Lemma \ref{lemma-h-limit-preserving}
tells us that $F'$ satisfies
the sheaf property for the V topology.
\end{remark}







\section{Constructing w-contractible covers}
\label{section-w-contractible}

\noindent
In this section we construct w-contractible covers of affine schemes.

\begin{definition}
\label{definition-w-contractible}
Let $A$ be a ring. We say $A$ is {\it w-contractible} if every
faithfully flat weakly \'etale ring map $A \to B$ has a section.
\end{definition}

\noindent
We remark that by Proposition \ref{proposition-weakly-etale}
an equivalent definition would be to ask that every faithfully
flat, ind-\'etale ring map $A \to B$ has a section.
Here is a key observation that will allow us to construct
w-contractible rings.

\begin{lemma}
\label{lemma-w-local-strictly-henselian-extremally-disconnected}
Let $A$ be a ring. The following are equivalent
\begin{enumerate}
\item $A$ is w-contractible,
\item every faithfully flat, ind-\'etale ring map $A \to B$ has
a section, and
\item $A$ satisfies
\begin{enumerate}
\item $\Spec(A)$ is w-local,
\item $\pi_0(\Spec(A))$ is extremally disconnected, and
\item for every maximal ideal $\mathfrak m \subset A$ the
local ring $A_\mathfrak m$ is strictly henselian.
\end{enumerate}
\end{enumerate}
\end{lemma}

\begin{proof}
The equivalence of (1) and (2) follows immediately from
Proposition \ref{proposition-weakly-etale}.

\medskip\noindent
Assume (3)(a), (3)(b), and (3)(c). Let $A \to B$ be faithfully flat
and ind-\'etale. We will use without further mention the fact that a flat map
$A \to B$ is faithfully flat if and only if every closed point
of $\Spec(A)$ is in the image of $\Spec(B) \to \Spec(A)$
We will show that $A \to B$ has a section.

\medskip\noindent
Let $I \subset A$ be an ideal such that $V(I) \subset \Spec(A)$ is
the set of closed points of $\Spec(A)$. 
We may replace $B$ by the ring $C$ constructed in
Lemma \ref{lemma-w-local-algebraic-residue-field-extensions}
for $A \to B$ and $I \subset A$.
Thus we may assume $\Spec(B)$ is w-local such that the set of
closed points of $\Spec(B)$ is $V(IB)$. In this case $A \to B$
identifies local rings by condition (3)(c) as it suffices to check
this at maximal ideals of $B$ which lie over maximal ideals of $A$.
Thus $A \to B$ has a section by
Lemma \ref{lemma-w-local-extremally-disconnected}.

\medskip\noindent
Assume (1) or equivalently (2). We have (3)(c) by
Lemma \ref{lemma-have-sections-strictly-henselian}.
Properties (3)(a) and (3)(b) follow from
Lemma \ref{lemma-w-local-extremally-disconnected}.
\end{proof}

\begin{proposition}
\label{proposition-find-w-contractible}
For every ring $A$ there exists a faithfully flat, ind-\'etale ring
map $A \to D$ such that $D$ is w-contractible.
\end{proposition}

\begin{proof}
Applying Lemma \ref{lemma-get-w-local-algebraic-residue-field-extensions}
to $\text{id}_A : A \to A$ we find a faithfully flat, ind-\'etale ring map
$A \to C$ such that $C$ is w-local and such that every local ring at a
maximal ideal of $C$ is strictly henselian.
Choose an extremally disconnected space $T$ and a surjective
continuous map $T \to \pi_0(\Spec(C))$, see
Topology, Lemma \ref{topology-lemma-existence-projective-cover}.
Note that $T$ is profinite. Apply Lemma \ref{lemma-construct-profinite}
to find an ind-Zariski ring map $C \to D$ such that
$\pi_0(\Spec(D)) \to \pi_0(\Spec(C))$ realizes $T \to \pi_0(\Spec(C))$
and such that
$$
\xymatrix{
\Spec(D) \ar[r] \ar[d] & \pi_0(\Spec(D)) \ar[d] \\
\Spec(C) \ar[r] & \pi_0(\Spec(C))
}
$$
is cartesian in the category of topological spaces. Note that $\Spec(D)$
is w-local, that $\Spec(D) \to \Spec(C)$ is w-local, and that the
set of closed points of $\Spec(D)$ is the inverse image of the
set of closed points of $\Spec(C)$, see Lemma \ref{lemma-silly}.
Thus it is still true that the local rings of $D$ at its maximal
ideals are strictly henselian (as they are isomorphic to the
local rings at the corresponding maximal ideals of $C$).
It follows from
Lemma \ref{lemma-w-local-strictly-henselian-extremally-disconnected}
that $D$ is w-contractible.
\end{proof}

\begin{remark}
\label{remark-size-w-contractible}
Let $A$ be a ring. Let $\kappa$ be an infinite cardinal bigger or
equal than the cardinality of $A$. Then the cardinality of the
ring $D$ constructed in Proposition \ref{proposition-find-w-contractible}
is at most
$$
\kappa^{2^{2^{2^\kappa}}}.
$$
Namely, the ring map $A \to D$ is
constructed as a composition
$$
A \to A_w = A' \to C' \to C \to D.
$$
Here the first three steps of the construction are carried out
in the first paragraph of the proof of
Lemma \ref{lemma-get-w-local-algebraic-residue-field-extensions}.
For the first step we have $|A_w| \leq \kappa$ by
Remark \ref{remark-size-w}.
We have $|C'| \leq \kappa$ by
Remark \ref{remark-size-T}.
Then $|C| \leq \kappa$ because $C$ is a localization of $(C')_w$
(it is constructed from $C'$ by an application of
Lemma \ref{lemma-localize-along-closed-profinite}
in the proof of Lemma \ref{lemma-w-local-algebraic-residue-field-extensions}).
Thus $C$ has at most $2^\kappa$ maximal ideals.
Finally, the ring map $C \to D$ identifies local rings and the
cardinality of the set of maximal ideals of $D$ is at most
$2^{2^{2^\kappa}}$ by
Topology, Remark \ref{topology-remark-size-projective-cover}.
Since $D \subset \prod_{\mathfrak m \subset D} D_\mathfrak m$ we see
that $D$ has at most the size displayed above.
\end{remark}

\begin{lemma}
\label{lemma-finite-finitely-presented-over-extremally-disconnected}
Let $A \to B$ be a quasi-finite and finitely presented ring map.
If the residue fields of $A$ are separably algebraically closed
and $\Spec(A)$ is extremally disconnected, then $\Spec(B)$ is
extremally disconnected.
\end{lemma}

\begin{proof}
Set $X = \Spec(A)$ and $Y = \Spec(B)$. Choose a finite partition
$X = \coprod X_i$ and $X'_i \to X_i$ as in
\'Etale Cohomology, Lemma
\ref{etale-cohomology-lemma-decompose-quasi-finite-morphism}.
Because $X$ is extremally disconnected, every constructible
locally closed subset is open and closed, hence we see that $X$
is topologically the disjoint union of the strata $X_i$. Thus we may
replace $X$ by the $X_i$ and assume there exists a surjective finite
locally free morphism $X' \to X$ such that $(X' \times_X Y)_{red}$
is isomorphic to a finite disjoint union of copies of $X'_{red}$.
Picture
$$
\xymatrix{
\coprod_{i = 1, \ldots, r} X' \ar[r] \ar[d] & Y \ar[d] \\
X' \ar[r] & X
}
$$
The assumption on the residue fields of $A$ implies that
this diagram is a fibre product diagram on underlying sets
of points (details omitted).
Since $X$ is extremally disconnected and $X'$ is Hausdorff
(Lemma \ref{lemma-profinite-goes-up}), the continuous map
$X' \to X$ has a continuous section $\sigma$. Then
$\coprod_{i = 1, \ldots, r} \sigma(X) \to Y$ is a bijective
continuous map. By
Topology, Lemma \ref{topology-lemma-bijective-map}
we see that it is a homeomorphism and the proof is done.
\end{proof}

\begin{lemma}
\label{lemma-finite-finitely-presented-over-w-contractible}
Let $A \to B$ be a finite and finitely presented ring map.
If $A$ is w-contractible, so is $B$.
\end{lemma}

\begin{proof}
We will use the criterion of
Lemma \ref{lemma-w-local-strictly-henselian-extremally-disconnected}.
Set $X = \Spec(A)$ and $Y = \Spec(B)$.
As $Y \to X$ is a finite morphism, we see that the set of closed
points $Y_0$ of $Y$ is the inverse image of the set of closed points
$X_0$ of $X$. Moreover, every point of $Y$ specializes to a unique
point of $Y_0$ as (a) this is true for $X$ and (b) the map
$X \to Y$ is separated. For every $y \in Y_0$ with image $x \in X_0$
we see that $\mathcal{O}_{Y, y}$ is strictly henselian by
Algebra, Lemma \ref{algebra-lemma-finite-over-henselian}
applied to $\mathcal{O}_{X, x} \to B \otimes_A \mathcal{O}_{X, x}$.
It remains to show that $Y_0$ is extremally disconnected.
To do this we look at $X_0 \times_X Y \to X_0$
where $X_0 \subset X$ is the reduced induced scheme structure.
Note that the underlying topological space of
$X_0 \times_X Y$ agrees with $Y_0$. Now the desired result follows from
Lemma \ref{lemma-finite-finitely-presented-over-extremally-disconnected}.
\end{proof}

\begin{lemma}
\label{lemma-localization-w-contractible}
Let $A$ be a ring. Let $Z \subset \Spec(A)$ be a closed subset
of the form $Z = V(f_1, \ldots, f_r)$. Set $B = A_Z^\sim$, see
Lemma \ref{lemma-localization}. If $A$ is w-contractible, so is $B$.
\end{lemma}

\begin{proof}
Let $A_Z^\sim \to B$ be a weakly \'etale faithfully flat ring map.
Consider the ring map
$$
A \longrightarrow A_{f_1} \times \ldots \times A_{f_r} \times B
$$
this is faithful flat and weakly \'etale. If $A$ is w-contractible,
then there is a section $\sigma$. Consider the morphism
$$
\Spec(A_Z^\sim) \to \Spec(A) \xrightarrow{\Spec(\sigma)}
\coprod \Spec(A_{f_i}) \amalg \Spec(B)
$$
Every point of $Z \subset \Spec(A_Z^\sim)$ maps into the component
$\Spec(B)$. Since every point of $\Spec(A_Z^\sim)$ specializes to a
point of $Z$ we find a morphism $\Spec(A_Z^\sim) \to \Spec(B)$
as desired.
\end{proof}






\section{The pro-\'etale site}
\label{section-proetale}

\noindent
In this section we only discuss the actual definition and construction
of the various pro-\'etale sites and the morphisms between them. The
existence of weakly contractible objects will be done in
Section \ref{section-weakly-contractible}.

\medskip\noindent
The pro-\'etale topology is a bit like
the fpqc topology (see Topologies, Section \ref{topologies-section-fpqc})
in that the topos of sheaves on the small pro-\'etale site of a scheme
depends on the choice of the underlying category of schemes. Thus we cannot
speak of {\it the} pro-\'etale topos of a scheme. However, it will be
true that the cohomology groups of a sheaf are unchanged if we enlarge
our underlying category of schemes, see Section \ref{section-change-universe}.

\medskip\noindent
We will define pro-\'etale coverings using weakly \'etale morphisms of schemes,
see More on Morphisms, Section \ref{more-morphisms-section-weakly-etale}.
The reason is that, on the one hand, it is somewhat awkward to define
the notion of a pro-\'etale morphism of schemes, and on the other,
Proposition \ref{proposition-weakly-etale}
assures us that we obtain the same sheaves\footnote{To be precise
the pro-\'etale topology we obtain using our choice of coverings
is the same as the one gotten from the general procedure explained
in Section \ref{section-V-versus-pro-h} starting with $\tau = \etale$.}
with the definition that follows.

\begin{definition}
\label{definition-fpqc-covering}
Let $T$ be a scheme. A {\it pro-\'etale covering of $T$} is a family
of morphisms $\{f_i : T_i \to T\}_{i \in I}$ of schemes
such that each $f_i$ is weakly-\'etale and such that for every affine open
$U \subset T$ there exists $n \geq 0$, a map
$a : \{1, \ldots, n\} \to I$ and affine opens
$V_j \subset T_{a(j)}$, $j = 1, \ldots, n$
with $\bigcup_{j = 1}^n f_{a(j)}(V_j) = U$.
\end{definition}

\noindent
To be sure this condition implies that $T = \bigcup f_i(T_i)$.
Here is a lemma that will allow us to recognize pro-\'etale coverings.
It will also allow us to reduce many lemmas about pro-\'etale coverings
to the corresponding results for fpqc coverings.

\begin{lemma}
\label{lemma-recognize-proetale-covering}
Let $T$ be a scheme. Let $\{f_i : T_i \to T\}_{i \in I}$ be a family of
morphisms of schemes with target $T$. The following are equivalent
\begin{enumerate}
\item $\{f_i : T_i \to T\}_{i \in I}$ is a pro-\'etale covering,
\item each $f_i$ is weakly \'etale and $\{f_i : T_i \to T\}_{i \in I}$
is an fpqc covering,
\item each $f_i$ is weakly \'etale and for every affine open $U \subset T$
there exist quasi-compact opens $U_i \subset T_i$ which are almost all empty,
such that $U = \bigcup f_i(U_i)$,
\item each $f_i$ is weakly \'etale and there exists an affine open covering
$T = \bigcup_{\alpha \in A} U_\alpha$ and for each $\alpha \in A$
there exist $i_{\alpha, 1}, \ldots, i_{\alpha, n(\alpha)} \in I$
and quasi-compact opens $U_{\alpha, j} \subset T_{i_{\alpha, j}}$ such that
$U_\alpha =
\bigcup_{j = 1, \ldots, n(\alpha)} f_{i_{\alpha, j}}(U_{\alpha, j})$.
\end{enumerate}
If $T$ is quasi-separated, these are also equivalent to
\begin{enumerate}
\item[(5)] each $f_i$ is weakly \'etale, and for every $t \in T$ there exist
$i_1, \ldots, i_n \in I$ and quasi-compact opens $U_j \subset T_{i_j}$
such that $\bigcup_{j = 1, \ldots, n} f_{i_j}(U_j)$ is a
(not necessarily open) neighbourhood of $t$ in $T$.
\end{enumerate}
\end{lemma}

\begin{proof}
The equivalence of (1) and (2) is immediate from the definitions.
Hence the lemma follows from
Topologies, Lemma \ref{topologies-lemma-recognize-fpqc-covering}.
\end{proof}

\begin{lemma}
\label{lemma-etale-proetale}
Any \'etale covering and any Zariski covering is a pro-\'etale covering.
\end{lemma}

\begin{proof}
This follows from the corresponding result for fpqc coverings
(Topologies, Lemma
\ref{topologies-lemma-zariski-etale-smooth-syntomic-fppf-fpqc}),
Lemma \ref{lemma-recognize-proetale-covering}, and
the fact that an \'etale morphism is a weakly \'etale morphism, see
More on Morphisms, Lemma \ref{more-morphisms-lemma-when-weakly-etale}.
\end{proof}

\begin{lemma}
\label{lemma-proetale}
Let $T$ be a scheme.
\begin{enumerate}
\item If $T' \to T$ is an isomorphism then $\{T' \to T\}$
is a pro-\'etale covering of $T$.
\item If $\{T_i \to T\}_{i\in I}$ is a pro-\'etale covering and for each
$i$ we have a pro-\'etale covering $\{T_{ij} \to T_i\}_{j\in J_i}$, then
$\{T_{ij} \to T\}_{i \in I, j\in J_i}$ is a pro-\'etale covering.
\item If $\{T_i \to T\}_{i\in I}$ is a pro-\'etale covering
and $T' \to T$ is a morphism of schemes then
$\{T' \times_T T_i \to T'\}_{i\in I}$ is a pro-\'etale covering.
\end{enumerate}
\end{lemma}

\begin{proof}
This follows from the fact that composition and base changes
of weakly \'etale morphisms are weakly \'etale
(More on Morphisms, Lemmas
\ref{more-morphisms-lemma-composition-weakly-etale} and
\ref{more-morphisms-lemma-base-change-weakly-etale}),
Lemma \ref{lemma-recognize-proetale-covering}, and
the corresponding results for fpqc coverings, see
Topologies, Lemma \ref{topologies-lemma-fpqc}.
\end{proof}

\begin{lemma}
\label{lemma-proetale-affine}
Let $T$ be an affine scheme. Let $\{T_i \to T\}_{i \in I}$ be a pro-\'etale
covering of $T$. Then there exists a pro-\'etale covering
$\{U_j \to T\}_{j = 1, \ldots, n}$ which is a refinement
of $\{T_i \to T\}_{i \in I}$ such that each $U_j$ is an affine
scheme. Moreover, we may choose each $U_j$ to be open affine
in one of the $T_i$.
\end{lemma}

\begin{proof}
This follows directly from the definition.
\end{proof}

\noindent
Thus we define the corresponding standard coverings of affines as follows.

\begin{definition}
\label{definition-standard-proetale}
Let $T$ be an affine scheme. A {\it standard pro-\'etale covering}
of $T$ is a family $\{f_i : T_i \to T\}_{i = 1, \ldots, n}$
where each $T_j$ is affine, each $f_i$ is weakly \'etale, and
$T = \bigcup f_i(T_i)$.
\end{definition}

\noindent
We follow the general outline given in
Topologies, Section \ref{topologies-section-procedure}
for constructing the big pro-\'etale site we will be working with.
However, because we need a bit larger rings to accommodate for the size
of certain constructions we modify the constructions slightly.

\begin{definition}
\label{definition-big-proetale-site}
A {\it big pro-\'etale site} is any site $\Sch_\proetale$ as in
Sites, Definition \ref{sites-definition-site} constructed as follows:
\begin{enumerate}
\item Choose any set of schemes $S_0$, and any set of pro-\'etale coverings
$\text{Cov}_0$ among these schemes.
\item Change the function $Bound$ of
Sets, Equation (\ref{sets-equation-bound}) into
$$
Bound(\kappa) = \max\{\kappa^{2^{2^{2^\kappa}}}, \kappa^{\aleph_0}, \kappa^+\}.
$$
\item As underlying category take any category $\Sch_\alpha$
constructed as in Sets, Lemma \ref{sets-lemma-construct-category}
starting with the set $S_0$ and the function $Bound$.
\item Choose any set of coverings as in
Sets, Lemma \ref{sets-lemma-coverings-site} starting with the
category $\Sch_\alpha$ and the class of pro-\'etale coverings,
and the set $\text{Cov}_0$ chosen above.
\end{enumerate}
\end{definition}

\noindent
See the remarks following
Topologies, Definition \ref{topologies-definition-big-zariski-site}
for motivation and explanation regarding the definition of big sites.

\medskip\noindent
It will turn out, see Lemma \ref{lemma-proetale-induced}, that the
topology on a big pro-\'etale site $\Sch_\proetale$ is in some sense
induced from the pro-\'etale topology on the category of all schemes.

\begin{definition}
\label{definition-big-small-proetale}
Let $S$ be a scheme. Let $\Sch_\proetale$ be a big pro-\'etale
site containing $S$.
\begin{enumerate}
\item The {\it big pro-\'etale site of $S$}, denoted
$(\Sch/S)_\proetale$, is the site $\Sch_\proetale/S$
introduced in Sites, Section \ref{sites-section-localize}.
\item The {\it small pro-\'etale site of $S$}, which we denote
$S_\proetale$, is the full subcategory of $(\Sch/S)_\proetale$
whose objects are those $U/S$ such that $U \to S$ is weakly \'etale.
A covering of $S_\proetale$ is any covering $\{U_i \to U\}$ of
$(\Sch/S)_\proetale$ with $U \in \Ob(S_\proetale)$.
\item The {\it big affine pro-\'etale site of $S$}, denoted
$(\textit{Aff}/S)_\proetale$, is the full subcategory of
$(\Sch/S)_\proetale$ whose objects are affine $U/S$.
A covering of $(\textit{Aff}/S)_\proetale$ is any covering
$\{U_i \to U\}$ of $(\Sch/S)_\proetale$ which is a
standard pro-\'etale covering.
\end{enumerate}
\end{definition}

\noindent
It is not completely clear that the small pro-\'etale site and
the big affine pro-\'etale site are sites. We check this now.

\begin{lemma}
\label{lemma-verify-site-proetale}
Let $S$ be a scheme. Let $\Sch_\proetale$ be a big pro-\'etale site
containing $S$. Both $S_\proetale$ and $(\textit{Aff}/S)_\proetale$ are sites.
\end{lemma}

\begin{proof}
Let us show that $S_\proetale$ is a site. It is a category with a
given set of families of morphisms with fixed target. Thus we
have to show properties (1), (2) and (3) of
Sites, Definition \ref{sites-definition-site}.
Since $(\Sch/S)_\proetale$ is a site, it suffices to prove
that given any covering $\{U_i \to U\}$ of $(\Sch/S)_\proetale$
with $U \in \Ob(S_\proetale)$ we also have $U_i \in \Ob(S_\proetale)$.
This follows from the definitions
as the composition of weakly \'etale morphisms is weakly \'etale.

\medskip\noindent
To show that $(\textit{Aff}/S)_\proetale$ is a site, reasoning as above,
it suffices to show that the collection of standard pro-\'etale coverings
of affines satisfies properties (1), (2) and (3) of
Sites, Definition \ref{sites-definition-site}.
This follows from Lemma \ref{lemma-recognize-proetale-covering}
and the corresponding result for standard fpqc coverings
(Topologies, Lemma \ref{topologies-lemma-fpqc-affine-axioms}).
\end{proof}

\begin{lemma}
\label{lemma-fibre-products-proetale}
Let $S$ be a scheme. Let $\Sch_\proetale$ be a big pro-\'etale
site containing $S$. Let $\Sch$ be the category of all schemes.
\begin{enumerate}
\item The categories $\Sch_\proetale$, $(\Sch/S)_\proetale$,
$S_\proetale$, and $(\textit{Aff}/S)_\proetale$ have fibre products
agreeing with fibre products in $\Sch$.
\item The categories $\Sch_\proetale$, $(\Sch/S)_\proetale$,
$S_\proetale$ have equalizers agreeing with equalizers in $\Sch$.
\item The categories $(\Sch/S)_\proetale$, and $S_\proetale$ both have
a final object, namely $S/S$.
\item The category $\Sch_\proetale$ has a final object agreeing
with the final object of $\Sch$, namely $\Spec(\mathbf{Z})$.
\end{enumerate}
\end{lemma}

\begin{proof}
The category $\Sch_\proetale$ contains $\Spec(\mathbf{Z})$ and
is closed under products and fibre products by construction, see
Sets, Lemma \ref{sets-lemma-what-is-in-it}.
Suppose we have $U \to S$, $V \to U$, $W \to U$ morphisms
of schemes with $U, V, W \in \Ob(\Sch_\proetale)$.
The fibre product $V \times_U W$ in $\Sch_\proetale$
is a fibre product in $\Sch$ and
is the fibre product of $V/S$ with $W/S$ over $U/S$ in
the category of all schemes over $S$, and hence also a
fibre product in $(\Sch/S)_\proetale$.
This proves the result for $(\Sch/S)_\proetale$.
If $U \to S$, $V \to U$ and $W \to U$ are weakly \'etale then so is
$V \times_U W \to S$ (see
More on Morphisms, Section \ref{more-morphisms-section-weakly-etale})
and hence we get fibre products for $S_\proetale$.
If $U, V, W$ are affine, so is $V \times_U W$ and hence we
get fibre products for $(\textit{Aff}/S)_\proetale$.

\medskip\noindent
Let $a, b : U \to V$ be two morphisms in $\Sch_\proetale$.
In this case the equalizer of $a$ and $b$ (in the category of schemes) is
$$
V
\times_{\Delta_{V/\Spec(\mathbf{Z})}, V \times_{\Spec(\mathbf{Z})} V, (a, b)}
(U \times_{\Spec(\mathbf{Z})} U)
$$
which is an object of $\Sch_\proetale$ by what we saw above.
Thus $\Sch_\proetale$ has equalizers. If $a$ and $b$ are morphisms over $S$,
then the equalizer (in the category of schemes) is also given by
$$
V \times_{\Delta_{V/S}, V \times_S V, (a, b)} (U \times_S U)
$$
hence we see that $(\Sch/S)_\proetale$ has equalizers. Moreover, if
$U$ and $V$ are weakly-\'etale over $S$, then so is the equalizer
above as a fibre product of schemes weakly \'etale over $S$.
Thus $S_\proetale$ has equalizers. The statements on final objects
is clear.
\end{proof}

\noindent
Next, we check that the big affine pro-\'etale site defines the same
topos as the big pro-\'etale site.

\begin{lemma}
\label{lemma-affine-big-site-proetale}
Let $S$ be a scheme. Let $\Sch_\proetale$ be a big pro-\'etale
site containing $S$.
The functor $(\textit{Aff}/S)_\proetale \to (\Sch/S)_\proetale$
is a special cocontinuous functor. Hence it induces an equivalence
of topoi from $\Sh((\textit{Aff}/S)_\proetale)$ to
$\Sh((\Sch/S)_\proetale)$.
\end{lemma}

\begin{proof}
The notion of a special cocontinuous functor is introduced in
Sites, Definition \ref{sites-definition-special-cocontinuous-functor}.
Thus we have to verify assumptions (1) -- (5) of
Sites, Lemma \ref{sites-lemma-equivalence}.
Denote the inclusion functor
$u : (\textit{Aff}/S)_\proetale \to (\Sch/S)_\proetale$.
Being cocontinuous just means that any pro-\'etale covering of
$T/S$, $T$ affine, can be refined by a standard pro-\'etale
covering of $T$. This is the content of
Lemma \ref{lemma-proetale-affine}.
Hence (1) holds. We see $u$ is continuous simply because a standard
pro-\'etale covering is a pro-\'etale covering. Hence (2) holds.
Parts (3) and (4) follow immediately from the fact that $u$ is
fully faithful. And finally condition (5) follows from the
fact that every scheme has an affine open covering.
\end{proof}

\begin{lemma}
\label{lemma-put-in-T}
Let $\Sch_\proetale$ be a big pro-\'etale site.
Let $f : T \to S$ be a morphism in $\Sch_\proetale$.
The functor $T_\proetale \to (\Sch/S)_\proetale$
is cocontinuous and induces a morphism of topoi
$$
i_f :
\Sh(T_\proetale)
\longrightarrow
\Sh((\Sch/S)_\proetale)
$$
For a sheaf $\mathcal{G}$ on $(\Sch/S)_\proetale$
we have the formula $(i_f^{-1}\mathcal{G})(U/T) = \mathcal{G}(U/S)$.
The functor $i_f^{-1}$ also has a left adjoint $i_{f, !}$ which commutes
with fibre products and equalizers.
\end{lemma}

\begin{proof}
Denote the functor $u : T_\proetale \to (\Sch/S)_\proetale$.
In other words, given a weakly \'etale morphism $j : U \to T$ corresponding
to an object of $T_\proetale$ we set $u(U \to T) = (f \circ j : U \to S)$.
This functor commutes with fibre products, see
Lemma \ref{lemma-fibre-products-proetale}.
Moreover, $T_\proetale$ has equalizers and $u$ commutes with them
by Lemma \ref{lemma-fibre-products-proetale}.
It is clearly cocontinuous.
It is also continuous as $u$ transforms coverings to coverings and
commutes with fibre products. Hence the lemma follows from
Sites, Lemmas \ref{sites-lemma-when-shriek}
and \ref{sites-lemma-preserve-equalizers}.
\end{proof}

\begin{lemma}
\label{lemma-at-the-bottom}
Let $S$ be a scheme. Let $\Sch_\proetale$ be a big pro-\'etale
site containing $S$.
The inclusion functor $S_\proetale \to (\Sch/S)_\proetale$
satisfies the hypotheses of Sites, Lemma \ref{sites-lemma-bigger-site}
and hence induces a morphism of sites
$$
\pi_S : (\Sch/S)_\proetale \longrightarrow S_\proetale
$$
and a morphism of topoi
$$
i_S : \Sh(S_\proetale) \longrightarrow \Sh((\Sch/S)_\proetale)
$$
such that $\pi_S \circ i_S = \text{id}$. Moreover, $i_S = i_{\text{id}_S}$
with $i_{\text{id}_S}$ as in Lemma \ref{lemma-put-in-T}. In particular the
functor $i_S^{-1} = \pi_{S, *}$ is described by the rule
$i_S^{-1}(\mathcal{G})(U/S) = \mathcal{G}(U/S)$.
\end{lemma}

\begin{proof}
In this case the functor $u : S_\proetale \to (\Sch/S)_\proetale$,
in addition to the properties seen in the proof of
Lemma \ref{lemma-put-in-T} above, also is fully faithful
and transforms the final object into the final object.
The lemma follows from Sites, Lemma \ref{sites-lemma-bigger-site}.
\end{proof}

\begin{definition}
\label{definition-restriction-small-proetale}
In the situation of
Lemma \ref{lemma-at-the-bottom}
the functor $i_S^{-1} = \pi_{S, *}$ is often
called the {\it restriction to the small pro-\'etale site}, and for a sheaf
$\mathcal{F}$ on the big pro-\'etale site we denote
$\mathcal{F}|_{S_\proetale}$ this restriction.
\end{definition}

\noindent
With this notation in place we have for a sheaf $\mathcal{F}$ on the
big site and a sheaf $\mathcal{G}$ on the big site that
\begin{align*}
\Mor_{\Sh(S_\proetale)}(\mathcal{F}|_{S_\proetale}, \mathcal{G})
& =
\Mor_{\Sh((\Sch/S)_\proetale)}(\mathcal{F},
i_{S, *}\mathcal{G}) \\
\Mor_{\Sh(S_\proetale)}(\mathcal{G}, \mathcal{F}|_{S_\proetale})
& =
\Mor_{\Sh((\Sch/S)_\proetale)}(\pi_S^{-1}\mathcal{G}, \mathcal{F})
\end{align*}
Moreover, we have $(i_{S, *}\mathcal{G})|_{S_\proetale} = \mathcal{G}$
and we have $(\pi_S^{-1}\mathcal{G})|_{S_\proetale} = \mathcal{G}$.

\begin{lemma}
\label{lemma-morphism-big}
Let $\Sch_\proetale$ be a big pro-\'etale site.
Let $f : T \to S$ be a morphism in $\Sch_\proetale$.
The functor
$$
u : (\Sch/T)_\proetale \longrightarrow (\Sch/S)_\proetale, \quad
V/T \longmapsto V/S
$$
is cocontinuous, and has a continuous right adjoint
$$
v : (\Sch/S)_\proetale \longrightarrow (\Sch/T)_\proetale, \quad
(U \to S) \longmapsto (U \times_S T \to T).
$$
They induce the same morphism of topoi
$$
f_{big} :
\Sh((\Sch/T)_\proetale)
\longrightarrow
\Sh((\Sch/S)_\proetale)
$$
We have $f_{big}^{-1}(\mathcal{G})(U/T) = \mathcal{G}(U/S)$.
We have $f_{big, *}(\mathcal{F})(U/S) = \mathcal{F}(U \times_S T/T)$.
Also, $f_{big}^{-1}$ has a left adjoint $f_{big!}$ which commutes with
fibre products and equalizers.
\end{lemma}

\begin{proof}
The functor $u$ is cocontinuous, continuous, and commutes with fibre products
and equalizers (details omitted; compare with proof of
Lemma \ref{lemma-put-in-T}). Hence
Sites, Lemmas \ref{sites-lemma-when-shriek} and
\ref{sites-lemma-preserve-equalizers}
apply and we deduce the formula
for $f_{big}^{-1}$ and the existence of $f_{big!}$. Moreover,
the functor $v$ is a right adjoint because given $U/T$ and $V/S$
we have $\Mor_S(u(U), V) = \Mor_T(U, V \times_S T)$
as desired. Thus we may apply
Sites, Lemmas \ref{sites-lemma-have-functor-other-way} and
\ref{sites-lemma-have-functor-other-way-morphism}
to get the formula for $f_{big, *}$.
\end{proof}

\begin{lemma}
\label{lemma-morphism-big-small}
Let $\Sch_\proetale$ be a big pro-\'etale site.
Let $f : T \to S$ be a morphism in $\Sch_\proetale$.
\begin{enumerate}
\item We have $i_f = f_{big} \circ i_T$ with $i_f$ as in
Lemma \ref{lemma-put-in-T} and $i_T$ as in
Lemma \ref{lemma-at-the-bottom}.
\item The functor $S_\proetale \to T_\proetale$,
$(U \to S) \mapsto (U \times_S T \to T)$ is continuous and induces
a morphism of topoi
$$
f_{small} : \Sh(T_\proetale) \longrightarrow \Sh(S_\proetale).
$$
We have $f_{small, *}(\mathcal{F})(U/S) = \mathcal{F}(U \times_S T/T)$.
\item We have a commutative diagram of morphisms of sites
$$
\xymatrix{
T_\proetale \ar[d]_{f_{small}} &
(\Sch/T)_\proetale \ar[d]^{f_{big}} \ar[l]^{\pi_T}\\
S_\proetale &
(\Sch/S)_\proetale \ar[l]_{\pi_S}
}
$$
so that $f_{small} \circ \pi_T = \pi_S \circ f_{big}$ as morphisms of topoi.
\item We have $f_{small} = \pi_S \circ f_{big} \circ i_T = \pi_S \circ i_f$.
\end{enumerate}
\end{lemma}

\begin{proof}
The equality $i_f = f_{big} \circ i_T$ follows from the
equality $i_f^{-1} = i_T^{-1} \circ f_{big}^{-1}$ which is
clear from the descriptions of these functors above.
Thus we see (1).

\medskip\noindent
The functor $u : S_\proetale \to T_\proetale$,
$u(U \to S) = (U \times_S T \to T)$
transforms coverings into coverings and commutes with fibre products,
see Lemmas \ref{lemma-proetale} and \ref{lemma-fibre-products-proetale}.
Moreover, both $S_\proetale$, $T_\proetale$ have final objects,
namely $S/S$ and $T/T$ and $u(S/S) = T/T$. Hence by
Sites, Proposition \ref{sites-proposition-get-morphism}
the functor $u$ corresponds to a morphism of sites
$T_\proetale \to S_\proetale$. This in turn gives rise to the
morphism of topoi, see
Sites, Lemma \ref{sites-lemma-morphism-sites-topoi}. The description
of the pushforward is clear from these references.

\medskip\noindent
Part (3) follows because $\pi_S$ and $\pi_T$ are given by the
inclusion functors and $f_{small}$ and $f_{big}$ by the
base change functors $U \mapsto U \times_S T$.

\medskip\noindent
Statement (4) follows from (3) by precomposing with $i_T$.
\end{proof}

\noindent
In the situation of the lemma, using the terminology of
Definition \ref{definition-restriction-small-proetale}
we have: for $\mathcal{F}$ a sheaf on the big pro-\'etale site of $T$
\begin{equation}
\label{equation-compare-big-small}
(f_{big, *}\mathcal{F})|_{S_\proetale} =
f_{small, *}(\mathcal{F}|_{T_\proetale}),
\end{equation}
This equality is clear from the commutativity of the diagram of
sites of the lemma, since restriction to the small pro-\'etale site of
$T$, resp.\ $S$ is given by $\pi_{T, *}$, resp.\ $\pi_{S, *}$. A similar
formula involving pullbacks and restrictions is false.

\begin{lemma}
\label{lemma-composition-proetale}
Given schemes $X$, $Y$, $Y$ in $\Sch_\proetale$
and morphisms $f : X \to Y$, $g : Y \to Z$ we have
$g_{big} \circ f_{big} = (g \circ f)_{big}$ and
$g_{small} \circ f_{small} = (g \circ f)_{small}$.
\end{lemma}

\begin{proof}
This follows from the simple description of pushforward
and pullback for the functors on the big sites from
Lemma \ref{lemma-morphism-big}. For the functors
on the small sites this follows from the description of
the pushforward functors in Lemma \ref{lemma-morphism-big-small}.
\end{proof}

\begin{lemma}
\label{lemma-morphism-big-small-cartesian-diagram}
Let $\Sch_\proetale$ be a big pro-\'etale site. Consider a cartesian diagram
$$
\xymatrix{
T' \ar[r]_{g'} \ar[d]_{f'} & T \ar[d]^f \\
S' \ar[r]^g & S
}
$$
in $\Sch_\proetale$. Then
$i_g^{-1} \circ f_{big, *} = f'_{small, *} \circ (i_{g'})^{-1}$
and $g_{big}^{-1} \circ f_{big, *} = f'_{big, *} \circ (g'_{big})^{-1}$.
\end{lemma}

\begin{proof}
Since the diagram is cartesian, we have for $U'/S'$
that $U' \times_{S'} T' = U' \times_S T$. Hence both
$i_g^{-1} \circ f_{big, *}$ and $f'_{small, *} \circ (i_{g'})^{-1}$
send a sheaf $\mathcal{F}$ on $(\Sch/T)_\proetale$ to the sheaf
$U' \mapsto \mathcal{F}(U' \times_{S'} T')$ on $S'_\proetale$
(use Lemmas \ref{lemma-put-in-T} and \ref{lemma-morphism-big}).
The second equality can be proved in the same manner or can be
deduced from the very general
Sites, Lemma \ref{sites-lemma-localize-morphism}.
\end{proof}

\noindent
We can think about a sheaf on the big pro-\'etale site of $S$ as a collection
of sheaves on the small pro-\'etale site on schemes over $S$.

\begin{lemma}
\label{lemma-characterize-sheaf-big}
Let $S$ be a scheme contained in a big pro-\'etale site $\Sch_\proetale$.
A sheaf $\mathcal{F}$ on the big pro-\'etale site $(\Sch/S)_\proetale$
is given by the following data:
\begin{enumerate}
\item for every $T/S \in \Ob((\Sch/S)_\proetale)$ a sheaf
$\mathcal{F}_T$ on $T_\proetale$,
\item for every $f : T' \to T$ in
$(\Sch/S)_\proetale$ a map
$c_f : f_{small}^{-1}\mathcal{F}_T \to \mathcal{F}_{T'}$.
\end{enumerate}
These data are subject to the following conditions:
\begin{enumerate}
\item[(a)] given any $f : T' \to T$ and $g : T'' \to T'$ in
$(\Sch/S)_\proetale$ the composition
$g_{small}^{-1}c_f \circ c_g$ is equal to $c_{f \circ g}$, and
\item[(b)] if $f : T' \to T$ in $(\Sch/S)_\proetale$
is weakly \'etale then $c_f$ is an isomorphism.
\end{enumerate}
\end{lemma}

\begin{proof}
Identical to the proof of
Topologies, Lemma \ref{topologies-lemma-characterize-sheaf-big-etale}.
\end{proof}

\begin{lemma}
\label{lemma-alternative}
Let $S$ be a scheme. Let $S_{affine, \proetale}$ denote the full subcategory
of $S_\proetale$ consisting of affine objects. A covering of
$S_{affine, \proetale}$ will be a standard pro-\'etale covering, see
Definition \ref{definition-standard-proetale}.
Then restriction
$$
\mathcal{F} \longmapsto \mathcal{F}|_{S_{affine, \etale}}
$$
defines an equivalence of topoi
$\Sh(S_\proetale) \cong \Sh(S_{affine, \proetale})$.
\end{lemma}

\begin{proof}
This you can show directly from the definitions, and is a good exercise.
But it also follows immediately from
Sites, Lemma \ref{sites-lemma-equivalence}
by checking that the inclusion functor
$S_{affine, \proetale} \to S_\proetale$
is a special cocontinuous functor (see
Sites, Definition \ref{sites-definition-special-cocontinuous-functor}).
\end{proof}

\begin{lemma}
\label{lemma-affine-alternative}
Let $S$ be an affine scheme. Let $S_{app}$ denote the full subcategory
of $S_\proetale$ consisting of affine objects $U$ such that
$\mathcal{O}(S) \to \mathcal{O}(U)$ is ind-\'etale. A covering of
$S_{app}$ will be a standard pro-\'etale covering, see
Definition \ref{definition-standard-proetale}.
Then restriction
$$
\mathcal{F} \longmapsto \mathcal{F}|_{S_{app}}
$$
defines an equivalence of topoi $\Sh(S_\proetale) \cong \Sh(S_{app})$.
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-alternative} we may replace $S_\proetale$ by
$S_{affine, \proetale}$.
The lemma follows from Sites, Lemma \ref{sites-lemma-equivalence}
by checking that the inclusion functor $S_{app} \to S_{affine, \proetale}$
is a special cocontinuous functor, see
Sites, Definition \ref{sites-definition-special-cocontinuous-functor}.
The conditions of Sites, Lemma \ref{sites-lemma-equivalence}
follow immediately from the definition and the facts
(a) any object $U$ of $S_{affine, \proetale}$ has a covering
$\{V \to U\}$ with $V$ ind-\'etale over $X$
(Proposition \ref{proposition-weakly-etale})
and (b) the functor $u$ is fully faithful.
\end{proof}

\begin{lemma}
\label{lemma-proetale-subcanonical}
Let $S$ be a scheme. The topology on each of the pro-\'etale sites
$\Sch_\proetale$, $S_\proetale$, $(\Sch/S)_\proetale$,
$S_{affine, \proetale}$, and $(\textit{Aff}/S)_\proetale$ is subcanonical.
\end{lemma}

\begin{proof}
Combine Lemma \ref{lemma-recognize-proetale-covering} and
Descent, Lemma \ref{descent-lemma-fpqc-universal-effective-epimorphisms}.
\end{proof}





\section{Weakly contractible objects}
\label{section-weakly-contractible}

\noindent
In this section we prove the key fact that our pro-\'etale sites
contain many weakly contractible objects. In fact, the proof of
Lemma \ref{lemma-get-many-weakly-contractible} is the reason for
the shape of the function $Bound$ in
Definition \ref{definition-big-proetale-site} (although
for readers who are ignoring set theoretical questions, this
information is without content).

\noindent
We first express the notion of w-contractible rings in terms of
pro-\'etale coverings.

\begin{lemma}
\label{lemma-w-contractible-proetale-cover}
Let $T = \Spec(A)$ be an affine scheme. The following are equivalent
\begin{enumerate}
\item $A$ is w-contractible, and
\item every pro-\'etale covering of $T$ can be refined by
a Zariski covering of the form $T = \coprod_{i = 1, \ldots, n} U_i$.
\end{enumerate}
\end{lemma}

\begin{proof}
Assume $A$ is w-contractible. By Lemma \ref{lemma-proetale-affine}
it suffices to prove we can refine every standard pro-\'etale covering
$\{f_i : T_i \to T\}_{i = 1, \ldots, n}$ by a Zariski covering of $T$.
The morphism $\coprod T_i \to T$ is a surjective weakly \'etale morphism
of affine schemes. Hence by Definition \ref{definition-w-contractible}
there exists a morphism $\sigma : T \to \coprod T_i$ over $T$.
Then the Zariski covering $T = \coprod \sigma^{-1}(T_i)$
refines $\{f_i : T_i \to T\}$.

\medskip\noindent
Conversely, assume (2). If $A \to B$ is faithfully flat and weakly \'etale,
then $\{\Spec(B) \to T\}$ is a pro-\'etale covering.
Hence there exists a Zariski covering $T = \coprod U_i$
and morphisms $U_i \to \Spec(B)$ over $T$. Since $T = \coprod U_i$
we obtain $T \to \Spec(B)$, i.e., an $A$-algebra map $B \to A$.
This means $A$ is w-contractible.
\end{proof}

\begin{lemma}
\label{lemma-w-contractible-is-weakly-contractible}
Let $\Sch_\proetale$ be a big pro-\'etale site as in
Definition \ref{definition-big-proetale-site}.
Let $T = \Spec(A)$ be an affine object of $\Sch_\proetale$.
The following are equivalent
\begin{enumerate}
\item $A$ is w-contractible,
\item $T$ is a weakly contractible
(Sites, Definition \ref{sites-definition-w-contractible})
object of $\Sch_\proetale$, and
\item every pro-\'etale covering of $T$ can be refined by
a Zariski covering of the form $T = \coprod_{i = 1, \ldots, n} U_i$.
\end{enumerate}
\end{lemma}

\begin{proof}
We have seen the equivalence of (1) and (3) in
Lemma \ref{lemma-w-contractible-proetale-cover}.

\medskip\noindent
Assume (3) and let $\mathcal{F} \to \mathcal{G}$ be a surjection of sheaves on
$\Sch_\proetale$. Let $s \in \mathcal{G}(T)$. To prove (2) we will show that
$s$ is in the image of $\mathcal{F}(T) \to \mathcal{G}(T)$. We can find a
covering $\{T_i \to T\}$ of $\Sch_\proetale$ such that $s$ lifts
to a section of $\mathcal{F}$ over $T_i$
(Sites, Definition \ref{sites-definition-sheaves-injective-surjective}).
By (3) we may assume we have a finite covering
$T = \coprod_{j = 1, \ldots, m} U_j$ by open and closed subsets
and we have $t_j \in \mathcal{F}(U_j)$ mapping to $s|_{U_j}$.
Since Zariski coverings are coverings in $\Sch_\proetale$
(Lemma \ref{lemma-etale-proetale}) we conclude that
$\mathcal{F}(T) = \prod \mathcal{F}(U_j)$.
Thus $t = (t_1, \ldots, t_m) \in \mathcal{F}(T)$
is a section mapping to $s$.

\medskip\noindent
Assume (2). Let $A \to D$ be as in
Proposition \ref{proposition-find-w-contractible}.
Then $\{V \to T\}$ is a covering of $\Sch_\proetale$.
(Note that $V = \Spec(D)$ is an object of $\Sch_\proetale$
by Remark \ref{remark-size-w-contractible}
combined with our choice of the function
$Bound$ in Definition \ref{definition-big-proetale-site}
and the computation of the size of affine schemes in
Sets, Lemma \ref{sets-lemma-bound-size}.)
Since the topology on $\Sch_\proetale$ is subcanonical
(Lemma \ref{lemma-proetale-subcanonical})
we see that $h_V \to h_T$ is a surjective map of sheaves
(Sites, Lemma \ref{sites-lemma-covering-surjective-after-sheafification}).
Since $T$ is assumed weakly contractible, we see that there is an element
$f \in h_V(T) = \Mor(T, V)$ whose image in $h_T(T)$ is $\text{id}_T$.
Thus $A \to D$ has a section $\sigma : D \to A$.
Now if $A \to B$ is faithfully flat and weakly \'etale, then
$D \to D \otimes_A B$ has the same properties, hence
there is a section $D \otimes_A B \to D$ and combined
with $\sigma$ we get a section $B \to D \otimes_A B \to D \to A$
of $A \to B$. Thus $A$ is w-contractible and (1) holds.
\end{proof}

\begin{lemma}
\label{lemma-get-many-weakly-contractible}
Let $\Sch_\proetale$ be a big pro-\'etale site as in
Definition \ref{definition-big-proetale-site}.
For every object $T$ of $\Sch_\proetale$ there exists
a covering $\{T_i \to T\}$ in $\Sch_\proetale$
with each $T_i$ affine and the spectrum of a w-contractible
ring. In particular, $T_i$ is weakly contractible in $\Sch_\proetale$.
\end{lemma}

\begin{proof}
For those readers who do not care about set-theoretical issues
this lemma is a trivial consequence of
Lemma \ref{lemma-w-contractible-is-weakly-contractible} and
Proposition \ref{proposition-find-w-contractible}.
Here are the details.
Choose an affine open covering $T = \bigcup U_i$. Write $U_i = \Spec(A_i)$.
Choose faithfully flat, ind-\'etale ring maps $A_i \to D_i$
such that $D_i$ is w-contractible as in
Proposition \ref{proposition-find-w-contractible}.
The family of morphisms $\{\Spec(D_i) \to T\}$ is a
pro-\'etale covering.
If we can show that $\Spec(D_i)$ is isomorphic to an object, say $T_i$,
of $\Sch_\proetale$, then $\{T_i \to T\}$ will be combinatorially
equivalent to a covering of $\Sch_\proetale$ by the construction
of $\Sch_\proetale$ in Definition \ref{definition-big-proetale-site}
and more precisely the application of
Sets, Lemma \ref{sets-lemma-coverings-site} in the last step.
To prove $\Spec(D_i)$ is isomorphic to an object of
$\Sch_\proetale$, it suffices to prove that
$|D_i| \leq Bound(\text{size}(T))$ by the construction
of $\Sch_\proetale$ in Definition \ref{definition-big-proetale-site}
and more precisely the application of
Sets, Lemma \ref{sets-lemma-construct-category} in step (3).
Since $|A_i| \leq \text{size}(U_i) \leq \text{size}(T)$
by Sets, Lemmas \ref{sets-lemma-bound-affine} and
\ref{sets-lemma-bound-finite-type} we get
$|D_i| \leq \kappa^{2^{2^{2^\kappa}}}$ where $\kappa = \text{size}(T)$
by Remark \ref{remark-size-w-contractible}.
Thus by our choice of the function $Bound$ in
Definition \ref{definition-big-proetale-site} we win.
\end{proof}

\begin{lemma}
\label{lemma-proetale-enough-w-contractible}
Let $S$ be a scheme. The pro-\'etale sites
$S_\proetale$, $(\Sch/S)_\proetale$, $S_{affine, \proetale}$, and
$(\textit{Aff}/S)_\proetale$ and if $S$ is affine $S_{app}$
have enough (affine) quasi-compact, weakly contractible
objects, see Sites, Definition \ref{sites-definition-w-contractible}.
\end{lemma}

\begin{proof}
Follows immediately from Lemma \ref{lemma-get-many-weakly-contractible}.
\end{proof}

\begin{lemma}
\label{lemma-weakly-contractible-cover}
Let $S$ be a scheme. The pro-\'etale sites
$\Sch_\proetale$, $S_\proetale$, $(\Sch/S)_\proetale$
have the following property: for any object
$U$ there exists a covering $\{V \to U\}$ with $V$ a
weakly contractible object. If $U$ is quasi-compact, then we
may choose $V$ affine and weakly contractible.
\end{lemma}

\begin{proof}
Suppose that $V = \coprod_{j \in J} V_j$ is an object of $(\Sch/S)_\proetale$
which is the disjoint union of weakly contractible objects $V_j$.
Since a disjoint union decomposition is a pro-\'etale covering we
see that $\mathcal{F}(V) = \prod_{j \in J} \mathcal{F}(V_j)$ for any
pro-\'etale sheaf $\mathcal{F}$. Let $\mathcal{F} \to \mathcal{G}$
be a surjective map of sheaves of sets. Since $V_j$ is weakly contractible,
the map $\mathcal{F}(V_j) \to \mathcal{G}(V_j)$ is surjective, see
Sites, Definition \ref{sites-definition-w-contractible}.
Thus $\mathcal{F}(V) \to \mathcal{G}(V)$ is surjective as a product
of surjective maps of sets and we conclude that $V$ is weakly contractible.

\medskip\noindent
Choose a covering $\{U_i \to U\}_{i \in I}$ with $U_i$ affine and
weakly contractible as in Lemma \ref{lemma-get-many-weakly-contractible}.
Take $V = \coprod_{i \in I} U_i$ (there is a set theoretic issue here
which we will address below). Then $\{V \to U\}$ is the desired
pro-\'etale covering by a weakly contractible object
(to check it is a covering use
Lemma \ref{lemma-recognize-proetale-covering}).
If $U$ is quasi-compact, then it follows immediately from
Lemma \ref{lemma-recognize-proetale-covering}
that we can choose a finite subset $I' \subset I$ such that
$\{U_i \to U\}_{i \in I'}$ is still a covering
and then $\{\coprod_{i \in I'} U_i \to U\}$ is the desired covering
by an affine and weakly contractible object.

\medskip\noindent
In this paragraph, which we urge the reader to skip, we address
set theoretic problems. In order to know that the disjoint union
lies in our partial universe, we need to bound the cardinality of
the index set $I$. It is seen immediately from the construction of
the covering $\{U_i \to U\}_{i \in I}$ in the proof of
Lemma \ref{lemma-get-many-weakly-contractible}
that $|I| \leq \text{size}(U)$ where the size of a scheme is as
defined in Sets, Section \ref{sets-section-categories-schemes}.
Moreover, for each $i$ we have
$\text{size}(U_i) \leq Bound(\text{size}(U))$;
this follows for the bound of the cardinality of
$\Gamma(U_i, \mathcal{O}_{U_i})$ in
the proof of Lemma \ref{lemma-get-many-weakly-contractible}
and Sets, Lemma \ref{sets-lemma-bound-affine}.
Thus $\text{size}(\coprod_{i \in I} U_i)) \leq Bound(\text{size}(U))$
by Sets, Lemma \ref{sets-lemma-bound-size}.
Hence by construction of the big pro-\'etale site through
Sets, Lemma \ref{sets-lemma-construct-category}
we see that $\coprod_{i \in I} U_i$ is isomorphic to an object
of our site and the proof is complete.
\end{proof}






\section{Weakly contractible hypercoverings}
\label{section-hypercovering}

\noindent
The results of Section \ref{section-weakly-contractible}
leads to the existence of hypercoverings made up out weakly
contractible objects.

\begin{lemma}
\label{lemma-w-contractible-hypercovering}
Let $X$ be a scheme.
\begin{enumerate}
\item For every object $U$ of $X_\proetale$ there exists a hypercovering
$K$ of $U$ in $X_\proetale$ such that each term $K_n$ consists of a
single weakly contractible object of $X_\proetale$ covering $U$.
\item For every quasi-compact and quasi-separated object $U$ of $X_\proetale$
there exists a hypercovering $K$ of $U$ in $X_\proetale$ such that each
term $K_n$ consists of a single affine and weakly contractible object of
$X_\proetale$ covering $U$.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $\mathcal{B} \subset \Ob(X_\proetale)$ be the set of weakly contractible
objects of $X_\proetale$. Every object $T$ of $X_\proetale$ has a
covering $\{T_i \to T\}_{i \in I}$ with $I$ finite and $T_i \in \mathcal{B}$ by
Lemma \ref{lemma-weakly-contractible-cover}.
By Hypercoverings, Lemma \ref{hypercovering-lemma-w-contractible}
we get a hypercovering $K$ of $U$ such that $K_n = \{U_{n, i}\}_{i \in I_n}$
with $I_n$ finite and $U_{n, i}$ weakly contractible.
Then we can replace $K$ by the hypercovering of $U$ given by $\{U_n\}$
in degree $n$ where $U_n = \coprod_{i \in I_n} U_{n, i}$
This is allowed by
Hypercoverings, Remark \ref{hypercovering-remark-take-unions-hypercovering-X}.

\medskip\noindent
Let $X_{qcqs, \proetale} \subset X_\proetale$ be the full subcategory
consisting of quasi-compact and quasi-separated objects.
A covering of $X_{qcqs, \proetale}$ will be a finite pro-\'etale covering.
Then $X_{qcqs, \proetale}$ is a site, has fibre products, and
the inclusion functor $X_{qcqs, \proetale} \to X_\proetale$ is continuous
and commutes with fibre products.
In particular, if $K$ is a hypercovering of an object $U$ in
$X_{qcqs, \proetale}$ then $K$ is a hypercovering of $U$ in $X_\proetale$
by Hypercoverings, Lemma
\ref{hypercovering-lemma-hypercovering-continuous-functor}.
Let $\mathcal{B} \subset \Ob(X_{qcqs, \proetale})$ be the set of
affine and weakly contractible objects. By 
Lemma \ref{lemma-get-many-weakly-contractible}
and the fact that finite unions of affines are affine,
for every object $U$ of $X_{qcqs, \proetale}$ there exists a covering
$\{V \to U\}$ of $X_{qcqs, \proetale}$ with $V \in \mathcal{B}$.
By Hypercoverings, Lemma \ref{hypercovering-lemma-w-contractible}
we get a hypercovering $K$ of $U$ such that $K_n = \{U_{n, i}\}_{i \in I_n}$
with $I_n$ finite and $U_{n, i}$ affine and weakly contractible.
Then we can replace $K$ by the hypercovering of $U$
given by $\{U_n\}$ in degree $n$ where
$U_n = \coprod_{i \in I_n} U_{n, i}$. This is allowed by
Hypercoverings, Remark \ref{hypercovering-remark-take-unions-hypercovering-X}.
\end{proof}

\noindent
In the following lemma we use the {\v C}ech complex $s(\mathcal{F}(K))$
associated to a hypercovering $K$ in a site. See
Hypercoverings, Section \ref{hypercovering-section-hyper-cech}.
If $K$ is a hypercovering of $U$ and $K_n = \{U_n \to U\}$, then
the {\v C}ech complex looks like this:
$$
s(\mathcal{F}(K)) =
\left(
\mathcal{F}(U_0) \to \mathcal{F}(U_1) \to \mathcal{F}(U_2) \to \ldots
\right)
$$
where $s(\mathcal{F}(U_n))$ is placed in cohomological degree $n$.

\begin{lemma}
\label{lemma-compute-cohomology}
Let $X$ be a scheme. Let $E \in D^+(X_\proetale)$ be represented by
a bounded below complex $\mathcal{E}^\bullet$ of abelian sheaves.
Let $K$ be a hypercovering of $U \in \Ob(X_\proetale)$ with
$K_n = \{U_n \to U\}$ where $U_n$ is a weakly contractible object of
$X_\proetale$. Then
$$
R\Gamma(U, E) = \text{Tot}(s(\mathcal{E}^\bullet(K)))
$$
in $D(\textit{Ab})$.
\end{lemma}

\begin{proof}
If $\mathcal{E}$ is an abelian
sheaf on $X_\proetale$, then the spectral sequence of
Hypercoverings, Lemma \ref{hypercovering-lemma-cech-spectral-sequence}
implies that
$$
R\Gamma(X_\proetale, \mathcal{E}) = s(\mathcal{E}(K))
$$
because the higher cohomology groups of any sheaf over $U_n$ vanish, see
Cohomology on Sites, Lemma \ref{sites-cohomology-lemma-w-contractible}.

\medskip\noindent
If $\mathcal{E}^\bullet$ is bounded below, then we can choose an injective
resolution $\mathcal{E}^\bullet \to \mathcal{I}^\bullet$ and consider
the map of complexes
$$
\text{Tot}(s(\mathcal{E}^\bullet(K)))
\longrightarrow
\text{Tot}(s(\mathcal{I}^\bullet(K)))
$$
For every $n$ the map $\mathcal{E}^\bullet(U_n) \to \mathcal{I}^\bullet(U_n)$
is a quasi-isomorphism because taking sections over $U_n$ is exact.
Hence the displayed map is a quasi-isomorphism by one of the spectral
sequences of
Homology, Lemma \ref{homology-lemma-first-quadrant-ss}.
Using the result of the first paragraph we see that for every $p$
the complex $s(\mathcal{I}^p(K))$ is acyclic in degrees $n > 0$ and
computes $\mathcal{I}^p(U)$ in degree $0$. Thus the other spectral
sequence of
Homology, Lemma \ref{homology-lemma-first-quadrant-ss}
shows $\text{Tot}(s(\mathcal{I}^\bullet(K)))$ computes
$R\Gamma(U, E) = \mathcal{I}^\bullet(U)$.
\end{proof}

\begin{lemma}
\label{lemma-quasi-compact-quasi-separated-commutes-direct-sums}
Let $X$ be a quasi-compact and quasi-separated scheme.
The functor $R\Gamma(X, -) : D^+(X_\proetale) \to D(\textit{Ab})$
commutes with direct sums and homotopy colimits.
\end{lemma}

\begin{proof}
The statement means the following: Suppose we have a family of objects
$E_i$ of $D^+(X_\proetale)$ such that $\bigoplus E_i$ is an object
of $D^+(X_\proetale)$. Then
$R\Gamma(X, \bigoplus E_i) = \bigoplus R\Gamma(X, E_i)$.
To see this choose a hypercovering $K$ of $X$ with $K_n = \{U_n \to X\}$
where $U_n$ is an affine and weakly contractible scheme, see
Lemma \ref{lemma-w-contractible-hypercovering}.
Let $N$ be an integer such that $H^p(E_i) = 0$ for $p < N$.
Choose a complex of abelian sheaves $\mathcal{E}_i^\bullet$
representing $E_i$ with $\mathcal{E}_i^p = 0$ for $p < N$.
The termwise direct sum $\bigoplus \mathcal{E}_i^\bullet$ represents
$\bigoplus E_i$ in $D(X_\proetale)$, see
Injectives, Lemma \ref{injectives-lemma-derived-products}.
By Lemma \ref{lemma-compute-cohomology} we have
$$
R\Gamma(X, \bigoplus E_i) =
\text{Tot}(s((\bigoplus \mathcal{E}^\bullet_i)(K)))
$$
and
$$
R\Gamma(X, E_i) = \text{Tot}(s(\mathcal{E}^\bullet_i(K)))
$$
Since each $U_n$ is quasi-compact we see that
$$
\text{Tot}(s((\bigoplus \mathcal{E}^\bullet_i)(K))) =
\bigoplus \text{Tot}(s(\mathcal{E}^\bullet_i(K)))
$$
by Modules on Sites, Lemma
\ref{sites-modules-lemma-sections-over-quasi-compact}.
The statement on homotopy colimits is a formal consequence of the fact
that $R\Gamma$ is an exact functor of triangulated categories and the
fact (just proved) that it commutes with direct sums.
\end{proof}

\begin{remark}
\label{remark-extend-to-all}
Let $X$ be a scheme. Because $X_\proetale$ has enough weakly contractible
objects for all $K$ in $D(X_\proetale)$ we have $K = R\lim \tau_{\geq -n}K$
by
Cohomology on Sites, Proposition
\ref{sites-cohomology-proposition-enough-weakly-contractibles}.
Since $R\Gamma$ commutes with $R\lim$ by
Injectives, Lemma \ref{injectives-lemma-RF-commutes-with-Rlim}
we see that
$$
R\Gamma(X, K) = R\lim R\Gamma(X, \tau_{\geq -n}K)
$$
in $D(\textit{Ab})$. This will sometimes allow us to extend results from
bounded below complexes to all complexes.
\end{remark}







\section{Compact generation}
\label{section-compact-generation}

\noindent
In this section we prove that various derived categories associated
to our pro-\'etale sites are compactly generated as defined in
Derived Categories, Definition \ref{derived-definition-compactly-generated}.

\begin{lemma}
\label{lemma-enough-compact-proetale}
Let $S$ be a scheme. Let $\Lambda$ be a ring.
\begin{enumerate}
\item $D(S_\proetale)$ is compactly generated,
\item $D(S_\proetale, \Lambda)$ is compactly generated,
\item $D(S_\proetale, \mathcal{A})$ is compactly generated
for any sheaf of rings $\mathcal{A}$ on $S_\proetale$,
\item $D((\Sch/S)_\proetale)$ is compactly generated,
\item $D((\Sch/S)_\proetale, \Lambda)$ is compactly generated, and
\item $D((\Sch/S)_\proetale, \mathcal{A})$ is compactly generated
for any sheaf of rings $\mathcal{A}$ on $(\Sch/S)_\proetale$,
\end{enumerate}
\end{lemma}

\begin{proof}
Proof of (3). Let $U$ be an affine object of $S_\proetale$ which is
weakly contractible. Then $j_{U!}\mathcal{A}_U$ is a compact object
of the derived category $D(S_\proetale, \mathcal{A})$, see
Cohomology on Sites, Lemma
\ref{sites-cohomology-lemma-quasi-compact-weakly-contractible-compact}.
Choose a set $I$ and for each $i \in I$ an affine weakly contractible
object $U_i$ of $S_\proetale$ such that every affine weakly contractible
object of $S_\proetale$ is isomorphic to one of the $U_i$. This is possible
because $\Ob(S_\proetale)$ is a set. To finish the proof of (3) it suffices
to show that $\bigoplus j_{U_i, !}\mathcal{A}_{U_i}$ is a generator
of $D(S_\proetale, \mathcal{A})$, see
Derived Categories, Definition \ref{derived-definition-generators}.
To see this, let $K$ be a nonzero object
of $D(S_\proetale, \mathcal{A})$. Then there exists an object $T$
of our site $S_\proetale$ and a nonzero element $\xi$ of $H^n(K)(T)$.
In other words, $\xi$ is a nonzero section of the $n$th cohomology
sheaf of $K$.
We may assume $K$ is represented by a complex $\mathcal{K}^\bullet$
of sheaves of $\mathcal{A}$-modules and $\xi$ is the class of a
section $s \in \mathcal{K}^n(T)$ with $\text{d}(s) = 0$.
Namely, $\xi$ is locally represented as the class of a section
(so you get the result after replacing $T$ by a member of a covering of $T$).
Next, we choose a covering $\{T_j \to T\}_{j \in J}$
as in Lemma \ref{lemma-get-many-weakly-contractible}.
Since $H^n(K)$ is a sheaf, we see that for some $j$ the restriction
$\xi|_{T_j}$ remains nonzero. Thus $s|_{T_j}$ defines a nonzero map
$j_{T_j, !}\mathcal{A}_{T_j} \to K$ in $D(S_\proetale, \mathcal{A})$.
Since $T_j \cong U_i$ for some $i \in I$ we conclude.

\medskip\noindent
The exact same argument works for the big pro-\'etale site of $S$.
\end{proof}







\section{Comparing topologies}
\label{section-compare-topologies}

\noindent
This section is the analogue of
\'Etale Cohomology, Section \ref{etale-cohomology-section-compare-topologies}.

\begin{lemma}
\label{lemma-presheaf-value-weakly-contractible}
Let $X$ be a scheme. Let $\mathcal{F}$ be a presheaf of sets on $X_\proetale$
which sends finite disjoint unions to products. Then
$\mathcal{F}^\#(W) = \mathcal{F}(W)$ if $W$ is an affine weakly contractible
object of $X_\proetale$.
\end{lemma}

\begin{proof}
Recall that $\mathcal{F}^\#$ is equal to $(\mathcal{F}^+)^+$, see
Sites, Theorem \ref{sites-theorem-plus}, where $\mathcal{F}^+$
is the presheaf which sends an object $U$ of $X_\proetale$ to
$\colim H^0(\mathcal{U}, \mathcal{F})$ where the colimit is
over all pro-\'etale coverings $\mathcal{U}$ of $U$.
Thus it suffices to prove that (a) $\mathcal{F}^+$ sends finite
disjoint unions to products and (b) sends $W$ to $\mathcal{F}(W)$.
If $U = U_1 \amalg U_2$, then given a pro-\'etale covering
$\mathcal{U} = \{f_j : V_j \to U\}$ of $U$ we obtain pro-\'etale coverings
$\mathcal{U}_i = \{f_j^{-1}(U_i) \to U_i\}$ and we clearly have
$$
H^0(\mathcal{U}, \mathcal{F}) =
H^0(\mathcal{U}_1, \mathcal{F}) \times
H^0(\mathcal{U}_2, \mathcal{F})
$$
because $\mathcal{F}$ sends finite disjoint unions to products (this includes
the condition that $\mathcal{F}$ sends the empty scheme to the singleton).
This proves (a).
Finally, any pro-\'etale covering of $W$ can be refined by a finite disjoint
union decomposition $W = W_1 \amalg \ldots W_n$ by
Lemma \ref{lemma-w-contractible-is-weakly-contractible}.
Hence $\mathcal{F}^+(W) = \mathcal{F}(W)$ exactly because the value of
$\mathcal{F}$ on $W$ is the product of the values of $\mathcal{F}$
on the $W_j$. This proves (b).
\end{proof}

\begin{lemma}
\label{lemma-small-pullback-weakly-contractible}
Let $f : X \to Y$ be a morphism of schemes. Let $\mathcal{F}$ be a sheaf
of sets on $X_\proetale$. If $W$ is an affine weakly contractible
object of $X_\proetale$, then
$$
f_{small}^{-1}\mathcal{F}(W) = \colim_{W \to V} \mathcal{F}(V)
$$
where the colimit is over morphisms $W \to V$ over $Y$
with $V \in Y_\proetale$.
\end{lemma}

\begin{proof}
Recall that $f_{small}^{-1}\mathcal{F}$ is the sheaf associated to the
presheaf
$$
u_p\mathcal{F} : U \mapsto \colim_{U \to V} \mathcal{F}(V)
$$
on $X_\etale$, see Sites, Sections \ref{sites-section-morphism-sites} and
\ref{sites-section-continuous-functors}; we've surpressed from the notation
that the colimit is over the opposite of the category
$\{U \to V, V \in Y_\proetale\}$. By
Lemma \ref{lemma-presheaf-value-weakly-contractible}
it suffices to prove that $u_p\mathcal{F}$ sends finite disjoint unions
to products.
Suppose that $U = U_1 \amalg U_2$ is a disjoint union of open and closed
subschemes. There is a functor
$$
\{U_1 \to V_1\} \times \{U_2 \to V_2\} \longrightarrow
\{U \to V\},\quad
(U_1 \to V_1, U_2 \to V_2) \longmapsto (U \to V_1 \amalg V_2)
$$
which is initial (Categories, Definition \ref{categories-definition-initial}).
Hence the corresponding functor on opposite categories is cofinal and
by Categories, Lemma \ref{categories-lemma-cofinal} we see
that $u_p\mathcal{F}$ on $U$ is the colimit of the values
$\mathcal{F}(V_1 \amalg V_2)$ over the product category.
Since $\mathcal{F}$ is a sheaf it sends disjoint unions to products and
we conclude $u_p\mathcal{F}$ does too.
\end{proof}

\begin{lemma}
\label{lemma-describe-pullback}
Let $S$ be a scheme. Consider the morphism
$$
\pi_S : (\Sch/S)_\proetale \longrightarrow S_\proetale
$$
of Lemma \ref{lemma-at-the-bottom}. Let $\mathcal{F}$ be a sheaf on
$S_\proetale$. Then $\pi_S^{-1}\mathcal{F}$ is given by the rule
$$
(\pi_S^{-1}\mathcal{F})(T) = \Gamma(T_\proetale, f_{small}^{-1}\mathcal{F})
$$
where $f : T \to S$. Moreover, $\pi_S^{-1}\mathcal{F}$ satisfies the
sheaf condition with respect to fpqc coverings.
\end{lemma}

\begin{proof}
Observe that we have a morphism
$i_f : \Sh(T_\proetale) \to \Sh(\Sch/S)_\proetale)$
such that $\pi_S \circ i_f = f_{small}$ as morphisms
$T_\proetale \to S_\proetale$, see Lemma \ref{lemma-put-in-T}.
Since pullback is transitive we see that
$i_f^{-1} \pi_S^{-1}\mathcal{F} = f_{small}^{-1}\mathcal{F}$ as desired.

\medskip\noindent
Let $\{g_i : T_i \to T\}_{i \in I}$ be an fpqc covering. The final statement
means the following: Given a sheaf $\mathcal{G}$ on $T_\proetale$ and given
sections $s_i \in \Gamma(T_i, g_{i, small}^{-1}\mathcal{G})$ whose pullbacks
to $T_i \times_T T_j$ agree, there is a unique section $s$ of $\mathcal{G}$
over $T$ whose pullback to $T_i$ agrees with $s_i$. We will prove this
statement when $T$ is affine and the covering is given by a single
surjective flat morphism $T' \to T$ of affines and omit the reduction of
the general case to this case.

\medskip\noindent
Let $g : T' \to T$ be a surjective flat morphism of affines and let
$s' \in g_{small}^{-1}\mathcal{G}(T')$ be a section with
$\text{pr}_0^*s' = \text{pr}_1^*s'$ on $T' \times_T T'$.
Choose a surjective weakly \'etale morphism $W \to T'$ with
$W$ affine and weakly contractible, see
Lemma \ref{lemma-weakly-contractible-cover}. By
Lemma \ref{lemma-small-pullback-weakly-contractible}
the restriction $s'|_W$ is an element of $\colim_{W \to U} \mathcal{G}(U)$.
Choose $\phi : W \to U_0$ and $s_0 \in \mathcal{G}(U_0)$ corresponding to $s'$.
Choose a surjective weakly \'etale morphism $V \to W \times_T W$
with $V$ affine and weakly contractible.
Denote $a, b : V \to W$ the induced morphisms.
Since $a^*(s'|_W) = b^*(s'|_W)$ and since the category
$\{V \to U, U \in T_\proetale\}$ is cofiltered
(this is clear but see
Sites, Lemma \ref{sites-lemma-directed-morphism} if in doubt),
we see that the two morphisms $\phi \circ a , \phi \circ b : V \to U_0$
have to be equal. By the results in
Descent, Section \ref{descent-section-fpqc-universal-effective-epimorphisms}
(especially
Descent, Lemma \ref{descent-lemma-fpqc-universal-effective-epimorphisms})
it follows there is a unique morphism $T \to U_0$ such that $\phi$
is the composition of this morphism with the structure morphism $W \to T$
(small detail omitted). Then we can let $s$ be the pullback
of $s_0$ by this morphism. We omit the verification that
$s$ pulls back to $s'$ on $T'$.
\end{proof}









\section{Comparing big and small topoi}
\label{section-compare}

\noindent
This section is the analogue of \'Etale Cohomology, Section
\ref{etale-cohomology-section-compare}. In the following we
will often denote $\mathcal{F} \mapsto \mathcal{F}|_{S_\proetale}$
the pullback functor $i_S^{-1}$ corresponding to
the morphism of topoi $i_S : \Sh(S_\proetale) \to \Sh((\Sch/S)_\proetale)$
of Lemma \ref{lemma-at-the-bottom}.

\begin{lemma}
\label{lemma-compare-injectives}
Let $S$ be a scheme. Let $T$ be an object of $(\Sch/S)_\proetale$.
\begin{enumerate}
\item If $\mathcal{I}$ is injective in $\textit{Ab}((\Sch/S)_\proetale)$, then
\begin{enumerate}
\item $i_f^{-1}\mathcal{I}$ is injective in $\textit{Ab}(T_\proetale)$,
\item $\mathcal{I}|_{S_\proetale}$ is injective in $\textit{Ab}(S_\proetale)$,
\end{enumerate}
\item If $\mathcal{I}^\bullet$ is a K-injective complex
in $\textit{Ab}((\Sch/S)_\proetale)$, then
\begin{enumerate}
\item $i_f^{-1}\mathcal{I}^\bullet$ is a K-injective complex in
$\textit{Ab}(T_\proetale)$,
\item $\mathcal{I}^\bullet|_{S_\proetale}$ is a K-injective complex in
$\textit{Ab}(S_\proetale)$,
\end{enumerate}
\end{enumerate}
\end{lemma}

\begin{proof}
Proof of (1)(a) and (2)(a): $i_f^{-1}$ is a right adjoint of an
exact functor $i_{f, !}$. Namely, recall that $i_f$ corresponds
to a cocontinuous functor $u : T_\proetale \to (\Sch/S)_\proetale$
which is continuous and commutes with fibre products and equalizers, see
Lemma \ref{lemma-put-in-T} and its proof. Hence we obtain $i_{f, !}$ by
Modules on Sites, Lemma \ref{sites-modules-lemma-g-shriek-adjoint}.
It is shown in Modules on Sites, Lemma
\ref{sites-modules-lemma-exactness-lower-shriek} that it is exact.
Then we conclude (1)(a) and (2)(a) hold by
Homology, Lemma \ref{homology-lemma-adjoint-preserve-injectives} and
Derived Categories, Lemma \ref{derived-lemma-adjoint-preserve-K-injectives}.

\medskip\noindent
Parts (1)(b) and (2)(b) are special cases of (1)(a) and (2)(a)
as $i_S = i_{\text{id}_S}$.
\end{proof}

\begin{lemma}
\label{lemma-compare-higher-direct-image}
Let $f : T \to S$ be a morphism of schemes.
For $K$ in $D((\Sch/T)_\proetale)$ we have
$$
(Rf_{big, *}K)|_{S_\proetale} = Rf_{small, *}(K|_{T_\proetale})
$$
in $D(S_\proetale)$. More generally, let $S' \in \Ob((\Sch/S)_\proetale)$
with structure morphism $g : S' \to S$. Consider the fibre product
$$
\xymatrix{
T' \ar[r]_{g'} \ar[d]_{f'} & T \ar[d]^f \\
S' \ar[r]^g & S
}
$$
Then for $K$ in $D((\Sch/T)_\proetale)$ we have
$$
i_g^{-1}(Rf_{big, *}K) = Rf'_{small, *}(i_{g'}^{-1}K)
$$
in $D(S'_\proetale)$ and
$$
g_{big}^{-1}(Rf_{big, *}K) = Rf'_{big, *}((g'_{big})^{-1}K)
$$
in $D((\Sch/S')_\proetale)$.
\end{lemma}

\begin{proof}
The first equality follows from Lemma \ref{lemma-compare-injectives}
and (\ref{equation-compare-big-small})
on choosing a K-injective complex of abelian sheaves representing $K$.
The second equality follows from Lemma \ref{lemma-compare-injectives}
and Lemma
\ref{lemma-morphism-big-small-cartesian-diagram}
on choosing a K-injective complex of abelian sheaves representing $K$.
The third equality follows similarly from
Cohomology on Sites, Lemmas \ref{sites-cohomology-lemma-cohomology-of-open} and
\ref{sites-cohomology-lemma-restrict-K-injective-to-open}
and Lemma \ref{lemma-morphism-big-small-cartesian-diagram}
on choosing a K-injective complex of abelian sheaves representing $K$.
\end{proof}

\noindent
Let $S$ be a scheme and let $\mathcal{H}$ be an abelian sheaf on
$(\Sch/S)_\proetale$. Recall that $H^n_\proetale(U, \mathcal{H})$ denotes
the cohomology of $\mathcal{H}$ over an object $U$ of $(\Sch/S)_\proetale$.

\begin{lemma}
\label{lemma-compare-cohomology-big-small}
Let $f : T \to S$ be a morphism of schemes. For $K$ in $D(S_\proetale)$
we have
$$
H^n_\proetale(S, \pi_S^{-1}K) = H^n(S_\proetale, K)
$$
and
$$
H^n_\proetale(T, \pi_S^{-1}K) = H^n(T_\proetale, f_{small}^{-1}K).
$$
For $M$ in $D((\Sch/S)_\proetale)$ we have
$$
H^n_\proetale(T, M) = H^n(T_\proetale, i_f^{-1}M).
$$
\end{lemma}

\begin{proof}
To prove the last equality represent $M$
by a K-injective complex of abelian sheaves
and apply Lemma \ref{lemma-compare-injectives}
and work out the definitions. The second equality follows from
this as $i_f^{-1} \circ \pi_S^{-1} = f_{small}^{-1}$. The first
equality is a special
case of the second one.
\end{proof}

\begin{lemma}
\label{lemma-cohomological-descent-proetale}
Let $S$ be a scheme. For $K \in D(S_\proetale)$ the map
$$
K \longrightarrow R\pi_{S, *}\pi_S^{-1}K
$$
is an isomorphism.
\end{lemma}

\begin{proof}
This is true because both $\pi_S^{-1}$ and $\pi_{S, *} = i_S^{-1}$
are exact functors and the composition $\pi_{S, *} \circ \pi_S^{-1}$
is the identity functor.
\end{proof}






















\section{Points of the pro-\'etale site}
\label{section-points}

\noindent
We first apply Deligne's criterion to show that there are enough points.

\begin{lemma}
\label{lemma-points-proetale}
Let $S$ be a scheme. The pro-\'etale sites $\Sch_\proetale$,
$S_\proetale$, $(\Sch/S)_\proetale$, $S_{affine, \proetale}$, and
$(\textit{Aff}/S)_\proetale$ have enough points.
\end{lemma}

\begin{proof}
The big pro-\'etale topos of $S$ is equivalent to the topos defined by
$(\textit{Aff}/S)_\proetale$, see
Lemma \ref{lemma-affine-big-site-proetale}.
The topos of sheaves on $S_\proetale$ is equivalent to the topos
associated to $S_{affine, \proetale}$, see
Lemma \ref{lemma-alternative}.
The result for the sites $(\textit{Aff}/S)_\proetale$ and
$S_{affine, \proetale}$ follows immediately from Deligne's result
Sites, Lemma \ref{sites-lemma-criterion-points}.
The case $\Sch_\proetale$ is handled because it is equal to
$(\Sch/\Spec(\mathbf{Z}))_\proetale$.
\end{proof}

\noindent
Let $S$ be a scheme. Let $\overline{s} : \Spec(k) \to S$ be a geometric
point. We define a {\it pro-\'etale neighbourhood} of $\overline{s}$
to be a commutative diagram
$$
\xymatrix{
\Spec(k) \ar[r]_-{\overline{u}} \ar[rd]_{\overline{s}} & U \ar[d] \\
& S
}
$$
with $U \to S$ weakly \'etale.

\begin{lemma}
\label{lemma-cofinal-etale}
Let $S$ be a scheme and let $\overline{s} : \Spec(k) \to S$ be a
geometric point. The category of pro-\'etale neighbourhoods of
$\overline{s}$ is cofiltered.
\end{lemma}

\begin{proof}
The proof is identitical to the proof of
\'Etale Cohomology, Lemma \ref{etale-cohomology-lemma-cofinal-etale}
but using the corresponding facts about weakly \'etale morphisms
proven in
More on Morphisms, Lemmas
\ref{more-morphisms-lemma-composition-weakly-etale},
\ref{more-morphisms-lemma-base-change-weakly-etale}, and
\ref{more-morphisms-lemma-weakly-etale-permanence}.
\end{proof}

\begin{lemma}
\label{lemma-geometric-lift-to-cover}
Let $S$ be a scheme. Let $\overline{s}$ be a geometric point of $S$.
Let $\mathcal{U} = \{\varphi_i : S_i \to S\}_{i\in I}$ be a
pro-\'etale covering. Then there exist $i \in I$ and geometric
point $\overline{s}_i$ of $S_i$ mapping to $\overline{s}$.
\end{lemma}

\begin{proof}
Immediate from the fact that $\coprod \varphi_i$ is surjective
and that residue field extensions induced by weakly \'etale
morphisms are separable algebraic (see for example
More on Morphisms, Lemma
\ref{more-morphisms-lemma-weakly-etale-strictly-henselian-local-rings}.
\end{proof}

\noindent
Let $S$ be a scheme and let $\overline{s}$ be a geometric point of $S$.
For $\mathcal{F}$ in $\Sh(S_\proetale)$ define the
{\it stalk of $\mathcal{F}$ at $\overline{s}$} by the formula
$$
\mathcal{F}_{\overline{s}} = \colim_{(U, \overline{u})} \mathcal{F}(U)
$$
where the colimit is over all pro-\'etale neighbourhoods $(U, \overline{u})$
of $\overline{s}$ with $U \in \Ob(S_\proetale)$. It follows from the
two lemmas above that the functor
$$
S_\proetale \textit{Sets},\quad
U \longmapsto
\{\overline{u}\text{ geometric point of }U\text{ mapping to }\overline{s}\}
$$
defines a point of the site $S_\proetale$, see
Sites, Definition \ref{sites-definition-point} and
Lemma \ref{sites-lemma-neighbourhoods-cofiltered}.
Hence the functor $\mathcal{F} \mapsto \mathcal{F}_{\overline{s}}$
defines a point of the topos $\Sh(S_\proetale)$, see
Sites, Definition \ref{sites-definition-point-topos} and
Lemma \ref{sites-lemma-point-site-topos}. In particular this
functor is exact and commutes with arbitrary colimits.
In fact, this functor has another description.

\begin{lemma}
\label{lemma-classical-point}
In the situation above the scheme $\Spec(\mathcal{O}_{S, \overline{s}}^{sh})$
is an object of $X_\proetale$ and there is a canonical isomorphism
$$
\mathcal{F}(\Spec(\mathcal{O}_{S, \overline{s}}^{sh})) =
\mathcal{F}_{\overline{s}}
$$
functorial in $\mathcal{F}$.
\end{lemma}

\begin{proof}
The first statement is clear from the construction of the strict henselization
as a filtered colimit of \'etale algebras over $S$, or by the characterization
of weakly \'etale morphisms of
More on Morphisms, Lemma
\ref{more-morphisms-lemma-weakly-etale-strictly-henselian-local-rings}.
The second statement follows as by Olivier's theorem
(More on Algebra, Theorem \ref{more-algebra-theorem-olivier})
the scheme $\Spec(\mathcal{O}_{S, \overline{s}}^{sh})$
is an initial object of the category of pro-\'etale neighbourhoods
of $\overline{s}$.
\end{proof}

\noindent
Contrary to the situation with the \'etale topos of $S$ it is not true
that every point of $\Sh(S_\proetale)$ is of this form, and it is not
true that the collection of points associated to geometric points is
conservative. Namely, suppose that $S = \Spec(k)$ where $k$ is an
algebraically closed field. Let $A$ be a nonzero abelian group.
Consider the sheaf $\mathcal{F}$ on $S_\proetale$ defined by the
$$
\mathcal{F}(U) =
\frac{\{\text{functions }U \to A\}}{\{\text{locally constant functions}\}}
$$
for $U$ affine and by sheafification in general, see
Example \ref{example-functions-mod-locally-constant-functions}.
Then $\mathcal{F}(U) = 0$ if $U = S = \Spec(k)$ but in general $\mathcal{F}$
is not zero. Namely, $S_\proetale$ contains affine objects
with infinitely many points. For example, let $E = \lim E_n$
be an inverse limit of finite sets with surjective transition maps,
e.g., $E = \mathbf{Z}_p = \lim \mathbf{Z}/p^n\mathbf{Z}$. The scheme
$U = \Spec(\colim \text{Map}(E_n, k))$ is an object of $S_\proetale$
because $\colim \text{Map}(E_n, k)$ is weakly \'etale (even ind-Zariski)
over $k$. Thus $\mathcal{F}(U)$ is nonzero as there exist maps $E \to A$
which aren't locally constant.
Thus $\mathcal{F}$ is a nonzero abelian sheaf whose stalk at the
unique geometric point of $S$ is zero. Since we know that $S_\proetale$
has enough points, we conclude there must be a point of the pro-\'etale
site which does not come from the construction explained above.

\medskip\noindent
The replacement for arguments using points, is to use affine
weakly contractible objects.
First, there are enough affine weakly contractible objects by
Lemma \ref{lemma-proetale-enough-w-contractible}.
Second, if $W \in \Ob(S_\proetale)$ is affine weakly contractible,
then the functor
$$
\Sh(S_\proetale) \longrightarrow \textit{Sets},\quad
\mathcal{F} \longmapsto \mathcal{F}(W)
$$
is an exact functor $\Sh(S_\proetale) \to \textit{Sets}$ which commutes
with all limits. The functor
$$
\textit{Ab}(S_\proetale) \longrightarrow \textit{Ab},\quad
\mathcal{F} \longmapsto \mathcal{F}(W)
$$
is exact and commutes with direct sums (as $W$ is quasi-compact, see
Sites, Lemma \ref{sites-lemma-directed-colimits-sections}), hence
commutes with all limits and colimits. Moreover, we can check exactness of
a complex of abelian sheaves by evaluation at these affine
weakly contractible objects of $S_\proetale$, see
Cohomology on Sites, Proposition
\ref{sites-cohomology-proposition-enough-weakly-contractibles}.

\medskip\noindent
A final remark is that the functor $\mathcal{F} \mapsto \mathcal{F}(W)$
for $W$ affine weakly contractible in general isn't a stalk functor of a
point of $S_\proetale$ because it doesn't preserve coproducts of sheaves of
sets if $W$ is disconnected. And in fact, $W$ is disconnected as soon as $W$
has more than $1$ closed point, i.e., when $W$ is not the spectrum of a
strictly henselian local ring (which is the special case discussed above).





\section{Comparison with the \'etale site}
\label{section-comparison}

\noindent
Let $X$ be a scheme. With suitable choices of sites\footnote{Choose
a big pro-\'etale site $\Sch_\proetale$ containing $X$ as in
Definition \ref{definition-big-proetale-site}. Then let $\Sch_\etale$
be the site having the same underlying category as $\Sch_\proetale$ but
whose coverings are exactly those pro-\'etale coverings which are also
\'etale coverings. With these choices let $X_\etale$ and $X_\proetale$
be the subcategories defined in
Definition \ref{definition-big-small-proetale} and
Topologies, Definition \ref{topologies-definition-big-small-etale}.
Compare with
Topologies, Remark \ref{topologies-remark-choice-sites}.}
the functor $u : X_\etale \to X_\proetale$ sending
$U/X$ to $U/X$ defines a morphism of sites
$$
\epsilon : X_\proetale \longrightarrow X_\etale
$$
This follows from Sites, Proposition \ref{sites-proposition-get-morphism}.
A fundamental fact about this comparison morphism is the following.

\begin{lemma}
\label{lemma-limit-pullback}
Let $X$ be a scheme. Let $Y = \lim Y_i$ be the limit of a directed inverse
system of quasi-compact and quasi-separated objects of $X_\proetale$
with affine transition morphisms. For any sheaf $\mathcal{F}$
on $X_\etale$ we have
$\epsilon^{-1}\mathcal{F}(Y) = \colim \mathcal{F}(Y_i)$.
\end{lemma}

\begin{proof}
Let $\mathcal{F} = h_U$ be a representable sheaf on $X_\etale$
with $U$ an object of $X_\etale$. In this case
$\epsilon^{-1}h_U = h_{u(U)}$ where $u(U)$ is $U$ viewed as an object of
$X_\proetale$ (Sites, Lemma \ref{sites-lemma-pullback-representable-sheaf}).
Then
\begin{align*}
(\epsilon^{-1}h_U)(Y)
& = h_{u(U)}(Y) \\
& = \Mor_X(Y, U) \\
& = \colim \Mor_X(Y_i, U) \\
& = \colim h_U(Y_i)
\end{align*}
Here the only nonformal equality is the $3$rd which holds
by Limits, Proposition
\ref{limits-proposition-characterize-locally-finite-presentation}.
Hence the lemma holds for every representable sheaf. Since every sheaf
is a coequalizer of a map of coproducts of representable sheaves
(Sites, Lemma \ref{sites-lemma-sheaf-coequalizer-representable})
we obtain the result in general.
\end{proof}

\begin{lemma}
\label{lemma-fully-faithful}
Let $X$ be a scheme. For every sheaf $\mathcal{F}$ on $X_\etale$
the adjunction map $\mathcal{F} \to \epsilon_*\epsilon^{-1}\mathcal{F}$ is an
isomorphism.
\end{lemma}

\begin{proof}
Suppose that $U$ is a quasi-compact and quasi-separated scheme \'etale
over $X$. Then
$$
\epsilon_*\epsilon^{-1}\mathcal{F}(U) =
\epsilon^{-1}\mathcal{F}(U) =
\mathcal{F}(U)
$$
the second equality by (a special case of) Lemma \ref{lemma-limit-pullback}.
Since every object of $X_\etale$
has a covering by quasi-compact and quasi-separated objects we conclude.
\end{proof}

\begin{lemma}
\label{lemma-affine-vanishing}
Let $X$ be an affine scheme. For injective abelian sheaf $\mathcal{I}$ on
$X_\etale$ we have $H^p(X_\proetale, \epsilon^{-1}\mathcal{I}) = 0$
for $p > 0$.
\end{lemma}

\begin{proof}
We are going to use
Cohomology on Sites, Lemma \ref{sites-cohomology-lemma-cech-vanish-collection}
to prove this. Let $\mathcal{B} \subset \Ob(X_\proetale)$ be the set of affine
objects $U$ of $X_\proetale$ such that $\mathcal{O}(X) \to \mathcal{O}(U)$ is
ind-\'etale. Let $\text{Cov}$ be the set of pro-\'etale coverings
$\{U_i \to U\}_{i = 1, \ldots, n}$ with $U \in \mathcal{B}$ such that
$\mathcal{O}(U) \to \mathcal{O}(U_i)$ is ind-\'etale for $i = 1, \ldots, n$.
Properties (1) and (2) of
Cohomology on Sites, Lemma \ref{sites-cohomology-lemma-cech-vanish-collection}
hold for $\mathcal{B}$ and $\text{Cov}$ by
Lemmas \ref{lemma-composition-ind-etale},
\ref{lemma-base-change-ind-etale}, and
\ref{lemma-proetale-affine} and
Proposition \ref{proposition-weakly-etale}.

\medskip\noindent
To check condition (3) suppose that
$\mathcal{U} = \{U_i \to U\}_{i = 1, \ldots, n}$
is an element of $\text{Cov}$. We have to show that the higher
Cech cohomology groups of $\epsilon^{-1}\mathcal{I}$
with respect to $\mathcal{U}$ are zero.
First we write $U_i = \lim_{a \in A_i} U_{i, a}$ as a directed inverse limit
with $U_{i, a} \to U$ \'etale and $U_{i, a}$ affine.
We think of $A_1 \times \ldots \times A_n$ as a direct set
with ordering $(a_1, \ldots, a_n) \geq (a_1', \ldots, a_n')$
if and only if $a_i \geq a_i'$ for $i = 1, \ldots, n$.
Observe that
$\mathcal{U}_{(a_1, \ldots, a_n)} = \{U_{i, a_i} \to U\}_{i = 1, \ldots, n}$
is an \'etale covering for all
$a_1, \ldots, a_n \in A_1 \times \ldots \times A_n$.
Observe that
$$
U_{i_0} \times_U U_{i_1} \times_U \ldots \times_U U_{i_p}
=
\lim_{(a_1, \ldots, a_n) \in A_1 \times \ldots \times A_n}
U_{i_0, a_{i_0}} \times_U
U_{i_1, a_{i_1}} \times_U \ldots \times_U U_{i_p, a_{i_p}}
$$
for all $i_0, \ldots, i_p \in \{1, \ldots, n\}$ because limits
commute with fibred products. Hence by Lemma \ref{lemma-limit-pullback}
and exactness of filtered colimits we have
$$
\check{H}^p(\mathcal{U}, \epsilon^{-1}\mathcal{I}) =
\colim \check{H}^p(\mathcal{U}_{(a_1, \ldots, a_n)}, \epsilon^{-1}\mathcal{I}) 
$$
Thus it suffices to prove the vanishing for \'etale coverings
of $U$!

\medskip\noindent
Let $\mathcal{U} = \{U_i \to U\}_{i = 1, \ldots, n}$ be an \'etale covering
with $U_i$ affine. Write $U = \lim_{b \in B} U_b$ as a directed inverse limit
with $U_b$ affine and $U_b \to X$ \'etale.
By Limits, Lemmas \ref{limits-lemma-descend-finite-presentation},
\ref{limits-lemma-limit-affine}, and
\ref{limits-lemma-descend-etale}
we can choose a $b_0 \in B$ such that for $i = 1, \ldots, n$ there is an
\'etale morphism $U_{i, b_0} \to U_{b_0}$ of affines
such that $U_i = U \times_{U_{b_0}} U_{i, b_0}$.
Set $U_{i, b} = U_b \times_{U_{b_0}} U_{i, b_0}$ for $b \geq b_0$.
For $b$ large enough the family
$\mathcal{U}_b = \{U_{i, b} \to U_b\}_{i = 1, \ldots, n}$
is an \'etale covering, see
Limits, Lemma \ref{limits-lemma-descend-surjective}.
Exactly as before we find that
$$
\check{H}^p(\mathcal{U}, \epsilon^{-1}\mathcal{I}) =
\colim \check{H}^p(\mathcal{U}_b, \epsilon^{-1}\mathcal{I}) =
\colim \check{H}^p(\mathcal{U}_b, \mathcal{I})
$$
the final equality by Lemma \ref{lemma-fully-faithful}.
Since each of the {\v C}ech complexes on the right hand side is
acyclic in positive degrees
(Cohomology on Sites, Lemma
\ref{sites-cohomology-lemma-injective-trivial-cech})
it follows that the one on the left is too. This proves condition (3) of
Cohomology on Sites, Lemma \ref{sites-cohomology-lemma-cech-vanish-collection}.
Since $X \in \mathcal{B}$ the lemma follows.
\end{proof}

\begin{lemma}
\label{lemma-relative-comparison}
Let $X$ be a scheme.
\begin{enumerate}
\item For an abelian sheaf $\mathcal{F}$ on $X_\etale$
we have $R\epsilon_*(\epsilon^{-1}\mathcal{F}) = \mathcal{F}$.
\item For $K \in D^+(X_\etale)$ the map $K \to R\epsilon_*\epsilon^{-1}K$
is an isomorphism.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $\mathcal{I}$ be an injective abelian sheaf on $X_\etale$.
Recall that $R^q\epsilon_*(\epsilon^{-1}\mathcal{I})$ is the sheaf associated
to $U \mapsto H^q(U_\proetale, \epsilon^{-1}\mathcal{I})$, see
Cohomology on Sites, Lemma \ref{sites-cohomology-lemma-higher-direct-images}.
By Lemma \ref{lemma-affine-vanishing} we see that this is zero for $q > 0$
and $U$ affine and \'etale over $X$. Since every object of
$X_\etale$ has a covering by affine objects, it follows that
$R^q\epsilon_*(\epsilon^{-1}\mathcal{I}) = 0$ for $q > 0$.

\medskip\noindent
Let $K \in D^+(X_\etale)$. Choose a bounded below complex $\mathcal{I}^\bullet$
of injective abelian sheaves on $X_\etale$ representing $K$.
Then $\epsilon^{-1}K$ is represented by $\epsilon^{-1}\mathcal{I}^\bullet$.
By Leray's acyclicity lemma (Derived Categories, Lemma
\ref{derived-lemma-leray-acyclicity}) we see that $R\epsilon_*\epsilon^{-1}K$
is represented by $\epsilon_*\epsilon^{-1}\mathcal{I}^\bullet$.
By Lemma \ref{lemma-fully-faithful} we conclude that
$R\epsilon_*\epsilon^{-1}\mathcal{I}^\bullet = \mathcal{I}^\bullet$
and the proof of (2) is complete. Part (1) is a special case of (2).
\end{proof}

\begin{lemma}
\label{lemma-compare-cohomology}
Let $X$ be a scheme.
\begin{enumerate}
\item For an abelian sheaf $\mathcal{F}$ on $X_\etale$ we have
$$
H^i(X_\etale, \mathcal{F}) =
H^i(X_\proetale, \epsilon^{-1}\mathcal{F})
$$
for all $i$.
\item For $K \in D^+(X_\etale)$ we have
$$
R\Gamma(X_\etale, K) = R\Gamma(X_\proetale, \epsilon^{-1}K)
$$
\end{enumerate}
\end{lemma}

\begin{proof}
Immediate consequence of Lemma \ref{lemma-relative-comparison} and
the Leray spectral sequence (Cohomology on Sites, Lemma
\ref{sites-cohomology-lemma-apply-Leray}).
\end{proof}

\begin{lemma}
\label{lemma-compare-cohomology-nonabelian}
Let $X$ be a scheme. Let $\mathcal{G}$ be a sheaf of (possibly
noncommutative) groups on $X_\etale$. We have
$$
H^1(X_\etale, \mathcal{G}) =
H^1(X_\proetale, \epsilon^{-1}\mathcal{G})
$$
where $H^1$ is defined as the set of isomorphism classes of
torsors (see
Cohomology on Sites, Section \ref{sites-cohomology-section-h1-torsors}).
\end{lemma}

\begin{proof}
Since the functor $\epsilon^{-1}$ is fully faithful by
Lemma \ref{lemma-fully-faithful}
it is clear that the map
$H^1(X_\etale, \mathcal{G}) \to H^1(X_\proetale, \epsilon^{-1}\mathcal{G})$
is injective. To show surjectivity it suffices to show that
any $\epsilon^{-1}\mathcal{G}$-torsor $\mathcal{F}$ is \'etale
locally trivial. To do this we may assume that $X$ is affine.
Thus we reduce to proving surjectivity for $X$ affine.

\medskip\noindent
Choose a covering $\{U \to X\}$ with (a) $U$ affine, (b)
$\mathcal{O}(X) \to \mathcal{O}(U)$ ind-\'etale, and (c) $\mathcal{F}(U)$
nonempty. We can do this by Proposition \ref{proposition-weakly-etale}
and the fact that
standard pro-\'etale coverings of $X$ are cofinal among all pro-\'etale
coverings of $X$ (Lemma \ref{lemma-proetale-affine}).
Write $U = \lim U_i$ as a limit of affine schemes \'etale over $X$.
Pick $s \in \mathcal{F}(U)$. Let
$g \in \epsilon^{-1}\mathcal{G}(U \times_X U)$
be the unique section such that $g \cdot \text{pr}_1^*s = \text{pr}_2^*s$ in
$\mathcal{F}(U \times_X U)$. Then $g$ satisfies the cocycle condition
$$
\text{pr}_{12}^*g \cdot \text{pr}_{23}^*g = \text{pr}_{13}^*g
$$
in $\epsilon^{-1}\mathcal{G}(U \times_X U \times_X U)$. By
Lemma \ref{lemma-limit-pullback}
we have
$$
\epsilon^{-1}\mathcal{G}(U \times_X U) =
\colim \mathcal{G}(U_i \times_X U_i)
$$
and
$$
\epsilon^{-1}\mathcal{G}(U \times_X U \times_X U) =
\colim \mathcal{G}(U_i \times_X U_i \times_X U_i)
$$
hence we can find an $i$ and an element $g_i \in \mathcal{G}(U_i)$
mapping to $g$ satisfying the cocycle condition.
The cocycle $g_i$ then defines a torsor for $\mathcal{G}$ on
$X_\etale$ whose pullback is isomorphic to $\mathcal{F}$
by construction. Some details omitted (namely, the relationship
between torsors and 1-cocycles which should be added to the chapter
on cohomology on sites).
\end{proof}

\begin{lemma}
\label{lemma-compare-derived}
Let $X$ be a scheme. Let $\Lambda$ be a ring.
\begin{enumerate}
\item The essential image of the fully faithful functor
$\epsilon^{-1} : \textit{Mod}(X_\etale, \Lambda) \to
\textit{Mod}(X_\proetale, \Lambda)$
is a weak Serre subcategory $\mathcal{C}$.
\item The functor $\epsilon^{-1}$ defines an equivalence of categories
of $D^+(X_\etale, \Lambda)$ with $D^+_\mathcal{C}(X_\proetale, \Lambda)$
with question inverse given by $R\epsilon_*$.
\end{enumerate}
\end{lemma}

\begin{proof}
To prove (1) we will prove conditions (1) -- (4) of
Homology, Lemma \ref{homology-lemma-characterize-weak-serre-subcategory}.
Since $\epsilon^{-1}$ is fully faithful (Lemma \ref{lemma-fully-faithful})
and exact, everything is clear except for condition (4).
However, if
$$
0 \to \epsilon^{-1}\mathcal{F}_1 \to \mathcal{G} \to
\epsilon^{-1}\mathcal{F}_2 \to 0
$$
is a short exact sequence of sheaves of $\Lambda$-modules on $X_\proetale$,
then we get
$$
0 \to \epsilon_*\epsilon^{-1}\mathcal{F}_1 \to \epsilon_*\mathcal{G} \to
\epsilon_*\epsilon^{-1}\mathcal{F}_2 \to
R^1\epsilon_*\epsilon^{-1}\mathcal{F}_1
$$
which by Lemma \ref{lemma-relative-comparison}
is the same as a short exact sequence
$$
0 \to \mathcal{F}_1 \to \epsilon_*\mathcal{G} \to \mathcal{F}_2 \to 0
$$
Pulling pack we find that $\mathcal{G} = \epsilon^{-1}\epsilon_*\mathcal{G}$.
This proves (1).

\medskip\noindent
Part (2) follows from part (1) and Cohomology on Sites,
Lemma \ref{sites-cohomology-lemma-equivalence-bounded}.
\end{proof}

\noindent
Let $\Lambda$ be a ring. In
Modules on Sites, Section \ref{sites-modules-section-locally-constant}
we have defined the notion of a locally constant sheaf of $\Lambda$-modules
on a site. If $M$ is a $\Lambda$-module, then $\underline{M}$ is of finite
presentation as a sheaf of $\underline{\Lambda}$-modules if and only
if $M$ is a finitely presented $\Lambda$-module, see
Modules on Sites, Lemma \ref{sites-modules-lemma-locally-constant-finite-type}.

\begin{lemma}
\label{lemma-compare-locally-constant}
Let $X$ be a scheme. Let $\Lambda$ be a ring.
The functor $\epsilon^{-1}$ defines an equivalence of categories
$$
\left\{
\begin{matrix}
\text{locally constant sheaves}\\
\text{of }\Lambda\text{-modules on }X_\etale\\
\text{of finite presentation}
\end{matrix}
\right\}
\longleftrightarrow
\left\{
\begin{matrix}
\text{locally constant sheaves}\\
\text{of }\Lambda\text{-modules on }X_\proetale\\
\text{of finite presentation}
\end{matrix}
\right\}
$$
\end{lemma}

\begin{proof}
Let $\mathcal{F}$ be a locally constant sheaf of $\Lambda$-modules
on $X_\proetale$ of finite presentation. Choose a pro-\'etale covering
$\{U_i \to X\}$ such that $\mathcal{F}|_{U_i}$ is constant, say
$\mathcal{F}|_{U_i} \cong \underline{M_i}_{U_i}$.
Observe that $U_i \times_X U_j$ is empty if $M_i$ is not isomorphic
to $M_j$.
For each $\Lambda$-module $M$ let $I_M = \{i \in I \mid M_i \cong M\}$.
As pro-\'etale coverings are fpqc coverings and by
Descent, Lemma \ref{descent-lemma-open-fpqc-covering}
we see that $U_M = \bigcup_{i \in I_M} \Im(U_i \to X)$
is an open subset of $X$. Then $X = \coprod U_M$ is a disjoint
open covering of $X$. We may replace $X$ by $U_M$ for some $M$ and
assume that $M_i = M$ for all $i$.

\medskip\noindent
Consider the sheaf $\mathcal{I} = \mathit{Isom}(\underline{M}, \mathcal{F})$.
This sheaf is a torsor for
$\mathcal{G} = \mathit{Isom}(\underline{M}, \underline{M})$.
By Modules on Sites, Lemma \ref{sites-modules-lemma-locally-constant}
we have $\mathcal{G} = \underline{G}$
where $G = \mathit{Isom}_\Lambda(M, M)$.
Since torsors for the \'etale topology
and the pro-\'etale topology agree by
Lemma \ref{lemma-compare-cohomology-nonabelian}
it follows that $\mathcal{I}$ has sections \'etale locally on $X$.
Thus $\mathcal{F}$ is \'etale locally a constant sheaf which is
what we had to show.
\end{proof}

\begin{lemma}
\label{lemma-compare-locally-constant-derived}
Let $X$ be a scheme. Let $\Lambda$ be a Noetherian ring.
Let $D_{flc}(X_\etale, \Lambda)$, resp.\ $D_{flc}(X_\proetale, \Lambda)$
be the full subcategory of
$D(X_\etale, \Lambda)$, resp.\ $D(X_\proetale, \Lambda)$
consisting of those complexes whose cohomology sheaves are locally
constant sheaves of $\Lambda$-modules of finite type. Then
$$
\epsilon^{-1} :
D_{flc}^+(X_\etale, \Lambda)
\longrightarrow
D_{flc}^+(X_\proetale, \Lambda)
$$
is an equivalence of categories.
\end{lemma}

\begin{proof}
The categories $D_{flc}(X_\etale, \Lambda)$ and $D_{flc}(X_\proetale, \Lambda)$
are strictly full, saturated, triangulated subcategories of
$D(X_\etale, \Lambda)$ and $D(X_\proetale, \Lambda)$
by Modules on Sites, Lemma
\ref{sites-modules-lemma-kernel-finite-locally-constant}
and
Derived Categories, Section \ref{derived-section-triangulated-sub}
The statement of the lemma follows by combining
Lemmas \ref{lemma-compare-derived} and
\ref{lemma-compare-locally-constant}.
\end{proof}

\begin{lemma}
\label{lemma-compare-truncations}
Let $X$ be a scheme. Let $\Lambda$ be a Noetherian ring.
Let $K$ be an object of $D(X_\proetale, \Lambda)$.
Set $K_n = K \otimes_\Lambda^\mathbf{L} \underline{\Lambda/I^n}$.
If $K_1$ is
\begin{enumerate}
\item in the essential image of
$\epsilon^{-1} :D(X_\etale, \Lambda/I) \to D(X_\proetale, \Lambda/I)$, and
\item has tor amplitude in $[a,\infty)$ for some $a \in \mathbf{Z}$,
\end{enumerate}
then (1) and (2) hold for $K_n$ as an object of $D(X_\proetale, \Lambda/I^n)$.
\end{lemma}

\begin{proof}
For assertion (2) this follows from the more general
Cohomology on Sites, Lemma \ref{sites-cohomology-lemma-bounded}.
The second assertion follows from the fact that
the essential image of $\epsilon^{-1}$ is a triangulated
subcategory of $D^+(X_\proetale, \Lambda/I^n)$
(Lemma \ref{lemma-compare-derived}),
the distinguished triangles
$$
K \otimes_\Lambda^\mathbf{L} \underline{I^n/I^{n + 1}} \to
K_{n + 1} \to
K_n \to
K \otimes_\Lambda^\mathbf{L} \underline{I^n/I^{n + 1}}[1]
$$
and the isomorphism
$$
K \otimes_\Lambda^\mathbf{L} \underline{I^n/I^{n + 1}} =
K_1 \otimes_{\Lambda/I}^\mathbf{L} \underline{I^n/I^{n + 1}}
$$
\end{proof}

\begin{example}
\label{example-functions-mod-locally-constant-functions}
Let $X$ be a scheme. Let $A$ be an abelian group. Denote
$fun(-, A)$ the sheaf on $X_\proetale$ which maps $U$
to the set of all maps $U \to A$ (of sets of points).
Consider the sequence of sheaves
$$
0 \to \underline{A} \to fun(-, A) \to \mathcal{F} \to 0
$$
on $X_\proetale$. Since the constant sheaf is the pullback from the final
topos we see that $\underline{A} = \epsilon^{-1}\underline{A}$.
However, if $A$ has more than one element, then neither $fun(-, A)$
nor $\mathcal{F}$ are pulled back from the \'etale site of $X$.
To work out the values of $\mathcal{F}$ in some cases, assume that
all points of $X$ are closed with separably closed residue fields
and $U$ is affine. Then all points of $U$ are closed with separably
closed residue fields and we have
$$
H^1_\proetale(U, \underline{A}) =
H^1_\etale(U, \underline{A}) = 0
$$
by Lemma \ref{lemma-compare-cohomology} and
\'Etale Cohomology, Lemma
\ref{etale-cohomology-lemma-affine-only-closed-points}.
Hence in this case we have
$$
\mathcal{F}(U) = fun(U, A)/\underline{A}(U)
$$
\end{example}





\section{Derived completion in the constant Noetherian case}
\label{section-derived-completion-noetherian}

\noindent
We continue the discussion started in Algebraic and Formal Geometry, Section
\ref{algebraization-section-derived-completion};
we assume the reader has read at least some of that section.

\medskip\noindent
Let $\mathcal{C}$ be a site. Let $\Lambda$ be a Noetherian ring
and let $I \subset \Lambda$ be an ideal. Recall from
Modules on Sites, Lemma \ref{sites-modules-lemma-completion-flat}
that
$$
\underline{\Lambda}^\wedge = \lim \underline{\Lambda/I^n}
$$
is a flat $\underline{\Lambda}$-algebra and that the map
$\underline{\Lambda} \to \underline{\Lambda}^\wedge$ identifies
quotients by $I$. Hence
Algebraic and Formal Geometry, Lemma
\ref{algebraization-lemma-restriction-derived-complete-equivalence}
tells us that
$$
D_{comp}(\mathcal{C}, \Lambda) =
D_{comp}(\mathcal{C}, \underline{\Lambda}^\wedge)
$$
In particular the cohomology sheaves $H^i(K)$ of an object $K$ of
$D_{comp}(\mathcal{C}, \Lambda)$ are sheaves of
$\underline{\Lambda}^\wedge$-modules.
For notational convenience we often work with
$D_{comp}(\mathcal{C}, \Lambda)$.

\begin{lemma}
\label{lemma-naive-completion}
Let $\mathcal{C}$ be a site. Let $\Lambda$ be a Noetherian ring
and let $I \subset \Lambda$ be an ideal. The left adjoint
to the inclusion functor
$D_{comp}(\mathcal{C}, \Lambda) \to D(\mathcal{C}, \Lambda)$
of Algebraic and Formal Geometry, Proposition
\ref{algebraization-proposition-derived-completion} sends $K$ to
$$
K^\wedge = R\lim(K \otimes_\Lambda^\mathbf{L} \underline{\Lambda/I^n})
$$
In particular, $K$ is derived complete if and only if
$K = R\lim(K \otimes_\Lambda^\mathbf{L} \underline{\Lambda/I^n})$.
\end{lemma}

\begin{proof}
Choose generators $f_1, \ldots, f_r$ of $I$. By
Algebraic and Formal Geometry, Lemma
\ref{algebraization-lemma-derived-completion-koszul}
we have
$$
K^\wedge = 
R\lim (K \otimes_\Lambda^\mathbf{L} \underline{K_n})
$$
where $K_n = K(\Lambda, f_1^n, \ldots, f_r^n)$.
In More on Algebra, Lemma \ref{more-algebra-lemma-sequence-Koszul-complexes}
we have seen that the pro-systems $\{K_n\}$ and
$\{\Lambda/I^n\}$ of $D(\Lambda)$
are isomorphic. Thus the lemma follows.
\end{proof}

\begin{lemma}
\label{lemma-pushforward-Noetherian-case}
Let $\Lambda$ be a Noetherian ring. Let $I \subset \Lambda$ be an ideal.
Let $f : \Sh(\mathcal{D}) \to \Sh(\mathcal{C})$ be a morphism of topoi.
Then
\begin{enumerate}
\item $Rf_*$ sends $D_{comp}(\mathcal{D}, \Lambda)$
into $D_{comp}(\mathcal{C}, \Lambda)$,
\item the map $Rf_* : D_{comp}(\mathcal{D}, \Lambda) \to
D_{comp}(\mathcal{C}, \Lambda)$ has a left adjoint
$Lf_{comp}^* : D_{comp}(\mathcal{C}, \Lambda) \to
D_{comp}(\mathcal{D}, \Lambda)$ which is $Lf^*$ followed by
derived completion,
\item $Rf_*$ commutes with derived completion,
\item for $K$ in $D_{comp}(\mathcal{D}, \Lambda)$ we have
$Rf_*K = R\lim Rf_*(K \otimes^\mathbf{L}_\Lambda \underline{\Lambda/I^n})$.
\item for $M$ in $D_{comp}(\mathcal{C}, \Lambda)$ we have
$Lf^*_{comp}M =
R\lim Lf^*(M \otimes^\mathbf{L}_\Lambda \underline{\Lambda/I^n})$.
\end{enumerate}
\end{lemma}

\begin{proof}
We have seen (1) and (2) in
Algebraic and Formal Geometry, Lemma
\ref{algebraization-lemma-pushforward-derived-complete-adjoint}.
Part (3) follows from
Algebraic and Formal Geometry, Lemma
\ref{algebraization-lemma-pushforward-commutes-with-derived-completion}.
For (4) let $K$ be derived complete. Then
$$
Rf_*K = Rf_*( R\lim K \otimes^\mathbf{L}_\Lambda \underline{\Lambda/I^n}) =
R\lim Rf_*(K \otimes^\mathbf{L}_\Lambda \underline{\Lambda/I^n})
$$
the first equality by Lemma \ref{lemma-naive-completion}
and the second because $Rf_*$ commutes with $R\lim$
(Cohomology on Sites, Lemma
\ref{sites-cohomology-lemma-Rf-commutes-with-Rlim}). This proves (4).
To prove (5), by Lemma \ref{lemma-naive-completion} we have
$$
Lf_{comp}^*M =
R\lim ( Lf^*M \otimes_\Lambda^\mathbf{L} \underline{\Lambda/I^n})
$$
Since $Lf^*$ commutes with derived tensor product by
Cohomology on Sites, Lemma \ref{sites-cohomology-lemma-pullback-tensor-product}
and since $Lf^*\underline{\Lambda/I^n} = \underline{\Lambda/I^n}$
we get (5).
\end{proof}







\section{Derived completion and weakly contractible objects}
\label{section-derived-completion-proetale}

\noindent
We continue the discussion in
Section \ref{section-derived-completion-noetherian}.
In this section we will see how the existence of
weakly contractible objects simplifies the study
of derived complete modules.

\medskip\noindent
Let $\mathcal{C}$ be a site. Let $\Lambda$ be a Noetherian ring.
Let $I \subset \Lambda$ be an ideal. Although the general theory
concerning $D_{comp}(\mathcal{C}, \Lambda)$ is quite satisfactory
it is hard to explicitly give examples of derived complete complexes.
We know that
\begin{enumerate}
\item every object $M$ of $D(\mathcal{C}, \Lambda/I^n)$ restricts to a
derived complete object of $D(\mathcal{C}, \Lambda)$, and
\item for every $K \in D(\mathcal{C}, \Lambda)$ the derived completion
$K^\wedge = R\lim (K \otimes_\Lambda^\mathbf{L} \underline{\Lambda/I^n})$
is derived complete.
\end{enumerate}
The first type of objects are trivially complete and perhaps not
interesting. The problem with (2) is that derived completion
in general is somewhat mysterious, even in case $K = \underline{\Lambda}$.
Namely, by definition of homotopy limits there
is a distinguished triangle
$$
R\lim(\underline{\Lambda/I^n}) \to
\prod \underline{\Lambda/I^n} \to
\prod \underline{\Lambda/I^n} \to
R\lim(\underline{\Lambda/I^n})[1]
$$
in $D(\mathcal{C}, \Lambda)$ where the products are in
$D(\mathcal{C}, \Lambda)$. These are computed by taking products
of injective resolutions
(Injectives, Lemma \ref{injectives-lemma-derived-products}),
so we see that the sheaf $H^p(\prod \underline{\Lambda/I^n})$
is the sheafification of the presheaf
$$
U \longmapsto \prod H^p(U, \Lambda/I^n).
$$
As an explicit example, if $X = \Spec(\mathbf{C}[t, t^{-1}])$,
$\mathcal{C} = X_\etale$, $\Lambda = \mathbf{Z}$, $I = (2)$, and
$p = 1$, then we get the sheafification of the presheaf
$$
U \mapsto \prod H^1(U_\etale, \mathbf{Z}/2^n\mathbf{Z})
$$
for $U$ \'etale over $X$. Note that $H^1(X_\etale, \mathbf{Z}/m\mathbf{Z})$
is cyclic of order $m$ with generator $\alpha_m$ given by the finite \'etale
$\mathbf{Z}/m\mathbf{Z}$-covering given by the equation $t = s^m$
(see \'Etale Cohomology, Section \ref{etale-cohomology-section-computation}).
Then the section
$$
\alpha = (\alpha_{2^n}) \in \prod H^1(X_\etale, \mathbf{Z}/2^n\mathbf{Z})
$$
of the presheaf above does not restrict to zero on any nonempty \'etale
scheme over $X$, whence the sheaf associated to the presheaf is not zero.

\medskip\noindent
However, on the pro-\'etale site this phenomenon does not occur.
The reason is that we have enough (quasi-compact) weakly contractible objects.
In the following proposition we collect some results about derived
completion in the Noetherian constant case for sites having enough
weakly contractible objects (see
Sites, Definition \ref{sites-definition-w-contractible}).

\begin{proposition}
\label{proposition-enough-weakly-contractibles}
Let $\mathcal{C}$ be a site. Assume $\mathcal{C}$ has enough
weakly contractible objects.
Let $\Lambda$ be a Noetherian ring. Let $I \subset \Lambda$ be an ideal.
\begin{enumerate}
\item The category of derived complete sheaves $\Lambda$-modules is a
weak Serre subcategory of $\textit{Mod}(\mathcal{C}, \Lambda)$.
\item A sheaf $\mathcal{F}$ of $\Lambda$-modules satisfies
$\mathcal{F} = \lim \mathcal{F}/I^n\mathcal{F}$ if and only if
$\mathcal{F}$ is derived complete and $\bigcap I^n\mathcal{F} = 0$.
\item The sheaf $\underline{\Lambda}^\wedge$ is derived complete.
\item If $\ldots \to \mathcal{F}_3 \to \mathcal{F}_2 \to \mathcal{F}_1$
is an inverse system of derived complete sheaves of $\Lambda$-modules,
then $\lim \mathcal{F}_n$ is derived complete.
\item An object $K \in D(\mathcal{C}, \Lambda)$ is derived complete if
and only if each cohomology sheaf $H^p(K)$ is derived complete.
\item An object $K \in D_{comp}(\mathcal{C}, \Lambda)$ is bounded above
if and only if $K \otimes_\Lambda^\mathbf{L} \underline{\Lambda/I}$
is bounded above.
\item An object $K \in D_{comp}(\mathcal{C}, \Lambda)$ is bounded
if $K \otimes_\Lambda^\mathbf{L} \underline{\Lambda/I}$ has finite
tor dimension.
\end{enumerate}
\end{proposition}

\begin{proof}
Let $\mathcal{B} \subset \Ob(\mathcal{C})$ be a subset such that every
$U \in \mathcal{B}$ is weakly contractible and every object of $\mathcal{C}$
has a covering by elements of $\mathcal{B}$.
We will use the results of Cohomology on Sites,
Lemma \ref{sites-cohomology-lemma-w-contractible} and
Proposition \ref{sites-cohomology-proposition-enough-weakly-contractibles}
without further mention.

\medskip\noindent
Recall that $R\lim$ commutes with $R\Gamma(U, -)$,
see Injectives, Lemma \ref{injectives-lemma-RF-commutes-with-Rlim}.
Let $f \in I$. Recall that $T(K, f)$ is the homotopy limit
of the system
$$
\ldots \xrightarrow{f} K \xrightarrow{f} K \xrightarrow{f} K
$$
in $D(\mathcal{C}, \Lambda)$. Thus
$$
R\Gamma(U, T(K, f)) = T(R\Gamma(U, K), f).
$$
Since we can test isomorphisms of maps between objects of
$D(\mathcal{C}, \Lambda)$ by evaluating at $U \in \mathcal{B}$
we conclude an object $K$ of $D(\mathcal{C}, \Lambda)$
is derived complete if and only if for every $U \in \mathcal{B}$ the
object $R\Gamma(U, K)$ is derived complete as an object of $D(\Lambda)$.

\medskip\noindent
The remark above implies that items (1), (5) follow from the corresponding
results for modules over rings, see
More on Algebra, Lemmas \ref{more-algebra-lemma-hom-from-Af} and
\ref{more-algebra-lemma-serre-subcategory}.
In the same way (2) can be deduced from
More on Algebra, Proposition
\ref{more-algebra-proposition-derived-complete-modules}
as $(I^n\mathcal{F})(U) = I^n \cdot \mathcal{F}(U)$
for $U \in \mathcal{B}$ (by exactness of evaluating at $U$).

\medskip\noindent
Proof of (4). The homotopy limit $R\lim \mathcal{F}_n$ is in
$D_{comp}(X, \Lambda)$ (see discussion following
Algebraic and Formal Geometry, Definition
\ref{algebraization-definition-derived-complete}).
By part (5) just proved we conclude that
$\lim \mathcal{F}_n = H^0(R\lim \mathcal{F}_n)$
is derived complete.
Part (3) is a special case of (4).

\medskip\noindent
Proof of (6) and (7). Follows from
Lemma \ref{lemma-naive-completion}
and
Cohomology on Sites, Lemma \ref{sites-cohomology-lemma-bounded}
and the computation of homotopy limits in Cohomology on Sites,
Proposition \ref{sites-cohomology-proposition-enough-weakly-contractibles}.
\end{proof}






\section{Cohomology of a point}
\label{section-cohomology-point}

\noindent
Let $\Lambda$ be a Noetherian ring complete with respect to an ideal
$I \subset \Lambda$. Let $k$ be a field. In this section we ``compute''
$$
H^i(\Spec(k)_\proetale, \underline{\Lambda}^\wedge)
$$
where $\underline{\Lambda}^\wedge = \lim_m \underline{\Lambda/I^m}$ as before.
Let $k^{sep}$ be a separable algebraic closure of $k$.
Then
$$
\mathcal{U} = \{\Spec(k^{sep}) \to \Spec(k)\}
$$
is a pro-\'etale covering of $\Spec(k)$. We will use the {\v C}ech
to cohomology spectral sequence with respect to this covering.
Set $U_0 = \Spec(k^{sep})$ and
\begin{align*}
U_n & =
\Spec(k^{sep}) \times_{\Spec(k)}
\Spec(k^{sep}) \times_{\Spec(k)} \ldots
\times_{\Spec(k)} \Spec(k^{sep}) \\
& =
\Spec(k^{sep} \otimes_k k^{sep} \otimes_k \ldots \otimes_k k^{sep})
\end{align*}
($n + 1$ factors). Note that the underlying topological space
$|U_0|$ of $U_0$ is a singleton and for $n \geq 1$ we have
$$
|U_n| = G \times \ldots \times G\quad (n\text{ factors})
$$
as profinite spaces where $G = \text{Gal}(k^{sep}/k)$. Namely, every
point of $U_n$ has residue field $k^{sep}$ and we identify
$(\sigma_1, \ldots, \sigma_n)$ with the point corresponding to the
surjection
$$
k^{sep} \otimes_k k^{sep} \otimes_k \ldots \otimes_k k^{sep}
\longrightarrow k^{sep}, \quad
\lambda_0 \otimes \lambda_1 \otimes \ldots \lambda_n
\longmapsto \lambda_0 \sigma_1(\lambda_1) \ldots \sigma_n(\lambda_n)
$$
Then we compute
\begin{align*}
R\Gamma((U_n)_\proetale, \underline{\Lambda}^\wedge)
& =
R\lim_m R\Gamma((U_n)_\proetale, \underline{\Lambda/I^m}) \\
& =
R\lim_m R\Gamma((U_n)_\etale, \underline{\Lambda/I^m}) \\
& =
\lim_m H^0(U_n, \underline{\Lambda/I^m}) \\
& = 
\text{Maps}_{cont}(G \times \ldots \times G, \Lambda)
\end{align*}
The first equality because $R\Gamma$ commutes with derived limits
and as $\Lambda^\wedge$ is the derived limit of the sheaves
$\underline{\Lambda/I^m}$ by
Proposition \ref{proposition-enough-weakly-contractibles}.
The second equality by Lemma \ref{lemma-compare-cohomology}.
The third equality by \'Etale Cohomology, Lemma
\ref{etale-cohomology-lemma-affine-only-closed-points}.
The fourth equality uses
\'Etale Cohomology, Remark
\ref{etale-cohomology-remark-constant-locally-constant-maps}
to identify sections of the constant sheaf $\underline{\Lambda/I^m}$.
Then it uses the fact that $\Lambda$ is complete with respect to $I$
and hence equal to $\lim_m \Lambda/I^m$ as a topological space, to see that
$\lim_m \text{Map}_{cont}(G, \Lambda/I^m) = \text{Map}_{cont}(G, \Lambda)$
and similarly for higher powers of $G$.
At this point Cohomology on Sites, Lemmas
\ref{sites-cohomology-lemma-cech-cohomology}  and
\ref{sites-cohomology-lemma-cech-spectral-sequence-application}
tell us that
$$
\Lambda \to \text{Maps}_{cont}(G, \Lambda) \to
\text{Maps}_{cont}(G \times G, \Lambda) \to \ldots
$$
computes the pro-\'etale cohomology. In other words, we see that
$$
H^i(\Spec(k)_\proetale, \underline{\Lambda}^\wedge)
=
H^i_{cont}(G, \Lambda)
$$
where the right hand side is Tate's continuous cohomology, see
\'Etale Cohomology, Section
\ref{etale-cohomology-section-continuous-group-cohomology}.
Of course, this is as it should be.

\begin{lemma}
\label{lemma-more-general-point}
Let $k$ be a field. Let $G = \text{Gal}(k^{sep}/k)$ be its absolute
Galois group. Further, 
\begin{enumerate}
\item let $M$ be a profinite abelian group with a continuous
$G$-action, or
\item let $\Lambda$ be a Noetherian ring and $I \subset \Lambda$ an ideal
an let $M$ be an $I$-adically complete $\Lambda$-module with continuous
$G$-action.
\end{enumerate}
Then there is a canonical sheaf $\underline{M}^\wedge$ on
$\Spec(k)_\proetale$ associated to $M$ such that
$$
H^i(\Spec(k), \underline{M}^\wedge) = H^i_{cont}(G, M)
$$
as abelian groups or $\Lambda$-modules.
\end{lemma}

\begin{proof}
Proof in case (2). Set $M_n = M/I^nM$. Then $M = \lim M_n$ as $M$ is
assumed $I$-adically complete. Since the action of $G$ is continuous
we get continuous actions of $G$ on $M_n$. By \'Etale Cohomology, Theorem
\ref{etale-cohomology-theorem-equivalence-sheaves-point}
this action corresponds to a (locally constant) sheaf
$\underline{M_n}$ of $\Lambda/I^n$-modules on $\Spec(k)_\etale$.
Pull back to $\Spec(k)_\proetale$ by the comparison morphism
$\epsilon$ and take the limit
$$
\underline{M}^\wedge = \lim \epsilon^{-1}\underline{M_n}
$$
to get the sheaf promised in the lemma. Exactly the same argument as
given in the introduction of this section gives the comparison
with Tate's continuous Galois cohomology.
\end{proof}






\section{Functoriality of the pro-\'etale site}
\label{section-morphism}

\noindent
Let $f : X \to Y$ be a morphism of schemes. The functor
$Y_\proetale \to X_\proetale$, $V \mapsto X \times_Y V$
induces a morphism of sites $f_\proetale : X_\proetale \to Y_\proetale$, see
Sites, Proposition \ref{sites-proposition-get-morphism}.
In fact, we obtain a commutative diagram of morphisms of sites
$$
\xymatrix{
X_\proetale \ar[r]_\epsilon \ar[d]_{f_\proetale} &
X_\etale \ar[d]^{f_\etale} \\
Y_\proetale \ar[r]^\epsilon & Y_\etale
}
$$
where $\epsilon$ is as in Section \ref{section-comparison}.
In particular we have
$\epsilon^{-1} f_\etale^{-1} = f_\proetale^{-1} \epsilon^{-1}$.
Here is the corresponding result for pushforward.

\begin{lemma}
\label{lemma-morphism-comparison}
Let $f : X \to Y$ be a morphism of schemes.
\begin{enumerate}
\item Let $\mathcal{F}$ be a sheaf of sets on $X_\etale$. Then we have
$f_{\proetale, *}\epsilon^{-1}\mathcal{F} =
\epsilon^{-1}f_{\etale, *}\mathcal{F}$.
\item Let $\mathcal{F}$ be an abelian sheaf on $X_\etale$. Then we have
$Rf_{\proetale, *}\epsilon^{-1}\mathcal{F} =
\epsilon^{-1}Rf_{\etale, *}\mathcal{F}$.
\end{enumerate}
\end{lemma}

\begin{proof}
Proof of (1). Let $\mathcal{F}$ be a sheaf of sets on $X_\etale$. There
is a canonical map $\epsilon^{-1}f_{\etale, *}\mathcal{F} \to
f_{\proetale, *}\epsilon^{-1}\mathcal{F}$, see
Sites, Section \ref{sites-section-pullback}.
To show it is an isomorphism we may work (Zariski) locally on $Y$, hence
we may assume $Y$ is affine. In this case
every object of $Y_\proetale$ has a covering by objects $V = \lim V_i$
which are limits of affine schemes $V_i$ \'etale over $Y$ (by
Proposition \ref{proposition-weakly-etale}
for example). Evaluating the map
$\epsilon^{-1}f_{\etale, *}\mathcal{F} \to
f_{\proetale, *}\epsilon^{-1}\mathcal{F}$
on $V$ we obtain a map
$$
\colim \Gamma(X \times_Y V_i, \mathcal{F})
\longrightarrow
\Gamma(X \times_Y V, \epsilon^*\mathcal{F}).
$$
see Lemma \ref{lemma-limit-pullback} for the left hand side.
By Lemma \ref{lemma-limit-pullback} we have
$$
\Gamma(X \times_Y V, \epsilon^*\mathcal{F}) =
\Gamma(X \times_Y V, \mathcal{F})
$$
Hence the result holds by
\'Etale Cohomology, Lemma
\ref{etale-cohomology-lemma-directed-colimit-cohomology}.

\medskip\noindent
Proof of (2). Arguing in exactly the same manner as above
we see that it suffices to show that
$$
\colim H^i_\etale(X \times_Y V_i, \mathcal{F})
\longrightarrow
H^i_\etale(X \times_Y V, \mathcal{F})
$$
which follows once more from \'Etale Cohomology, Lemma
\ref{etale-cohomology-lemma-directed-colimit-cohomology}.
\end{proof}







\section{Finite morphisms and pro-\'etale sites}
\label{section-finite}

\noindent
It is not clear that a finite morphism of schemes determines
an exact pushforward on abelian pro-\'etale sheaves.

\begin{lemma}
\label{lemma-finite}
Let $f : Z \to X$ be a finite morphism of schemes which is
locally of finite presentation. Then
$f_{\proetale, *} : \textit{Ab}(Z_\proetale) \to \textit{Ab}(X_\proetale)$
is exact.
\end{lemma}

\begin{proof}
The prove this we may work (Zariski) locally on $X$ and assume that $X$
is affine, say $X = \Spec(A)$. Then $Z = \Spec(B)$ for some finite
$A$-algebra $B$ of finite presentation. The construction in the proof of
Proposition \ref{proposition-find-w-contractible}
produces a faithfully flat, ind-\'etale ring map $A \to D$
with $D$ w-contractible. We may check exactness of a sequence of
sheaves by evaluating on $U = \Spec(D)$ be such an object. Then
$f_{\proetale, *}\mathcal{F}$
evaluated at $U$ is equal to $\mathcal{F}$ evaluated at
$V = \Spec(D \otimes_A B)$. Since $D \otimes_A B$ is w-contractible
by Lemma \ref{lemma-finite-finitely-presented-over-w-contractible}
evaluation at $V$ is exact.
\end{proof}








\section{Closed immersions and pro-\'etale sites}
\label{section-closed-immersion}

\noindent
It is not clear (and likely false) that a closed immersion of schemes
determines an exact pushforward on abelian pro-\'etale sheaves.

\begin{lemma}
\label{lemma-closed-immersion-affines}
Let $i : Z \to X$ be a closed immersion morphism of affine schemes.
Denote $X_{app}$ and $Z_{app}$ the sites introduced in
Lemma \ref{lemma-affine-alternative}.
The base change functor
$$
u : X_{app} \to Z_{app},\quad U \longmapsto u(U) = U \times_X Z
$$
is continuous and has a fully faithful left adjoint $v$.
For $V$ in $Z_{app}$ the morphism $V \to v(V)$ is a closed immersion
identifying $V$ with $u(v(V)) = v(V) \times_X Z$ and every point of
$v(V)$ specializes to a point of $V$.
The functor $v$ is cocontinuous and sends coverings to coverings.
\end{lemma}

\begin{proof}
The existence of the adjoint follows immediately from
Lemma \ref{lemma-lift-ind-etale} and the definitions.
It is clear that $u$ is continuous from the definition of
coverings in $X_{app}$.

\medskip\noindent
Write $X = \Spec(A)$ and $Z = \Spec(A/I)$. Let $V = \Spec(\overline{C})$
be an object of $Z_{app}$ and let $v(V) = \Spec(C)$.
We have seen in the statement of Lemma \ref{lemma-lift-ind-etale}
that $V$ equals $v(V) \times_X Z = \Spec(C/IC)$.
Any $g \in C$ which maps to an invertible element of
$C/IC = \overline{C}$ is invertible in $C$. Namely, we have the
$A$-algebra maps $C \to C_g \to C/IC$ and by adjointness
we obtain an $C$-algebra map $C_g \to C$.
Thus every point of $v(V)$ specializes to a point of $V$.

\medskip\noindent
Suppose that $\{V_i \to V\}$ is a covering in $Z_{app}$.
Then $\{v(V_i) \to v(V)\}$ is a finite family of morphisms of
$Z_{app}$ such that every point of $V \subset v(V)$ is
in the image of one of the maps $v(V_i) \to v(V)$. As the
morphisms $v(V_i) \to v(V)$ are flat (since they are weakly \'etale)
we conclude that $\{v(V_i) \to v(V)\}$ is jointly surjective.
This proves that $v$ sends coverings to coverings.

\medskip\noindent
Let $V$ be an object of $Z_{app}$ and let $\{U_i \to v(V)\}$
be a covering in $X_{app}$. Then we see that
$\{u(U_i) \to u(v(V)) = V\}$ is a covering of $Z_{app}$.
By adjointness we obtain morphisms $v(u(U_i)) \to U_i$.
Thus the family $\{v(u(U_i)) \to v(V)\}$ refines the given
covering and we conclude that $v$ is cocontinuous.
\end{proof}

\begin{lemma}
\label{lemma-closed-immersion-affines-apply}
Let $Z \to X$ be a closed immersion morphism of affine schemes.
The corresponding morphism of topoi $i = i_\proetale$
is equal to the morphism of topoi
associated to the fully faithful cocontinuous functor
$v : Z_{app} \to X_{app}$ of Lemma \ref{lemma-closed-immersion-affines}.
It follows that
\begin{enumerate}
\item $i^{-1}\mathcal{F}$ is the sheaf associated to the presheaf
$V \mapsto \mathcal{F}(v(V))$,
\item for a weakly contractible object $V$ of $Z_{app}$ we have
$i^{-1}\mathcal{F}(V) = \mathcal{F}(v(V))$,
\item $i^{-1} : \Sh(X_\proetale) \to \Sh(Z_\proetale)$
has a left adjoint $i^{Sh}_!$,
\item $i^{-1} : \textit{Ab}(X_\proetale) \to \textit{Ab}(Z_\proetale)$
has a left adjoint $i_!$,
\item $\text{id} \to i^{-1}i^{Sh}_!$, $\text{id} \to i^{-1}i_!$, and
$i^{-1}i_* \to \text{id}$ are isomorphisms, and
\item $i_*$, $i^{Sh}_!$ and $i_!$ are fully faithful.
\end{enumerate}
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-affine-alternative} we may describe $i_\proetale$ in terms
of the morphism of sites $u : X_{app} \to Z_{app}$, $V \mapsto V \times_X Z$.
The first statement of the lemma follows from
Sites, Lemma \ref{sites-lemma-have-functor-other-way-morphism}
(but with the roles of $u$ and $v$ reversed).

\medskip\noindent
Proof of (1). By the description of $i$ as the morphism of topoi associated
to $v$ this holds by the construction, see
Sites, Lemma \ref{sites-lemma-cocontinuous-morphism-topoi}.

\medskip\noindent
Proof of (2). Since the functor $v$ sends coverings to coverings by
Lemma \ref{lemma-closed-immersion-affines} we see that the presheaf
$\mathcal{G} : V \mapsto \mathcal{F}(v(V))$ is a separated presheaf
(Sites, Definition \ref{sites-definition-separated}). Hence
the sheafification of $\mathcal{G}$ is $\mathcal{G}^+$, see
Sites, Theorem \ref{sites-theorem-plus}. Next, let $V$ be a weakly
contractible object of $Z_{app}$. Let
$\mathcal{V} = \{V_i \to V\}_{i = 1, \ldots, n}$
be any covering in $Z_{app}$. Set $\mathcal{V}' = \{\coprod V_i \to V\}$.
Since $v$ commutes with finite disjoint unions (as a left adjoint or by
the construction) and since $\mathcal{F}$ sends finite disjoint
unions into products, we see that
$$
H^0(\mathcal{V}, \mathcal{G}) = H^0(\mathcal{V}', \mathcal{G})
$$
(notation as in Sites, Section \ref{sites-section-sheafification};
compare with
\'Etale Cohomology, Lemma \ref{etale-cohomology-lemma-cech-complex}).
Thus we may assume the covering is given by a single morphism, like
so $\{V' \to V\}$. Since $V$ is weakly contractible, this covering
can be refined by the trivial covering $\{V \to V\}$.
It therefore follows that the value of $\mathcal{G}^+ = i^{-1}\mathcal{F}$
on $V$ is simply $\mathcal{F}(v(V))$ and (2) is proved.

\medskip\noindent
Proof of (3). Every object of $Z_{app}$ has a covering by weakly
contractible objects (Lemma \ref{lemma-proetale-enough-w-contractible}).
By the above we see that we would have $i^{Sh}_!h_V = h_{v(V)}$ for $V$
weakly contractible if $i^{Sh}_!$ existed. The existence of
$i^{Sh}_!$ then follows from
Sites, Lemma \ref{sites-lemma-existence-lower-shriek}.

\medskip\noindent
Proof of (4). Existence of $i_!$ follows in the same way by setting
$i_!\mathbf{Z}_V = \mathbf{Z}_{v(V)}$ for $V$ weakly contractible in $Z_{app}$,
using similar for direct sums, and applying
Homology, Lemma \ref{homology-lemma-partially-defined-adjoint}.
Details omitted.

\medskip\noindent
Proof of (5). Let $V$ be a contractible object of $Z_{app}$.
Then $i^{-1}i^{Sh}_!h_V = i^{-1}h_{v(V)} = h_{u(v(V))} = h_V$.
(It is a general fact that $i^{-1}h_U = h_{u(U)}$.) Since the
sheaves $h_V$ for $V$ contractible generate $\Sh(Z_{app})$
(Sites, Lemma \ref{sites-lemma-sheaf-coequalizer-representable})
we conclude $\text{id} \to i^{-1}i^{Sh}_!$ is an isomorphism.
Similarly for the map $\text{id} \to i^{-1}i_!$. Then
$(i^{-1}i_*\mathcal{H})(V) = i_*\mathcal{H}(v(V)) =
\mathcal{H}(u(v(V))) = \mathcal{H}(V)$ and we find that
$i^{-1}i_* \to \text{id}$ is an isomorphism.

\medskip\noindent
The fully faithfulness statements of (6) now follow from
Categories, Lemma \ref{categories-lemma-adjoint-fully-faithful}.
\end{proof}

\begin{lemma}
\label{lemma-closed-immersion}
Let $i : Z \to X$ be a closed immersion of schemes. Then
\begin{enumerate}
\item $i_\proetale^{-1}$ commutes with limits,
\item $i_{\proetale, *}$ is fully faithful, and
\item $i_\proetale^{-1}i_{\proetale, *} \cong \text{id}_{\Sh(Z_\proetale)}$.
\end{enumerate}
\end{lemma}

\begin{proof}
Assertions (2) and (3) are equivalent by
Sites, Lemma \ref{sites-lemma-exactness-properties}.
Parts (1) and (3) are (Zariski) local on $X$, hence we may assume that
$X$ is affine. In this case the result follows from
Lemma \ref{lemma-closed-immersion-affines-apply}.
\end{proof}

\begin{lemma}
\label{lemma-thickening}
Let $i : Z \to X$ be an integral universally injective and surjective morphism
of schemes. Then
$i_{\proetale, *}$ and $i_\proetale^{-1}$ are quasi-inverse
equivalences of categories of pro-\'etale topoi.
\end{lemma}

\begin{proof}
There is an immediate reduction to the case that $X$ is affine.
Then $Z$ is affine too. Set $A = \mathcal{O}(X)$ and $B = \mathcal{O}(Z)$.
Then the categories of \'etale algebras over
$A$ and $B$ are equivalent, see 
\'Etale Cohomology, Theorem
\ref{etale-cohomology-theorem-topological-invariance} and
Remark \ref{etale-cohomology-remark-affine-inside-equivalence}.
Thus the categories of ind-\'etale algebras over $A$ and $B$ are
equivalent. In other words the categories $X_{app}$ and $Z_{app}$
of Lemma \ref{lemma-affine-alternative} are equivalent.
We omit the verification
that this equivalence sends coverings to coverings and vice versa.
Thus the result as Lemma \ref{lemma-affine-alternative}
tells us the pro-\'etale topos is the topos of sheaves on $X_{app}$.
\end{proof}

\begin{lemma}
\label{lemma-compute-i-star}
Let $i : Z \to X$ be a closed immersion of schemes.
Let $U \to X$ be an object of $X_\proetale$ such that
\begin{enumerate}
\item $U$ is affine and weakly contractible, and
\item every point of $U$ specializes to a point of $U \times_X Z$.
\end{enumerate}
Then $i_\proetale^{-1}\mathcal{F}(U \times_X Z) = \mathcal{F}(U)$
for all abelian sheaves on $X_\proetale$.
\end{lemma}

\begin{proof}
Since pullback commutes with restriction, we may replace $X$ by $U$.
Thus we may assume that $X$ is affine and weakly contractible
and that every point of $X$ specializes to a point of $Z$.
By Lemma \ref{lemma-closed-immersion-affines-apply} part (1)
it suffices to show that $v(Z) = X$ in this case.
Thus we have to show: If $A$ is a w-contractible ring, $I \subset A$
an ideal contained in the Jacobson radical of $A$ and $A \to B \to A/I$
is a factorization with $A \to B$ ind-\'etale, then there is
a unique section $B \to A$ compatible with maps to $A/I$.
Observe that $B/IB = A/I \times R$ as $A/I$-algebras.
After replacing $B$ by a localization we may assume $B/IB = A/I$.
Note that $\Spec(B) \to \Spec(A)$ is surjective as the image
contains $V(I)$ and hence all closed points and is closed under
specialization. Since $A$ is w-contractible there is a section $B \to A$.
Since $B/IB = A/I$ this section is compatible with the map to $A/I$.
We omit the proof of uniqueness (hint: use that $A$ and $B$ have
isomorphic local rings at maximal ideals of $A$).
\end{proof}

\begin{lemma}
\label{lemma-closed-immersion-complement-retrocompact-exact}
Let $i : Z \to X$ be a closed immersion of schemes.
If $X \setminus i(Z)$ is a retrocompact open of $X$, then
$i_{\proetale, *}$ is exact.
\end{lemma}

\begin{proof}
The question is local on $X$ hence we may assume $X$ is affine.
Say $X = \Spec(A)$ and $Z = \Spec(A/I)$. There exist
$f_1, \ldots, f_r \in I$ such that $Z = V(f_1, \ldots, f_r)$
set theoretically, see Algebra, Lemma \ref{algebra-lemma-qc-open}.
By Lemma \ref{lemma-thickening} we may assume that
$Z = \Spec(A/(f_1, \ldots, f_r))$. In this case
the functor $i_{\proetale, *}$ is exact by
Lemma \ref{lemma-finite}.
\end{proof}





\section{Extension by zero}
\label{section-extension-by-zero}

\noindent
The general material in
Modules on Sites, Section \ref{sites-modules-section-localize}
allows us to make the following definition.

\begin{definition}
\label{definition-extension-zero}
Let $j : U \to X$ be a weakly \'etale morphism of schemes.
\begin{enumerate}
\item The restriction functor
$j^{-1} : \Sh(X_\proetale) \to \Sh(U_\proetale)$
has a left adjoint
$j_!^{Sh} : \Sh(X_\proetale) \to \Sh(U_\proetale)$.
\item The restriction functor
$j^{-1} : \textit{Ab}(X_\proetale) \to \textit{Ab}(U_\proetale)$
has a left adjoint which is denoted
$j_! : \textit{Ab}(U_\proetale) \to \textit{Ab}(X_\proetale)$
and called {\it extension by zero}.
\item Let $\Lambda$ be a ring. The functor
$j^{-1} : \textit{Mod}(X_\proetale, \Lambda) \to
\textit{Mod}(U_\proetale, \Lambda)$
has a left adjoint
$j_! : \textit{Mod}(U_\proetale, \Lambda) \to
\textit{Mod}(X_\proetale, \Lambda)$
and called {\it extension by zero}.
\end{enumerate}
\end{definition}

\noindent
As usual we compare this to what happens in the \'etale case.

\begin{lemma}
\label{lemma-jshriek-comparison}
Let $j : U \to X$ be an \'etale morphism of schemes.
Let $\mathcal{G}$ be an abelian sheaf on $U_\etale$.
Then $\epsilon^{-1} j_!\mathcal{G} = j_!\epsilon^{-1}\mathcal{G}$
as sheaves on $X_\proetale$.
\end{lemma}

\begin{proof}
This is true because both are left adjoints to
$j_{\proetale, *}\epsilon^{-1} = \epsilon^{-1}j_{\etale, *}$, see
Lemma \ref{lemma-morphism-comparison}.
\end{proof}

\begin{lemma}
\label{lemma-jshriek-zero}
Let $j : U \to X$ be a weakly \'etale morphism of schemes.
Let $i : Z \to X$ be a closed immersion such that $U \times_X Z = \emptyset$.
Let $V \to X$ be an affine object of $X_\proetale$ such that every point
of $V$ specializes to a point of $V_Z = Z \times_X V$.
Then $j_!\mathcal{F}(V) = 0$ for all abelian sheaves on $U_\proetale$.
\end{lemma}

\begin{proof}
Let $\{V_i \to V\}$ be a pro-\'etale covering. The lemma follows if we
can refine this covering to a covering where the members have no
morphisms into $U$ over $X$ (see construction of $j_!$ in
Modules on Sites, Section \ref{sites-modules-section-localize}).
First refine the covering to get a finite covering with $V_i$ affine.
For each $i$ let $V_i = \Spec(A_i)$ and let $Z_i \subset V_i$ be the
inverse image of $Z$.
Set $W_i = \Spec(A_{i, Z_i}^\sim)$ with notation as in
Lemma \ref{lemma-localization}.
Then $\coprod W_i \to V$ is weakly \'etale and the image contains all
points of $V_Z$. Hence the image contains all points of $V$ by
our assumption on specializations. Thus $\{W_i \to V\}$ is a
pro-\'etale covering refining the given one. But each point in $W_i$
specializes to a point lying over $Z$, hence there are no morphisms
$W_i \to U$ over $X$.
\end{proof}

\begin{lemma}
\label{lemma-open-immersion}
Let $j : U \to X$ be an open immersion of schemes.
Then $\text{id} \cong j^{-1}j_!$ and $j^{-1}j_* \cong \text{id}$
and the functors $j_!$ and $j_*$ are fully faithful.
\end{lemma}

\begin{proof}
See Modules on Sites, Lemma \ref{sites-modules-lemma-restrict-back}
(and Sites, Lemma \ref{sites-lemma-restrict-back} for the case
of sheaves of sets) and
Categories, Lemma \ref{categories-lemma-adjoint-fully-faithful}.
\end{proof}

\noindent
Here is the relationship between extension by zero and restriction
to the complementary closed subscheme.

\begin{lemma}
\label{lemma-ses-associated-to-open}
Let $X$ be a scheme. Let $Z \subset X$ be a closed subscheme and let
$U \subset X$ be the complement. Denote $i : Z \to X$ and $j : U \to X$
the inclusion morphisms. Assume that $j$ is a quasi-compact morphism.
For every abelian sheaf on $X_\proetale$ there is a canonical short exact
sequence
$$
0 \to j_!j^{-1}\mathcal{F} \to \mathcal{F} \to i_*i^{-1}\mathcal{F} \to 0
$$
on $X_\proetale$ where all the functors are for the pro-\'etale topology.
\end{lemma}

\begin{proof}
We obtain the maps by the adjointness properties of the functors involved.
It suffices to show that $X_\proetale$ has enough objects
(Sites, Definition \ref{sites-definition-w-contractible}) on which
the sequence evaluates to a short exact sequence.
Let $V = \Spec(A)$ be an affine object of $X_\proetale$
such that $A$ is w-contractible (there are enough objects of this type).
Then $V \times_X Z$ is cut out by an ideal $I \subset A$.
The assumption that $j$ is quasi-compact implies there exist
$f_1, \ldots, f_r \in I$ such that $V(I) = V(f_1, \ldots, f_r)$.
We obtain a faithfully flat, ind-Zariski ring map
$$
A \longrightarrow A_{f_1} \times \ldots \times A_{f_r} \times
A_{V(I)}^\sim
$$
with $A_{V(I)}^\sim$ as in Lemma \ref{lemma-localization}.
Since $V_i = \Spec(A_{f_i}) \to X$ factors through $U$ we have
$$
j_!j^{-1}\mathcal{F}(V_i) = \mathcal{F}(V_i)
\quad\text{and}\quad
i_*i^{-1}\mathcal{F}(V_i) = 0
$$
On the other hand, for the scheme $V^\sim = \Spec(A_{V(I)}^\sim)$
we have
$$
j_!j^{-1}\mathcal{F}(V^\sim) = 0
\quad\text{and}\quad
\mathcal{F}(V^\sim) = i_*i^{-1}\mathcal{F}(V^\sim)
$$
the first equality by Lemma \ref{lemma-jshriek-zero}
and the second by
Lemmas \ref{lemma-compute-i-star} and \ref{lemma-localization-w-contractible}.
Thus the sequence evaluates to an exact sequence on
$\Spec(A_{f_1} \times \ldots \times A_{f_r} \times A_{V(I)}^\sim)$
and the lemma is proved.
\end{proof}

\begin{lemma}
\label{lemma-j-shriek-limits}
Let $j : U \to X$ be a quasi-compact open immersion
morphism of schemes. The functor
$j_! : \textit{Ab}(U_\proetale) \to \textit{Ab}(X_\proetale)$
commutes with limits.
\end{lemma}

\begin{proof}
Since $j_!$ is exact it suffices to show that $j_!$ commutes with products.
The question is local on $X$, hence we may assume $X$ affine.
Let $\mathcal{G}$ be an abelian sheaf on $U_\proetale$.
We have $j^{-1}j_*\mathcal{G} = \mathcal{G}$. Hence applying
the exact sequence of Lemma \ref{lemma-ses-associated-to-open}
we get
$$
0 \to j_!\mathcal{G} \to j_*\mathcal{G} \to i_*i^{-1}j_*\mathcal{G} \to 0
$$
where $i : Z \to X$ is the inclusion of the reduced induced scheme
structure on the complement $Z = X \setminus U$.
The functors $j_*$ and $i_*$ commute with products as right adjoints.
The functor $i^{-1}$ commutes with products by
Lemma \ref{lemma-closed-immersion}.
Hence $j_!$ does because on the pro-\'etale site products
are exact
(Cohomology on Sites, Proposition
\ref{sites-cohomology-proposition-enough-weakly-contractibles}).
\end{proof}




\section{Constructible sheaves on the pro-\'etale site}
\label{section-constructible}

\noindent
We stick to constructible sheaves of $\Lambda$-modules for a
Noetherian ring. In the future we intend to discuss constructible
sheaves of sets, groups, etc.

\begin{definition}
\label{definition-constructible}
Let $X$ be a scheme.
Let $\Lambda$ be a Noetherian ring. A sheaf of $\Lambda$-modules
on $X_\proetale$ is {\it constructible} if for every affine open
$U \subset X$ there exists a finite decomposition
of $U$ into constructible locally closed subschemes
$U = \coprod_i U_i$ such that
$\mathcal{F}|_{U_i}$ is of finite type and locally constant for all $i$.
\end{definition}

\noindent
Again this does not give anything ``new''.

\begin{lemma}
\label{lemma-compare-constructible}
Let $X$ be a scheme. Let $\Lambda$ be a Noetherian ring.
The functor $\epsilon^{-1}$ defines an equivalence of categories
$$
\left\{
\begin{matrix}
\text{constructible sheaves of}\\
\Lambda\text{-modules on }X_\etale\\
\end{matrix}
\right\}
\longleftrightarrow
\left\{
\begin{matrix}
\text{constructible sheaves of}\\
\Lambda\text{-modules on }X_\proetale\\
\end{matrix}
\right\}
$$
between constructible sheaves of $\Lambda$-modules on $X_\etale$
and constructible sheaves of $\Lambda$-modules on $X_\proetale$.
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-fully-faithful} the functor $\epsilon^{-1}$
is fully faithful and commutes with pullback (restriction) to
the strata. Hence $\epsilon^{-1}$ of a constructible \'etale
sheaf is a constructible pro-\'etale sheaf. To finish the
proof let $\mathcal{F}$ be a constructible sheaf of $\Lambda$-modules
on $X_\proetale$ as in Definition \ref{definition-constructible}.
There is a canonical map
$$
\epsilon^{-1}\epsilon_*\mathcal{F} \longrightarrow \mathcal{F}
$$
We will show this map is an isomorphism. This will prove that
$\mathcal{F}$ is in the essential image of $\epsilon^{-1}$
and finish the proof (details omitted).

\medskip\noindent
To prove this we may assume that $X$ is affine. In this case we have
a finite partition $X = \coprod_i X_i$ by constructible locally closed
strata such that $\mathcal{F}|_{X_i}$ is locally constant of finite
type. Let $U \subset X$ be one of the open strata in the partition
and let $Z \subset X$ be the reduced induced structure on the complement.
By Lemma \ref{lemma-ses-associated-to-open}
we have a short exact sequence
$$
0 \to j_!j^{-1}\mathcal{F} \to \mathcal{F} \to i_*i^{-1}\mathcal{F} \to 0
$$
on $X_\proetale$. Functoriality gives a commutative diagram
$$
\xymatrix{
0 \ar[r] &
\epsilon^{-1}\epsilon_*j_!j^{-1}\mathcal{F} \ar[r] \ar[d] &
\epsilon^{-1}\epsilon_*\mathcal{F} \ar[r] \ar[d] &
\epsilon^{-1}\epsilon_*i_*i^{-1}\mathcal{F} \ar[r] \ar[d] & 0 \\
0 \ar[r] &
j_!j^{-1}\mathcal{F} \ar[r] &
\mathcal{F} \ar[r] &
i_*i^{-1}\mathcal{F} \ar[r] & 0
}
$$
By induction on the length of the partition we know that
on the one hand
$\epsilon^{-1}\epsilon_*i^{-1}\mathcal{F} \to i^{-1}\mathcal{F}$
and
$\epsilon^{-1}\epsilon_*j^{-1}\mathcal{F} \to j^{-1}\mathcal{F}$
are isomorphisms and on the other that
$i^{-1}\mathcal{F} = \epsilon^{-1}\mathcal{A}$
and
$j^{-1}\mathcal{F} = \epsilon^{-1}\mathcal{B}$
for some constructible sheaves of $\Lambda$-modules
$\mathcal{A}$ on $Z_\etale$ and $\mathcal{B}$ on $U_\etale$.
Then
$$
\epsilon^{-1}\epsilon_*j_!j^{-1}\mathcal{F} =
\epsilon^{-1}\epsilon_*j_!\epsilon^{-1}\mathcal{B} =
\epsilon^{-1}\epsilon_*\epsilon^{-1}j_!\mathcal{B} =
\epsilon^{-1}j_!\mathcal{B} =
j_!\epsilon^{-1}\mathcal{B} =
j_!j^{-1}\mathcal{F}
$$
the second equality by Lemma \ref{lemma-jshriek-comparison},
the third equality by Lemma \ref{lemma-fully-faithful}, and the
fourth equality by Lemma \ref{lemma-jshriek-comparison} again.
Similarly, we have
$$
\epsilon^{-1}\epsilon_*i_*i^{-1}\mathcal{F} =
\epsilon^{-1}\epsilon_*i_*\epsilon^{-1}\mathcal{A} =
\epsilon^{-1}\epsilon_*\epsilon^{-1}i_*\mathcal{A} =
\epsilon^{-1}i_*\mathcal{A} =
i_*\epsilon^{-1}\mathcal{A} =
i_*i^{-1}\mathcal{F}
$$
this time using Lemma \ref{lemma-morphism-comparison}.
By the five lemma we conclude the
vertical map in the middle of the big diagram is an isomorphism.
\end{proof}

\begin{lemma}
\label{lemma-constructible-serre}
Let $X$ be a scheme. Let $\Lambda$ be a Noetherian ring.
The category of constructible sheaves of $\Lambda$-modules on $X_\proetale$
is a weak Serre subcategory of $\textit{Mod}(X_\proetale, \Lambda)$.
\end{lemma}

\begin{proof}
This is a formal consequence of
Lemmas \ref{lemma-compare-constructible} and \ref{lemma-compare-derived}
and the result for the \'etale site
(\'Etale Cohomology, Lemma \ref{etale-cohomology-lemma-constructible-abelian}).
\end{proof}

\begin{lemma}
\label{lemma-compare-constructible-derived}
Let $X$ be a scheme. Let $\Lambda$ be a Noetherian ring.
Let $D_c(X_\etale, \Lambda)$, resp.\ $D_c(X_\proetale, \Lambda)$
be the full subcategory of
$D(X_\etale, \Lambda)$, resp.\ $D(X_\proetale, \Lambda)$
consisting of those complexes whose cohomology sheaves are
constructible sheaves of $\Lambda$-modules. Then
$$
\epsilon^{-1} :
D_c^+(X_\etale, \Lambda)
\longrightarrow
D_c^+(X_\proetale, \Lambda)
$$
is an equivalence of categories.
\end{lemma}

\begin{proof}
The categories $D_c(X_\etale, \Lambda)$ and $D_c(X_\proetale, \Lambda)$
are strictly full, saturated, triangulated subcategories of
$D(X_\etale, \Lambda)$ and $D(X_\proetale, \Lambda)$ by
\'Etale Cohomology, Lemma \ref{etale-cohomology-lemma-constructible-abelian}
and
Lemma \ref{lemma-constructible-serre}
and
Derived Categories, Section \ref{derived-section-triangulated-sub}.
The statement of the lemma follows by combining
Lemmas \ref{lemma-compare-derived} and
\ref{lemma-compare-constructible}.
\end{proof}

\begin{lemma}
\label{lemma-tensor-c}
Let $X$ be a scheme. Let $\Lambda$ be a Noetherian ring.
Let $K, L \in D_c^-(X_\proetale, \Lambda)$. Then
$K \otimes_\Lambda^\mathbf{L} L$ is in $D_c^-(X_\proetale, \Lambda)$.
\end{lemma}

\begin{proof}
Note that $H^i(K \otimes_\Lambda^\mathbf{L} L)$ is the same as
$H^i(\tau_{\geq i - 1}K \otimes_\Lambda^\mathbf{L} \tau_{\geq i - 1}L)$.
Thus we may assume $K$ and $L$ are bounded.
In this case we can apply Lemma \ref{lemma-compare-constructible-derived} to
reduce to the case of the \'etale site, see
\'Etale Cohomology, Lemma \ref{etale-cohomology-lemma-tensor-c}.
\end{proof}

\begin{lemma}
\label{lemma-compare-truncations-constructible}
Let $X$ be a scheme. Let $\Lambda$ be a Noetherian ring.
Let $K$ be an object of $D(X_\proetale, \Lambda)$.
Set $K_n = K \otimes_\Lambda^\mathbf{L} \underline{\Lambda/I^n}$.
If $K_1$ is in $D^-_c(X_\proetale, \Lambda/I)$, then
$K_n$ is in $D^-_c(X_\proetale, \Lambda/I^n)$ for all $n$.
\end{lemma}

\begin{proof}
Consider the distinguished triangles
$$
K \otimes_\Lambda^\mathbf{L} \underline{I^n/I^{n + 1}} \to
K_{n + 1} \to
K_n \to
K \otimes_\Lambda^\mathbf{L} \underline{I^n/I^{n + 1}}[1]
$$
and the isomorphisms
$$
K \otimes_\Lambda^\mathbf{L} \underline{I^n/I^{n + 1}} =
K_1 \otimes_{\Lambda/I}^\mathbf{L} \underline{I^n/I^{n + 1}}
$$
By Lemma \ref{lemma-tensor-c} we see that this tensor product has
constructible cohomology sheaves (and vanishing when $K_1$ has
vanishing cohomology). Hence by induction on $n$ using
Lemma \ref{lemma-constructible-serre}
we see that each $K_n$ has constructible cohomology sheaves.
\end{proof}








\section{Constructible adic sheaves}
\label{section-adic}

\noindent
In this section we define the notion of a constructible
$\Lambda$-sheaf as well as some variants.

\begin{definition}
\label{definition-adic}
Let $\Lambda$ be a Noetherian ring and let $I \subset \Lambda$ be an ideal.
Let $X$ be a scheme. Let $\mathcal{F}$ be a sheaf of $\Lambda$-modules
on $X_\proetale$.
\begin{enumerate}
\item We say $\mathcal{F}$ is a {\it constructible $\Lambda$-sheaf}
if $\mathcal{F} = \lim \mathcal{F}/I^n\mathcal{F}$ and each
$\mathcal{F}/I^n\mathcal{F}$ is a constructible sheaf of $\Lambda/I^n$-modules.
\item If $\mathcal{F}$ is a constructible $\Lambda$-sheaf, then we say
$\mathcal{F}$ is {\it lisse} if each $\mathcal{F}/I^n\mathcal{F}$ is
locally constant.
\item We say $\mathcal{F}$ is {\it adic lisse}\footnote{This may
be nonstandard notation.} if there exists a
$I$-adically complete $\Lambda$-module $M$ with $M/IM$ finite
such that $\mathcal{F}$ is locally isomorphic to
$$
\underline{M}^\wedge = \lim \underline{M/I^nM}.
$$
\item We say $\mathcal{F}$ is
{\it adic constructible}\footnote{This may be nonstandard notation.}
if for every affine open $U \subset X$
there exists a decomposition $U = \coprod U_i$ into
constructible locally closed subschemes such that $\mathcal{F}|_{U_i}$
is adic lisse.
\end{enumerate}
\end{definition}

\noindent
The definition of a constructible $\Lambda$-sheaf is equivalent
to the one in \cite[Expos\'e VI, Definition 1.1.1]{SGA5} when
$\Lambda = \mathbf{Z}_\ell$ and $I = (\ell)$. It is clear that
we have the implications
$$
\xymatrix{
\text{lisse adic} \ar@{=>}[r] \ar@{=>}[d] &
\text{adic constructible} \ar@{=>}[d] \\
\text{lisse constructible }\Lambda\text{-sheaf} \ar@{=>}[r] &
\text{constructible }\Lambda\text{-sheaf}
}
$$
The vertical arrows can be inverted in some cases
(see Lemmas \ref{lemma-Noetherian-constructible} and
\ref{lemma-Noetherian-adic-constructible}). In general
neither the category of adic constructible sheaves nor
the category of adic constructible sheaves is closed
under kernels and cokernels.

\medskip\noindent
Namely, let $X$ be an affine scheme whose underlying topological space $|X|$
is homeomorphic to $\Lambda = \mathbf{Z}_\ell$, see
Example \ref{example-construct-space}. Denote
$f : |X| \to \mathbf{Z}_\ell = \Lambda$
a homeomorphism. We can think of $f$ as a section of
$\underline{\Lambda}^\wedge$ over $X$ and multiplication by $f$
then defines a two term complex
$$
\underline{\Lambda}^\wedge \xrightarrow{f} \underline{\Lambda}^\wedge
$$
on $X_\proetale$. The sheaf $\underline{\Lambda}^\wedge$ is adic lisse.
However, the cokernel of the map above, is not adic constructible, as
the isomorphism type of the stalks of this cokernel attains infinitely
many values: $\mathbf{Z}/\ell^n\mathbf{Z}$ and $\mathbf{Z}_\ell$.
The cokernel is a constructible $\mathbf{Z}_\ell$-sheaf.
However, the kernel is not even a constructible $\mathbf{Z}_\ell$-sheaf
as it is zero a non-quasi-compact open but not zero.

\begin{lemma}
\label{lemma-Noetherian-constructible}
Let $X$ be a Noetherian scheme. Let $\Lambda$ be a Noetherian ring and
let $I \subset \Lambda$ be an ideal. Let $\mathcal{F}$ be a
constructible $\Lambda$-sheaf on $X_\proetale$.
Then there exists a finite partition $X = \coprod X_i$ by
locally closed subschemes such that the restriction $\mathcal{F}|_{X_i}$
is lisse.
\end{lemma}

\begin{proof}
Let $R = \bigoplus I^n/I^{n + 1}$. Observe that $R$ is a Noetherian ring.
Since each of the sheaves
$\mathcal{F}/I^n\mathcal{F}$ is a constructible sheaf of
$\Lambda/I^n\Lambda$-modules also $I^n\mathcal{F}/I^{n + 1}\mathcal{F}$
is a constructible sheaf of $\Lambda/I$-modules and hence the pullback
of a constructible sheaf $\mathcal{G}_n$ on $X_\etale$ by
Lemma \ref{lemma-compare-constructible}.
Set $\mathcal{G} = \bigoplus \mathcal{G}_n$. This is a sheaf
of $R$-modules on $X_\etale$ and the map
$$
\mathcal{G}_0 \otimes_{\Lambda/I} \underline{R}
\longrightarrow
\mathcal{G}
$$
is surjective because the maps
$$
\mathcal{F}/I\mathcal{F} \otimes \underline{I^n/I^{n + 1}} \to
I^n\mathcal{F}/I^{n + 1}\mathcal{F}
$$
are surjective. Hence $\mathcal{G}$ is a constructible sheaf of
$R$-modules by \'Etale Cohomology, Proposition
\ref{etale-cohomology-proposition-constructible-over-noetherian}.
Choose a partition $X = \coprod X_i$ such that
$\mathcal{G}|_{X_i}$ is a locally constant sheaf of $R$-modules
of finite type (\'Etale Cohomology, Lemma
\ref{etale-cohomology-lemma-constructible-quasi-compact-quasi-separated}).
We claim this is a partition as in the lemma.
Namely, replacing $X$ by $X_i$ we may assume $\mathcal{G}$ is locally
constant. It follows that each of the sheaves
 $I^n\mathcal{F}/I^{n + 1}\mathcal{F}$
is locally constant. Using the short exact sequences
$$
0 \to I^n\mathcal{F}/I^{n + 1}\mathcal{F} \to
\mathcal{F}/I^{n + 1}\mathcal{F} \to \mathcal{F}/I^n\mathcal{F} \to 0
$$
induction and Modules on Sites, Lemma
\ref{sites-modules-lemma-kernel-finite-locally-constant}
the lemma follows.
\end{proof}

\begin{lemma}
\label{lemma-weird}
Let $X$ be a weakly contractible affine scheme. Let $\Lambda$ be a Noetherian
ring and $I \subset \Lambda$ be an ideal. Let $\mathcal{F}$ be a sheaf of
$\Lambda$-modules on $X_\proetale$ such that
\begin{enumerate}
\item $\mathcal{F} = \lim \mathcal{F}/I^n\mathcal{F}$,
\item $\mathcal{F}/I^n\mathcal{F}$ is a constant sheaf of
$\Lambda/I^n$-modules,
\item $\mathcal{F}/I\mathcal{F}$ is of finite type.
\end{enumerate}
Then $\mathcal{F} \cong \underline{M}^\wedge$ where $M$ is
a finite $\Lambda^\wedge$-module.
\end{lemma}

\begin{proof}
Pick a $\Lambda/I^n$-module $M_n$ such that
$\mathcal{F}/I^n\mathcal{F} \cong \underline{M_n}$.
Since we have the surjections
$\mathcal{F}/I^{n + 1}\mathcal{F} \to \mathcal{F}/I^n\mathcal{F}$
we conclude that there
exist surjections $M_{n + 1} \to M_n$ inducing isomorphisms
$M_{n + 1}/I^nM_{n + 1} \to M_n$. Fix a choice of such surjections
and set $M = \lim M_n$. Then $M$ is an $I$-adically complete
$\Lambda$-module with $M/I^nM = M_n$, see
Algebra, Lemma \ref{algebra-lemma-limit-complete}.
Since $M_1$ is a finite type $\Lambda$-module
(Modules on Sites, Lemma
\ref{sites-modules-lemma-locally-constant-finite-type})
we see that $M$ is a finite $\Lambda^\wedge$-module.
Consider the sheaves
$$
\mathcal{I}_n = \mathit{Isom}(\underline{M_n}, \mathcal{F}/I^n\mathcal{F})
$$
on $X_\proetale$. Modding out by $I^n$ defines a transition map
$$
\mathcal{I}_{n + 1} \longrightarrow \mathcal{I}_n
$$
By our choice of $M_n$ the sheaf $\mathcal{I}_n$ is a torsor under
$$
\mathit{Isom}(\underline{M_n}, \underline{M_n}) =
\underline{\text{Isom}_\Lambda(M_n, M_n)}
$$
(Modules on Sites, Lemma \ref{sites-modules-lemma-locally-constant})
since $\mathcal{F}/I^n\mathcal{F}$ is (\'etale) locally isomorphic
to $\underline{M_n}$. It follows from
More on Algebra, Lemma \ref{more-algebra-lemma-hom-systems-ML}
that the system of sheaves $(\mathcal{I}_n)$ is Mittag-Leffler.
For each $n$ let $\mathcal{I}'_n \subset \mathcal{I}_n$ be the
image of $\mathcal{I}_N \to \mathcal{I}_n$ for all $N \gg n$.
Then
$$
\ldots \to \mathcal{I}'_3 \to \mathcal{I}'_2 \to \mathcal{I}'_1 \to *
$$
is a sequence of sheaves of sets on $X_\proetale$ with surjective
transition maps. Since $*(X)$ is a singleton (not empty)
and since evaluating at $X$ transforms surjective maps of sheaves of sets
into surjections of sets, we can pick
$s \in \lim \mathcal{I}'_n(X)$. The sections define isomorphisms
$\underline{M}^\wedge \to \lim \mathcal{F}/I^n\mathcal{F} = \mathcal{F}$
and the proof is done.
\end{proof}

\begin{lemma}
\label{lemma-connected-lisse}
Let $X$ be a connected scheme. Let $\Lambda$ be a Noetherian ring and let
$I \subset \Lambda$ be an ideal. If $\mathcal{F}$ is a lisse
constructible $\Lambda$-sheaf on $X_\proetale$, then $\mathcal{F}$
is adic lisse.
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-compare-locally-constant} we have
$\mathcal{F}/I^n\mathcal{F} = \epsilon^{-1}\mathcal{G}_n$
for some locally constant sheaf $\mathcal{G}_n$ of $\Lambda/I^n$-modules. By
\'Etale Cohomology, Lemma
\ref{etale-cohomology-lemma-connected-locally-constant}
there exists a finite $\Lambda/I^n$-module $M_n$ such that
$\mathcal{G}_n$ is locally isomorphic to $\underline{M_n}$.
Choose a covering $\{W_t \to X\}_{t \in T}$ with each $W_t$
affine and weakly contractible.
Then $\mathcal{F}|_{W_t}$ satisfies the assumptions of
Lemma \ref{lemma-weird}
and hence $\mathcal{F}|_{W_t} \cong \underline{N_t}^\wedge$
for some finite $\Lambda^\wedge$-module $N_t$. Note that
$N_t/I^nN_t \cong M_n$ for all $t$ and $n$. Hence
$N_t \cong N_{t'}$ for all $t, t' \in T$, see
More on Algebra, Lemma \ref{more-algebra-lemma-isomorphic-completions}.
This proves that $\mathcal{F}$ is adic lisse.
\end{proof}

\begin{lemma}
\label{lemma-Noetherian-adic-constructible}
Let $X$ be a Noetherian scheme. Let $\Lambda$ be a Noetherian ring and
let $I \subset \Lambda$ be an ideal. Let $\mathcal{F}$ be a
constructible $\Lambda$-sheaf on $X_\proetale$. Then $\mathcal{F}$
is adic constructible.
\end{lemma}

\begin{proof}
This is a consequence of Lemmas \ref{lemma-Noetherian-constructible} and
\ref{lemma-connected-lisse}, the fact that a Noetherian scheme
is locally connected
(Topology, Lemma \ref{topology-lemma-locally-Noetherian-locally-connected}),
and the definitions.
\end{proof}

\noindent
It will be useful to identify the constructible $\Lambda$-sheaves
inside the category of derived complete sheaves of $\Lambda$-modules.
It turns out that the naive analogue of
More on Algebra, Lemma \ref{more-algebra-lemma-derived-complete-finite}
is wrong in this setting. However, here
is the analogue of More on Algebra, Lemma
\ref{more-algebra-lemma-derived-complete-zero}.

\begin{lemma}
\label{lemma-derived-complete-zero}
Let $X$ be a scheme. Let $\Lambda$ be a ring and let
$I \subset \Lambda$ be a finitely generated ideal.
Let $\mathcal{F}$ be a sheaf of $\Lambda$-modules on $X_\proetale$.
If $\mathcal{F}$ is derived complete and $\mathcal{F}/I\mathcal{F} = 0$,
then $\mathcal{F} = 0$.
\end{lemma}

\begin{proof}
Assume that $\mathcal{F}/I\mathcal{F}$ is zero.
Let $I = (f_1, \ldots, f_r)$. Let $i < r$ be the largest
integer such that $\mathcal{G} = \mathcal{F}/(f_1, \ldots, f_i)\mathcal{F}$
is nonzero. If $i$ does not exist, then $\mathcal{F} = 0$ which is what we
want to show. Then $\mathcal{G}$ is derived complete as a cokernel
of a map between derived complete modules, see
Proposition \ref{proposition-enough-weakly-contractibles}.
By our choice of $i$ we have that $f_{i + 1} : \mathcal{G} \to \mathcal{G}$
is surjective. Hence
$$
\lim (\ldots \to \mathcal{G} \xrightarrow{f_{i + 1}} \mathcal{G}
\xrightarrow{f_{i + 1}} \mathcal{G})
$$
is nonzero, contradicting the derived completeness of $\mathcal{G}$.
\end{proof}

\begin{lemma}
\label{lemma-derived-complete-limit}
Let $X$ be a weakly contractible affine scheme.
Let $\Lambda$ be a Noetherian ring and let $I \subset \Lambda$ be an ideal.
Let $\mathcal{F}$ be a derived complete sheaf of $\Lambda$-modules
on $X_\proetale$ with $\mathcal{F}/I\mathcal{F}$ a locally
constant sheaf of $\Lambda/I$-modules of finite type.
Then there exists an integer $t$ and a surjective map
$$
(\underline{\Lambda}^\wedge)^{\oplus t} \to \mathcal{F}
$$
\end{lemma}

\begin{proof}
Since $X$ is weakly contractible, there exists a finite disjoint open
covering $X = \coprod U_i$ such that $\mathcal{F}/I\mathcal{F}|_{U_i}$
is isomorphic to the constant sheaf associated to a finite $\Lambda/I$-module
$M_i$. Choose finitely many generators $m_{ij}$ of $M_i$. We
can find sections $s_{ij} \in \mathcal{F}(X)$ restricting to
$m_{ij}$ viewed as a section of $\mathcal{F}/I\mathcal{F}$ over $U_i$. 
Let $t$ be the total number of $s_{ij}$. Then we obtain a map
$$
\alpha : \underline{\Lambda}^{\oplus t} \longrightarrow \mathcal{F}
$$
which is surjective modulo $I$ by construction. By
Lemma \ref{lemma-naive-completion}
the derived completion of $\underline{\Lambda}^{\oplus t}$ is the
sheaf $(\underline{\Lambda}^\wedge)^{\oplus t}$. Since $\mathcal{F}$
is derived complete we see that $\alpha$ factors through a map
$$
\alpha^\wedge :
(\underline{\Lambda}^\wedge)^{\oplus t}
\longrightarrow
\mathcal{F}
$$
Then $\mathcal{Q} = \Coker(\alpha^\wedge)$ is a derived complete
sheaf of $\Lambda$-modules by
Proposition \ref{proposition-enough-weakly-contractibles}.
By construction $\mathcal{Q}/I\mathcal{Q} = 0$. It follows from
Lemma \ref{lemma-derived-complete-zero}
that $\mathcal{Q} = 0$ which is what we wanted to show.
\end{proof}








\section{A suitable derived category}
\label{section-suitable-derived}

\noindent
Let $X$ be a scheme. It will turn out that for many schemes $X$ a suitable
derived category of $\ell$-adic sheaves can be gotten by considering the
derived complete objects $K$ of $D(X_\proetale, \Lambda)$ with the property
that $K \otimes_\Lambda^\mathbf{L} \mathbf{F}_\ell$ is bounded with
constructible cohomology sheaves. Here is the general definition.

\begin{definition}
\label{definition-Dbc}
Let $\Lambda$ be a Noetherian ring and let $I \subset \Lambda$ be an ideal.
Let $X$ be a scheme. An object $K$ of $D(X_\proetale, \Lambda)$ is called
{\it constructible} if
\begin{enumerate}
\item $K$ is derived complete with respect to $I$,
\item $K \otimes_\Lambda^\mathbf{L} \underline{\Lambda/I}$
has constructible cohomology sheaves and locally has finite tor dimension.
\end{enumerate}
We denote $D_{cons}(X, \Lambda)$ the full subcategory of constructible
$K$ in $D(X_\proetale, \Lambda)$.
\end{definition}

\noindent
Recall that with our conventions a complex of finite tor dimension
is bounded (Cohomology on Sites, Definition
\ref{sites-cohomology-definition-tor-amplitude}).
In fact, let's collect everything proved so far in a lemma.

\begin{lemma}
\label{lemma-describe-constructible-complexes}
In the situation above suppose $K$ is in $D_{cons}(X, \Lambda)$
and $X$ is quasi-compact. Set
$K_n = K \otimes_\Lambda^\mathbf{L} \underline{\Lambda/I^n}$.
There exist $a, b$ such that
\begin{enumerate}
\item $K = R\lim K_n$ and $H^i(K) = 0$ for $i \not \in [a, b]$,
\item each $K_n$ has tor amplitude in $[a, b]$,
\item each $K_n$ has constructible cohomology sheaves,
\item each $K_n = \epsilon^{-1}L_n$ for some
$L_n \in D_{ctf}(X_\etale, \Lambda/I^n)$
(\'Etale Cohomology, Definition \ref{etale-cohomology-definition-ctf}).
\end{enumerate}
\end{lemma}

\begin{proof}
By definition of local having finite tor dimension, we can find
$a, b$ such that $K_1$ has tor amplitude in $[a, b]$.
Part (2) follows from 
Cohomology on Sites, Lemma \ref{sites-cohomology-lemma-bounded}.
Then (1) follows as $K$ is derived complete by the description
of limits in
Cohomology on Sites, Proposition
\ref{sites-cohomology-proposition-enough-weakly-contractibles}
and the fact that $H^b(K_{n + 1}) \to H^b(K_n)$ is surjective
as $K_n = K_{n + 1} \otimes^\mathbf{L}_\Lambda \underline{\Lambda/I^n}$.
Part (3) follows from
Lemma \ref{lemma-compare-truncations-constructible},
Part (4) follows from
Lemma \ref{lemma-compare-constructible-derived}
and the fact that $L_n$ has finite tor dimension because $K_n$ does
(small argument omitted).
\end{proof}

\begin{lemma}
\label{lemma-local-structure-constructible-complex}
Let $X$ be a weakly contractible affine scheme. Let $\Lambda$ be a Noetherian
ring and let $I \subset \Lambda$ be an ideal. Let $K$ be an object of
$D_{cons}(X, \Lambda)$ such that the cohomology sheaves of
$K \otimes_\Lambda^\mathbf{L} \underline{\Lambda/I}$ are locally
constant. Then there exists a finite disjoint open covering
$X = \coprod U_i$ and for each $i$ a finite collection of
finite projective $\Lambda^\wedge$-modules $M_a, \ldots, M_b$
such that $K|_{U_i}$ is represented by a complex
$$
(\underline{M^a})^\wedge \to \ldots \to (\underline{M^b})^\wedge
$$
in $D(U_{i, \proetale}, \Lambda)$ for some maps of sheaves of
$\Lambda$-modules $(\underline{M^i})^\wedge \to (\underline{M^{i + 1}})^\wedge$.
\end{lemma}

\begin{proof}
We freely use the results of
Lemma \ref{lemma-describe-constructible-complexes}.
Choose $a, b$ as in that lemma. We will prove the lemma by
induction on $b - a$. Let $\mathcal{F} = H^b(K)$.
Note that $\mathcal{F}$ is a derived complete sheaf of
$\Lambda$-modules by
Proposition \ref{proposition-enough-weakly-contractibles}.
Moreover $\mathcal{F}/I\mathcal{F}$ is a locally
constant sheaf of $\Lambda/I$-modules of finite type.
Apply Lemma \ref{lemma-derived-complete-limit} to get a surjection
$\rho : (\underline{\Lambda}^\wedge)^{\oplus t} \to \mathcal{F}$.

\medskip\noindent
If $a = b$, then $K = \mathcal{F}[-b]$. In this case we see that
$$
\mathcal{F} \otimes_\Lambda^\mathbf{L} \underline{\Lambda/I} =
\mathcal{F}/I\mathcal{F}
$$
As $X$ is weakly contractible and $\mathcal{F}/I\mathcal{F}$
locally constant, we can find a finite disjoint
union decomposition $X = \coprod U_i$ by affine opens $U_i$
and $\Lambda/I$-modules $\overline{M}_i$
such that $\mathcal{F}/I\mathcal{F}$ restricts to
$\underline{\overline{M}_i}$ on $U_i$. After refining the covering
we may assume the map
$$
\rho|_{U_i} \bmod I :
\underline{\Lambda/I}^{\oplus t}
\longrightarrow
\underline{\overline{M}_i}
$$
is equal to $\underline{\alpha_i}$ for some surjective module map
$\alpha_i : \Lambda/I^{\oplus t} \to \overline{M}_i$, see
Modules on Sites, Lemma \ref{sites-modules-lemma-morphism-locally-constant}.
Note that each $\overline{M}_i$ is a finite $\Lambda/I$-module.
Since $\mathcal{F}/I\mathcal{F}$ has tor amplitude in $[0, 0]$
we conclude that $\overline{M}_i$ is a flat $\Lambda/I$-module.
Hence $\overline{M}_i$ is finite projective
(Algebra, Lemma \ref{algebra-lemma-finite-projective}).
Hence we can find a projector
$\overline{p}_i : (\Lambda/I)^{\oplus t} \to (\Lambda/I)^{\oplus t}$
whose image maps isomorphically to $\overline{M}_i$ under the map $\alpha_i$.
We can lift $\overline{p}_i$ to a projector
$p_i : (\Lambda^\wedge)^{\oplus t} \to
(\Lambda^\wedge)^{\oplus t}$\footnote{Proof: by
Algebra, Lemma \ref{algebra-lemma-lift-idempotents-noncommutative}
we can lift $\overline{p}_i$ to a compatible system of
projectors $p_{i, n} : (\Lambda/I^n)^{\oplus t} \to (\Lambda/I^n)^{\oplus t}$
and then we set $p_i = \lim p_{i, n}$ which works because
$\Lambda^\wedge = \lim \Lambda/I^n$.}.
Then $M_i = \Im(p_i)$ is a finite $I$-adically complete
$\Lambda^\wedge$-module with $M_i/IM_i = \overline{M}_i$.
Over $U_i$ consider the maps
$$
\underline{M_i}^\wedge \to
(\underline{\Lambda}^\wedge)^{\oplus t} \to
\mathcal{F}|_{U_i}
$$
By construction the composition induces an isomorphism modulo $I$.
The source and target are derived complete, hence so are the cokernel
$\mathcal{Q}$ and the kernel $\mathcal{K}$. We have
$\mathcal{Q}/I\mathcal{Q} = 0$ by construction hence $\mathcal{Q}$
is zero by Lemma \ref{lemma-derived-complete-zero}.
Then
$$
0 \to \mathcal{K}/I\mathcal{K} \to
\underline{\overline{M}_i}
\to \mathcal{F}/I\mathcal{F} \to 0
$$
is exact by the vanishing of $\text{Tor}_1$ see at the start of this
paragraph; also use that
$\underline{\Lambda}^\wedge/I\overline{\Lambda}^\wedge$ by
Modules on Sites, Lemma \ref{sites-modules-lemma-completion-flat}
to see that
$\underline{M_i}^\wedge/I\underline{M_i}^\wedge = \underline{\overline{M}_i}$.
Hence $\mathcal{K}/I\mathcal{K} = 0$ by construction and we conclude
that $\mathcal{K} = 0$ as before. This proves the result in case $a = b$.

\medskip\noindent
If $b > a$, then we lift the map $\rho$ to a map
$$
\tilde \rho : (\underline{\Lambda}^\wedge)^{\oplus t}[-b] \longrightarrow K
$$
in $D(X_\proetale, \Lambda)$. This is possible as we can think of
$K$ as a complex of $\underline{\Lambda}^\wedge$-modules by
discussion in the introduction to
Section \ref{section-derived-completion-noetherian}
and because $X_\proetale$ is weakly contractible
hence there is no obstruction to lifting the elements
$\rho(e_s) \in H^0(X, \mathcal{F})$ to elements of $H^b(X, K)$.
Fitting $\tilde \rho$ into a distinguished triangle
$$
(\underline{\Lambda}^\wedge)^{\oplus t}[-b] \to K \to L \to
(\underline{\Lambda}^\wedge)^{\oplus t}[-b + 1]
$$
we see that $L$ is an object of $D_{cons}(X, \Lambda)$ such
that $L \otimes_\Lambda^\mathbf{L} \underline{\Lambda/I}$
has tor amplitude contained in $[a, b - 1]$ (details omitted).
By induction we can describe $L$ locally as stated in the lemma, say
$L$ is isomorphic to
$$
(\underline{M^a})^\wedge \to \ldots \to (\underline{M^{b - 1}})^\wedge
$$
The map
$L \to (\underline{\Lambda}^\wedge)^{\oplus t}[-b + 1]$
corresponds to a map
$(\underline{M^{b - 1}})^\wedge \to (\underline{\Lambda}^\wedge)^{\oplus t}$
which allows us to extend the complex by one. The corresponding
complex is isomorphic to $K$ in the derived category by the properties
of triangulated categories. This finishes the proof.
\end{proof}

\noindent
Motivated by what happens for constructible $\Lambda$-sheaves
we introduce the following notion.

\begin{definition}
\label{definition-adic-constructible}
Let $X$ be a scheme. Let $\Lambda$ be a Noetherian ring and let
$I \subset \Lambda$ be an ideal. Let $K \in D(X_\proetale, \Lambda)$.
\begin{enumerate}
\item We say $K$ is {\it adic lisse}\footnote{This may be
nonstandard notation} if there exists a finite complex of finite
projective $\Lambda^\wedge$-modules $M^\bullet$ such that
$K$ is locally isomorphic to
$$
\underline{M^a}^\wedge \to \ldots \to \underline{M^b}^\wedge
$$
\item We say $K$ is {\it adic constructible}\footnote{This may be
nonstandard notation.} if for every affine open $U \subset X$
there exists a decomposition $U = \coprod U_i$ into
constructible locally closed subschemes such that $K|_{U_i}$
is adic lisse.
\end{enumerate}
\end{definition}

\noindent
The difference between the local structure obtained in
Lemma \ref{lemma-local-structure-constructible-complex}
and the structure of an adic lisse complex is that
the maps $\underline{M^i}^\wedge \to \underline{M^{i + 1}}^\wedge$ in 
Lemma \ref{lemma-local-structure-constructible-complex}
need not be constant, whereas in the definition above they
are required to be constant.

\begin{lemma}
\label{lemma-weakly-contractible-locally-constant-ML}
Let $X$ be a weakly contractible affine scheme. Let $\Lambda$ be a Noetherian
ring and let $I \subset \Lambda$ be an ideal. Let $K$ be an object of
$D_{cons}(X, \Lambda)$ such that
$K \otimes_\Lambda^\mathbf{L} \underline{\Lambda/I^n}$
is isomorphic in $D(X_\proetale, \Lambda/I^n)$ to a
complex of constant sheaves of $\Lambda/I^n$-modules. Then
$$
H^0(X, K \otimes_\Lambda^\mathbf{L} \Lambda/I^n)
$$
has the Mittag-Leffler condition.
\end{lemma}

\begin{proof}
Say $K \otimes_\Lambda^\mathbf{L} \underline{\Lambda/I^n}$ is isomorphic
to $\underline{E_n}$ for some object $E_n$ of $D(\Lambda/I^n)$.
Since $K \otimes_\Lambda^\mathbf{L} \underline{\Lambda/I}$ has
finite tor dimension and has finite type cohomology sheaves
we see that $E_1$ is perfect (see
More on Algebra, Lemma \ref{more-algebra-lemma-perfect}). The transition maps
$$
K \otimes_\Lambda^\mathbf{L} \underline{\Lambda/I^{n + 1}}
\to
K \otimes_\Lambda^\mathbf{L} \underline{\Lambda/I^n}
$$
locally come from (possibly many distinct) maps of complexes
$E_{n + 1} \to E_n$ in $D(\Lambda/I^{n + 1})$ see
Cohomology on Sites, Lemma \ref{sites-cohomology-lemma-locally-constant-map}.
For each $n$ choose one such map and observe that it induces
an isomorphism
$E_{n + 1} \otimes_{\Lambda/I^{n + 1}}^\mathbf{L} \Lambda/I^n \to E_n$
in $D(\Lambda/I^n)$. By
More on Algebra, Lemma \ref{more-algebra-lemma-Rlim-perfect-gives-complete}
we can find a finite complex $M^\bullet$ of finite projective
$\Lambda^\wedge$-modules and isomorphisms $M^\bullet/I^nM^\bullet \to E_n$
in $D(\Lambda/I^n)$ compatible with the transition maps.

\medskip\noindent
Now observe that for each finite collection of indices
$n > m > k$ the triple of maps
$$
H^0(X, K \otimes_\Lambda^\mathbf{L} \Lambda/I^n)
\to
H^0(X, K \otimes_\Lambda^\mathbf{L} \Lambda/I^m)
\to
H^0(X, K \otimes_\Lambda^\mathbf{L} \Lambda/I^k)
$$
is isomorphic to
$$
H^0(X, \underline{M^\bullet/I^nM^\bullet})
\to
H^0(X, \underline{M^\bullet/I^mM^\bullet})
\to
H^0(X, \underline{M^\bullet/I^kM^\bullet})
$$
Namely, choose any isomorphism
$$
\underline{M^\bullet/I^nM^\bullet} \to
K \otimes_\Lambda^\mathbf{L} \Lambda/I^n
$$
induces similar isomorphisms module $I^m$ and $I^k$ and we see that
the assertion is true. Thus to prove the lemma it suffices to show that
the system
$H^0(X, \underline{M^\bullet/I^nM^\bullet})$ has Mittag-Leffler.
Since taking sections over $X$ is exact, it suffices to prove that
the system of $\Lambda$-modules
$$
H^0(M^\bullet/I^nM^\bullet)
$$
has Mittag-Leffler. Set $A = \Lambda^\wedge$ and consider the spectral
sequence
$$
\text{Tor}_{-p}^A(H^q(M^\bullet), A/I^nA) \Rightarrow
H^{p + q}(M^\bullet/I^nM^\bullet)
$$
By More on Algebra, Lemma \ref{more-algebra-lemma-tor-strictly-pro-zero}
the pro-systems $\{\text{Tor}_{-p}^A(H^q(M^\bullet), A/I^nA)\}$ are zero
for $p > 0$. Thus the pro-system $\{H^0(M^\bullet/I^nM^\bullet)\}$
is equal to the pro-system $\{H^0(M^\bullet)/I^nH^0(M^\bullet)\}$
and the lemma is proved.
\end{proof}

\begin{lemma}
\label{lemma-connected-adic-lisse}
Let $X$ be a connected scheme. Let $\Lambda$ be a Noetherian ring and let
$I \subset \Lambda$ be an ideal. If $K$ is in $D_{cons}(X, \Lambda)$
such that $K \otimes_\Lambda \underline{\Lambda/I}$
has locally constant cohomology sheaves, then $K$ is adic lisse
(Definition \ref{definition-adic-constructible}).
\end{lemma}

\begin{proof}
Write $K_n = K \otimes_\Lambda^\mathbf{L} \underline{\Lambda/I^n}$.
We will use the results of Lemma \ref{lemma-describe-constructible-complexes}
without further mention. By Cohomology on Sites, Lemma
\ref{sites-cohomology-lemma-locally-constant-bounded}
we see that $K_n$ has locally constant cohomology sheaves for all $n$.
We have $K_n = \epsilon^{-1}L_n$ some $L_n$ in
$D_{ctf}(X_\etale, \Lambda/I^n)$ with locally constant cohomology sheaves.
By \'Etale Cohomology, Lemma
\ref{etale-cohomology-lemma-connected-ctf-locally-constant}
there exist perfect $M_n \in D(\Lambda/I^n)$
such that $L_n$ is \'etale locally isomorphic to $\underline{M_n}$.
The maps $L_{n + 1} \to L_n$ corresponding to $K_{n + 1} \to K_n$
induces isomorphisms
$L_{n + 1} \otimes_{\Lambda/I^{n + 1}}^\mathbf{L} \underline{\Lambda/I^n}
\to L_n$. Looking locally on $X$ we conclude that there
exist maps $M_{n + 1} \to M_n$ in $D(\Lambda/I^{n + 1})$
inducing isomorphisms
$M_{n + 1} \otimes_{\Lambda/I^{n + 1}} \Lambda/I^n \to M_n$, see
Cohomology on Sites, Lemma \ref{sites-cohomology-lemma-locally-constant-map}.
Fix a choice of such maps. By
More on Algebra, Lemma \ref{more-algebra-lemma-Rlim-perfect-gives-complete}
we can find a finite complex $M^\bullet$ of finite projective
$\Lambda^\wedge$-modules and isomorphisms $M^\bullet/I^nM^\bullet \to M_n$
in $D(\Lambda/I^n)$ compatible with the transition maps.
To finish the proof we will show that $K$ is locally isomorphic
to
$$
\underline{M^\bullet}^\wedge =
\lim \underline{M^\bullet/I^nM^\bullet} =
R\lim \underline{M^\bullet/I^nM^\bullet}
$$
Let $E^\bullet$ be the dual complex to $M^\bullet$, see
More on Algebra, Lemma \ref{more-algebra-lemma-dual-perfect-complex}
and its proof. Consider the objects
$$
H_n =
R\SheafHom_{\Lambda/I^n}(\underline{M^\bullet/I^nM^\bullet}, K_n) =
\underline{E^\bullet/I^nE^\bullet} \otimes_{\Lambda/I^n}^\mathbf{L} K_n
$$
of $D(X_\proetale, \Lambda/I^n)$. Modding out by $I^n$ defines a
transition map $H_{n + 1} \to H_n$. Set $H = R\lim H_n$. Then $H$ is an
object of $D_{cons}(X, \Lambda)$ (details omitted) with
$H \otimes_\Lambda^\mathbf{L} \underline{\Lambda/I^n} = H_n$.
Choose a covering $\{W_t \to X\}_{t \in T}$ with each $W_t$
affine and weakly contractible. By our choice of $M^\bullet$
we see that
\begin{align*}
H_n|_{W_t} & \cong 
R\SheafHom_{\Lambda/I^n}(\underline{M^\bullet/I^nM^\bullet},
\underline{M^\bullet/I^nM^\bullet}) \\
& =
\underline{
\text{Tot}(E^\bullet/I^nE^\bullet \otimes_{\Lambda/I^n} M^\bullet/I^nM^\bullet)
}
\end{align*}
Thus we may apply Lemma \ref{lemma-weakly-contractible-locally-constant-ML}
to $H = R\lim H_n$. We conclude the system $H^0(W_t, H_n)$ satisfies
Mittag-Leffler. Since for all $n \gg 1$ there is an element of $H^0(W_t, H_n)$
which maps to an isomorphism in
$$
H^0(W_t, H_1) = \Hom(\underline{M^\bullet/IM^\bullet}, K_1)
$$
we find an element $(\varphi_{t, n})$
in the inverse limit which produces an isomorphism mod $I$. Then
$$
R\lim \varphi_{t, n} :
\underline{M^\bullet}^\wedge|_{W_t} =
R\lim \underline{M^\bullet/I^nM^\bullet}|_{W_t}
\longrightarrow
R\lim K_n|_{W_t} = K|_{W_t}
$$
is an isomorphism. This finishes the proof.
\end{proof}

\begin{proposition}
\label{proposition-Noetherian-adic-constructible}
Let $X$ be a Noetherian scheme. Let $\Lambda$ be a Noetherian ring and
let $I \subset \Lambda$ be an ideal. Let $K$ be an object of
$D_{cons}(X, \Lambda)$. Then $K$ is adic constructible
(Definition \ref{definition-adic-constructible}).
\end{proposition}

\begin{proof}
This is a consequence of Lemma \ref{lemma-connected-adic-lisse}
and the fact that a Noetherian scheme is locally connected
(Topology, Lemma \ref{topology-lemma-locally-Noetherian-locally-connected}),
and the definitions.
\end{proof}







\section{Proper base change}
\label{section-proper-base-change}

\noindent
In this section we explain how to prove the proper base change theorem
for derived complete objects on the pro-\'etale site using the proper
base change theorem for \'etale cohomology following the general theme
that we use the pro-\'etale topology only to deal with ``limit issues''
and we use results proved for the \'etale topology to handle everything
else.

\begin{theorem}
\label{theorem-proper-base-change}
Let $f : X \to Y$ be a proper morphism of schemes. Let $g : Y' \to Y$ be
a morphism of schemes giving rise to the base change diagram
$$
\xymatrix{
X' \ar[r]_{g'} \ar[d]_{f'} & X \ar[d]^f \\
Y' \ar[r]^g & Y
}
$$
Let $\Lambda$ be a Noetherian ring and let $I \subset \Lambda$ be an ideal
such that $\Lambda/I$ is torsion. Let $K$ be an object
of $D(X_\proetale)$ such that
\begin{enumerate}
\item $K$ is derived complete, and
\item $K \otimes_\Lambda^\mathbf{L} \underline{\Lambda/I^n}$ is
bounded below with cohomology sheaves coming from $X_\etale$,
\item $\Lambda/I^n$ is a perfect $\Lambda$-module\footnote{This assumption
can be removed if $K$ is a constructible complex, see \cite{BS}.}.
\end{enumerate}
Then the base change map
$$
Lg_{comp}^*Rf_*K \longrightarrow Rf'_*L(g')^*_{comp}K
$$
is an isomorphism.
\end{theorem}

\begin{proof}
We omit the construction of the base change map (this uses only
formal properties of derived pushforward and completed derived pullback,
compare with
Cohomology on Sites, Remark \ref{sites-cohomology-remark-base-change}).
Write $K_n = K \otimes^\mathbf{L}_\Lambda \underline{\Lambda/I^n}$.
By Lemma \ref{lemma-naive-completion} we have $K = R\lim K_n$
because $K$ is derived complete.
By Lemmas \ref{lemma-pushforward-Noetherian-case} and
\ref{lemma-naive-completion} we can unwind the left hand side
$$
Lg_{comp}^* Rf_* K =
R\lim Lg^*(Rf_*K)\otimes^\mathbf{L}_\Lambda \underline{\Lambda/I^n} =
R\lim Lg^* Rf_* K_n
$$
the last equality because $\Lambda/I^n$ is a perfect module and
the projection formula (Cohomology on Sites, Lemma
\ref{sites-cohomology-lemma-projection-formula}).
Using Lemma \ref{lemma-pushforward-Noetherian-case} we can unwind the right
hand side
$$
Rf'_* L(g')^*_{comp} K =
Rf'_* R\lim L(g')^* K_n  =
R\lim Rf'_* L(g')^* K_n
$$
the last equality because $Rf'_*$ commutes with $R\lim$
(Cohomology on Sites, Lemma
\ref{sites-cohomology-lemma-Rf-commutes-with-Rlim}).
Thus it suffices to show the maps
$$
Lg^* Rf_* K_n \longrightarrow Rf'_* L(g')^* K_n
$$
are isomorphisms. By Lemma \ref{lemma-compare-derived} and our second
condition we can write $K_n = \epsilon^{-1}L_n$ for some
$L_n \in D^+(X_\etale, \Lambda/I^n)$. By Lemma \ref{lemma-morphism-comparison}
and the fact that $\epsilon^{-1}$ commutes with pullbacks
we obtain
$$
Lg^* Rf_* K_n =
Lg^* Rf_* \epsilon^*L_n =
Lg^* \epsilon^{-1} Rf_* L_n =
\epsilon^{-1} Lg^* Rf_* L_n
$$
and
$$
Rf'_* L(g')^* K_n =
Rf'_* L(g')^* \epsilon^{-1} L_n =
Rf'_* \epsilon^{-1} L(g')^* L_n =
\epsilon^{-1} Rf'_* L(g')^* L_n
$$
(this also uses that $L_n$ is bounded below).
Finally, by the proper base change theorem for \'etale cohomology
(\'Etale Cohomology, Theorem
\ref{etale-cohomology-theorem-proper-base-change}) we have
$$
Lg^* Rf_* L_n = Rf'_* L(g')^* L_n
$$
(again using that $L_n$ is bounded below)
and the theorem is proved.
\end{proof}






\section{Change of partial universe}
\label{section-change-universe}

\noindent
We advise the reader to skip this section: here we show that cohomology
of sheaves in the pro-\'etale topology is independent of the
choice of partial universe. Namely, the functor $g_*$ of
Lemma \ref{lemma-proetale-cohomology-independent-partial-universe} below
is an embedding of small pro-\'etale topoi which does not change cohomology.
For big pro-\'etale sites we have Lemmas \ref{lemma-change-alpha} and
\ref{lemma-cohomology-enlarge-partial-universe} saying essentially the
same thing.

\medskip\noindent
But first, 
as promised in Section \ref{section-proetale} we prove that the topology on a
big pro-\'etale site $\Sch_\proetale$ is in some sense induced from
the pro-\'etale topology on the category of all schemes.

\begin{lemma}
\label{lemma-proetale-induced}
Let $\Sch_\proetale$ be a big pro-\'etale site as in
Definition \ref{definition-big-proetale-site}.
Let $T \in \Ob(\Sch_\proetale)$.
Let $\{T_i \to T\}_{i \in I}$ be an arbitrary pro-\'etale covering of $T$.
There exists a covering $\{U_j \to T\}_{j \in J}$ of $T$ in the site
$\Sch_\proetale$ which refines $\{T_i \to T\}_{i \in I}$.
\end{lemma}

\begin{proof}
Namely, we first let $\{V_k \to T\}$ be a covering as in
Lemma \ref{lemma-get-many-weakly-contractible}.
Then the pro-\'etale coverings $\{T_i \times_T V_k \to V_k\}$
can be refined by a finite disjoint open covering
$V_k = V_{k, 1} \amalg \ldots \amalg V_{k, n_k}$, see
Lemma \ref{lemma-w-contractible-proetale-cover}.
Then $\{V_{k, i} \to T\}$ is a covering of $\Sch_\proetale$
which refines $\{T_i \to T\}_{i \in I}$.
\end{proof}

\noindent
We first state and prove the comparison for the small pro-\'etale
sites. Note that we are not claiming that the small pro-\'etale topos
of a scheme is independent of the choice of partial universe; this isn't
true in contrast with the case of the small \'etale topos
(\'Etale Cohomology, Lemma
\ref{etale-cohomology-lemma-etale-topos-independent-partial-universe}).

\begin{lemma}
\label{lemma-proetale-cohomology-independent-partial-universe}
Let $S$ be a scheme. Let $S_\proetale \subset S_\proetale'$ be
two small pro-\'etale sites of $S$ as constructed in
Definition \ref{definition-big-small-proetale}. Then the inclusion functor
satisfies the assumptions of 
Sites, Lemma \ref{sites-lemma-bigger-site}.
Hence there exist morphisms of topoi
$$
\xymatrix{
\Sh(S_\proetale) \ar[r]^g &
\Sh(S_\proetale') \ar[r]^f &
\Sh(S_\proetale)
}
$$
whose composition is isomorphic to the identity and with $f_* = g^{-1}$.
Moreover,
\begin{enumerate}
\item for $\mathcal{F}' \in \textit{Ab}(S_\proetale')$ we have
$H^p(S_\proetale', \mathcal{F}') = H^p(S_\proetale, g^{-1}\mathcal{F}')$,
\item for $\mathcal{F} \in \textit{Ab}(S_\proetale)$ we have
$$
H^p(S_\proetale, \mathcal{F}) =
H^p(S_\proetale', g_*\mathcal{F}) =
H^p(S_\proetale', f^{-1}\mathcal{F}).
$$
\end{enumerate}
\end{lemma}

\begin{proof}
The inclusion functor is fully faithful and continuous.
We have seen that $S_\proetale$ and $S_\proetale'$ have fibre products
and final objects and that our functor commutes with these
(Lemma \ref{lemma-fibre-products-proetale}).
It follows from Lemma \ref{lemma-proetale-induced}
that the inclusion functor is cocontinuous.
Hence the existence of $f$ and $g$ follows from
Sites, Lemma \ref{sites-lemma-bigger-site}.
The equality in (1) is
Cohomology on Sites, Lemma \ref{sites-cohomology-lemma-cohomology-bigger-site}.
Part (2) follows from (1) as
$\mathcal{F} = g^{-1}g_*\mathcal{F} = g^{-1}f^{-1}\mathcal{F}$.
\end{proof}

\noindent
Next, we prove a corresponding result for the big pro-\'etale topoi.

\begin{lemma}
\label{lemma-change-alpha}
Suppose given big sites $\Sch_\proetale$ and $\Sch'_\proetale$ as in
Definition \ref{definition-big-proetale-site}.
Assume that $\Sch_\proetale$ is contained in $\Sch'_\proetale$.
The inclusion functor $\Sch_\proetale \to \Sch'_\proetale$ satisfies
the assumptions of Sites, Lemma \ref{sites-lemma-bigger-site}.
There are morphisms of topoi
\begin{eqnarray*}
g : \Sh(\Sch_\proetale) &
\longrightarrow &
\Sh(\Sch'_\proetale) \\
f : \Sh(\Sch'_\proetale) &
\longrightarrow &
\Sh(\Sch_\proetale)
\end{eqnarray*}
such that $f \circ g \cong \text{id}$. For any object $S$
of $\Sch_\proetale$ the inclusion functor
$(\Sch/S)_\proetale \to (\Sch'/S)_\proetale$ satisfies
the assumptions of Sites, Lemma \ref{sites-lemma-bigger-site}
also. Hence similarly we obtain morphisms
\begin{eqnarray*}
g : \Sh((\Sch/S)_\proetale) &
\longrightarrow &
\Sh((\Sch'/S)_\proetale) \\
f : \Sh((\Sch'/S)_\proetale) &
\longrightarrow &
\Sh((\Sch/S)_\proetale)
\end{eqnarray*}
with $f \circ g \cong \text{id}$.
\end{lemma}

\begin{proof}
Assumptions (b), (c), and (e) of
Sites, Lemma \ref{sites-lemma-bigger-site}
are immediate for the functors
$\Sch_\proetale \to \Sch'_\proetale$ and
$(\Sch/S)_\proetale \to (\Sch'/S)_\proetale$. Property (a) holds by
Lemma \ref{lemma-proetale-induced}.
Property (d) holds because
fibre products in the categories $\Sch_\proetale$, $\Sch'_\proetale$
exist and are compatible with fibre products in the category of schemes.
\end{proof}

\begin{lemma}
\label{lemma-cohomology-enlarge-partial-universe}
Let $S$ be a scheme. Let $(\Sch/S)_\proetale$ and $(\Sch'/S)_\proetale$ be two
big pro-\'etale sites of $S$ as in
Definition \ref{definition-big-small-proetale}.
Assume that the first is contained in
the second. In this case
\begin{enumerate}
\item for any abelian sheaf $\mathcal{F}'$ defined on $(\Sch'/S)_\proetale$
and any object $U$ of $(\Sch/S)_\proetale$ we have
$$
H^p(U, \mathcal{F}'|_{(\Sch/S)_\proetale}) =
H^p(U, \mathcal{F}')
$$
In words: the cohomology of $\mathcal{F}'$ over $U$ computed in the bigger site
agrees with the cohomology of $\mathcal{F}'$ restricted to the smaller site
over $U$.
\item for any abelian sheaf $\mathcal{F}$ on $(\Sch/S)_\proetale$ there is an
abelian sheaf $\mathcal{F}'$ on $(\Sch/S)_\proetale'$ whose restriction to
$(\Sch/S)_\proetale$ is isomorphic to $\mathcal{F}$.
\end{enumerate}
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-change-alpha} the inclusion functor
$(\Sch/S)_\proetale \to (\Sch'/S)_\proetale$ satisfies the assumptions of
Sites, Lemma \ref{sites-lemma-bigger-site}. This implies (2) and (1)
follows from
Cohomology on Sites, Lemma \ref{sites-cohomology-lemma-cohomology-bigger-site}.
\end{proof}










\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}
